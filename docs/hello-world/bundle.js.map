{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:////Users/andy/dev/game/noa-examples/node_modules/tslib/tslib.es6.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/index.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/events/events.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/ndarray/ndarray.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/aabb-3d/index.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/typedarray-pool/pool.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/components/position.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/components/physics.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/epsilon.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/create.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/fromValues.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/normalize.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/dot.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/subtract.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/multiply.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/divide.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/distance.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/squaredDistance.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/length.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/squaredLength.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/iota-array/iota.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/voxel-aabb-sweep/index.js","webpack:///(webpack)/buildin/global.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/box-intersect/lib/sweep.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/box-intersect/node_modules/bit-twiddle/twiddle.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/box-intersect/lib/partition.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/clone.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/angle.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/copy.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/set.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/equals.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/exactEquals.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/add.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/sub.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/mul.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/div.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/min.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/max.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/floor.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/ceil.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/round.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/scale.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/scaleAndAdd.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/dist.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/sqrDist.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/len.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/sqrLen.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/negate.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/inverse.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/cross.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/lerp.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/random.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/transformMat4.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/transformMat3.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/transformQuat.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/rotateX.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/rotateY.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/rotateZ.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/forEach.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/is-buffer/index.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/fast-voxel-raycast/index.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/game-shell/shell.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/util/util.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/process/browser.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/util/support/isBufferBrowser.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/util/node_modules/inherits/inherits_browser.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/domready/ready.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/game-shell/node_modules/vkey/index.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/invert-hash/invert.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/uniq/uniq.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/binary-search-bounds/search-bounds.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/game-shell/lib/raf-polyfill.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/game-shell/lib/mousewheel-polyfill.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/game-shell/lib/hrtime-polyfill.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/game-inputs/inputs.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/vkey/index.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/game-inputs/lib/mousewheel-polyfill.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/voxel-physics-engine/src/index.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/voxel-physics-engine/src/rigidBody.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/ent-comp/src/ECS.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/ent-comp/src/dataStore.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/components sync nonrecursive \\.js$","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/components/collideEntities.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/box-intersect/index.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/typedarray-pool/node_modules/bit-twiddle/twiddle.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/dup/dup.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/buffer/index.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/base64-js/index.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/ieee754/index.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/isarray/index.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/box-intersect/lib/sort.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/box-intersect/lib/intersect.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/box-intersect/lib/brute.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/box-intersect/lib/median.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/components/collideTerrain.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/components/fadeOnZoom.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/components/followsEntity.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/components/mesh.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/components/movement.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/components/receivesInputs.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/components/shadow.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/components/smoothCamera.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/lib/container.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/lib/util.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/lib/rendering.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/lib/constants.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/lib/terrainMesher.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/lib/objectMesher.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/lib/chunk.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/lib/world.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/lib/inputs.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/lib/physics.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/lib/camera.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/lib/registry.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/lib/entities.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/index.js","webpack:///./index.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","1","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","extendStatics","b","setPrototypeOf","__proto__","Array","__extends","__","this","constructor","__assign","assign","arguments","__decorate","decorators","target","desc","getOwnPropertyDescriptor","Reflect","decorate","EPSILON","clone","angle","fromValues","copy","set","equals","exactEquals","add","subtract","sub","multiply","mul","divide","div","min","max","floor","ceil","round","scale","scaleAndAdd","distance","dist","squaredDistance","sqrDist","len","squaredLength","sqrLen","negate","inverse","normalize","dot","cross","lerp","random","transformMat4","transformMat3","transformQuat","rotateX","rotateY","rotateZ","forEach","ReflectOwnKeys","R","ReflectApply","receiver","args","Function","ownKeys","getOwnPropertySymbols","getOwnPropertyNames","concat","NumberIsNaN","Number","isNaN","EventEmitter","init","_events","undefined","_eventsCount","_maxListeners","defaultMaxListeners","checkListener","listener","TypeError","_getMaxListeners","that","_addListener","type","prepend","events","existing","warning","newListener","emit","unshift","warned","w","Error","String","emitter","count","console","warn","onceWrapper","fired","removeListener","wrapFn","_onceWrap","state","wrapped","_listeners","unwrap","evlistener","arr","ret","unwrapListeners","arrayClone","listenerCount","arg","RangeError","getPrototypeOf","setMaxListeners","getMaxListeners","doError","error","er","err","message","context","handler","listeners","addListener","on","prependListener","once","prependOnceListener","list","position","originalListener","index","pop","spliceOne","off","removeAllListeners","keys","rawListeners","eventNames","iota","isBuffer","hasTypedArrays","Float64Array","compare1st","a","order","stride","terms","Math","abs","sort","compileConstructor","dtype","dimension","className","join","useGetters","code","procedure","CACHED_CONSTRUCTORS","indices","map","index_str","shapeArg","strideArg","a_vars","c_vars","tShape","tStride","idx","shape","offset","ctor","array","sz","toString","isArray","arrayDType","ctor_list","AABB","vec3","pos","vec","pos2","base","mag","proto","width","height","depth","x0","y0","z0","x1","y1","z1","translate","by","setPosition","expand","aabb","intersects","touches","intersection","union","base_x","base_y","base_z","bits","dup","Buffer","global","__TYPEDARRAY_POOL","UINT8","UINT16","UINT32","BIGUINT64","INT8","INT16","INT32","BIGINT64","FLOAT","DOUBLE","DATA","UINT8C","BUFFER","hasUint8C","Uint8ClampedArray","hasBigUint64","BigUint64Array","hasBigInt64","BigInt64Array","POOL","freeArrayBuffer","buffer","byteLength","log_n","log2","mallocArrayBuffer","nextPow2","ArrayBuffer","mallocUint8","Uint8Array","mallocUint16","Uint16Array","mallocUint32","Uint32Array","mallocInt8","Int8Array","mallocInt16","Int16Array","mallocInt32","Int32Array","mallocFloat","Float32Array","mallocDouble","mallocUint8Clamped","mallocBigUint64","mallocBigInt64","mallocDataView","DataView","mallocBuffer","cache","free","freeUint8","freeUint16","freeUint32","freeBigUint64","freeInt8","freeInt16","freeInt32","freeBigInt64","freeFloat32","freeFloat","freeFloat64","freeDouble","freeUint8Clamped","freeDataView","freeBuffer","malloc","mallocFloat32","mallocFloat64","clearCache","updatePositionExtents","hw","lpos","_localPosition","ext","_extents","_renderPosition","onAdd","eid","noa","globalToLocal","onRemove","system","dt","states","worldOriginOffset","body","entID","physics","addBody","setPhysicsFromPosition","ents","getPositionData","__id","hasPosition","pdat","setPositionFromPhysics","backtrackRenderPos","removeBody","renderSystem","backtrackAmt","positionInCurrentTick","_tickRate","id","smoothed","cameraSmoothed","local","physState","posState","box","vel","velocity","out","x","y","z","sqrt","tr_arr","ldi_arr","tri_arr","step_arr","tDelta_arr","tNext_arr","vec_arr","normed_arr","base_arr","max_arr","left_arr","result_arr","getVoxel","dir","callback","noTranslate","epsilon","tr","ldi","tri","step","tDelta","tNext","normed","cumulative_t","max_t","axis","initSweep","stepForward","checkCollision","handleCollision","lead","leadEdgeToInt","trailEdgeToInt","Infinity","i_axis","stepx","stepy","stepz","done","left","dv","coord","sweep_impl","g","e","rcount","RED_SWEEP_QUEUE","pool","RED_SWEEP_INDEX","BLUE_SWEEP_QUEUE","BLUE_SWEEP_INDEX","COMMON_SWEEP_QUEUE","COMMON_SWEEP_INDEX","eventLength","SWEEP_EVENTS","sweepBipartite","visit","redStart","redEnd","red","redIndex","blueStart","blueEnd","blue","blueIndex","ptr","elemSize","istart","iend","redOffset","blueOffset","isort","redActive","blueActive","sqPop","retval","sqPush","sweepComplete","commonActive","color","scanBipartite","flip","redShift","blueShift","isRed","blueId","bluePtr","b0","b1","red_loop","oidx","redPtr","k","redId","scanComplete","INIT_CAPACITY","queue","item","top","countTrailingZeros","v","INT_BITS","INT_MAX","INT_MIN","sign","mask","isPow2","log10","popCount","prevPow2","parity","REVERSE_TABLE","tab","reverse","interleave2","deinterleave2","interleave3","deinterleave3","nextCombination","predicate","fargs","split","reads","indexOf","replace","tempA","tempB","cosine","acos","a0","a1","a2","b2","ax","ay","az","bx","bz","PI","zScale","cos","sin","q","qx","qy","qz","qw","ix","iy","iz","iw","py","pz","sc","cc","px","fn","obj","readFloatLE","isSlowBuffer","_isBuffer","origin","direction","max_d","hit_pos","hit_norm","dx","dy","dz","ds","txDelta","tyDelta","tzDelta","txMax","tyMax","tzMax","steppedIndex","traceRay_impl","util","domready","vkey","invert","uniq","bsearch","addMouseWheel","hrtime","filtered_vkey","charAt","substring","parseInt","keyNames","virtualKeyCode","eq","physicalKeyCode","GameShell","_curKeyState","_pressCount","_releaseCount","_tickInterval","_rafHandle","_lastTick","_frameTime","_paused","_width","_height","_wantFullscreen","_wantPointerLock","_fullscreenActive","_pointerLockActive","_rafFunction","tickOrRender","preventDefaults","stopPropagation","element","bindings","frameSkip","tickCount","frameCount","startTime","tickTime","frameTime","stickyFullscreen","stickyPointerLock","scroll","mouseX","mouseY","prevMouseX","prevMouseY","inherits","lookupCount","kc","tryFullscreen","shell","elem","requestFullscreen","requestFullScreen","webkitRequestFullscreen","webkitRequestFullScreen","mozRequestFullscreen","mozRequestFullScreen","requestPointerLock","webkitRequestPointerLock","mozRequestPointerLock","msRequestPointerLock","oRequestPointerLock","virtual_key","physical_key","keybinds","unbind","down","lookupKey","wasDown","press","up","wasUp","release","setInterval","requestAnimationFrame","clearInterval","cancelFullscreen","document","exitFullscreen","cancelFullScreen","webkitCancelFullscreen","webkitCancelFullScreen","mozCancelFullscreen","mozCancelFullScreen","handleFullscreen","fullscreen","mozFullScreen","webkitIsFullScreen","exitPointerLock","webkitExitPointerLock","mozExitPointerLock","handlePointerLockChange","event","pointerLockElement","mozPointerLockElement","webkitPointerLockElement","setKeyState","doRender","skip","pCount","rCount","tick","render","handleEvent","ev","preventDefault","handleKeyUp","keyCode","char","which","charCode","handleKeyDown","activeElement","isFocused","metaKey","handleBlur","clientWidth","clientHeight","mouseCodes","handleMouseMove","movementX","mozMovementX","webkitMovementX","movementY","mozMovementY","webkitMovementY","clientX","offsetLeft","clientY","offsetTop","handleMouseDown","button","handleMouseUp","handleMouseEnter","handleMouseLeave","buttons","setMouseButtons","handleMouseWheel","deltaMode","deltaX","deltaY","deltaZ","handleContexMenu","handleResizeElement","h","makeDefaultContainer","container","createElement","tabindex","style","right","bottom","overflow","appendChild","options","useFullscreen","usePointerLock","pointerLock","tickRate","sticky","setTimeout","querySelector","getElementById","getElementByClass","handleResize","MutationObserver","observe","attributes","subtree","addEventListener","oncontextmenu","leave","blur","fullscreenChange","pointerLockChange","paused","getOwnPropertyDescriptors","descriptors","formatRegExp","format","f","isString","objects","inspect","str","JSON","stringify","_","isNull","isObject","deprecate","msg","process","noDeprecation","throwDeprecation","traceDeprecation","trace","debugEnviron","debugs","opts","ctx","seen","stylize","stylizeNoColor","colors","isBoolean","showHidden","_extend","isUndefined","customInspect","stylizeWithColor","formatValue","styleType","styles","recurseTimes","isFunction","primitive","simple","isNumber","formatPrimitive","visibleKeys","hash","val","arrayToHash","isError","formatError","isRegExp","RegExp","isDate","Date","output","braces","toUTCString","formatProperty","match","formatArray","reduce","prev","cur","numLinesEst","reduceToSingleString","line","substr","ar","re","objectToString","pad","debuglog","env","NODE_DEBUG","toUpperCase","test","pid","isNullOrUndefined","isSymbol","isPrimitive","months","timestamp","time","getHours","getMinutes","getSeconds","getDate","getMonth","prop","log","kCustomPromisifiedSymbol","callbackifyOnRejected","reason","cb","newReason","promisify","original","writable","configurable","promiseResolve","promiseReject","promise","Promise","resolve","reject","defineProperties","custom","callbackify","callbackified","maybeCb","self","then","nextTick","rej","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","runTimeout","fun","clearTimeout","currentQueue","draining","queueIndex","cleanUpNextTick","drainQueue","timeout","run","marker","runClearTimeout","Item","noop","title","browser","argv","version","versions","binding","cwd","chdir","umask","fill","readUInt8","superCtor","super_","TempCtor","fns","doc","hack","loaded","documentElement","doScroll","readyState","removeEventListener","ua","navigator","userAgent","isOSX","isOpera","maybeFirefox","0","2","3","4","5","6","8","9","12","13","16","17","18","19","20","21","23","24","25","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","91","92","93","95","106","107","108","109","110","111","144","145","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","186","187","188","189","190","191","192","219","220","221","222","223","224","226","229","231","246","247","248","249","250","251","252","253","254","fromCharCode","compare","sorted","unique_pred","unique_eq","compileSearch","funcName","reversed","extraArgs","useNdarray","earlyOut","compileBoundsSearch","suffix","ge","gt","lt","le","lastTime","vendors","cancelAnimationFrame","currTime","getTime","timeToCall","_addEventListener","support","prefix","_addWheelListener","eventName","useCapture","originalEvent","srcElement","delatZ","returnValue","wheelDelta","wheelDeltaX","detail","onmousewheel","performance","now","webkitNow","Inputs","allowContextMenu","disabled","scrollx","scrolly","scrollz","_keybindmap","_keyStates","_bindPressCounts","_ignoreMousemoveOnce","initEvents","onKeyEvent","inputs","handleKeyEvent","onMouseEvent","onContextMenu","onMouseMove","xy","touch","changedTouches","identifier","lastTouchID","res","lastTouchX","lastTouchY","getTouchMovement","domElement","onTouchStart","onMouseWheel","onLockChange","vkeyCode","getBoundKeys","innerHeight","keycode","vcode","XOR","handleBindingEvent","ct","sweep","RigidBody","testSolid","testFluid","Physics","defaults","gravity","minBounceImpulse","airDrag","fluidDrag","fluidDensity","bodies","_aabb","mass","friction","restitution","gravMult","onCollide","impacts","oldResting","noGravity","resting","_forces","_impulses","localNoGrav","gravityMultiplier","_sleepFrameCount","isResting","gmult","sleepVec","bodyAsleep","cx","cz","inFluid","ratioInFluid","submerged","cy","displaced","_fluidVec","applyForce","applyFluidForces","sanityCheck","applyFrictionByAxis","drag","mult","autoStep","cloneAABB","tmpBox","processCollisions","oldBox","xBlocked","zBlocked","ratio","targetPos","getVoxels","ydist","upvec","collided","leftover","tmpResting","onStep","tryAutoStepping","applyImpulse","_markActive","iterateBody","dvel","restDir","vNormal","lateralVel","vCurr","dvMax","scaler","tgt","src","_ratioInFluid","getPosition","atRestX","atRestY","atRestZ","ECS","components","comps","UID","storage","systems","renderSystems","deferredEntityRemovals","deferredCompRemovals","deferredMultiCompRemovals","deleteEntityNow","compName","removeComponentNow","def","multi","DataStore","remove","removeMultiCompNow","stateObj","statesArr","makeDeferralTimeout","deferralTimeoutPending","runAllDeferredRemovals","_storage","_systems","_renderSystems","createEntity","compList","addComponent","deleteEntity","immediately","createComponent","compDefn","internalDef","deleteComponent","removeComponent","pendingRemoval","doDeferredComponentRemovals","newState","hasComponent","getState","getStatesList","getStateAccessor","getComponentAccessor","removeMultiComponent","stateToRemove","ecs","doDeferredMultiComponentRemovals","doDeferredEntityRemovals","_map","movedItem","movedID","webpackContext","req","webpackContextResolve","boxIntersect","intervals","cylinder","collideBits","collideMask","dat","stateA","stateB","intervalA","intervalB","rada","radb","radsum","cylinderCylinderTest","cylinderBoxTest","cylindricalHitTest","idA","idB","onPairwiseEntityCollision","cyl","cube","rad","clamp","lo","hi","arg0","arg1","arg2","intersectFullArray","intersectBipartiteArray","RESULT","boxIntersectIter","boxEmpty","convertBoxes","boxes","ids","full","redList","redIds","blueList","blueIds","appendItem","dupe_number","dupe_array","base64","ieee754","kMaxLength","TYPED_ARRAY_SUPPORT","createBuffer","encodingOrOffset","allocUnsafe","from","byteOffset","fromArrayLike","fromArrayBuffer","string","encoding","isEncoding","actual","write","fromString","checked","fromObject","assertSize","size","isView","loweredCase","utf8ToBytes","base64ToBytes","toLowerCase","slowToString","start","end","hexSlice","utf8Slice","asciiSlice","latin1Slice","base64Slice","utf16leSlice","swap","bidirectionalIndexOf","arrayIndexOf","lastIndexOf","indexSize","arrLength","valLength","read","buf","readUInt16BE","foundIndex","found","hexWrite","remaining","strLen","parsed","utf8Write","blitBuffer","asciiWrite","byteArray","charCodeAt","asciiToBytes","latin1Write","base64Write","ucs2Write","units","utf16leToBytes","fromByteArray","secondByte","thirdByte","fourthByte","tempCodePoint","firstByte","codePoint","bytesPerSequence","codePoints","decodeCodePointsArray","SlowBuffer","alloc","INSPECT_MAX_BYTES","foo","subarray","typedArraySupport","poolSize","_augment","species","allocUnsafeSlow","swap16","swap32","swap64","thisStart","thisEnd","thisCopy","targetCopy","includes","isFinite","toJSON","_arr","toHex","bytes","checkOffset","checkInt","objectWriteUInt16","littleEndian","objectWriteUInt32","checkIEEE754","writeFloat","noAssert","writeDouble","newBuf","sliceLen","readUIntLE","readUIntBE","readUInt16LE","readUInt32LE","readUInt32BE","readIntLE","pow","readIntBE","readInt8","readInt16LE","readInt16BE","readInt32LE","readInt32BE","readFloatBE","readDoubleLE","readDoubleBE","writeUIntLE","writeUIntBE","writeUInt8","writeUInt16LE","writeUInt16BE","writeUInt32LE","writeUInt32BE","writeIntLE","limit","writeIntBE","writeInt8","writeInt16LE","writeInt16BE","writeInt32LE","writeInt32BE","writeFloatLE","writeFloatBE","writeDoubleLE","writeDoubleBE","targetStart","INVALID_BASE64_RE","leadSurrogate","toByteArray","trim","stringtrim","base64clean","dst","b64","lens","getLens","validLen","placeHoldersLen","tmp","Arr","_byteLength","curByte","revLookup","uint8","extraBytes","parts","len2","encodeChunk","lookup","num","isLE","mLen","nBytes","eLen","eMax","eBias","nBits","NaN","rt","LN2","n0","insertionSort","quickSort","sixth","index1","index5","index3","index2","index4","el1","el2","el3","el4","el5","less","great","pivot1X","pivot1Y","pivot2X","pivot2Y","ptr0","ptr2","ptr4","ptr5","ptr6","ptr7","i1","move","comparePivot","rotate","shufflePivot","jptr","initFull","xSize","xBoxes","xIndex","ySize","yBoxes","yIndex","levels","maxInts","BOX_ISTACK","maxDoubles","BOX_DSTACK","iterInit","iterPush","iptr","dptr","partitionStartLessThan","partitionEndLessThanEqual","redCount","blueCount","bruteForcePartial","red0","partitionInteriorContainsInterval","bruteForceFull","blue0","findMedian","mid","blue1","partitionStartEqual","onePointFull","onePointPartial","red1","partitionContainsPoint","redX","partitionContainsPointProper","bruteForce","partial","genPartition","blueX","r0","r1","ARGS","bruteForcePlanner","invoke","redMajor","redLoop","blueLoop","generateBruteForce","codeStr","proc","pivot","pivot0","value0","pivot1","value1","pivot2","value2","aPtr","bPtr","boxPtr","entities","hasPhysics","getPhysicsBody","impulse","getCollideTerrain","cutoff","_showing","zoom","camera","currentZoom","hasMesh","getMeshData","mesh","visibility","checkZoom","entity","updatePosition","updateRenderPosition","other","names","followsEntity","posDat","rendering","addMeshToScene","rpos","copyFromFloats","dispose","heading","running","jumping","maxSpeed","moveForce","responsiveness","runningFriction","standingFriction","airMoveMult","jumpImpulse","jumpForce","jumpTime","airJumps","_jumpCount","_isJumping","_currjumptime","onGround","canjump","jf","tempvec","tempvec2","speed","zeroVec","pushLen","canPush","pushAmt","applyMovementPhysics","inputState","camHeading","jump","fb","forward","backward","rl","setMovementState","getMovement","shadowDist","scene","getScene","disc","CreateDisc","rotation","material","makeStandardMaterial","diffuseColor","Black","ambientColor","alpha","setEnabled","removeMesh","_mesh","createInstance","cpos","_localGetPosition","getPhysics","physDat","camPos","localY","_localPick","shadowPos","scaling","updateShadowHeight","spos","createGameShell","Container","_noa","createContainerDiv","canvas","el","insertBefore","firstChild","getOrCreateCanvas","_shell","createShell","hasPointerLock","supportsPointerLock","pointerInGame","hasFocus","lockChange","detectPointerLock","onShellInit","resize","removeUnorderedListItem","loopForTime","maxTimeInMS","appendTo","htmlElement","setPointerLock","lock","prevRad","prevAnswer","copyNdarrayContents","tgtPos","i0","j0","k0","si","sj","sk","ti","tj","tk","six","tix","doNdarrayCopy","doNdarrayZero","StringList","isEmpty","empty","keyToDistanceFn","mapping","copyFrom","glvec3","showFPS","antiAlias","clearColor","lightDiffuse","lightSpecular","groundLightColor","useAO","AOmultipliers","reverseAOmultiplier","preserveDrawingBuffer","Rendering","aoVals","revAoVal","meshingCutoffTime","_resizeDebounce","_engine","_scene","detachControl","_addComponent","_octree","$","blocks","_selectionOctree","_cameraHolder","_camera","parent","minZ","_camScreen","CreatePlane","_camScreenMat","_camLocBlock","lightVec","arrToColor","_light","diffuse","specular","groundColor","flatMaterial","initScene","longest","last","fps_hook","nt","fps","innerHTML","setUpFPS","profile_hook","cam","tgtLoc","_localGetTargetPosition","pitch","cloc","getBlock","matId","registry","getBlockFaceMaterial","matData","getMaterialData","col","checkCameraEffect","updateCameraForRender","beginFrame","endFrame","pendingResize","highlightBlockFace","show","posArr","normArr","_highlightMesh","hlm","backFaceCulling","emissiveColor","lines","CreateLines","getHighlightMesh","hlpos","slop","isStatic","_containingChunk","_noaContainingChunk","dynamicContent","addToOctree","chunk","world","_getChunkByCoords","octreeBlock","entries","freezeWorldMatrix","freezeNormals","remover","removeMeshFromScene","onDisposeObservable","mat","specularColor","prepareChunkForRendering","cs","loc","disposeChunkForRendering","_rebaseOrigin","delta","dvec","meshes","subtractInPlace","_isWorldMatrixFrozen","markAsDirty","minPoint","maxPoint","_boundingVectors","debug_SceneCheck","dyns","octs","numOcts","numSubs","mats","materials","allmats","subMaterials","block","_isDisposed","getIndices","missing","subMeshes","unusedMats","used","avgPerOct","list1","list2","debug_MeshCount","ID_BITS","OBJECT_BIT","constants","SOLID_BIT","OPAQUE_BIT","greedyMesher","GreedyMesher","meshBuilder","MeshBuilder","meshChunk","matGetter","colGetter","ignoreMaterials","cols","_getMaterialVertexColor","ao","vals","rev","voxels","cachedPadded","s2","_vecs","posValues","sizeValues","tgtPosValues","_cachedVecSize","allocateVectors","nab","_neighbors","buildPaddedVoxelArray","edgesOnly","isFull","build","Submesh","positions","normals","uvs","mergeable","mergeSubmeshes","meshDataList","mergeAll","vertices","matIDs","mdat","indexOffset","mergeArrays","numMergeable","url","getMaterialTexture","renderMat","results","submesh","verts","inds","vdat","applyToMesh","multiMat","vertStart","indStart","buildMeshFromSubmesh","matID","ignore","materialCache","tex","NEAREST_SAMPLINGMODE","textureAlpha","hasAlpha","diffuseTexture","makeTerrainMaterial","getTerrainMaterial","ID_MASK","maskCache","aomaskCache","constructMeshMasks","arrT","getMaterial","aoPackFcn","aomask","materialDir","dbase","istride","jstride","kstride","d0","id0","id1","faceDir","getFaceDir","op0","op1","m0","m1","constructMeshDataFromMasks","u","len1","doAO","submeshes","getColor","aoValues","maskCompareFcn","maskCompare","maskCompare_noAO","meshColorFcn","pushMeshColors","pushMeshColors_noAO","maskVal","OUTER","triDir","du","vs","norm0","norm1","norm2","hx","wx","aoVal","ao00","unpackAOMask","ao10","ao11","ao01","pushAOColor","packAOMaskNoReverse","ipos","ineg","a00","a01","a10","a11","solidBit","facingSolid","packAOMask","jpos","kpos","baseCol","skipReverseAO","transpose","len0","buildSPSforMaterialIndex","meshHash","blockHash","_objectBlocks","sps","updatable","blockHandlerLookup","_blockHandlerLookup","objectMeshLookup","_blockMeshLookup","blockID","handlerFn","blockArr","handlers","onCustomMeshCreate","addShape","positionFunction","particle","partIndex","shapeIndex","initChunk","_objectSystems","disposeChunk","removeObjectMeshes","addObjectBlock","ObjMeshDat","removeObjectBlock","buildObjectMeshes","matIndexes","matIndex","merged","buildMesh","solidLookup","opaqueLookup","Chunk","dataArray","requestID","isDisposed","_terrainDirty","_objectsDirty","_solidityLookup","_opacityLookup","setBlockLookups","_terrainMesh","objectMesher","narr","_neighborCount","_maxMeshedNeighbors","_timesMeshed","packVoxelData","callBlockHandler","hobj","affectsTerrain","packID","newID","fullyOpaque","fullyAir","hasObj","packed","callAllBlockHandlers","_createVoxelArray","_updateVoxelArray","getSolidityAt","oldID","oldIDnum","_queueChunkForRemesh","edge","iedge","jedge","kedge","js","ks","terrainMesher","updateMeshes","defaultOptions","chunkSize","chunkAddDistance","chunkRemoveDistance","worldGenWhilePaused","World","playerChunkLoaded","minNeighborsToMesh","maxChunksPendingCreation","maxChunksPendingMeshing","maxProcessingPerTick","maxProcessingPerRender","_cachedWorldName","_lastPlayerChunkID","_chunkStorage","_chunkIDsKnown","_chunkIDsToRequest","_chunkIDsPending","_chunkIDsToMesh","_chunkIDsToMeshFirst","_chunkIDsToRemove","queueChunkForRemesh","_getChunk","getChunkID","_setChunk","_worldCoordToChunkCoord","initChunkStorage","_worldCoordToChunkIndex","parseChunkID","getPlayerChunkCoords","playerEntity","getBlockID","getBlockSolidity","getBlockOpacity","getBlockFluidity","getBlockProperties","getBlockProps","getBlockObjectMesh","getObjectMeshAt","setBlockID","isBoxUnobstructed","setChunkData","userData","reqID","worldName","updateNeighborsOfChunk","profile_queues_hook","invalidateVoxelsInAABB","invalidateChunksInBox","tickStartTime","sortIDListByDistanceFrom","markAllChunksForRemoval","ci","cj","ck","remDistSq","toRemove","chunkID","changedChunks","di","dj","dk","numChunks","rsq","numberOfVoxelsInSphere","addDistSq","known","toRequest","findNewChunksInRange","pending","toMesh","dataArr","requestNewChunk","processRequestQueue","removeChunk","processRemoveQueue","processMeshingQueue","numQueued","lookIndex","nc","lookForChunksToMesh","pChunk","firstOnly","doChunkRemesh","nid","neighbor","_report","exist","surrounded","remeshes","padEnd","sum","acc","toFixed","report","createInputs","defaultBindings","makeInputs","createPhysics","makePhysics","inverseX","inverseY","sensitivityX","sensitivityY","initialZoom","zoomSpeed","Camera","cameraTarget","eyeOffset","zoomDistance","_dirVector","_camPos","getTargetPosition","localToGlobal","globalCamPos","getDirection","applyInputsToCamera","wval","hval","badx","lastx","bady","lasty","bugFix","conv","twopi","maxPitch","updateBeforeEntityRenderSystems","updateAfterEntityRenderSystems","maxZoom","_camBox","_camBoxVec","_getVoxel","_sweepVec","_hitFn","cameraObstructionDistance","texturePath","blockDefaults","solid","opaque","viscosity","MAX_BLOCK_ID","Registry","blockSolidity","blockOpacity","blockIsFluid","blockMats","blockProps","blockMeshes","blockHandlers","registerBlock","_options","fluid","blockMesh","getMaterialId","hasHandler","onLoad","onUnload","onSet","onUnset","BlockCallbackHolder","registerMaterial","textureURL","texHasAlpha","renderMaterial","texture","blockId","getMaterialColor","white","reg","lazyInit","EntComp","shadowDistance","Entities","componentArgs","reqContext","bareName","exec","compFn","default","compDef","comp","isPlayer","smoothCamera","getPos","updateDerivedPositionData","getPhys","_localSetPosition","_yarg","_zarg","setEntitySize","xs","ys","zs","movement","collideTerrain","getCollideEntities","collideEntities","id2","extentsOverlap","extA","extB","addComponentAgain","isTerrainBlocked","xlocal","ylocal","zlocal","blockExt","getEntitiesInAABB","withComponent","testExtents","entStates","hits","meshOffset","doPhysics","shadow","smoothName","raycast","debug","silent","playerHeight","playerWidth","playerStart","playerAutoStep","blockTestDistance","dragCameraOutsidePointerLock","skipDefaultHighlighting","originRebaseDistance","Engine","_lastRenderTime","_dragOutsideLock","debugstr","_originRebaseDistance","receivesInputs","fadeOnZoom","ver","dep","blockTargetIdCheck","targetedBlock","defaultBlockHighlightFunction","normal","_constants","ndarray","setViewDistance","throwFn","checkWorldOffset","newhash","blockIdFn","_targetedBlockDat","adjacent","_prevTargetHash","updateBlockTargets","st","framePart","profile_hook_render","fire","globalPrecise","floored","setPaused","setBlock","addBlock","pick","blockIdTestFunction","_pickPos","testFn","_hitResult","rnorm","dirtID","grassID","getVoxelID","voxelID","player","CreateBox"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t1: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([164,0]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","module.exports = {\n  EPSILON: require('./epsilon')\n  , create: require('./create')\n  , clone: require('./clone')\n  , angle: require('./angle')\n  , fromValues: require('./fromValues')\n  , copy: require('./copy')\n  , set: require('./set')\n  , equals: require('./equals')\n  , exactEquals: require('./exactEquals')\n  , add: require('./add')\n  , subtract: require('./subtract')\n  , sub: require('./sub')\n  , multiply: require('./multiply')\n  , mul: require('./mul')\n  , divide: require('./divide')\n  , div: require('./div')\n  , min: require('./min')\n  , max: require('./max')\n  , floor: require('./floor')\n  , ceil: require('./ceil')\n  , round: require('./round')\n  , scale: require('./scale')\n  , scaleAndAdd: require('./scaleAndAdd')\n  , distance: require('./distance')\n  , dist: require('./dist')\n  , squaredDistance: require('./squaredDistance')\n  , sqrDist: require('./sqrDist')\n  , length: require('./length')\n  , len: require('./len')\n  , squaredLength: require('./squaredLength')\n  , sqrLen: require('./sqrLen')\n  , negate: require('./negate')\n  , inverse: require('./inverse')\n  , normalize: require('./normalize')\n  , dot: require('./dot')\n  , cross: require('./cross')\n  , lerp: require('./lerp')\n  , random: require('./random')\n  , transformMat4: require('./transformMat4')\n  , transformMat3: require('./transformMat3')\n  , transformQuat: require('./transformQuat')\n  , rotateX: require('./rotateX')\n  , rotateY: require('./rotateY')\n  , rotateZ: require('./rotateZ')\n  , forEach: require('./forEach')\n}\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n  }\n\nvar ReflectOwnKeys\nif (R && typeof R.ownKeys === 'function') {\n  ReflectOwnKeys = R.ownKeys\n} else if (Object.getOwnPropertySymbols) {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target)\n      .concat(Object.getOwnPropertySymbols(target));\n  };\n} else {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target);\n  };\n}\n\nfunction ProcessEmitWarning(warning) {\n  if (console && console.warn) console.warn(warning);\n}\n\nvar NumberIsNaN = Number.isNaN || function NumberIsNaN(value) {\n  return value !== value;\n}\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._eventsCount = 0;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nvar defaultMaxListeners = 10;\n\nfunction checkListener(listener) {\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n}\n\nObject.defineProperty(EventEmitter, 'defaultMaxListeners', {\n  enumerable: true,\n  get: function() {\n    return defaultMaxListeners;\n  },\n  set: function(arg) {\n    if (typeof arg !== 'number' || arg < 0 || NumberIsNaN(arg)) {\n      throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received ' + arg + '.');\n    }\n    defaultMaxListeners = arg;\n  }\n});\n\nEventEmitter.init = function() {\n\n  if (this._events === undefined ||\n      this._events === Object.getPrototypeOf(this)._events) {\n    this._events = Object.create(null);\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || NumberIsNaN(n)) {\n    throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received ' + n + '.');\n  }\n  this._maxListeners = n;\n  return this;\n};\n\nfunction _getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return _getMaxListeners(this);\n};\n\nEventEmitter.prototype.emit = function emit(type) {\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    ReflectApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      ReflectApply(listeners[i], this, args);\n  }\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  checkListener(listener);\n\n  events = target._events;\n  if (events === undefined) {\n    events = target._events = Object.create(null);\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener !== undefined) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (existing === undefined) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] =\n        prepend ? [listener, existing] : [existing, listener];\n      // If we've already got an array, just append.\n    } else if (prepend) {\n      existing.unshift(listener);\n    } else {\n      existing.push(listener);\n    }\n\n    // Check for listener leak\n    m = _getMaxListeners(target);\n    if (m > 0 && existing.length > m && !existing.warned) {\n      existing.warned = true;\n      // No error code for this since it is a Warning\n      // eslint-disable-next-line no-restricted-syntax\n      var w = new Error('Possible EventEmitter memory leak detected. ' +\n                          existing.length + ' ' + String(type) + ' listeners ' +\n                          'added. Use emitter.setMaxListeners() to ' +\n                          'increase limit');\n      w.name = 'MaxListenersExceededWarning';\n      w.emitter = target;\n      w.type = type;\n      w.count = existing.length;\n      ProcessEmitWarning(w);\n    }\n  }\n\n  return target;\n}\n\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction onceWrapper() {\n  if (!this.fired) {\n    this.target.removeListener(this.type, this.wrapFn);\n    this.fired = true;\n    if (arguments.length === 0)\n      return this.listener.call(this.target);\n    return this.listener.apply(this.target, arguments);\n  }\n}\n\nfunction _onceWrap(target, type, listener) {\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n  var wrapped = onceWrapper.bind(state);\n  wrapped.listener = listener;\n  state.wrapFn = wrapped;\n  return wrapped;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  checkListener(listener);\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      checkListener(listener);\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// Emits a 'removeListener' event if and only if the listener was removed.\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      checkListener(listener);\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      list = events[type];\n      if (list === undefined)\n        return this;\n\n      if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0)\n          this._events = Object.create(null);\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n          if (list[i] === listener || list[i].listener === listener) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (position === 0)\n          list.shift();\n        else {\n          spliceOne(list, position);\n        }\n\n        if (list.length === 1)\n          events[type] = list[0];\n\n        if (events.removeListener !== undefined)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events, i;\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (events.removeListener === undefined) {\n        if (arguments.length === 0) {\n          this._events = Object.create(null);\n          this._eventsCount = 0;\n        } else if (events[type] !== undefined) {\n          if (--this._eventsCount === 0)\n            this._events = Object.create(null);\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        var key;\n        for (i = 0; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = Object.create(null);\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners !== undefined) {\n        // LIFO order\n        for (i = listeners.length - 1; i >= 0; i--) {\n          this.removeListener(type, listeners[i]);\n        }\n      }\n\n      return this;\n    };\n\nfunction _listeners(target, type, unwrap) {\n  var events = target._events;\n\n  if (events === undefined)\n    return [];\n\n  var evlistener = events[type];\n  if (evlistener === undefined)\n    return [];\n\n  if (typeof evlistener === 'function')\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n  return unwrap ?\n    unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  return _listeners(this, type, true);\n};\n\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\n  return _listeners(this, type, false);\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events !== undefined) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener !== undefined) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];\n};\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction spliceOne(list, index) {\n  for (; index + 1 < list.length; index++)\n    list[index] = list[index + 1];\n  list.pop();\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n","var iota = require(\"iota-array\")\nvar isBuffer = require(\"is-buffer\")\n\nvar hasTypedArrays  = ((typeof Float64Array) !== \"undefined\")\n\nfunction compare1st(a, b) {\n  return a[0] - b[0]\n}\n\nfunction order() {\n  var stride = this.stride\n  var terms = new Array(stride.length)\n  var i\n  for(i=0; i<terms.length; ++i) {\n    terms[i] = [Math.abs(stride[i]), i]\n  }\n  terms.sort(compare1st)\n  var result = new Array(terms.length)\n  for(i=0; i<result.length; ++i) {\n    result[i] = terms[i][1]\n  }\n  return result\n}\n\nfunction compileConstructor(dtype, dimension) {\n  var className = [\"View\", dimension, \"d\", dtype].join(\"\")\n  if(dimension < 0) {\n    className = \"View_Nil\" + dtype\n  }\n  var useGetters = (dtype === \"generic\")\n\n  if(dimension === -1) {\n    //Special case for trivial arrays\n    var code =\n      \"function \"+className+\"(a){this.data=a;};\\\nvar proto=\"+className+\".prototype;\\\nproto.dtype='\"+dtype+\"';\\\nproto.index=function(){return -1};\\\nproto.size=0;\\\nproto.dimension=-1;\\\nproto.shape=proto.stride=proto.order=[];\\\nproto.lo=proto.hi=proto.transpose=proto.step=\\\nfunction(){return new \"+className+\"(this.data);};\\\nproto.get=proto.set=function(){};\\\nproto.pick=function(){return null};\\\nreturn function construct_\"+className+\"(a){return new \"+className+\"(a);}\"\n    var procedure = new Function(code)\n    return procedure()\n  } else if(dimension === 0) {\n    //Special case for 0d arrays\n    var code =\n      \"function \"+className+\"(a,d) {\\\nthis.data = a;\\\nthis.offset = d\\\n};\\\nvar proto=\"+className+\".prototype;\\\nproto.dtype='\"+dtype+\"';\\\nproto.index=function(){return this.offset};\\\nproto.dimension=0;\\\nproto.size=1;\\\nproto.shape=\\\nproto.stride=\\\nproto.order=[];\\\nproto.lo=\\\nproto.hi=\\\nproto.transpose=\\\nproto.step=function \"+className+\"_copy() {\\\nreturn new \"+className+\"(this.data,this.offset)\\\n};\\\nproto.pick=function \"+className+\"_pick(){\\\nreturn TrivialArray(this.data);\\\n};\\\nproto.valueOf=proto.get=function \"+className+\"_get(){\\\nreturn \"+(useGetters ? \"this.data.get(this.offset)\" : \"this.data[this.offset]\")+\n\"};\\\nproto.set=function \"+className+\"_set(v){\\\nreturn \"+(useGetters ? \"this.data.set(this.offset,v)\" : \"this.data[this.offset]=v\")+\"\\\n};\\\nreturn function construct_\"+className+\"(a,b,c,d){return new \"+className+\"(a,d)}\"\n    var procedure = new Function(\"TrivialArray\", code)\n    return procedure(CACHED_CONSTRUCTORS[dtype][0])\n  }\n\n  var code = [\"'use strict'\"]\n\n  //Create constructor for view\n  var indices = iota(dimension)\n  var args = indices.map(function(i) { return \"i\"+i })\n  var index_str = \"this.offset+\" + indices.map(function(i) {\n        return \"this.stride[\" + i + \"]*i\" + i\n      }).join(\"+\")\n  var shapeArg = indices.map(function(i) {\n      return \"b\"+i\n    }).join(\",\")\n  var strideArg = indices.map(function(i) {\n      return \"c\"+i\n    }).join(\",\")\n  code.push(\n    \"function \"+className+\"(a,\" + shapeArg + \",\" + strideArg + \",d){this.data=a\",\n      \"this.shape=[\" + shapeArg + \"]\",\n      \"this.stride=[\" + strideArg + \"]\",\n      \"this.offset=d|0}\",\n    \"var proto=\"+className+\".prototype\",\n    \"proto.dtype='\"+dtype+\"'\",\n    \"proto.dimension=\"+dimension)\n\n  //view.size:\n  code.push(\"Object.defineProperty(proto,'size',{get:function \"+className+\"_size(){\\\nreturn \"+indices.map(function(i) { return \"this.shape[\"+i+\"]\" }).join(\"*\"),\n\"}})\")\n\n  //view.order:\n  if(dimension === 1) {\n    code.push(\"proto.order=[0]\")\n  } else {\n    code.push(\"Object.defineProperty(proto,'order',{get:\")\n    if(dimension < 4) {\n      code.push(\"function \"+className+\"_order(){\")\n      if(dimension === 2) {\n        code.push(\"return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})\")\n      } else if(dimension === 3) {\n        code.push(\n\"var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);\\\nif(s0>s1){\\\nif(s1>s2){\\\nreturn [2,1,0];\\\n}else if(s0>s2){\\\nreturn [1,2,0];\\\n}else{\\\nreturn [1,0,2];\\\n}\\\n}else if(s0>s2){\\\nreturn [2,0,1];\\\n}else if(s2>s1){\\\nreturn [0,1,2];\\\n}else{\\\nreturn [0,2,1];\\\n}}})\")\n      }\n    } else {\n      code.push(\"ORDER})\")\n    }\n  }\n\n  //view.set(i0, ..., v):\n  code.push(\n\"proto.set=function \"+className+\"_set(\"+args.join(\",\")+\",v){\")\n  if(useGetters) {\n    code.push(\"return this.data.set(\"+index_str+\",v)}\")\n  } else {\n    code.push(\"return this.data[\"+index_str+\"]=v}\")\n  }\n\n  //view.get(i0, ...):\n  code.push(\"proto.get=function \"+className+\"_get(\"+args.join(\",\")+\"){\")\n  if(useGetters) {\n    code.push(\"return this.data.get(\"+index_str+\")}\")\n  } else {\n    code.push(\"return this.data[\"+index_str+\"]}\")\n  }\n\n  //view.index:\n  code.push(\n    \"proto.index=function \"+className+\"_index(\", args.join(), \"){return \"+index_str+\"}\")\n\n  //view.hi():\n  code.push(\"proto.hi=function \"+className+\"_hi(\"+args.join(\",\")+\"){return new \"+className+\"(this.data,\"+\n    indices.map(function(i) {\n      return [\"(typeof i\",i,\"!=='number'||i\",i,\"<0)?this.shape[\", i, \"]:i\", i,\"|0\"].join(\"\")\n    }).join(\",\")+\",\"+\n    indices.map(function(i) {\n      return \"this.stride[\"+i + \"]\"\n    }).join(\",\")+\",this.offset)}\")\n\n  //view.lo():\n  var a_vars = indices.map(function(i) { return \"a\"+i+\"=this.shape[\"+i+\"]\" })\n  var c_vars = indices.map(function(i) { return \"c\"+i+\"=this.stride[\"+i+\"]\" })\n  code.push(\"proto.lo=function \"+className+\"_lo(\"+args.join(\",\")+\"){var b=this.offset,d=0,\"+a_vars.join(\",\")+\",\"+c_vars.join(\",\"))\n  for(var i=0; i<dimension; ++i) {\n    code.push(\n\"if(typeof i\"+i+\"==='number'&&i\"+i+\">=0){\\\nd=i\"+i+\"|0;\\\nb+=c\"+i+\"*d;\\\na\"+i+\"-=d}\")\n  }\n  code.push(\"return new \"+className+\"(this.data,\"+\n    indices.map(function(i) {\n      return \"a\"+i\n    }).join(\",\")+\",\"+\n    indices.map(function(i) {\n      return \"c\"+i\n    }).join(\",\")+\",b)}\")\n\n  //view.step():\n  code.push(\"proto.step=function \"+className+\"_step(\"+args.join(\",\")+\"){var \"+\n    indices.map(function(i) {\n      return \"a\"+i+\"=this.shape[\"+i+\"]\"\n    }).join(\",\")+\",\"+\n    indices.map(function(i) {\n      return \"b\"+i+\"=this.stride[\"+i+\"]\"\n    }).join(\",\")+\",c=this.offset,d=0,ceil=Math.ceil\")\n  for(var i=0; i<dimension; ++i) {\n    code.push(\n\"if(typeof i\"+i+\"==='number'){\\\nd=i\"+i+\"|0;\\\nif(d<0){\\\nc+=b\"+i+\"*(a\"+i+\"-1);\\\na\"+i+\"=ceil(-a\"+i+\"/d)\\\n}else{\\\na\"+i+\"=ceil(a\"+i+\"/d)\\\n}\\\nb\"+i+\"*=d\\\n}\")\n  }\n  code.push(\"return new \"+className+\"(this.data,\"+\n    indices.map(function(i) {\n      return \"a\" + i\n    }).join(\",\")+\",\"+\n    indices.map(function(i) {\n      return \"b\" + i\n    }).join(\",\")+\",c)}\")\n\n  //view.transpose():\n  var tShape = new Array(dimension)\n  var tStride = new Array(dimension)\n  for(var i=0; i<dimension; ++i) {\n    tShape[i] = \"a[i\"+i+\"]\"\n    tStride[i] = \"b[i\"+i+\"]\"\n  }\n  code.push(\"proto.transpose=function \"+className+\"_transpose(\"+args+\"){\"+\n    args.map(function(n,idx) { return n + \"=(\" + n + \"===undefined?\" + idx + \":\" + n + \"|0)\"}).join(\";\"),\n    \"var a=this.shape,b=this.stride;return new \"+className+\"(this.data,\"+tShape.join(\",\")+\",\"+tStride.join(\",\")+\",this.offset)}\")\n\n  //view.pick():\n  code.push(\"proto.pick=function \"+className+\"_pick(\"+args+\"){var a=[],b=[],c=this.offset\")\n  for(var i=0; i<dimension; ++i) {\n    code.push(\"if(typeof i\"+i+\"==='number'&&i\"+i+\">=0){c=(c+this.stride[\"+i+\"]*i\"+i+\")|0}else{a.push(this.shape[\"+i+\"]);b.push(this.stride[\"+i+\"])}\")\n  }\n  code.push(\"var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}\")\n\n  //Add return statement\n  code.push(\"return function construct_\"+className+\"(data,shape,stride,offset){return new \"+className+\"(data,\"+\n    indices.map(function(i) {\n      return \"shape[\"+i+\"]\"\n    }).join(\",\")+\",\"+\n    indices.map(function(i) {\n      return \"stride[\"+i+\"]\"\n    }).join(\",\")+\",offset)}\")\n\n  //Compile procedure\n  var procedure = new Function(\"CTOR_LIST\", \"ORDER\", code.join(\"\\n\"))\n  return procedure(CACHED_CONSTRUCTORS[dtype], order)\n}\n\nfunction arrayDType(data) {\n  if(isBuffer(data)) {\n    return \"buffer\"\n  }\n  if(hasTypedArrays) {\n    switch(Object.prototype.toString.call(data)) {\n      case \"[object Float64Array]\":\n        return \"float64\"\n      case \"[object Float32Array]\":\n        return \"float32\"\n      case \"[object Int8Array]\":\n        return \"int8\"\n      case \"[object Int16Array]\":\n        return \"int16\"\n      case \"[object Int32Array]\":\n        return \"int32\"\n      case \"[object Uint8Array]\":\n        return \"uint8\"\n      case \"[object Uint16Array]\":\n        return \"uint16\"\n      case \"[object Uint32Array]\":\n        return \"uint32\"\n      case \"[object Uint8ClampedArray]\":\n        return \"uint8_clamped\"\n      case \"[object BigInt64Array]\":\n        return \"bigint64\"\n      case \"[object BigUint64Array]\":\n        return \"biguint64\"\n    }\n  }\n  if(Array.isArray(data)) {\n    return \"array\"\n  }\n  return \"generic\"\n}\n\nvar CACHED_CONSTRUCTORS = {\n  \"float32\":[],\n  \"float64\":[],\n  \"int8\":[],\n  \"int16\":[],\n  \"int32\":[],\n  \"uint8\":[],\n  \"uint16\":[],\n  \"uint32\":[],\n  \"array\":[],\n  \"uint8_clamped\":[],\n  \"bigint64\": [],\n  \"biguint64\": [],\n  \"buffer\":[],\n  \"generic\":[]\n}\n\n;(function() {\n  for(var id in CACHED_CONSTRUCTORS) {\n    CACHED_CONSTRUCTORS[id].push(compileConstructor(id, -1))\n  }\n});\n\nfunction wrappedNDArrayCtor(data, shape, stride, offset) {\n  if(data === undefined) {\n    var ctor = CACHED_CONSTRUCTORS.array[0]\n    return ctor([])\n  } else if(typeof data === \"number\") {\n    data = [data]\n  }\n  if(shape === undefined) {\n    shape = [ data.length ]\n  }\n  var d = shape.length\n  if(stride === undefined) {\n    stride = new Array(d)\n    for(var i=d-1, sz=1; i>=0; --i) {\n      stride[i] = sz\n      sz *= shape[i]\n    }\n  }\n  if(offset === undefined) {\n    offset = 0\n    for(var i=0; i<d; ++i) {\n      if(stride[i] < 0) {\n        offset -= (shape[i]-1)*stride[i]\n      }\n    }\n  }\n  var dtype = arrayDType(data)\n  var ctor_list = CACHED_CONSTRUCTORS[dtype]\n  while(ctor_list.length <= d+1) {\n    ctor_list.push(compileConstructor(dtype, ctor_list.length-1))\n  }\n  var ctor = ctor_list[d+1]\n  return ctor(data, shape, stride, offset)\n}\n\nmodule.exports = wrappedNDArrayCtor\n","module.exports = AABB\n\nvar vec3 = require('gl-vec3')\n\nfunction AABB(pos, vec) {\n\n  if(!(this instanceof AABB)) {\n    return new AABB(pos, vec)\n  }\n\n  var pos2 = vec3.create()\n  vec3.add(pos2, pos, vec)\n \n  this.base = vec3.min(vec3.create(), pos, pos2)\n  this.vec = vec3.clone(vec)\n  this.max = vec3.max(vec3.create(), pos, pos2)\n\n  this.mag = vec3.length(this.vec)\n\n}\n\nvar cons = AABB\n  , proto = cons.prototype\n\nproto.width = function() {\n  return this.vec[0]\n}\n\nproto.height = function() {\n  return this.vec[1]\n}\n\nproto.depth = function() {\n  return this.vec[2]\n}\n\nproto.x0 = function() {\n  return this.base[0]\n}\n\nproto.y0 = function() {\n  return this.base[1]\n}\n\nproto.z0 = function() {\n  return this.base[2]\n}\n\nproto.x1 = function() {\n  return this.max[0]\n}\n\nproto.y1 = function() {\n  return this.max[1]\n}\n\nproto.z1 = function() {\n  return this.max[2]\n}\n\nproto.translate = function(by) {\n  vec3.add(this.max, this.max, by)\n  vec3.add(this.base, this.base, by)\n  return this\n}\n\nproto.setPosition = function(pos) {\n  vec3.add(this.max, pos, this.vec)\n  vec3.copy(this.base, pos)\n  return this\n}\n\nproto.expand = function(aabb) {\n  var max = vec3.create()\n    , min = vec3.create()\n\n  vec3.max(max, aabb.max, this.max)\n  vec3.min(min, aabb.base, this.base)\n  vec3.subtract(max, max, min)\n\n  return new AABB(min, max)\n}\n\nproto.intersects = function(aabb) {\n  if(aabb.base[0] > this.max[0]) return false\n  if(aabb.base[1] > this.max[1]) return false\n  if(aabb.base[2] > this.max[2]) return false\n  if(aabb.max[0] < this.base[0]) return false\n  if(aabb.max[1] < this.base[1]) return false\n  if(aabb.max[2] < this.base[2]) return false\n\n  return true\n}\n\nproto.touches = function(aabb) {\n\n  var intersection = this.union(aabb);\n\n  return (intersection !== null) &&\n         ((intersection.width() == 0) ||\n         (intersection.height() == 0) || \n         (intersection.depth() == 0))\n\n}\n\nproto.union = function(aabb) {\n  if(!this.intersects(aabb)) return null\n\n  var base_x = Math.max(aabb.base[0], this.base[0])\n    , base_y = Math.max(aabb.base[1], this.base[1])\n    , base_z = Math.max(aabb.base[2], this.base[2])\n    , max_x = Math.min(aabb.max[0], this.max[0])\n    , max_y = Math.min(aabb.max[1], this.max[1])\n    , max_z = Math.min(aabb.max[2], this.max[2])\n\n  return new AABB([base_x, base_y, base_z], [max_x - base_x, max_y - base_y, max_z - base_z])\n}\n\n\n\n\n","'use strict'\n\nvar bits = require('bit-twiddle')\nvar dup = require('dup')\nvar Buffer = require('buffer').Buffer\n\n//Legacy pool support\nif(!global.__TYPEDARRAY_POOL) {\n  global.__TYPEDARRAY_POOL = {\n      UINT8     : dup([32, 0])\n    , UINT16    : dup([32, 0])\n    , UINT32    : dup([32, 0])\n    , BIGUINT64 : dup([32, 0])\n    , INT8      : dup([32, 0])\n    , INT16     : dup([32, 0])\n    , INT32     : dup([32, 0])\n    , BIGINT64  : dup([32, 0])\n    , FLOAT     : dup([32, 0])\n    , DOUBLE    : dup([32, 0])\n    , DATA      : dup([32, 0])\n    , UINT8C    : dup([32, 0])\n    , BUFFER    : dup([32, 0])\n  }\n}\n\nvar hasUint8C = (typeof Uint8ClampedArray) !== 'undefined'\nvar hasBigUint64 = (typeof BigUint64Array) !== 'undefined'\nvar hasBigInt64 = (typeof BigInt64Array) !== 'undefined'\nvar POOL = global.__TYPEDARRAY_POOL\n\n//Upgrade pool\nif(!POOL.UINT8C) {\n  POOL.UINT8C = dup([32, 0])\n}\nif(!POOL.BIGUINT64) {\n  POOL.BIGUINT64 = dup([32, 0])\n}\nif(!POOL.BIGINT64) {\n  POOL.BIGINT64 = dup([32, 0])\n}\nif(!POOL.BUFFER) {\n  POOL.BUFFER = dup([32, 0])\n}\n\n//New technique: Only allocate from ArrayBufferView and Buffer\nvar DATA    = POOL.DATA\n  , BUFFER  = POOL.BUFFER\n\nexports.free = function free(array) {\n  if(Buffer.isBuffer(array)) {\n    BUFFER[bits.log2(array.length)].push(array)\n  } else {\n    if(Object.prototype.toString.call(array) !== '[object ArrayBuffer]') {\n      array = array.buffer\n    }\n    if(!array) {\n      return\n    }\n    var n = array.length || array.byteLength\n    var log_n = bits.log2(n)|0\n    DATA[log_n].push(array)\n  }\n}\n\nfunction freeArrayBuffer(buffer) {\n  if(!buffer) {\n    return\n  }\n  var n = buffer.length || buffer.byteLength\n  var log_n = bits.log2(n)\n  DATA[log_n].push(buffer)\n}\n\nfunction freeTypedArray(array) {\n  freeArrayBuffer(array.buffer)\n}\n\nexports.freeUint8 =\nexports.freeUint16 =\nexports.freeUint32 =\nexports.freeBigUint64 =\nexports.freeInt8 =\nexports.freeInt16 =\nexports.freeInt32 =\nexports.freeBigInt64 =\nexports.freeFloat32 = \nexports.freeFloat =\nexports.freeFloat64 = \nexports.freeDouble = \nexports.freeUint8Clamped = \nexports.freeDataView = freeTypedArray\n\nexports.freeArrayBuffer = freeArrayBuffer\n\nexports.freeBuffer = function freeBuffer(array) {\n  BUFFER[bits.log2(array.length)].push(array)\n}\n\nexports.malloc = function malloc(n, dtype) {\n  if(dtype === undefined || dtype === 'arraybuffer') {\n    return mallocArrayBuffer(n)\n  } else {\n    switch(dtype) {\n      case 'uint8':\n        return mallocUint8(n)\n      case 'uint16':\n        return mallocUint16(n)\n      case 'uint32':\n        return mallocUint32(n)\n      case 'int8':\n        return mallocInt8(n)\n      case 'int16':\n        return mallocInt16(n)\n      case 'int32':\n        return mallocInt32(n)\n      case 'float':\n      case 'float32':\n        return mallocFloat(n)\n      case 'double':\n      case 'float64':\n        return mallocDouble(n)\n      case 'uint8_clamped':\n        return mallocUint8Clamped(n)\n      case 'bigint64':\n        return mallocBigInt64(n)\n      case 'biguint64':\n        return mallocBigUint64(n)\n      case 'buffer':\n        return mallocBuffer(n)\n      case 'data':\n      case 'dataview':\n        return mallocDataView(n)\n\n      default:\n        return null\n    }\n  }\n  return null\n}\n\nfunction mallocArrayBuffer(n) {\n  var n = bits.nextPow2(n)\n  var log_n = bits.log2(n)\n  var d = DATA[log_n]\n  if(d.length > 0) {\n    return d.pop()\n  }\n  return new ArrayBuffer(n)\n}\nexports.mallocArrayBuffer = mallocArrayBuffer\n\nfunction mallocUint8(n) {\n  return new Uint8Array(mallocArrayBuffer(n), 0, n)\n}\nexports.mallocUint8 = mallocUint8\n\nfunction mallocUint16(n) {\n  return new Uint16Array(mallocArrayBuffer(2*n), 0, n)\n}\nexports.mallocUint16 = mallocUint16\n\nfunction mallocUint32(n) {\n  return new Uint32Array(mallocArrayBuffer(4*n), 0, n)\n}\nexports.mallocUint32 = mallocUint32\n\nfunction mallocInt8(n) {\n  return new Int8Array(mallocArrayBuffer(n), 0, n)\n}\nexports.mallocInt8 = mallocInt8\n\nfunction mallocInt16(n) {\n  return new Int16Array(mallocArrayBuffer(2*n), 0, n)\n}\nexports.mallocInt16 = mallocInt16\n\nfunction mallocInt32(n) {\n  return new Int32Array(mallocArrayBuffer(4*n), 0, n)\n}\nexports.mallocInt32 = mallocInt32\n\nfunction mallocFloat(n) {\n  return new Float32Array(mallocArrayBuffer(4*n), 0, n)\n}\nexports.mallocFloat32 = exports.mallocFloat = mallocFloat\n\nfunction mallocDouble(n) {\n  return new Float64Array(mallocArrayBuffer(8*n), 0, n)\n}\nexports.mallocFloat64 = exports.mallocDouble = mallocDouble\n\nfunction mallocUint8Clamped(n) {\n  if(hasUint8C) {\n    return new Uint8ClampedArray(mallocArrayBuffer(n), 0, n)\n  } else {\n    return mallocUint8(n)\n  }\n}\nexports.mallocUint8Clamped = mallocUint8Clamped\n\nfunction mallocBigUint64(n) {\n  if(hasBigUint64) {\n    return new BigUint64Array(mallocArrayBuffer(8*n), 0, n)\n  } else {\n    return null;\n  }\n}\nexports.mallocBigUint64 = mallocBigUint64\n\nfunction mallocBigInt64(n) {\n  if (hasBigInt64) {\n    return new BigInt64Array(mallocArrayBuffer(8*n), 0, n)\n  } else {\n    return null;\n  }\n}\nexports.mallocBigInt64 = mallocBigInt64\n\nfunction mallocDataView(n) {\n  return new DataView(mallocArrayBuffer(n), 0, n)\n}\nexports.mallocDataView = mallocDataView\n\nfunction mallocBuffer(n) {\n  n = bits.nextPow2(n)\n  var log_n = bits.log2(n)\n  var cache = BUFFER[log_n]\n  if(cache.length > 0) {\n    return cache.pop()\n  }\n  return new Buffer(n)\n}\nexports.mallocBuffer = mallocBuffer\n\nexports.clearCache = function clearCache() {\n  for(var i=0; i<32; ++i) {\n    POOL.UINT8[i].length = 0\n    POOL.UINT16[i].length = 0\n    POOL.UINT32[i].length = 0\n    POOL.INT8[i].length = 0\n    POOL.INT16[i].length = 0\n    POOL.INT32[i].length = 0\n    POOL.FLOAT[i].length = 0\n    POOL.DOUBLE[i].length = 0\n    POOL.BIGUINT64[i].length = 0\n    POOL.BIGINT64[i].length = 0\n    POOL.UINT8C[i].length = 0\n    DATA[i].length = 0\n    BUFFER[i].length = 0\n  }\n}\n","var vec3 = require('gl-vec3')\n\nexport default function (noa) {\n\n    /**\n     * \n     * \tComponent holding entity's position, width, and height.\n     *  By convention, entity's \"position\" is the bottom center of its AABB\n     * \n     *  Of the various properties, _localPosition is the \"real\", \n     *  single-source-of-truth position. Others are derived.\n     *  Local coords are relative to `noa.worldOriginOffset`.\n     * \n     *  Props:\n     *      position: pos in global coords (may be low precision)\n     *      _localPosition: precise pos in local coords\n     *      _renderPosition: [x,y,z] in LOCAL COORDS\n     *      _extents: array [lo, lo, lo, hi, hi, hi] in LOCAL COORDS\n     * \n     */\n\n\n\n    return {\n\n        name: 'position',\n\n        order: 60,\n\n        state: {\n            position: null,\n            width: +1,\n            height: +1,\n            _localPosition: null,\n            _renderPosition: null,\n            _extents: null,\n        },\n\n\n        onAdd: function (eid, state) {\n            // copy position into a plain array\n            var pos = [0, 0, 0]\n            if (state.position) vec3.copy(pos, state.position)\n            state.position = pos\n\n            state._localPosition = vec3.create()\n            state._renderPosition = vec3.create()\n            state._extents = new Float32Array(6)\n\n            // on init only, set local from global\n            noa.globalToLocal(state.position, null, state._localPosition)\n            vec3.copy(state._renderPosition, state._localPosition)\n            updatePositionExtents(state)\n        },\n\n        onRemove: null,\n\n\n\n        system: function (dt, states) {\n            var off = noa.worldOriginOffset\n            states.forEach(state => {\n                vec3.add(state.position, state._localPosition, off)\n                updatePositionExtents(state)\n            })\n        },\n\n\n    }\n}\n\n\n\n// update an entity's position state `_extents` \nexport function updatePositionExtents(state) {\n    var hw = state.width / 2\n    var lpos = state._localPosition\n    var ext = state._extents\n    ext[0] = lpos[0] - hw\n    ext[1] = lpos[1]\n    ext[2] = lpos[2] - hw\n    ext[3] = lpos[0] + hw\n    ext[4] = lpos[1] + state.height\n    ext[5] = lpos[2] + hw\n}\n","var vec3 = require('gl-vec3')\n\n\nexport default function (noa) {\n\n\n    return {\n\n        name: 'physics',\n\n        order: 40,\n\n        state: {\n            body: null,\n        },\n\n\n        onAdd: function (entID, state) {\n            state.body = noa.physics.addBody()\n            // implicitly assume body has a position component, to get size\n            var posDat = noa.ents.getPositionData(state.__id)\n            setPhysicsFromPosition(state, posDat)\n        },\n\n\n        onRemove: function (entID, state) {\n            // update position before removing\n            // this lets entity wind up at e.g. the result of a collision\n            // even if physics component is removed in collision handler\n            if (noa.ents.hasPosition(state.__id)) {\n                var pdat = noa.ents.getPositionData(state.__id)\n                setPositionFromPhysics(state, pdat)\n                backtrackRenderPos(state, pdat, 0, false)\n            }\n            noa.physics.removeBody(state.body)\n        },\n\n\n        system: function (dt, states) {\n            states.forEach(state => {\n                var pdat = noa.ents.getPositionData(state.__id)\n                setPositionFromPhysics(state, pdat)\n            })\n\n        },\n\n\n        renderSystem: function (dt, states) {\n\n            var tickPos = noa.positionInCurrentTick\n            var tickMS = tickPos * noa._tickRate\n\n            // tickMS is time since last physics engine tick\n            // to avoid temporal aliasing, render the state as if lerping between\n            // the last position and the next one \n            // since the entity data is the \"next\" position this amounts to \n            // offsetting each entity into the past by tickRate - dt\n            // http://gafferongames.com/game-physics/fix-your-timestep/\n\n            var backtrackAmt = (tickMS - noa._tickRate) / 1000\n            states.forEach(state => {\n                var id = state.__id\n                var pdat = noa.ents.getPositionData(id)\n                var smoothed = noa.ents.cameraSmoothed(id)\n                backtrackRenderPos(state, pdat, backtrackAmt, smoothed)\n            })\n        }\n\n    }\n\n}\n\n\n\n// var offset = vec3.create()\nvar local = vec3.create()\n\nexport function setPhysicsFromPosition(physState, posState) {\n    var box = physState.body.aabb\n    var ext = posState._extents\n    vec3.copy(box.base, ext)\n    vec3.set(box.vec, posState.width, posState.height, posState.width)\n    vec3.add(box.max, box.base, box.vec)\n}\n\n\nfunction setPositionFromPhysics(physState, posState) {\n    var base = physState.body.aabb.base\n    var hw = posState.width / 2\n    vec3.set(posState._localPosition, base[0] + hw, base[1], base[2] + hw)\n}\n\n\nfunction backtrackRenderPos(physState, posState, backtrackAmt, smoothed) {\n    // pos = pos + backtrack * body.velocity\n    var vel = physState.body.velocity\n    vec3.scaleAndAdd(local, posState._localPosition, vel, backtrackAmt)\n\n    // smooth out update if component is present\n    // (this is set after sudden movements like auto-stepping)\n    if (smoothed) vec3.lerp(local, posState._renderPosition, local, 0.3)\n\n    // copy values over to renderPosition, \n    vec3.copy(posState._renderPosition, local)\n}\n","module.exports = 0.000001\n","module.exports = create;\n\n/**\n * Creates a new, empty vec3\n *\n * @returns {vec3} a new 3D vector\n */\nfunction create() {\n    var out = new Float32Array(3)\n    out[0] = 0\n    out[1] = 0\n    out[2] = 0\n    return out\n}","module.exports = fromValues;\n\n/**\n * Creates a new vec3 initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} a new 3D vector\n */\nfunction fromValues(x, y, z) {\n    var out = new Float32Array(3)\n    out[0] = x\n    out[1] = y\n    out[2] = z\n    return out\n}","module.exports = normalize;\n\n/**\n * Normalize a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a vector to normalize\n * @returns {vec3} out\n */\nfunction normalize(out, a) {\n    var x = a[0],\n        y = a[1],\n        z = a[2]\n    var len = x*x + y*y + z*z\n    if (len > 0) {\n        //TODO: evaluate use of glm_invsqrt here?\n        len = 1 / Math.sqrt(len)\n        out[0] = a[0] * len\n        out[1] = a[1] * len\n        out[2] = a[2] * len\n    }\n    return out\n}","module.exports = dot;\n\n/**\n * Calculates the dot product of two vec3's\n *\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {Number} dot product of a and b\n */\nfunction dot(a, b) {\n    return a[0] * b[0] + a[1] * b[1] + a[2] * b[2]\n}","module.exports = subtract;\n\n/**\n * Subtracts vector b from vector a\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nfunction subtract(out, a, b) {\n    out[0] = a[0] - b[0]\n    out[1] = a[1] - b[1]\n    out[2] = a[2] - b[2]\n    return out\n}","module.exports = multiply;\n\n/**\n * Multiplies two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nfunction multiply(out, a, b) {\n    out[0] = a[0] * b[0]\n    out[1] = a[1] * b[1]\n    out[2] = a[2] * b[2]\n    return out\n}","module.exports = divide;\n\n/**\n * Divides two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nfunction divide(out, a, b) {\n    out[0] = a[0] / b[0]\n    out[1] = a[1] / b[1]\n    out[2] = a[2] / b[2]\n    return out\n}","module.exports = distance;\n\n/**\n * Calculates the euclidian distance between two vec3's\n *\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {Number} distance between a and b\n */\nfunction distance(a, b) {\n    var x = b[0] - a[0],\n        y = b[1] - a[1],\n        z = b[2] - a[2]\n    return Math.sqrt(x*x + y*y + z*z)\n}","module.exports = squaredDistance;\n\n/**\n * Calculates the squared euclidian distance between two vec3's\n *\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {Number} squared distance between a and b\n */\nfunction squaredDistance(a, b) {\n    var x = b[0] - a[0],\n        y = b[1] - a[1],\n        z = b[2] - a[2]\n    return x*x + y*y + z*z\n}","module.exports = length;\n\n/**\n * Calculates the length of a vec3\n *\n * @param {vec3} a vector to calculate length of\n * @returns {Number} length of a\n */\nfunction length(a) {\n    var x = a[0],\n        y = a[1],\n        z = a[2]\n    return Math.sqrt(x*x + y*y + z*z)\n}","module.exports = squaredLength;\n\n/**\n * Calculates the squared length of a vec3\n *\n * @param {vec3} a vector to calculate squared length of\n * @returns {Number} squared length of a\n */\nfunction squaredLength(a) {\n    var x = a[0],\n        y = a[1],\n        z = a[2]\n    return x*x + y*y + z*z\n}","\"use strict\"\n\nfunction iota(n) {\n  var result = new Array(n)\n  for(var i=0; i<n; ++i) {\n    result[i] = i\n  }\n  return result\n}\n\nmodule.exports = iota","'use strict'\n\n\n// reused array instances\n\nvar tr_arr = []\nvar ldi_arr = []\nvar tri_arr = []\nvar step_arr = []\nvar tDelta_arr = []\nvar tNext_arr = []\nvar vec_arr = []\nvar normed_arr = []\nvar base_arr = []\nvar max_arr = []\nvar left_arr = []\nvar result_arr = []\n\n\n\n// core implementation:\n\nfunction sweep_impl(getVoxel, callback, vec, base, max, epsilon) {\n\n    // consider algo as a raycast along the AABB's leading corner\n    // as raycast enters each new voxel, iterate in 2D over the AABB's \n    // leading face in that axis looking for collisions\n    // \n    // original raycast implementation: https://github.com/andyhall/fast-voxel-raycast\n    // original raycast paper: http://www.cse.chalmers.se/edu/year/2010/course/TDA361/grid.pdf\n\n    var tr = tr_arr\n    var ldi = ldi_arr\n    var tri = tri_arr\n    var step = step_arr\n    var tDelta = tDelta_arr\n    var tNext = tNext_arr\n    var normed = normed_arr\n\n    var floor = Math.floor\n    var cumulative_t = 0.0\n    var t = 0.0\n    var max_t = 0.0\n    var axis = 0\n    var i = 0\n\n\n    // init for the current sweep vector and take first step\n    initSweep()\n    if (max_t === 0) return 0\n\n    axis = stepForward()\n\n    // loop along raycast vector\n    while (t <= max_t) {\n\n        // sweeps over leading face of AABB\n        if (checkCollision(axis)) {\n            // calls the callback and decides whether to continue\n            var done = handleCollision()\n            if (done) return cumulative_t\n        }\n\n        axis = stepForward()\n    }\n\n    // reached the end of the vector unobstructed, finish and exit\n    cumulative_t += max_t\n    for (i = 0; i < 3; i++) {\n        base[i] += vec[i]\n        max[i] += vec[i]\n    }\n    return cumulative_t\n\n\n\n\n\n    // low-level implementations of each step:\n    function initSweep() {\n\n        // parametrization t along raycast\n        t = 0.0\n        max_t = Math.sqrt(vec[0] * vec[0] + vec[1] * vec[1] + vec[2] * vec[2])\n        if (max_t === 0) return\n        for (var i = 0; i < 3; i++) {\n            var dir = (vec[i] >= 0)\n            step[i] = dir ? 1 : -1\n            // trailing / trailing edge coords\n            var lead = dir ? max[i] : base[i]\n            tr[i] = dir ? base[i] : max[i]\n            // int values of lead/trail edges\n            ldi[i] = leadEdgeToInt(lead, step[i])\n            tri[i] = trailEdgeToInt(tr[i], step[i])\n            // normed vector\n            normed[i] = vec[i] / max_t\n            // distance along t required to move one voxel in each axis\n            tDelta[i] = Math.abs(1 / normed[i])\n            // location of nearest voxel boundary, in units of t \n            var dist = dir ? (ldi[i] + 1 - lead) : (lead - ldi[i])\n            tNext[i] = (tDelta[i] < Infinity) ? tDelta[i] * dist : Infinity\n        }\n\n    }\n\n\n    // check for collisions - iterate over the leading face on the advancing axis\n\n    function checkCollision(i_axis) {\n        var stepx = step[0]\n        var x0 = (i_axis === 0) ? ldi[0] : tri[0]\n        var x1 = ldi[0] + stepx\n\n        var stepy = step[1]\n        var y0 = (i_axis === 1) ? ldi[1] : tri[1]\n        var y1 = ldi[1] + stepy\n\n        var stepz = step[2]\n        var z0 = (i_axis === 2) ? ldi[2] : tri[2]\n        var z1 = ldi[2] + stepz\n\n        // var j_axis = (i_axis + 1) % 3\n        // var k_axis = (i_axis + 2) % 3\n        // var s = ['x', 'y', 'z'][i_axis]\n        // var js = ['x', 'y', 'z'][j_axis]\n        // var ks = ['x', 'y', 'z'][k_axis]\n        // var i0 = [x0, y0, z0][i_axis]\n        // var j0 = [x0, y0, z0][j_axis]\n        // var k0 = [x0, y0, z0][k_axis]\n        // var i1 = [x1 - stepx, y1 - stepy, z1 - stepz][i_axis]\n        // var j1 = [x1 - stepx, y1 - stepy, z1 - stepz][j_axis]\n        // var k1 = [x1 - stepx, y1 - stepy, z1 - stepz][k_axis]\n        // console.log('=== step', s, 'to', i0, '   sweep', js, j0 + ',' + j1, '   ', ks, k0 + ',' + k1)\n\n        for (var x = x0; x != x1; x += stepx) {\n            for (var y = y0; y != y1; y += stepy) {\n                for (var z = z0; z != z1; z += stepz) {\n                    if (getVoxel(x, y, z)) return true\n                }\n            }\n        }\n        return false\n    }\n\n\n    // on collision - call the callback and return or set up for the next sweep\n\n    function handleCollision() {\n\n        // set up for callback\n        cumulative_t += t\n        var dir = step[axis]\n\n        // vector moved so far, and left to move\n        var done = t / max_t\n        var left = left_arr\n        for (i = 0; i < 3; i++) {\n            var dv = vec[i] * done\n            base[i] += dv\n            max[i] += dv\n            left[i] = vec[i] - dv\n        }\n\n        // set leading edge of stepped axis exactly to voxel boundary\n        // else we'll sometimes rounding error beyond it\n        if (dir > 0) {\n            max[axis] = Math.round(max[axis])\n        } else {\n            base[axis] = Math.round(base[axis])\n        }\n        \n        // call back to let client update the \"left to go\" vector\n        var res = callback(cumulative_t, axis, dir, left)\n\n        // bail out out on truthy response\n        if (res) return true\n\n        // init for new sweep along vec\n        for (i = 0; i < 3; i++) vec[i] = left[i]\n        initSweep()\n        if (max_t === 0) return true // no vector left\n\n        return false\n    }\n\n\n    // advance to next voxel boundary, and return which axis was stepped\n\n    function stepForward() {\n        var axis = (tNext[0] < tNext[1]) ?\n            ((tNext[0] < tNext[2]) ? 0 : 2) :\n            ((tNext[1] < tNext[2]) ? 1 : 2)\n        var dt = tNext[axis] - t\n        t = tNext[axis]\n        ldi[axis] += step[axis]\n        tNext[axis] += tDelta[axis]\n        for (i = 0; i < 3; i++) {\n            tr[i] += dt * normed[i]\n            tri[i] = trailEdgeToInt(tr[i], step[i])\n        }\n\n        return axis\n    }\n\n\n\n    function leadEdgeToInt(coord, step) {\n        return floor(coord - step * epsilon)\n    }\n    function trailEdgeToInt(coord, step) {\n        return floor(coord + step * epsilon)\n    }\n\n}\n\n\n\n\n\n// conform inputs\n\nfunction sweep(getVoxel, box, dir, callback, noTranslate, epsilon) {\n\n    var vec = vec_arr\n    var base = base_arr\n    var max = max_arr\n    var result = result_arr\n\n    // init parameter float arrays\n    for (var i = 0; i < 3; i++) {\n        vec[i] = +dir[i]\n        max[i] = +box.max[i]\n        base[i] = +box.base[i]\n    }\n\n    if (!epsilon) epsilon = 1e-10\n\n    // run sweep implementation\n    var dist = sweep_impl(getVoxel, callback, vec, base, max, epsilon)\n\n    // translate box by distance needed to updated base value\n    if (!noTranslate) {\n        for (i = 0; i < 3; i++) {\n            result[i] = (dir[i] > 0) ? max[i] - box.max[i] : base[i] - box.base[i]\n        }\n        box.translate(result)\n    }\n\n    // return value is total distance moved (not necessarily magnitude of [end]-[start])\n    return dist\n}\n\nmodule.exports = sweep\n\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","'use strict'\n\nmodule.exports = {\n  init:           sqInit,\n  sweepBipartite: sweepBipartite,\n  sweepComplete:  sweepComplete,\n  scanBipartite:  scanBipartite,\n  scanComplete:   scanComplete\n}\n\nvar pool  = require('typedarray-pool')\nvar bits  = require('bit-twiddle')\nvar isort = require('./sort')\n\n//Flag for blue\nvar BLUE_FLAG = (1<<28)\n\n//1D sweep event queue stuff (use pool to save space)\nvar INIT_CAPACITY      = 1024\nvar RED_SWEEP_QUEUE    = pool.mallocInt32(INIT_CAPACITY)\nvar RED_SWEEP_INDEX    = pool.mallocInt32(INIT_CAPACITY)\nvar BLUE_SWEEP_QUEUE   = pool.mallocInt32(INIT_CAPACITY)\nvar BLUE_SWEEP_INDEX   = pool.mallocInt32(INIT_CAPACITY)\nvar COMMON_SWEEP_QUEUE = pool.mallocInt32(INIT_CAPACITY)\nvar COMMON_SWEEP_INDEX = pool.mallocInt32(INIT_CAPACITY)\nvar SWEEP_EVENTS       = pool.mallocDouble(INIT_CAPACITY * 8)\n\n//Reserves memory for the 1D sweep data structures\nfunction sqInit(count) {\n  var rcount = bits.nextPow2(count)\n  if(RED_SWEEP_QUEUE.length < rcount) {\n    pool.free(RED_SWEEP_QUEUE)\n    RED_SWEEP_QUEUE = pool.mallocInt32(rcount)\n  }\n  if(RED_SWEEP_INDEX.length < rcount) {\n    pool.free(RED_SWEEP_INDEX)\n    RED_SWEEP_INDEX = pool.mallocInt32(rcount)\n  }\n  if(BLUE_SWEEP_QUEUE.length < rcount) {\n    pool.free(BLUE_SWEEP_QUEUE)\n    BLUE_SWEEP_QUEUE = pool.mallocInt32(rcount)\n  }\n  if(BLUE_SWEEP_INDEX.length < rcount) {\n    pool.free(BLUE_SWEEP_INDEX)\n    BLUE_SWEEP_INDEX = pool.mallocInt32(rcount)\n  }\n  if(COMMON_SWEEP_QUEUE.length < rcount) {\n    pool.free(COMMON_SWEEP_QUEUE)\n    COMMON_SWEEP_QUEUE = pool.mallocInt32(rcount)\n  }\n  if(COMMON_SWEEP_INDEX.length < rcount) {\n    pool.free(COMMON_SWEEP_INDEX)\n    COMMON_SWEEP_INDEX = pool.mallocInt32(rcount)\n  }\n  var eventLength = 8 * rcount\n  if(SWEEP_EVENTS.length < eventLength) {\n    pool.free(SWEEP_EVENTS)\n    SWEEP_EVENTS = pool.mallocDouble(eventLength)\n  }\n}\n\n//Remove an item from the active queue in O(1)\nfunction sqPop(queue, index, count, item) {\n  var idx = index[item]\n  var top = queue[count-1]\n  queue[idx] = top\n  index[top] = idx\n}\n\n//Insert an item into the active queue in O(1)\nfunction sqPush(queue, index, count, item) {\n  queue[count] = item\n  index[item]  = count\n}\n\n//Recursion base case: use 1D sweep algorithm\nfunction sweepBipartite(\n    d, visit,\n    redStart,  redEnd, red, redIndex,\n    blueStart, blueEnd, blue, blueIndex) {\n\n  //store events as pairs [coordinate, idx]\n  //\n  //  red create:  -(idx+1)\n  //  red destroy: idx\n  //  blue create: -(idx+BLUE_FLAG)\n  //  blue destroy: idx+BLUE_FLAG\n  //\n  var ptr      = 0\n  var elemSize = 2*d\n  var istart   = d-1\n  var iend     = elemSize-1\n\n  for(var i=redStart; i<redEnd; ++i) {\n    var idx = redIndex[i]\n    var redOffset = elemSize*i\n    SWEEP_EVENTS[ptr++] = red[redOffset+istart]\n    SWEEP_EVENTS[ptr++] = -(idx+1)\n    SWEEP_EVENTS[ptr++] = red[redOffset+iend]\n    SWEEP_EVENTS[ptr++] = idx\n  }\n\n  for(var i=blueStart; i<blueEnd; ++i) {\n    var idx = blueIndex[i]+BLUE_FLAG\n    var blueOffset = elemSize*i\n    SWEEP_EVENTS[ptr++] = blue[blueOffset+istart]\n    SWEEP_EVENTS[ptr++] = -idx\n    SWEEP_EVENTS[ptr++] = blue[blueOffset+iend]\n    SWEEP_EVENTS[ptr++] = idx\n  }\n\n  //process events from left->right\n  var n = ptr >>> 1\n  isort(SWEEP_EVENTS, n)\n  \n  var redActive  = 0\n  var blueActive = 0\n  for(var i=0; i<n; ++i) {\n    var e = SWEEP_EVENTS[2*i+1]|0\n    if(e >= BLUE_FLAG) {\n      //blue destroy event\n      e = (e-BLUE_FLAG)|0\n      sqPop(BLUE_SWEEP_QUEUE, BLUE_SWEEP_INDEX, blueActive--, e)\n    } else if(e >= 0) {\n      //red destroy event\n      sqPop(RED_SWEEP_QUEUE, RED_SWEEP_INDEX, redActive--, e)\n    } else if(e <= -BLUE_FLAG) {\n      //blue create event\n      e = (-e-BLUE_FLAG)|0\n      for(var j=0; j<redActive; ++j) {\n        var retval = visit(RED_SWEEP_QUEUE[j], e)\n        if(retval !== void 0) {\n          return retval\n        }\n      }\n      sqPush(BLUE_SWEEP_QUEUE, BLUE_SWEEP_INDEX, blueActive++, e)\n    } else {\n      //red create event\n      e = (-e-1)|0\n      for(var j=0; j<blueActive; ++j) {\n        var retval = visit(e, BLUE_SWEEP_QUEUE[j])\n        if(retval !== void 0) {\n          return retval\n        }\n      }\n      sqPush(RED_SWEEP_QUEUE, RED_SWEEP_INDEX, redActive++, e)\n    }\n  }\n}\n\n//Complete sweep\nfunction sweepComplete(d, visit, \n  redStart, redEnd, red, redIndex,\n  blueStart, blueEnd, blue, blueIndex) {\n\n  var ptr      = 0\n  var elemSize = 2*d\n  var istart   = d-1\n  var iend     = elemSize-1\n\n  for(var i=redStart; i<redEnd; ++i) {\n    var idx = (redIndex[i]+1)<<1\n    var redOffset = elemSize*i\n    SWEEP_EVENTS[ptr++] = red[redOffset+istart]\n    SWEEP_EVENTS[ptr++] = -idx\n    SWEEP_EVENTS[ptr++] = red[redOffset+iend]\n    SWEEP_EVENTS[ptr++] = idx\n  }\n\n  for(var i=blueStart; i<blueEnd; ++i) {\n    var idx = (blueIndex[i]+1)<<1\n    var blueOffset = elemSize*i\n    SWEEP_EVENTS[ptr++] = blue[blueOffset+istart]\n    SWEEP_EVENTS[ptr++] = (-idx)|1\n    SWEEP_EVENTS[ptr++] = blue[blueOffset+iend]\n    SWEEP_EVENTS[ptr++] = idx|1\n  }\n\n  //process events from left->right\n  var n = ptr >>> 1\n  isort(SWEEP_EVENTS, n)\n  \n  var redActive    = 0\n  var blueActive   = 0\n  var commonActive = 0\n  for(var i=0; i<n; ++i) {\n    var e     = SWEEP_EVENTS[2*i+1]|0\n    var color = e&1\n    if(i < n-1 && (e>>1) === (SWEEP_EVENTS[2*i+3]>>1)) {\n      color = 2\n      i += 1\n    }\n    \n    if(e < 0) {\n      //Create event\n      var id = -(e>>1) - 1\n\n      //Intersect with common\n      for(var j=0; j<commonActive; ++j) {\n        var retval = visit(COMMON_SWEEP_QUEUE[j], id)\n        if(retval !== void 0) {\n          return retval\n        }\n      }\n\n      if(color !== 0) {\n        //Intersect with red\n        for(var j=0; j<redActive; ++j) {\n          var retval = visit(RED_SWEEP_QUEUE[j], id)\n          if(retval !== void 0) {\n            return retval\n          }\n        }\n      }\n\n      if(color !== 1) {\n        //Intersect with blue\n        for(var j=0; j<blueActive; ++j) {\n          var retval = visit(BLUE_SWEEP_QUEUE[j], id)\n          if(retval !== void 0) {\n            return retval\n          }\n        }\n      }\n\n      if(color === 0) {\n        //Red\n        sqPush(RED_SWEEP_QUEUE, RED_SWEEP_INDEX, redActive++, id)\n      } else if(color === 1) {\n        //Blue\n        sqPush(BLUE_SWEEP_QUEUE, BLUE_SWEEP_INDEX, blueActive++, id)\n      } else if(color === 2) {\n        //Both\n        sqPush(COMMON_SWEEP_QUEUE, COMMON_SWEEP_INDEX, commonActive++, id)\n      }\n    } else {\n      //Destroy event\n      var id = (e>>1) - 1\n      if(color === 0) {\n        //Red\n        sqPop(RED_SWEEP_QUEUE, RED_SWEEP_INDEX, redActive--, id)\n      } else if(color === 1) {\n        //Blue\n        sqPop(BLUE_SWEEP_QUEUE, BLUE_SWEEP_INDEX, blueActive--, id)\n      } else if(color === 2) {\n        //Both\n        sqPop(COMMON_SWEEP_QUEUE, COMMON_SWEEP_INDEX, commonActive--, id)\n      }\n    }\n  }\n}\n\n//Sweep and prune/scanline algorithm:\n//  Scan along axis, detect intersections\n//  Brute force all boxes along axis\nfunction scanBipartite(\n  d, axis, visit, flip,\n  redStart,  redEnd, red, redIndex,\n  blueStart, blueEnd, blue, blueIndex) {\n  \n  var ptr      = 0\n  var elemSize = 2*d\n  var istart   = axis\n  var iend     = axis+d\n\n  var redShift  = 1\n  var blueShift = 1\n  if(flip) {\n    blueShift = BLUE_FLAG\n  } else {\n    redShift  = BLUE_FLAG\n  }\n\n  for(var i=redStart; i<redEnd; ++i) {\n    var idx = i + redShift\n    var redOffset = elemSize*i\n    SWEEP_EVENTS[ptr++] = red[redOffset+istart]\n    SWEEP_EVENTS[ptr++] = -idx\n    SWEEP_EVENTS[ptr++] = red[redOffset+iend]\n    SWEEP_EVENTS[ptr++] = idx\n  }\n  for(var i=blueStart; i<blueEnd; ++i) {\n    var idx = i + blueShift\n    var blueOffset = elemSize*i\n    SWEEP_EVENTS[ptr++] = blue[blueOffset+istart]\n    SWEEP_EVENTS[ptr++] = -idx\n  }\n\n  //process events from left->right\n  var n = ptr >>> 1\n  isort(SWEEP_EVENTS, n)\n  \n  var redActive    = 0\n  for(var i=0; i<n; ++i) {\n    var e = SWEEP_EVENTS[2*i+1]|0\n    if(e < 0) {\n      var idx   = -e\n      var isRed = false\n      if(idx >= BLUE_FLAG) {\n        isRed = !flip\n        idx -= BLUE_FLAG \n      } else {\n        isRed = !!flip\n        idx -= 1\n      }\n      if(isRed) {\n        sqPush(RED_SWEEP_QUEUE, RED_SWEEP_INDEX, redActive++, idx)\n      } else {\n        var blueId  = blueIndex[idx]\n        var bluePtr = elemSize * idx\n        \n        var b0 = blue[bluePtr+axis+1]\n        var b1 = blue[bluePtr+axis+1+d]\n\nred_loop:\n        for(var j=0; j<redActive; ++j) {\n          var oidx   = RED_SWEEP_QUEUE[j]\n          var redPtr = elemSize * oidx\n\n          if(b1 < red[redPtr+axis+1] || \n             red[redPtr+axis+1+d] < b0) {\n            continue\n          }\n\n          for(var k=axis+2; k<d; ++k) {\n            if(blue[bluePtr + k + d] < red[redPtr + k] || \n               red[redPtr + k + d] < blue[bluePtr + k]) {\n              continue red_loop\n            }\n          }\n\n          var redId  = redIndex[oidx]\n          var retval\n          if(flip) {\n            retval = visit(blueId, redId)\n          } else {\n            retval = visit(redId, blueId)\n          }\n          if(retval !== void 0) {\n            return retval \n          }\n        }\n      }\n    } else {\n      sqPop(RED_SWEEP_QUEUE, RED_SWEEP_INDEX, redActive--, e - redShift)\n    }\n  }\n}\n\nfunction scanComplete(\n  d, axis, visit,\n  redStart,  redEnd, red, redIndex,\n  blueStart, blueEnd, blue, blueIndex) {\n\n  var ptr      = 0\n  var elemSize = 2*d\n  var istart   = axis\n  var iend     = axis+d\n\n  for(var i=redStart; i<redEnd; ++i) {\n    var idx = i + BLUE_FLAG\n    var redOffset = elemSize*i\n    SWEEP_EVENTS[ptr++] = red[redOffset+istart]\n    SWEEP_EVENTS[ptr++] = -idx\n    SWEEP_EVENTS[ptr++] = red[redOffset+iend]\n    SWEEP_EVENTS[ptr++] = idx\n  }\n  for(var i=blueStart; i<blueEnd; ++i) {\n    var idx = i + 1\n    var blueOffset = elemSize*i\n    SWEEP_EVENTS[ptr++] = blue[blueOffset+istart]\n    SWEEP_EVENTS[ptr++] = -idx\n  }\n\n  //process events from left->right\n  var n = ptr >>> 1\n  isort(SWEEP_EVENTS, n)\n  \n  var redActive    = 0\n  for(var i=0; i<n; ++i) {\n    var e = SWEEP_EVENTS[2*i+1]|0\n    if(e < 0) {\n      var idx   = -e\n      if(idx >= BLUE_FLAG) {\n        RED_SWEEP_QUEUE[redActive++] = idx - BLUE_FLAG\n      } else {\n        idx -= 1\n        var blueId  = blueIndex[idx]\n        var bluePtr = elemSize * idx\n\n        var b0 = blue[bluePtr+axis+1]\n        var b1 = blue[bluePtr+axis+1+d]\n\nred_loop:\n        for(var j=0; j<redActive; ++j) {\n          var oidx   = RED_SWEEP_QUEUE[j]\n          var redId  = redIndex[oidx]\n\n          if(redId === blueId) {\n            break\n          }\n\n          var redPtr = elemSize * oidx\n          if(b1 < red[redPtr+axis+1] || \n            red[redPtr+axis+1+d] < b0) {\n            continue\n          }\n          for(var k=axis+2; k<d; ++k) {\n            if(blue[bluePtr + k + d] < red[redPtr + k] || \n               red[redPtr + k + d]   < blue[bluePtr + k]) {\n              continue red_loop\n            }\n          }\n\n          var retval = visit(redId, blueId)\n          if(retval !== void 0) {\n            return retval \n          }\n        }\n      }\n    } else {\n      var idx = e - BLUE_FLAG\n      for(var j=redActive-1; j>=0; --j) {\n        if(RED_SWEEP_QUEUE[j] === idx) {\n          for(var k=j+1; k<redActive; ++k) {\n            RED_SWEEP_QUEUE[k-1] = RED_SWEEP_QUEUE[k]\n          }\n          break\n        }\n      }\n      --redActive\n    }\n  }\n}","/**\n * Bit twiddling hacks for JavaScript.\n *\n * Author: Mikola Lysenko\n *\n * Ported from Stanford bit twiddling hack library:\n *    http://graphics.stanford.edu/~seander/bithacks.html\n */\n\n\"use strict\"; \"use restrict\";\n\n//Number of bits in an integer\nvar INT_BITS = 32;\n\n//Constants\nexports.INT_BITS  = INT_BITS;\nexports.INT_MAX   =  0x7fffffff;\nexports.INT_MIN   = -1<<(INT_BITS-1);\n\n//Returns -1, 0, +1 depending on sign of x\nexports.sign = function(v) {\n  return (v > 0) - (v < 0);\n}\n\n//Computes absolute value of integer\nexports.abs = function(v) {\n  var mask = v >> (INT_BITS-1);\n  return (v ^ mask) - mask;\n}\n\n//Computes minimum of integers x and y\nexports.min = function(x, y) {\n  return y ^ ((x ^ y) & -(x < y));\n}\n\n//Computes maximum of integers x and y\nexports.max = function(x, y) {\n  return x ^ ((x ^ y) & -(x < y));\n}\n\n//Checks if a number is a power of two\nexports.isPow2 = function(v) {\n  return !(v & (v-1)) && (!!v);\n}\n\n//Computes log base 2 of v\nexports.log2 = function(v) {\n  var r, shift;\n  r =     (v > 0xFFFF) << 4; v >>>= r;\n  shift = (v > 0xFF  ) << 3; v >>>= shift; r |= shift;\n  shift = (v > 0xF   ) << 2; v >>>= shift; r |= shift;\n  shift = (v > 0x3   ) << 1; v >>>= shift; r |= shift;\n  return r | (v >> 1);\n}\n\n//Computes log base 10 of v\nexports.log10 = function(v) {\n  return  (v >= 1000000000) ? 9 : (v >= 100000000) ? 8 : (v >= 10000000) ? 7 :\n          (v >= 1000000) ? 6 : (v >= 100000) ? 5 : (v >= 10000) ? 4 :\n          (v >= 1000) ? 3 : (v >= 100) ? 2 : (v >= 10) ? 1 : 0;\n}\n\n//Counts number of bits\nexports.popCount = function(v) {\n  v = v - ((v >>> 1) & 0x55555555);\n  v = (v & 0x33333333) + ((v >>> 2) & 0x33333333);\n  return ((v + (v >>> 4) & 0xF0F0F0F) * 0x1010101) >>> 24;\n}\n\n//Counts number of trailing zeros\nfunction countTrailingZeros(v) {\n  var c = 32;\n  v &= -v;\n  if (v) c--;\n  if (v & 0x0000FFFF) c -= 16;\n  if (v & 0x00FF00FF) c -= 8;\n  if (v & 0x0F0F0F0F) c -= 4;\n  if (v & 0x33333333) c -= 2;\n  if (v & 0x55555555) c -= 1;\n  return c;\n}\nexports.countTrailingZeros = countTrailingZeros;\n\n//Rounds to next power of 2\nexports.nextPow2 = function(v) {\n  v += v === 0;\n  --v;\n  v |= v >>> 1;\n  v |= v >>> 2;\n  v |= v >>> 4;\n  v |= v >>> 8;\n  v |= v >>> 16;\n  return v + 1;\n}\n\n//Rounds down to previous power of 2\nexports.prevPow2 = function(v) {\n  v |= v >>> 1;\n  v |= v >>> 2;\n  v |= v >>> 4;\n  v |= v >>> 8;\n  v |= v >>> 16;\n  return v - (v>>>1);\n}\n\n//Computes parity of word\nexports.parity = function(v) {\n  v ^= v >>> 16;\n  v ^= v >>> 8;\n  v ^= v >>> 4;\n  v &= 0xf;\n  return (0x6996 >>> v) & 1;\n}\n\nvar REVERSE_TABLE = new Array(256);\n\n(function(tab) {\n  for(var i=0; i<256; ++i) {\n    var v = i, r = i, s = 7;\n    for (v >>>= 1; v; v >>>= 1) {\n      r <<= 1;\n      r |= v & 1;\n      --s;\n    }\n    tab[i] = (r << s) & 0xff;\n  }\n})(REVERSE_TABLE);\n\n//Reverse bits in a 32 bit word\nexports.reverse = function(v) {\n  return  (REVERSE_TABLE[ v         & 0xff] << 24) |\n          (REVERSE_TABLE[(v >>> 8)  & 0xff] << 16) |\n          (REVERSE_TABLE[(v >>> 16) & 0xff] << 8)  |\n           REVERSE_TABLE[(v >>> 24) & 0xff];\n}\n\n//Interleave bits of 2 coordinates with 16 bits.  Useful for fast quadtree codes\nexports.interleave2 = function(x, y) {\n  x &= 0xFFFF;\n  x = (x | (x << 8)) & 0x00FF00FF;\n  x = (x | (x << 4)) & 0x0F0F0F0F;\n  x = (x | (x << 2)) & 0x33333333;\n  x = (x | (x << 1)) & 0x55555555;\n\n  y &= 0xFFFF;\n  y = (y | (y << 8)) & 0x00FF00FF;\n  y = (y | (y << 4)) & 0x0F0F0F0F;\n  y = (y | (y << 2)) & 0x33333333;\n  y = (y | (y << 1)) & 0x55555555;\n\n  return x | (y << 1);\n}\n\n//Extracts the nth interleaved component\nexports.deinterleave2 = function(v, n) {\n  v = (v >>> n) & 0x55555555;\n  v = (v | (v >>> 1))  & 0x33333333;\n  v = (v | (v >>> 2))  & 0x0F0F0F0F;\n  v = (v | (v >>> 4))  & 0x00FF00FF;\n  v = (v | (v >>> 16)) & 0x000FFFF;\n  return (v << 16) >> 16;\n}\n\n\n//Interleave bits of 3 coordinates, each with 10 bits.  Useful for fast octree codes\nexports.interleave3 = function(x, y, z) {\n  x &= 0x3FF;\n  x  = (x | (x<<16)) & 4278190335;\n  x  = (x | (x<<8))  & 251719695;\n  x  = (x | (x<<4))  & 3272356035;\n  x  = (x | (x<<2))  & 1227133513;\n\n  y &= 0x3FF;\n  y  = (y | (y<<16)) & 4278190335;\n  y  = (y | (y<<8))  & 251719695;\n  y  = (y | (y<<4))  & 3272356035;\n  y  = (y | (y<<2))  & 1227133513;\n  x |= (y << 1);\n  \n  z &= 0x3FF;\n  z  = (z | (z<<16)) & 4278190335;\n  z  = (z | (z<<8))  & 251719695;\n  z  = (z | (z<<4))  & 3272356035;\n  z  = (z | (z<<2))  & 1227133513;\n  \n  return x | (z << 2);\n}\n\n//Extracts nth interleaved component of a 3-tuple\nexports.deinterleave3 = function(v, n) {\n  v = (v >>> n)       & 1227133513;\n  v = (v | (v>>>2))   & 3272356035;\n  v = (v | (v>>>4))   & 251719695;\n  v = (v | (v>>>8))   & 4278190335;\n  v = (v | (v>>>16))  & 0x3FF;\n  return (v<<22)>>22;\n}\n\n//Computes next combination in colexicographic order (this is mistakenly called nextPermutation on the bit twiddling hacks page)\nexports.nextCombination = function(v) {\n  var t = v | (v - 1);\n  return (t + 1) | (((~t & -~t) - 1) >>> (countTrailingZeros(v) + 1));\n}\n\n","'use strict'\n\nmodule.exports = genPartition\n\nvar code = 'for(var j=2*a,k=j*c,l=k,m=c,n=b,o=a+b,p=c;d>p;++p,k+=j){var _;if($)if(m===p)m+=1,l+=j;else{for(var s=0;j>s;++s){var t=e[k+s];e[k+s]=e[l],e[l++]=t}var u=f[p];f[p]=f[m],f[m++]=u}}return m'\n\nfunction genPartition(predicate, args) {\n  var fargs ='abcdef'.split('').concat(args)\n  var reads = []\n  if(predicate.indexOf('lo') >= 0) {\n    reads.push('lo=e[k+n]')\n  }\n  if(predicate.indexOf('hi') >= 0) {\n    reads.push('hi=e[k+o]')\n  }\n  fargs.push(\n    code.replace('_', reads.join())\n        .replace('$', predicate))\n  return Function.apply(void 0, fargs)\n}","module.exports = clone;\n\n/**\n * Creates a new vec3 initialized with values from an existing vector\n *\n * @param {vec3} a vector to clone\n * @returns {vec3} a new 3D vector\n */\nfunction clone(a) {\n    var out = new Float32Array(3)\n    out[0] = a[0]\n    out[1] = a[1]\n    out[2] = a[2]\n    return out\n}","module.exports = angle\n\nvar fromValues = require('./fromValues')\nvar normalize = require('./normalize')\nvar dot = require('./dot')\n\n/**\n * Get the angle between two 3D vectors\n * @param {vec3} a The first operand\n * @param {vec3} b The second operand\n * @returns {Number} The angle in radians\n */\nfunction angle(a, b) {\n    var tempA = fromValues(a[0], a[1], a[2])\n    var tempB = fromValues(b[0], b[1], b[2])\n \n    normalize(tempA, tempA)\n    normalize(tempB, tempB)\n \n    var cosine = dot(tempA, tempB)\n\n    if(cosine > 1.0){\n        return 0\n    } else {\n        return Math.acos(cosine)\n    }     \n}\n","module.exports = copy;\n\n/**\n * Copy the values from one vec3 to another\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the source vector\n * @returns {vec3} out\n */\nfunction copy(out, a) {\n    out[0] = a[0]\n    out[1] = a[1]\n    out[2] = a[2]\n    return out\n}","module.exports = set;\n\n/**\n * Set the components of a vec3 to the given values\n *\n * @param {vec3} out the receiving vector\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} out\n */\nfunction set(out, x, y, z) {\n    out[0] = x\n    out[1] = y\n    out[2] = z\n    return out\n}","module.exports = equals\n\nvar EPSILON = require('./epsilon')\n\n/**\n * Returns whether or not the vectors have approximately the same elements in the same position.\n *\n * @param {vec3} a The first vector.\n * @param {vec3} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\nfunction equals(a, b) {\n  var a0 = a[0]\n  var a1 = a[1]\n  var a2 = a[2]\n  var b0 = b[0]\n  var b1 = b[1]\n  var b2 = b[2]\n  return (Math.abs(a0 - b0) <= EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) &&\n          Math.abs(a1 - b1) <= EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) &&\n          Math.abs(a2 - b2) <= EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)))\n}\n","module.exports = exactEquals\n\n/**\n * Returns whether or not the vectors exactly have the same elements in the same position (when compared with ===)\n *\n * @param {vec3} a The first vector.\n * @param {vec3} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\nfunction exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2]\n}\n","module.exports = add;\n\n/**\n * Adds two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nfunction add(out, a, b) {\n    out[0] = a[0] + b[0]\n    out[1] = a[1] + b[1]\n    out[2] = a[2] + b[2]\n    return out\n}","module.exports = require('./subtract')\n","module.exports = require('./multiply')\n","module.exports = require('./divide')\n","module.exports = min;\n\n/**\n * Returns the minimum of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nfunction min(out, a, b) {\n    out[0] = Math.min(a[0], b[0])\n    out[1] = Math.min(a[1], b[1])\n    out[2] = Math.min(a[2], b[2])\n    return out\n}","module.exports = max;\n\n/**\n * Returns the maximum of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nfunction max(out, a, b) {\n    out[0] = Math.max(a[0], b[0])\n    out[1] = Math.max(a[1], b[1])\n    out[2] = Math.max(a[2], b[2])\n    return out\n}","module.exports = floor\n\n/**\n * Math.floor the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a vector to floor\n * @returns {vec3} out\n */\nfunction floor(out, a) {\n  out[0] = Math.floor(a[0])\n  out[1] = Math.floor(a[1])\n  out[2] = Math.floor(a[2])\n  return out\n}\n","module.exports = ceil\n\n/**\n * Math.ceil the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a vector to ceil\n * @returns {vec3} out\n */\nfunction ceil(out, a) {\n  out[0] = Math.ceil(a[0])\n  out[1] = Math.ceil(a[1])\n  out[2] = Math.ceil(a[2])\n  return out\n}\n","module.exports = round\n\n/**\n * Math.round the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a vector to round\n * @returns {vec3} out\n */\nfunction round(out, a) {\n  out[0] = Math.round(a[0])\n  out[1] = Math.round(a[1])\n  out[2] = Math.round(a[2])\n  return out\n}\n","module.exports = scale;\n\n/**\n * Scales a vec3 by a scalar number\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {vec3} out\n */\nfunction scale(out, a, b) {\n    out[0] = a[0] * b\n    out[1] = a[1] * b\n    out[2] = a[2] * b\n    return out\n}","module.exports = scaleAndAdd;\n\n/**\n * Adds two vec3's after scaling the second operand by a scalar value\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @param {Number} scale the amount to scale b by before adding\n * @returns {vec3} out\n */\nfunction scaleAndAdd(out, a, b, scale) {\n    out[0] = a[0] + (b[0] * scale)\n    out[1] = a[1] + (b[1] * scale)\n    out[2] = a[2] + (b[2] * scale)\n    return out\n}","module.exports = require('./distance')\n","module.exports = require('./squaredDistance')\n","module.exports = require('./length')\n","module.exports = require('./squaredLength')\n","module.exports = negate;\n\n/**\n * Negates the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a vector to negate\n * @returns {vec3} out\n */\nfunction negate(out, a) {\n    out[0] = -a[0]\n    out[1] = -a[1]\n    out[2] = -a[2]\n    return out\n}","module.exports = inverse;\n\n/**\n * Returns the inverse of the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a vector to invert\n * @returns {vec3} out\n */\nfunction inverse(out, a) {\n  out[0] = 1.0 / a[0]\n  out[1] = 1.0 / a[1]\n  out[2] = 1.0 / a[2]\n  return out\n}","module.exports = cross;\n\n/**\n * Computes the cross product of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nfunction cross(out, a, b) {\n    var ax = a[0], ay = a[1], az = a[2],\n        bx = b[0], by = b[1], bz = b[2]\n\n    out[0] = ay * bz - az * by\n    out[1] = az * bx - ax * bz\n    out[2] = ax * by - ay * bx\n    return out\n}","module.exports = lerp;\n\n/**\n * Performs a linear interpolation between two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @param {Number} t interpolation amount between the two inputs\n * @returns {vec3} out\n */\nfunction lerp(out, a, b, t) {\n    var ax = a[0],\n        ay = a[1],\n        az = a[2]\n    out[0] = ax + t * (b[0] - ax)\n    out[1] = ay + t * (b[1] - ay)\n    out[2] = az + t * (b[2] - az)\n    return out\n}","module.exports = random;\n\n/**\n * Generates a random vector with the given scale\n *\n * @param {vec3} out the receiving vector\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\n * @returns {vec3} out\n */\nfunction random(out, scale) {\n    scale = scale || 1.0\n\n    var r = Math.random() * 2.0 * Math.PI\n    var z = (Math.random() * 2.0) - 1.0\n    var zScale = Math.sqrt(1.0-z*z) * scale\n\n    out[0] = Math.cos(r) * zScale\n    out[1] = Math.sin(r) * zScale\n    out[2] = z * scale\n    return out\n}","module.exports = transformMat4;\n\n/**\n * Transforms the vec3 with a mat4.\n * 4th vector component is implicitly '1'\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the vector to transform\n * @param {mat4} m matrix to transform with\n * @returns {vec3} out\n */\nfunction transformMat4(out, a, m) {\n    var x = a[0], y = a[1], z = a[2],\n        w = m[3] * x + m[7] * y + m[11] * z + m[15]\n    w = w || 1.0\n    out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w\n    out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w\n    out[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w\n    return out\n}","module.exports = transformMat3;\n\n/**\n * Transforms the vec3 with a mat3.\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the vector to transform\n * @param {mat4} m the 3x3 matrix to transform with\n * @returns {vec3} out\n */\nfunction transformMat3(out, a, m) {\n    var x = a[0], y = a[1], z = a[2]\n    out[0] = x * m[0] + y * m[3] + z * m[6]\n    out[1] = x * m[1] + y * m[4] + z * m[7]\n    out[2] = x * m[2] + y * m[5] + z * m[8]\n    return out\n}","module.exports = transformQuat;\n\n/**\n * Transforms the vec3 with a quat\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the vector to transform\n * @param {quat} q quaternion to transform with\n * @returns {vec3} out\n */\nfunction transformQuat(out, a, q) {\n    // benchmarks: http://jsperf.com/quaternion-transform-vec3-implementations\n\n    var x = a[0], y = a[1], z = a[2],\n        qx = q[0], qy = q[1], qz = q[2], qw = q[3],\n\n        // calculate quat * vec\n        ix = qw * x + qy * z - qz * y,\n        iy = qw * y + qz * x - qx * z,\n        iz = qw * z + qx * y - qy * x,\n        iw = -qx * x - qy * y - qz * z\n\n    // calculate result * inverse quat\n    out[0] = ix * qw + iw * -qx + iy * -qz - iz * -qy\n    out[1] = iy * qw + iw * -qy + iz * -qx - ix * -qz\n    out[2] = iz * qw + iw * -qz + ix * -qy - iy * -qx\n    return out\n}","module.exports = rotateX;\n\n/**\n * Rotate a 3D vector around the x-axis\n * @param {vec3} out The receiving vec3\n * @param {vec3} a The vec3 point to rotate\n * @param {vec3} b The origin of the rotation\n * @param {Number} c The angle of rotation\n * @returns {vec3} out\n */\nfunction rotateX(out, a, b, c){\n    var by = b[1]\n    var bz = b[2]\n\n    // Translate point to the origin\n    var py = a[1] - by\n    var pz = a[2] - bz\n\n    var sc = Math.sin(c)\n    var cc = Math.cos(c)\n\n    // perform rotation and translate to correct position\n    out[0] = a[0]\n    out[1] = by + py * cc - pz * sc\n    out[2] = bz + py * sc + pz * cc\n\n    return out\n}\n","module.exports = rotateY;\n\n/**\n * Rotate a 3D vector around the y-axis\n * @param {vec3} out The receiving vec3\n * @param {vec3} a The vec3 point to rotate\n * @param {vec3} b The origin of the rotation\n * @param {Number} c The angle of rotation\n * @returns {vec3} out\n */\nfunction rotateY(out, a, b, c){\n    var bx = b[0]\n    var bz = b[2]\n\n    // translate point to the origin\n    var px = a[0] - bx\n    var pz = a[2] - bz\n    \n    var sc = Math.sin(c)\n    var cc = Math.cos(c)\n  \n    // perform rotation and translate to correct position\n    out[0] = bx + pz * sc + px * cc\n    out[1] = a[1]\n    out[2] = bz + pz * cc - px * sc\n  \n    return out\n}\n","module.exports = rotateZ;\n\n/**\n * Rotate a 3D vector around the z-axis\n * @param {vec3} out The receiving vec3\n * @param {vec3} a The vec3 point to rotate\n * @param {vec3} b The origin of the rotation\n * @param {Number} c The angle of rotation\n * @returns {vec3} out\n */\nfunction rotateZ(out, a, b, c){\n    var bx = b[0]\n    var by = b[1]\n\n    //Translate point to the origin\n    var px = a[0] - bx\n    var py = a[1] - by\n  \n    var sc = Math.sin(c)\n    var cc = Math.cos(c)\n\n    // perform rotation and translate to correct position\n    out[0] = bx + px * cc - py * sc\n    out[1] = by + px * sc + py * cc\n    out[2] = a[2]\n  \n    return out\n}\n","module.exports = forEach;\n\nvar vec = require('./create')()\n\n/**\n * Perform some operation over an array of vec3s.\n *\n * @param {Array} a the array of vectors to iterate over\n * @param {Number} stride Number of elements between the start of each vec3. If 0 assumes tightly packed\n * @param {Number} offset Number of elements to skip at the beginning of the array\n * @param {Number} count Number of vec3s to iterate over. If 0 iterates over entire array\n * @param {Function} fn Function to call for each vector in the array\n * @param {Object} [arg] additional argument to pass to fn\n * @returns {Array} a\n * @function\n */\nfunction forEach(a, stride, offset, count, fn, arg) {\n        var i, l\n        if(!stride) {\n            stride = 3\n        }\n\n        if(!offset) {\n            offset = 0\n        }\n        \n        if(count) {\n            l = Math.min((count * stride) + offset, a.length)\n        } else {\n            l = a.length\n        }\n\n        for(i = offset; i < l; i += stride) {\n            vec[0] = a[i] \n            vec[1] = a[i+1] \n            vec[2] = a[i+2]\n            fn(vec, vec, arg)\n            a[i] = vec[0] \n            a[i+1] = vec[1] \n            a[i+2] = vec[2]\n        }\n        \n        return a\n}","/*!\n * Determine if an object is a Buffer\n *\n * @author   Feross Aboukhadijeh <https://feross.org>\n * @license  MIT\n */\n\n// The _isBuffer check is for Safari 5-7 support, because it's missing\n// Object.prototype.constructor. Remove this eventually\nmodule.exports = function (obj) {\n  return obj != null && (isBuffer(obj) || isSlowBuffer(obj) || !!obj._isBuffer)\n}\n\nfunction isBuffer (obj) {\n  return !!obj.constructor && typeof obj.constructor.isBuffer === 'function' && obj.constructor.isBuffer(obj)\n}\n\n// For Node v0.10 support. Remove this eventually.\nfunction isSlowBuffer (obj) {\n  return typeof obj.readFloatLE === 'function' && typeof obj.slice === 'function' && isBuffer(obj.slice(0, 0))\n}\n","\"use strict\"\n\nfunction traceRay_impl( getVoxel,\n\tpx, py, pz,\n\tdx, dy, dz,\n\tmax_d, hit_pos, hit_norm) {\n\t\n\t// consider raycast vector to be parametrized by t\n\t//   vec = [px,py,pz] + t * [dx,dy,dz]\n\t\n\t// algo below is as described by this paper:\n\t// http://www.cse.chalmers.se/edu/year/2010/course/TDA361/grid.pdf\n\t\n\tvar t = 0.0\n\t\t, floor = Math.floor\n\t\t, ix = floor(px) | 0\n\t\t, iy = floor(py) | 0\n\t\t, iz = floor(pz) | 0\n\n\t\t, stepx = (dx > 0) ? 1 : -1\n\t\t, stepy = (dy > 0) ? 1 : -1\n\t\t, stepz = (dz > 0) ? 1 : -1\n\t\t\n\t// dx,dy,dz are already normalized\n\t\t, txDelta = Math.abs(1 / dx)\n\t\t, tyDelta = Math.abs(1 / dy)\n\t\t, tzDelta = Math.abs(1 / dz)\n\n\t\t, xdist = (stepx > 0) ? (ix + 1 - px) : (px - ix)\n\t\t, ydist = (stepy > 0) ? (iy + 1 - py) : (py - iy)\n\t\t, zdist = (stepz > 0) ? (iz + 1 - pz) : (pz - iz)\n\t\t\n\t// location of nearest voxel boundary, in units of t \n\t\t, txMax = (txDelta < Infinity) ? txDelta * xdist : Infinity\n\t\t, tyMax = (tyDelta < Infinity) ? tyDelta * ydist : Infinity\n\t\t, tzMax = (tzDelta < Infinity) ? tzDelta * zdist : Infinity\n\n\t\t, steppedIndex = -1\n\t\n\t// main loop along raycast vector\n\twhile (t <= max_d) {\n\t\t\n\t\t// exit check\n\t\tvar b = getVoxel(ix, iy, iz)\n\t\tif (b) {\n\t\t\tif (hit_pos) {\n\t\t\t\thit_pos[0] = px + t * dx\n\t\t\t\thit_pos[1] = py + t * dy\n\t\t\t\thit_pos[2] = pz + t * dz\n\t\t\t}\n\t\t\tif (hit_norm) {\n\t\t\t\thit_norm[0] = hit_norm[1] = hit_norm[2] = 0\n\t\t\t\tif (steppedIndex === 0) hit_norm[0] = -stepx\n\t\t\t\tif (steppedIndex === 1) hit_norm[1] = -stepy\n\t\t\t\tif (steppedIndex === 2) hit_norm[2] = -stepz\n\t\t\t}\n\t\t\treturn b\n\t\t}\n\t\t\n\t\t// advance t to next nearest voxel boundary\n\t\tif (txMax < tyMax) {\n\t\t\tif (txMax < tzMax) {\n\t\t\t\tix += stepx\n\t\t\t\tt = txMax\n\t\t\t\ttxMax += txDelta\n\t\t\t\tsteppedIndex = 0\n\t\t\t} else {\n\t\t\t\tiz += stepz\n\t\t\t\tt = tzMax\n\t\t\t\ttzMax += tzDelta\n\t\t\t\tsteppedIndex = 2\n\t\t\t}\n\t\t} else {\n\t\t\tif (tyMax < tzMax) {\n\t\t\t\tiy += stepy\n\t\t\t\tt = tyMax\n\t\t\t\ttyMax += tyDelta\n\t\t\t\tsteppedIndex = 1\n\t\t\t} else {\n\t\t\t\tiz += stepz\n\t\t\t\tt = tzMax\n\t\t\t\ttzMax += tzDelta\n\t\t\t\tsteppedIndex = 2\n\t\t\t}\n\t\t}\n\n\t}\n\t\n\t// no voxel hit found\n\tif (hit_pos) {\n\t\thit_pos[0] = px + t * dx\n\t\thit_pos[1] = py + t * dy\n\t\thit_pos[2] = pz + t * dz\n\t}\n\tif (hit_norm) {\n\t\thit_norm[0] = hit_norm[1] = hit_norm[2] = 0\n\t}\n\n\treturn 0\n\n}\n\n\n// conform inputs\n\nfunction traceRay(getVoxel, origin, direction, max_d, hit_pos, hit_norm) {\n\tvar px = +origin[0]\n\t\t, py = +origin[1]\n\t\t, pz = +origin[2]\n\t\t, dx = +direction[0]\n\t\t, dy = +direction[1]\n\t\t, dz = +direction[2]\n\t\t, ds = Math.sqrt(dx * dx + dy * dy + dz * dz)\n\n\tif (ds === 0) {\n\t\tthrow new Error(\"Can't raycast along a zero vector\")\n\t}\n\n\tdx /= ds\n\tdy /= ds\n\tdz /= ds\n\tif (typeof (max_d) === \"undefined\") {\n\t\tmax_d = 64.0\n\t} else {\n\t\tmax_d = +max_d\n\t}\n\treturn traceRay_impl(getVoxel, px, py, pz, dx, dy, dz, max_d, hit_pos, hit_norm)\n}\n\nmodule.exports = traceRay","\"use strict\"\n\nvar EventEmitter = require(\"events\").EventEmitter\n  , util         = require(\"util\")\n  , domready     = require(\"domready\")\n  , vkey         = require(\"vkey\")\n  , invert       = require(\"invert-hash\")\n  , uniq         = require(\"uniq\")\n  , bsearch      = require(\"binary-search-bounds\")\n  , iota         = require(\"iota-array\")\n  , min          = Math.min\n\n//Browser compatibility hacks\nrequire(\"./lib/raf-polyfill.js\")\nvar addMouseWheel = require(\"./lib/mousewheel-polyfill.js\")\nvar hrtime = require(\"./lib/hrtime-polyfill.js\")\n\n//Remove angle braces and other useless crap\nvar filtered_vkey = (function() {\n  var result = new Array(256)\n    , i, j, k\n  for(i=0; i<256; ++i) {\n    result[i] = \"UNK\"\n  }\n  for(i in vkey) {\n    k = vkey[i]\n    if(k.charAt(0) === '<' && k.charAt(k.length-1) === '>') {\n      k = k.substring(1, k.length-1)\n    }\n    k = k.replace(/\\s/g, \"-\")\n    result[parseInt(i)] = k\n  }\n  return result\n})()\n\n//Compute minimal common set of keyboard functions\nvar keyNames = uniq(Object.keys(invert(filtered_vkey)))\n\n//Translates a virtual keycode to a normalized keycode\nfunction virtualKeyCode(key) {\n  return bsearch.eq(keyNames, key)\n}\n\n//Maps a physical keycode to a normalized keycode\nfunction physicalKeyCode(key) {\n  return virtualKeyCode(filtered_vkey[key])\n}\n\n//Game shell\nfunction GameShell() {\n  EventEmitter.call(this)\n  this._curKeyState  = new Array(keyNames.length)\n  this._pressCount   = new Array(keyNames.length)\n  this._releaseCount = new Array(keyNames.length)\n  \n  this._tickInterval = null\n  this._rafHandle = null\n  this._tickRate = 0\n  this._lastTick = hrtime()\n  this._frameTime = 0.0\n  this._paused = true\n  this._width = 0\n  this._height = 0\n  \n  this._wantFullscreen = false\n  this._wantPointerLock = false\n  this._fullscreenActive = false\n  this._pointerLockActive = false\n  \n  this._rafFunction = tickOrRender.bind(undefined, this, true)\n\n  this.preventDefaults = true\n  this.stopPropagation = false\n  \n  for(var i=0; i<keyNames.length; ++i) {\n    this._curKeyState[i] = false\n    this._pressCount[i] = this._releaseCount[i] = 0\n  }\n  \n  //Public members\n  this.element = null\n  this.bindings = {}\n  this.frameSkip = 100.0\n  this.tickCount = 0\n  this.frameCount = 0\n  this.startTime = hrtime()\n  this.tickTime = this._tickRate\n  this.frameTime = 10.0\n  this.stickyFullscreen = false\n  this.stickyPointerLock = false\n  \n  //Scroll stuff\n  this.scroll = [0,0,0]\n    \n  //Mouse state\n  this.mouseX = 0\n  this.mouseY = 0\n  this.prevMouseX = 0\n  this.prevMouseY = 0\n}\n\nutil.inherits(GameShell, EventEmitter)\n\nvar proto = GameShell.prototype\n\n//Bind keynames\nproto.keyNames = keyNames\n\n//Binds a virtual keyboard event to a physical key\nproto.bind = function(virtual_key) {\n  //Look up previous key bindings\n  var arr\n  if(virtual_key in this.bindings) {\n    arr = this.bindings[virtual_key]\n  } else {\n    arr = []\n  }\n  //Add keys to list\n  var physical_key\n  for(var i=1, n=arguments.length; i<n; ++i) {\n    physical_key = arguments[i]\n    if(virtualKeyCode(physical_key) >= 0) {\n      arr.push(physical_key)\n    } else if(physical_key in this.bindings) {\n      var keybinds = this.bindings[physical_key]\n      for(var j=0; j<keybinds.length; ++j) {\n        arr.push(keybinds[j])\n      }\n    }\n  }\n  //Remove any duplicate keys\n  arr = uniq(arr)\n  if(arr.length > 0) {\n    this.bindings[virtual_key] = arr\n  }\n  this.emit('bind', virtual_key, arr)\n}\n\n//Unbinds a virtual keyboard event\nproto.unbind = function(virtual_key) {\n  if(virtual_key in this.bindings) {\n    delete this.bindings[virtual_key]\n  }\n  this.emit('unbind', virtual_key)\n}\n\n//Checks if a key is set in a given state\nfunction lookupKey(state, bindings, key) {\n  if(key in bindings) {\n    var arr = bindings[key]\n    for(var i=0, n=arr.length; i<n; ++i) {\n      if(state[virtualKeyCode(arr[i])]) {\n        return true\n      }\n    }\n    return false\n  }\n  var kc = virtualKeyCode(key)\n  if(kc >= 0) {\n    return state[kc]\n  }\n  return false\n}\n\n//Checks if a key is set in a given state\nfunction lookupCount(state, bindings, key) {\n  if(key in bindings) {\n    var arr = bindings[key], r = 0\n    for(var i=0, n=arr.length; i<n; ++i) {\n      r += state[virtualKeyCode(arr[i])]\n    }\n    return r\n  }\n  var kc = virtualKeyCode(key)\n  if(kc >= 0) {\n    return state[kc]\n  }\n  return 0\n}\n\n//Checks if a key (either physical or virtual) is currently held down\nproto.down = function(key) {\n  return lookupKey(this._curKeyState, this.bindings, key)\n}\n\n//Checks if a key was ever down\nproto.wasDown = function(key) {\n  return this.down(key) || !!this.press(key)\n}\n\n//Opposite of down\nproto.up = function(key) {\n  return !this.down(key)\n}\n\n//Checks if a key was released during previous frame\nproto.wasUp = function(key) {\n  return this.up(key) || !!this.release(key)\n}\n\n//Returns the number of times a key was pressed since last tick\nproto.press = function(key) {\n  return lookupCount(this._pressCount, this.bindings, key)\n}\n\n//Returns the number of times a key was released since last tick\nproto.release = function(key) {\n  return lookupCount(this._releaseCount, this.bindings, key)\n}\n\n//Pause/unpause the game loop\nObject.defineProperty(proto, \"paused\", {\n  get: function() {\n    return this._paused\n  },\n  set: function(state) {\n    var ns = !!state\n    if(ns !== this._paused) {\n      if(!this._paused) {\n        this._paused = true\n        this._frameTime = min(1.0, (hrtime() - this._lastTick) / this._tickRate)\n        clearInterval(this._tickInterval)\n        //cancelAnimationFrame(this._rafHandle)\n      } else {\n        this._paused = false\n        this._lastTick = hrtime() - Math.floor(this._frameTime * this._tickRate)\n        this._tickInterval = setInterval(tickOrRender, this._tickRate, this, false)\n        this._rafHandle = requestAnimationFrame(this._rafFunction)\n      }\n    }\n  }\n})\n\n//Fullscreen state toggle\n\nfunction tryFullscreen(shell) {\n  //Request full screen\n  var elem = shell.element\n  \n  if(shell._wantFullscreen && !shell._fullscreenActive) {\n    var fs = elem.requestFullscreen ||\n             elem.requestFullScreen ||\n             elem.webkitRequestFullscreen ||\n             elem.webkitRequestFullScreen ||\n             elem.mozRequestFullscreen ||\n             elem.mozRequestFullScreen ||\n             function() {}\n    fs.call(elem)\n  }\n  if(shell._wantPointerLock && !shell._pointerLockActive) {\n    var pl =  elem.requestPointerLock ||\n              elem.webkitRequestPointerLock ||\n              elem.mozRequestPointerLock ||\n              elem.msRequestPointerLock ||\n              elem.oRequestPointerLock ||\n              function() {}\n    pl.call(elem)\n  }\n}\n\nvar cancelFullscreen = document.exitFullscreen ||\n                       document.cancelFullscreen ||  //Why can no one agree on this?\n                       document.cancelFullScreen ||\n                       document.webkitCancelFullscreen ||\n                       document.webkitCancelFullScreen ||\n                       document.mozCancelFullscreen ||\n                       document.mozCancelFullScreen ||\n                       function(){}\n\nObject.defineProperty(proto, \"fullscreen\", {\n  get: function() {\n    return this._fullscreenActive\n  },\n  set: function(state) {\n    var ns = !!state\n    if(!ns) {\n      this._wantFullscreen = false\n      var hasFS = document.fullscreen ||\n                  document.mozFullScreen ||\n                  document.webkitIsFullScreen ||\n                  false\n      if (hasFS) cancelFullscreen.call(document)\n    } else {\n      this._wantFullscreen = true\n      tryFullscreen(this)\n    }\n    return this._fullscreenActive\n  }\n})\n\nfunction handleFullscreen(shell) {\n  shell._fullscreenActive = document.fullscreen ||\n                            document.mozFullScreen ||\n                            document.webkitIsFullScreen ||\n                            false\n  if(!shell.stickyFullscreen && shell._fullscreenActive) {\n    shell._wantFullscreen = false\n  }\n}\n\n//Pointer lock state toggle\nvar exitPointerLock = document.exitPointerLock ||\n                      document.webkitExitPointerLock ||\n                      document.mozExitPointerLock ||\n                      function() {}\n\nObject.defineProperty(proto, \"pointerLock\", {\n  get: function() {\n    return this._pointerLockActive\n  },\n  set: function(state) {\n    var ns = !!state\n    if(!ns) {\n      this._wantPointerLock = false\n      exitPointerLock.call(document)\n    } else {\n      this._wantPointerLock = true\n      tryFullscreen(this)\n    }\n    return this._pointerLockActive\n  }\n})\n\nfunction handlePointerLockChange(shell, event) {\n  shell._pointerLockActive = shell.element === (\n      document.pointerLockElement ||\n      document.mozPointerLockElement ||\n      document.webkitPointerLockElement ||\n      null)\n  if(!shell.stickyPointerLock && shell._pointerLockActive) {\n    shell._wantPointerLock = false\n  }\n}\n\n//Width and height\nObject.defineProperty(proto, \"width\", {\n  get: function() {\n    return this.element.clientWidth\n  }\n})\nObject.defineProperty(proto, \"height\", {\n  get: function() {\n    return this.element.clientHeight\n  }\n})\n\n//Set key state\nfunction setKeyState(shell, key, state) {\n  var ps = shell._curKeyState[key]\n  if(ps !== state) {\n    if(state) {\n      shell._pressCount[key]++\n    } else {\n      shell._releaseCount[key]++\n    }\n    shell._curKeyState[key] = state\n  }\n}\n\nfunction tickOrRender(shell, doRender) {\n  tick(shell)\n  if (doRender) {\n    render(shell)\n  }\n}\n\n//Ticks the game state one update\nfunction tick(shell) {\n  var skip = hrtime() + shell.frameSkip\n    , pCount = shell._pressCount\n    , rCount = shell._releaseCount\n    , i, s, t\n    , tr = shell._tickRate\n    , n = keyNames.length\n  while(!shell._paused &&\n        hrtime() >= shell._lastTick + tr) {\n    \n    //Skip frames if we are over budget\n    if(hrtime() > skip) {\n      shell._lastTick = hrtime() + tr\n      return\n    }\n    \n    //Tick the game\n    s = hrtime()\n    shell.emit(\"tick\")\n    t = hrtime()\n    shell.tickTime = t - s\n    \n    //Update counters and time\n    ++shell.tickCount\n    shell._lastTick += tr\n    \n    //Shift input state\n    for(i=0; i<n; ++i) {\n      pCount[i] = rCount[i] = 0\n    }\n    if(shell._pointerLockActive) {\n      shell.prevMouseX = shell.mouseX = shell.width>>1\n      shell.prevMouseY = shell.mouseY = shell.height>>1\n    } else {\n      shell.prevMouseX = shell.mouseX\n      shell.prevMouseY = shell.mouseY\n    }\n    shell.scroll[0] = shell.scroll[1] = shell.scroll[2] = 0\n  }\n}\n\n//Render stuff\nfunction render(shell) {\n\n  //Request next frame\n  shell._rafHandle = requestAnimationFrame(shell._rafFunction)\n\n  //Compute frame time\n  var dt\n  if(shell._paused) {\n    dt = shell._frameTime\n  } else {\n    dt = min(1.0, (hrtime() - shell._lastTick) / shell._tickRate)\n  }\n  \n  //Draw a frame\n  ++shell.frameCount\n  var s = hrtime()\n  shell.emit(\"render\", dt)\n  var t = hrtime()\n  shell.frameTime = t - s\n  \n}\n\nfunction isFocused(shell) {\n  return (document.activeElement === document.body) ||\n         (document.activeElement === shell.element)\n}\n\nfunction handleEvent(shell, ev) {\n  if(shell.preventDefaults) {\n    ev.preventDefault()\n  }\n  if(shell.stopPropagation) {\n    ev.stopPropagation()\n  }\n}\n\n//Set key up\nfunction handleKeyUp(shell, ev) {\n  handleEvent(shell, ev)\n  var kc = physicalKeyCode(ev.keyCode || ev.char || ev.which || ev.charCode)\n  if(kc >= 0) {\n    setKeyState(shell, kc, false)\n  }\n}\n\n//Set key down\nfunction handleKeyDown(shell, ev) {\n  if(!isFocused(shell)) {\n    return\n  }\n  handleEvent(shell, ev)\n  if(ev.metaKey) {\n    //Hack: Clear key state when meta gets pressed to prevent keys sticking\n    handleBlur(shell, ev)\n  } else {\n    var kc = physicalKeyCode(ev.keyCode || ev.char || ev.which || ev.charCode)\n    if(kc >= 0) {\n      setKeyState(shell, kc, true)\n    }\n  }\n}\n\n//Mouse events are really annoying\nvar mouseCodes = iota(32).map(function(n) {\n  return virtualKeyCode(\"mouse-\" + (n+1))\n})\n\nfunction setMouseButtons(shell, buttons) {\n  for(var i=0; i<32; ++i) {\n    setKeyState(shell, mouseCodes[i], !!(buttons & (1<<i)))\n  }\n}\n\nfunction handleMouseMove(shell, ev) {\n  handleEvent(shell, ev)\n  if(shell._pointerLockActive) {\n    var movementX = ev.movementX       ||\n                    ev.mozMovementX    ||\n                    ev.webkitMovementX ||\n                    0,\n        movementY = ev.movementY       ||\n                    ev.mozMovementY    ||\n                    ev.webkitMovementY ||\n                    0\n    shell.mouseX += movementX\n    shell.mouseY += movementY\n  } else {\n    shell.mouseX = ev.clientX - shell.element.offsetLeft\n    shell.mouseY = ev.clientY - shell.element.offsetTop\n  }\n  return false\n}\n\nfunction handleMouseDown(shell, ev) {\n  handleEvent(shell, ev)\n  setKeyState(shell, mouseCodes[ev.button], true)\n  return false\n}\n\nfunction handleMouseUp(shell, ev) {\n  handleEvent(shell, ev)\n  setKeyState(shell, mouseCodes[ev.button], false)\n  return false\n}\n\nfunction handleMouseEnter(shell, ev) {\n  handleEvent(shell, ev)\n  if(shell._pointerLockActive) {\n    shell.prevMouseX = shell.mouseX = shell.width>>1\n    shell.prevMouseY = shell.mouseY = shell.height>>1\n  } else {\n    shell.prevMouseX = shell.mouseX = ev.clientX - shell.element.offsetLeft\n    shell.prevMouseY = shell.mouseY = ev.clientY - shell.element.offsetTop\n  }\n  return false\n}\n\nfunction handleMouseLeave(shell, ev) {\n  handleEvent(shell, ev)\n  setMouseButtons(shell, 0)\n  return false\n}\n\n//Handle mouse wheel events\nfunction handleMouseWheel(shell, ev) {\n  handleEvent(shell, ev)\n  var scale = 1\n  switch(ev.deltaMode) {\n    case 0: //Pixel\n      scale = 1\n    break\n    case 1: //Line\n      scale = 12\n    break\n    case 2: //Page\n       scale = shell.height\n    break\n  }\n  //Add scroll\n  shell.scroll[0] +=  ev.deltaX * scale\n  shell.scroll[1] +=  ev.deltaY * scale\n  shell.scroll[2] += (ev.deltaZ * scale)||0.0\n  return false\n}\n\nfunction handleContexMenu(shell, ev) {\n  handleEvent(shell, ev)\n  return false\n}\n\nfunction handleBlur(shell, ev) {\n  var n = keyNames.length\n    , c = shell._curKeyState\n    , r = shell._releaseCount\n    , i\n  for(i=0; i<n; ++i) {\n    if(c[i]) {\n      ++r[i]\n    }\n    c[i] = false\n  }\n  return false\n}\n\nfunction handleResizeElement(shell, ev) {\n  var w = shell.element.clientWidth|0\n  var h = shell.element.clientHeight|0\n  if((w !== shell._width) || (h !== shell._height)) {\n    shell._width = w\n    shell._height = h\n    shell.emit(\"resize\", w, h)\n  }\n}\n\nfunction makeDefaultContainer() {\n  var container = document.createElement(\"div\")\n  container.tabindex = 1\n  container.style.position = \"absolute\"\n  container.style.left = \"0px\"\n  container.style.right = \"0px\"\n  container.style.top = \"0px\"\n  container.style.bottom = \"0px\"\n  container.style.height = \"100%\"\n  container.style.overflow = \"hidden\"\n  document.body.appendChild(container)\n  document.body.style.overflow = \"hidden\" //Prevent bounce\n  document.body.style.height = \"100%\"\n  return container\n}\n\nfunction createShell(options) {\n  options = options || {}\n  \n  //Check fullscreen and pointer lock flags\n  var useFullscreen = !!options.fullscreen\n  var usePointerLock = useFullscreen\n  if(typeof options.pointerLock !== undefined) {\n    usePointerLock = !!options.pointerLock\n  }\n  \n  //Create initial shell\n  var shell = new GameShell()\n  shell._tickRate = options.tickRate || 30\n  shell.frameSkip = options.frameSkip || (shell._tickRate+5) * 5\n  shell.stickyFullscreen = !!options.stickyFullscreen || !!options.sticky\n  shell.stickyPointerLock = !!options.stickyPointerLock || !!options.sticky\n  \n  //Set bindings\n  if(options.bindings) {\n    shell.bindings = options.bindings\n  }\n  \n  //Wait for dom to intiailize\n  setTimeout(function() { domready(function initGameShell() {\n    \n    //Retrieve element\n    var element = options.element\n    if(typeof element === \"string\") {\n      var e = document.querySelector(element)\n      if(!e) {\n        e = document.getElementById(element)\n      }\n      if(!e) {\n        e = document.getElementByClass(element)[0]\n      }\n      if(!e) {\n        e = makeDefaultContainer()\n      }\n      shell.element = e\n    } else if(typeof element === \"object\" && !!element) {\n      shell.element = element\n    } else if(typeof element === \"function\") {\n      shell.element = element()\n    } else {\n      shell.element = makeDefaultContainer()\n    }\n    \n    //Disable user-select\n    if(shell.element.style) {\n      shell.element.style[\"-webkit-touch-callout\"] = \"none\"\n      shell.element.style[\"-webkit-user-select\"] = \"none\"\n      shell.element.style[\"-khtml-user-select\"] = \"none\"\n      shell.element.style[\"-moz-user-select\"] = \"none\"\n      shell.element.style[\"-ms-user-select\"] = \"none\"\n      shell.element.style[\"user-select\"] = \"none\"\n    }\n    \n    //Hook resize handler\n    shell._width = shell.element.clientWidth\n    shell._height = shell.element.clientHeight\n    var handleResize = handleResizeElement.bind(undefined, shell)\n    if(typeof MutationObserver !== \"undefined\") {\n      var observer = new MutationObserver(handleResize)\n      observer.observe(shell.element, {\n        attributes: true,\n        subtree: true\n      })\n    } else {\n      shell.element.addEventListener(\"DOMSubtreeModified\", handleResize, false)\n    }\n    window.addEventListener(\"resize\", handleResize, false)\n    \n    //Hook keyboard listener\n    window.addEventListener(\"keydown\", handleKeyDown.bind(undefined, shell), false)\n    window.addEventListener(\"keyup\", handleKeyUp.bind(undefined, shell), false)\n    \n    //Disable right click\n    shell.element.oncontextmenu = handleContexMenu.bind(undefined, shell)\n    \n    //Hook mouse listeners\n    shell.element.addEventListener(\"mousedown\", handleMouseDown.bind(undefined, shell), false)\n    shell.element.addEventListener(\"mouseup\", handleMouseUp.bind(undefined, shell), false)\n    shell.element.addEventListener(\"mousemove\", handleMouseMove.bind(undefined, shell), false)\n    shell.element.addEventListener(\"mouseenter\", handleMouseEnter.bind(undefined, shell), false)\n    \n    //Mouse leave\n    var leave = handleMouseLeave.bind(undefined, shell)\n    shell.element.addEventListener(\"mouseleave\", leave, false)\n    shell.element.addEventListener(\"mouseout\", leave, false)\n    window.addEventListener(\"mouseleave\", leave, false)\n    window.addEventListener(\"mouseout\", leave, false)\n    \n    //Blur event \n    var blur = handleBlur.bind(undefined, shell)\n    shell.element.addEventListener(\"blur\", blur, false)\n    shell.element.addEventListener(\"focusout\", blur, false)\n    shell.element.addEventListener(\"focus\", blur, false)\n    window.addEventListener(\"blur\", blur, false)\n    window.addEventListener(\"focusout\", blur, false)\n    window.addEventListener(\"focus\", blur, false)\n\n    //Mouse wheel handler\n    addMouseWheel(shell.element, handleMouseWheel.bind(undefined, shell), false)\n\n    //Fullscreen handler\n    var fullscreenChange = handleFullscreen.bind(undefined, shell)\n    document.addEventListener(\"fullscreenchange\", fullscreenChange, false)\n    document.addEventListener(\"mozfullscreenchange\", fullscreenChange, false)\n    document.addEventListener(\"webkitfullscreenchange\", fullscreenChange, false)\n\n    //Stupid fullscreen hack\n    shell.element.addEventListener(\"click\", tryFullscreen.bind(undefined, shell), false)\n\n    //Pointer lock change handler\n    var pointerLockChange = handlePointerLockChange.bind(undefined, shell)\n    document.addEventListener(\"pointerlockchange\", pointerLockChange, false)\n    document.addEventListener(\"mozpointerlockchange\", pointerLockChange, false)\n    document.addEventListener(\"webkitpointerlockchange\", pointerLockChange, false)\n    document.addEventListener(\"pointerlocklost\", pointerLockChange, false)\n    document.addEventListener(\"webkitpointerlocklost\", pointerLockChange, false)\n    document.addEventListener(\"mozpointerlocklost\", pointerLockChange, false)\n    \n    //Update flags\n    shell.fullscreen = useFullscreen\n    shell.pointerLock = usePointerLock\n  \n    //Default mouse button aliases\n    shell.bind(\"mouse-left\",   \"mouse-1\")\n    shell.bind(\"mouse-right\",  \"mouse-3\")\n    shell.bind(\"mouse-middle\", \"mouse-2\")\n    \n    //Initialize tick counter\n    shell._lastTick = hrtime()\n    shell.startTime = hrtime()\n\n    //Unpause shell\n    shell.paused = false\n    \n    //Emit initialize event\n    shell.emit(\"init\")\n  })}, 0)\n  \n  return shell\n}\n\nmodule.exports = createShell\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nvar getOwnPropertyDescriptors = Object.getOwnPropertyDescriptors ||\n  function getOwnPropertyDescriptors(obj) {\n    var keys = Object.keys(obj);\n    var descriptors = {};\n    for (var i = 0; i < keys.length; i++) {\n      descriptors[keys[i]] = Object.getOwnPropertyDescriptor(obj, keys[i]);\n    }\n    return descriptors;\n  };\n\nvar formatRegExp = /%[sdj%]/g;\nexports.format = function(f) {\n  if (!isString(f)) {\n    var objects = [];\n    for (var i = 0; i < arguments.length; i++) {\n      objects.push(inspect(arguments[i]));\n    }\n    return objects.join(' ');\n  }\n\n  var i = 1;\n  var args = arguments;\n  var len = args.length;\n  var str = String(f).replace(formatRegExp, function(x) {\n    if (x === '%%') return '%';\n    if (i >= len) return x;\n    switch (x) {\n      case '%s': return String(args[i++]);\n      case '%d': return Number(args[i++]);\n      case '%j':\n        try {\n          return JSON.stringify(args[i++]);\n        } catch (_) {\n          return '[Circular]';\n        }\n      default:\n        return x;\n    }\n  });\n  for (var x = args[i]; i < len; x = args[++i]) {\n    if (isNull(x) || !isObject(x)) {\n      str += ' ' + x;\n    } else {\n      str += ' ' + inspect(x);\n    }\n  }\n  return str;\n};\n\n\n// Mark that a method should not be used.\n// Returns a modified function which warns once by default.\n// If --no-deprecation is set, then it is a no-op.\nexports.deprecate = function(fn, msg) {\n  if (typeof process !== 'undefined' && process.noDeprecation === true) {\n    return fn;\n  }\n\n  // Allow for deprecating things in the process of starting up.\n  if (typeof process === 'undefined') {\n    return function() {\n      return exports.deprecate(fn, msg).apply(this, arguments);\n    };\n  }\n\n  var warned = false;\n  function deprecated() {\n    if (!warned) {\n      if (process.throwDeprecation) {\n        throw new Error(msg);\n      } else if (process.traceDeprecation) {\n        console.trace(msg);\n      } else {\n        console.error(msg);\n      }\n      warned = true;\n    }\n    return fn.apply(this, arguments);\n  }\n\n  return deprecated;\n};\n\n\nvar debugs = {};\nvar debugEnviron;\nexports.debuglog = function(set) {\n  if (isUndefined(debugEnviron))\n    debugEnviron = process.env.NODE_DEBUG || '';\n  set = set.toUpperCase();\n  if (!debugs[set]) {\n    if (new RegExp('\\\\b' + set + '\\\\b', 'i').test(debugEnviron)) {\n      var pid = process.pid;\n      debugs[set] = function() {\n        var msg = exports.format.apply(exports, arguments);\n        console.error('%s %d: %s', set, pid, msg);\n      };\n    } else {\n      debugs[set] = function() {};\n    }\n  }\n  return debugs[set];\n};\n\n\n/**\n * Echos the value of a value. Trys to print the value out\n * in the best way possible given the different types.\n *\n * @param {Object} obj The object to print out.\n * @param {Object} opts Optional options object that alters the output.\n */\n/* legacy: obj, showHidden, depth, colors*/\nfunction inspect(obj, opts) {\n  // default options\n  var ctx = {\n    seen: [],\n    stylize: stylizeNoColor\n  };\n  // legacy...\n  if (arguments.length >= 3) ctx.depth = arguments[2];\n  if (arguments.length >= 4) ctx.colors = arguments[3];\n  if (isBoolean(opts)) {\n    // legacy...\n    ctx.showHidden = opts;\n  } else if (opts) {\n    // got an \"options\" object\n    exports._extend(ctx, opts);\n  }\n  // set default options\n  if (isUndefined(ctx.showHidden)) ctx.showHidden = false;\n  if (isUndefined(ctx.depth)) ctx.depth = 2;\n  if (isUndefined(ctx.colors)) ctx.colors = false;\n  if (isUndefined(ctx.customInspect)) ctx.customInspect = true;\n  if (ctx.colors) ctx.stylize = stylizeWithColor;\n  return formatValue(ctx, obj, ctx.depth);\n}\nexports.inspect = inspect;\n\n\n// http://en.wikipedia.org/wiki/ANSI_escape_code#graphics\ninspect.colors = {\n  'bold' : [1, 22],\n  'italic' : [3, 23],\n  'underline' : [4, 24],\n  'inverse' : [7, 27],\n  'white' : [37, 39],\n  'grey' : [90, 39],\n  'black' : [30, 39],\n  'blue' : [34, 39],\n  'cyan' : [36, 39],\n  'green' : [32, 39],\n  'magenta' : [35, 39],\n  'red' : [31, 39],\n  'yellow' : [33, 39]\n};\n\n// Don't use 'blue' not visible on cmd.exe\ninspect.styles = {\n  'special': 'cyan',\n  'number': 'yellow',\n  'boolean': 'yellow',\n  'undefined': 'grey',\n  'null': 'bold',\n  'string': 'green',\n  'date': 'magenta',\n  // \"name\": intentionally not styling\n  'regexp': 'red'\n};\n\n\nfunction stylizeWithColor(str, styleType) {\n  var style = inspect.styles[styleType];\n\n  if (style) {\n    return '\\u001b[' + inspect.colors[style][0] + 'm' + str +\n           '\\u001b[' + inspect.colors[style][1] + 'm';\n  } else {\n    return str;\n  }\n}\n\n\nfunction stylizeNoColor(str, styleType) {\n  return str;\n}\n\n\nfunction arrayToHash(array) {\n  var hash = {};\n\n  array.forEach(function(val, idx) {\n    hash[val] = true;\n  });\n\n  return hash;\n}\n\n\nfunction formatValue(ctx, value, recurseTimes) {\n  // Provide a hook for user-specified inspect functions.\n  // Check that value is an object with an inspect function on it\n  if (ctx.customInspect &&\n      value &&\n      isFunction(value.inspect) &&\n      // Filter out the util module, it's inspect function is special\n      value.inspect !== exports.inspect &&\n      // Also filter out any prototype objects using the circular check.\n      !(value.constructor && value.constructor.prototype === value)) {\n    var ret = value.inspect(recurseTimes, ctx);\n    if (!isString(ret)) {\n      ret = formatValue(ctx, ret, recurseTimes);\n    }\n    return ret;\n  }\n\n  // Primitive types cannot have properties\n  var primitive = formatPrimitive(ctx, value);\n  if (primitive) {\n    return primitive;\n  }\n\n  // Look up the keys of the object.\n  var keys = Object.keys(value);\n  var visibleKeys = arrayToHash(keys);\n\n  if (ctx.showHidden) {\n    keys = Object.getOwnPropertyNames(value);\n  }\n\n  // IE doesn't make error fields non-enumerable\n  // http://msdn.microsoft.com/en-us/library/ie/dww52sbt(v=vs.94).aspx\n  if (isError(value)\n      && (keys.indexOf('message') >= 0 || keys.indexOf('description') >= 0)) {\n    return formatError(value);\n  }\n\n  // Some type of object without properties can be shortcutted.\n  if (keys.length === 0) {\n    if (isFunction(value)) {\n      var name = value.name ? ': ' + value.name : '';\n      return ctx.stylize('[Function' + name + ']', 'special');\n    }\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    }\n    if (isDate(value)) {\n      return ctx.stylize(Date.prototype.toString.call(value), 'date');\n    }\n    if (isError(value)) {\n      return formatError(value);\n    }\n  }\n\n  var base = '', array = false, braces = ['{', '}'];\n\n  // Make Array say that they are Array\n  if (isArray(value)) {\n    array = true;\n    braces = ['[', ']'];\n  }\n\n  // Make functions say that they are functions\n  if (isFunction(value)) {\n    var n = value.name ? ': ' + value.name : '';\n    base = ' [Function' + n + ']';\n  }\n\n  // Make RegExps say that they are RegExps\n  if (isRegExp(value)) {\n    base = ' ' + RegExp.prototype.toString.call(value);\n  }\n\n  // Make dates with properties first say the date\n  if (isDate(value)) {\n    base = ' ' + Date.prototype.toUTCString.call(value);\n  }\n\n  // Make error with message first say the error\n  if (isError(value)) {\n    base = ' ' + formatError(value);\n  }\n\n  if (keys.length === 0 && (!array || value.length == 0)) {\n    return braces[0] + base + braces[1];\n  }\n\n  if (recurseTimes < 0) {\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    } else {\n      return ctx.stylize('[Object]', 'special');\n    }\n  }\n\n  ctx.seen.push(value);\n\n  var output;\n  if (array) {\n    output = formatArray(ctx, value, recurseTimes, visibleKeys, keys);\n  } else {\n    output = keys.map(function(key) {\n      return formatProperty(ctx, value, recurseTimes, visibleKeys, key, array);\n    });\n  }\n\n  ctx.seen.pop();\n\n  return reduceToSingleString(output, base, braces);\n}\n\n\nfunction formatPrimitive(ctx, value) {\n  if (isUndefined(value))\n    return ctx.stylize('undefined', 'undefined');\n  if (isString(value)) {\n    var simple = '\\'' + JSON.stringify(value).replace(/^\"|\"$/g, '')\n                                             .replace(/'/g, \"\\\\'\")\n                                             .replace(/\\\\\"/g, '\"') + '\\'';\n    return ctx.stylize(simple, 'string');\n  }\n  if (isNumber(value))\n    return ctx.stylize('' + value, 'number');\n  if (isBoolean(value))\n    return ctx.stylize('' + value, 'boolean');\n  // For some reason typeof null is \"object\", so special case here.\n  if (isNull(value))\n    return ctx.stylize('null', 'null');\n}\n\n\nfunction formatError(value) {\n  return '[' + Error.prototype.toString.call(value) + ']';\n}\n\n\nfunction formatArray(ctx, value, recurseTimes, visibleKeys, keys) {\n  var output = [];\n  for (var i = 0, l = value.length; i < l; ++i) {\n    if (hasOwnProperty(value, String(i))) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          String(i), true));\n    } else {\n      output.push('');\n    }\n  }\n  keys.forEach(function(key) {\n    if (!key.match(/^\\d+$/)) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          key, true));\n    }\n  });\n  return output;\n}\n\n\nfunction formatProperty(ctx, value, recurseTimes, visibleKeys, key, array) {\n  var name, str, desc;\n  desc = Object.getOwnPropertyDescriptor(value, key) || { value: value[key] };\n  if (desc.get) {\n    if (desc.set) {\n      str = ctx.stylize('[Getter/Setter]', 'special');\n    } else {\n      str = ctx.stylize('[Getter]', 'special');\n    }\n  } else {\n    if (desc.set) {\n      str = ctx.stylize('[Setter]', 'special');\n    }\n  }\n  if (!hasOwnProperty(visibleKeys, key)) {\n    name = '[' + key + ']';\n  }\n  if (!str) {\n    if (ctx.seen.indexOf(desc.value) < 0) {\n      if (isNull(recurseTimes)) {\n        str = formatValue(ctx, desc.value, null);\n      } else {\n        str = formatValue(ctx, desc.value, recurseTimes - 1);\n      }\n      if (str.indexOf('\\n') > -1) {\n        if (array) {\n          str = str.split('\\n').map(function(line) {\n            return '  ' + line;\n          }).join('\\n').substr(2);\n        } else {\n          str = '\\n' + str.split('\\n').map(function(line) {\n            return '   ' + line;\n          }).join('\\n');\n        }\n      }\n    } else {\n      str = ctx.stylize('[Circular]', 'special');\n    }\n  }\n  if (isUndefined(name)) {\n    if (array && key.match(/^\\d+$/)) {\n      return str;\n    }\n    name = JSON.stringify('' + key);\n    if (name.match(/^\"([a-zA-Z_][a-zA-Z_0-9]*)\"$/)) {\n      name = name.substr(1, name.length - 2);\n      name = ctx.stylize(name, 'name');\n    } else {\n      name = name.replace(/'/g, \"\\\\'\")\n                 .replace(/\\\\\"/g, '\"')\n                 .replace(/(^\"|\"$)/g, \"'\");\n      name = ctx.stylize(name, 'string');\n    }\n  }\n\n  return name + ': ' + str;\n}\n\n\nfunction reduceToSingleString(output, base, braces) {\n  var numLinesEst = 0;\n  var length = output.reduce(function(prev, cur) {\n    numLinesEst++;\n    if (cur.indexOf('\\n') >= 0) numLinesEst++;\n    return prev + cur.replace(/\\u001b\\[\\d\\d?m/g, '').length + 1;\n  }, 0);\n\n  if (length > 60) {\n    return braces[0] +\n           (base === '' ? '' : base + '\\n ') +\n           ' ' +\n           output.join(',\\n  ') +\n           ' ' +\n           braces[1];\n  }\n\n  return braces[0] + base + ' ' + output.join(', ') + ' ' + braces[1];\n}\n\n\n// NOTE: These type checking functions intentionally don't use `instanceof`\n// because it is fragile and can be easily faked with `Object.create()`.\nfunction isArray(ar) {\n  return Array.isArray(ar);\n}\nexports.isArray = isArray;\n\nfunction isBoolean(arg) {\n  return typeof arg === 'boolean';\n}\nexports.isBoolean = isBoolean;\n\nfunction isNull(arg) {\n  return arg === null;\n}\nexports.isNull = isNull;\n\nfunction isNullOrUndefined(arg) {\n  return arg == null;\n}\nexports.isNullOrUndefined = isNullOrUndefined;\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\nexports.isNumber = isNumber;\n\nfunction isString(arg) {\n  return typeof arg === 'string';\n}\nexports.isString = isString;\n\nfunction isSymbol(arg) {\n  return typeof arg === 'symbol';\n}\nexports.isSymbol = isSymbol;\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\nexports.isUndefined = isUndefined;\n\nfunction isRegExp(re) {\n  return isObject(re) && objectToString(re) === '[object RegExp]';\n}\nexports.isRegExp = isRegExp;\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\nexports.isObject = isObject;\n\nfunction isDate(d) {\n  return isObject(d) && objectToString(d) === '[object Date]';\n}\nexports.isDate = isDate;\n\nfunction isError(e) {\n  return isObject(e) &&\n      (objectToString(e) === '[object Error]' || e instanceof Error);\n}\nexports.isError = isError;\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\nexports.isFunction = isFunction;\n\nfunction isPrimitive(arg) {\n  return arg === null ||\n         typeof arg === 'boolean' ||\n         typeof arg === 'number' ||\n         typeof arg === 'string' ||\n         typeof arg === 'symbol' ||  // ES6 symbol\n         typeof arg === 'undefined';\n}\nexports.isPrimitive = isPrimitive;\n\nexports.isBuffer = require('./support/isBuffer');\n\nfunction objectToString(o) {\n  return Object.prototype.toString.call(o);\n}\n\n\nfunction pad(n) {\n  return n < 10 ? '0' + n.toString(10) : n.toString(10);\n}\n\n\nvar months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep',\n              'Oct', 'Nov', 'Dec'];\n\n// 26 Feb 16:19:34\nfunction timestamp() {\n  var d = new Date();\n  var time = [pad(d.getHours()),\n              pad(d.getMinutes()),\n              pad(d.getSeconds())].join(':');\n  return [d.getDate(), months[d.getMonth()], time].join(' ');\n}\n\n\n// log is just a thin wrapper to console.log that prepends a timestamp\nexports.log = function() {\n  console.log('%s - %s', timestamp(), exports.format.apply(exports, arguments));\n};\n\n\n/**\n * Inherit the prototype methods from one constructor into another.\n *\n * The Function.prototype.inherits from lang.js rewritten as a standalone\n * function (not on Function.prototype). NOTE: If this file is to be loaded\n * during bootstrapping this function needs to be rewritten using some native\n * functions as prototype setup using normal JavaScript does not work as\n * expected during bootstrapping (see mirror.js in r114903).\n *\n * @param {function} ctor Constructor function which needs to inherit the\n *     prototype.\n * @param {function} superCtor Constructor function to inherit prototype from.\n */\nexports.inherits = require('inherits');\n\nexports._extend = function(origin, add) {\n  // Don't do anything if add isn't an object\n  if (!add || !isObject(add)) return origin;\n\n  var keys = Object.keys(add);\n  var i = keys.length;\n  while (i--) {\n    origin[keys[i]] = add[keys[i]];\n  }\n  return origin;\n};\n\nfunction hasOwnProperty(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\nvar kCustomPromisifiedSymbol = typeof Symbol !== 'undefined' ? Symbol('util.promisify.custom') : undefined;\n\nexports.promisify = function promisify(original) {\n  if (typeof original !== 'function')\n    throw new TypeError('The \"original\" argument must be of type Function');\n\n  if (kCustomPromisifiedSymbol && original[kCustomPromisifiedSymbol]) {\n    var fn = original[kCustomPromisifiedSymbol];\n    if (typeof fn !== 'function') {\n      throw new TypeError('The \"util.promisify.custom\" argument must be of type Function');\n    }\n    Object.defineProperty(fn, kCustomPromisifiedSymbol, {\n      value: fn, enumerable: false, writable: false, configurable: true\n    });\n    return fn;\n  }\n\n  function fn() {\n    var promiseResolve, promiseReject;\n    var promise = new Promise(function (resolve, reject) {\n      promiseResolve = resolve;\n      promiseReject = reject;\n    });\n\n    var args = [];\n    for (var i = 0; i < arguments.length; i++) {\n      args.push(arguments[i]);\n    }\n    args.push(function (err, value) {\n      if (err) {\n        promiseReject(err);\n      } else {\n        promiseResolve(value);\n      }\n    });\n\n    try {\n      original.apply(this, args);\n    } catch (err) {\n      promiseReject(err);\n    }\n\n    return promise;\n  }\n\n  Object.setPrototypeOf(fn, Object.getPrototypeOf(original));\n\n  if (kCustomPromisifiedSymbol) Object.defineProperty(fn, kCustomPromisifiedSymbol, {\n    value: fn, enumerable: false, writable: false, configurable: true\n  });\n  return Object.defineProperties(\n    fn,\n    getOwnPropertyDescriptors(original)\n  );\n}\n\nexports.promisify.custom = kCustomPromisifiedSymbol\n\nfunction callbackifyOnRejected(reason, cb) {\n  // `!reason` guard inspired by bluebird (Ref: https://goo.gl/t5IS6M).\n  // Because `null` is a special error value in callbacks which means \"no error\n  // occurred\", we error-wrap so the callback consumer can distinguish between\n  // \"the promise rejected with null\" or \"the promise fulfilled with undefined\".\n  if (!reason) {\n    var newReason = new Error('Promise was rejected with a falsy value');\n    newReason.reason = reason;\n    reason = newReason;\n  }\n  return cb(reason);\n}\n\nfunction callbackify(original) {\n  if (typeof original !== 'function') {\n    throw new TypeError('The \"original\" argument must be of type Function');\n  }\n\n  // We DO NOT return the promise as it gives the user a false sense that\n  // the promise is actually somehow related to the callback's execution\n  // and that the callback throwing will reject the promise.\n  function callbackified() {\n    var args = [];\n    for (var i = 0; i < arguments.length; i++) {\n      args.push(arguments[i]);\n    }\n\n    var maybeCb = args.pop();\n    if (typeof maybeCb !== 'function') {\n      throw new TypeError('The last argument must be of type Function');\n    }\n    var self = this;\n    var cb = function() {\n      return maybeCb.apply(self, arguments);\n    };\n    // In true node style we process the callback on `nextTick` with all the\n    // implications (stack, `uncaughtException`, `async_hooks`)\n    original.apply(this, args)\n      .then(function(ret) { process.nextTick(cb, null, ret) },\n            function(rej) { process.nextTick(callbackifyOnRejected, rej, cb) });\n  }\n\n  Object.setPrototypeOf(callbackified, Object.getPrototypeOf(original));\n  Object.defineProperties(callbackified,\n                          getOwnPropertyDescriptors(original));\n  return callbackified;\n}\nexports.callbackify = callbackify;\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","module.exports = function isBuffer(arg) {\n  return arg && typeof arg === 'object'\n    && typeof arg.copy === 'function'\n    && typeof arg.fill === 'function'\n    && typeof arg.readUInt8 === 'function';\n}","if (typeof Object.create === 'function') {\n  // implementation from standard node.js 'util' module\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    ctor.prototype = Object.create(superCtor.prototype, {\n      constructor: {\n        value: ctor,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n  };\n} else {\n  // old school shim for old browsers\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    var TempCtor = function () {}\n    TempCtor.prototype = superCtor.prototype\n    ctor.prototype = new TempCtor()\n    ctor.prototype.constructor = ctor\n  }\n}\n","/*!\n  * domready (c) Dustin Diaz 2014 - License MIT\n  */\n!function (name, definition) {\n\n  if (typeof module != 'undefined') module.exports = definition()\n  else if (typeof define == 'function' && typeof define.amd == 'object') define(definition)\n  else this[name] = definition()\n\n}('domready', function () {\n\n  var fns = [], listener\n    , doc = document\n    , hack = doc.documentElement.doScroll\n    , domContentLoaded = 'DOMContentLoaded'\n    , loaded = (hack ? /^loaded|^c/ : /^loaded|^i|^c/).test(doc.readyState)\n\n\n  if (!loaded)\n  doc.addEventListener(domContentLoaded, listener = function () {\n    doc.removeEventListener(domContentLoaded, listener)\n    loaded = 1\n    while (listener = fns.shift()) listener()\n  })\n\n  return function (fn) {\n    loaded ? setTimeout(fn, 0) : fns.push(fn)\n  }\n\n});\n","var ua = typeof window !== 'undefined' ? window.navigator.userAgent : ''\n  , isOSX = /OS X/.test(ua)\n  , isOpera = /Opera/.test(ua)\n  , maybeFirefox = !/like Gecko/.test(ua) && !isOpera\n\nvar i, output = module.exports = {\n  0:  isOSX ? '<menu>' : '<UNK>'\n, 1:  '<mouse 1>'\n, 2:  '<mouse 2>'\n, 3:  '<break>'\n, 4:  '<mouse 3>'\n, 5:  '<mouse 4>'\n, 6:  '<mouse 5>'\n, 8:  '<backspace>'\n, 9:  '<tab>'\n, 12: '<clear>'\n, 13: '<enter>'\n, 16: '<shift>'\n, 17: '<control>'\n, 18: '<alt>'\n, 19: '<pause>'\n, 20: '<caps-lock>'\n, 21: '<ime-hangul>'\n, 23: '<ime-junja>'\n, 24: '<ime-final>'\n, 25: '<ime-kanji>'\n, 27: '<escape>'\n, 28: '<ime-convert>'\n, 29: '<ime-nonconvert>'\n, 30: '<ime-accept>'\n, 31: '<ime-mode-change>'\n, 27: '<escape>'\n, 32: '<space>'\n, 33: '<page-up>'\n, 34: '<page-down>'\n, 35: '<end>'\n, 36: '<home>'\n, 37: '<left>'\n, 38: '<up>'\n, 39: '<right>'\n, 40: '<down>'\n, 41: '<select>'\n, 42: '<print>'\n, 43: '<execute>'\n, 44: '<snapshot>'\n, 45: '<insert>'\n, 46: '<delete>'\n, 47: '<help>'\n, 91: '<meta>'  // meta-left -- no one handles left and right properly, so we coerce into one.\n, 92: '<meta>'  // meta-right\n, 93: isOSX ? '<meta>' : '<menu>'      // chrome,opera,safari all report this for meta-right (osx mbp).\n, 95: '<sleep>'\n, 106: '<num-*>'\n, 107: '<num-+>'\n, 108: '<num-enter>'\n, 109: '<num-->'\n, 110: '<num-.>'\n, 111: '<num-/>'\n, 144: '<num-lock>'\n, 145: '<scroll-lock>'\n, 160: '<shift-left>'\n, 161: '<shift-right>'\n, 162: '<control-left>'\n, 163: '<control-right>'\n, 164: '<alt-left>'\n, 165: '<alt-right>'\n, 166: '<browser-back>'\n, 167: '<browser-forward>'\n, 168: '<browser-refresh>'\n, 169: '<browser-stop>'\n, 170: '<browser-search>'\n, 171: '<browser-favorites>'\n, 172: '<browser-home>'\n\n  // ff/osx reports '<volume-mute>' for '-'\n, 173: isOSX && maybeFirefox ? '-' : '<volume-mute>'\n, 174: '<volume-down>'\n, 175: '<volume-up>'\n, 176: '<next-track>'\n, 177: '<prev-track>'\n, 178: '<stop>'\n, 179: '<play-pause>'\n, 180: '<launch-mail>'\n, 181: '<launch-media-select>'\n, 182: '<launch-app 1>'\n, 183: '<launch-app 2>'\n, 186: ';'\n, 187: '='\n, 188: ','\n, 189: '-'\n, 190: '.'\n, 191: '/'\n, 192: '`'\n, 219: '['\n, 220: '\\\\'\n, 221: ']'\n, 222: \"'\"\n, 223: '<meta>'\n, 224: '<meta>'       // firefox reports meta here.\n, 226: '<alt-gr>'\n, 229: '<ime-process>'\n, 231: isOpera ? '`' : '<unicode>'\n, 246: '<attention>'\n, 247: '<crsel>'\n, 248: '<exsel>'\n, 249: '<erase-eof>'\n, 250: '<play>'\n, 251: '<zoom>'\n, 252: '<no-name>'\n, 253: '<pa-1>'\n, 254: '<clear>'\n}\n\nfor(i = 58; i < 65; ++i) {\n  output[i] = String.fromCharCode(i)\n}\n\n// 0-9\nfor(i = 48; i < 58; ++i) {\n  output[i] = (i - 48)+''\n}\n\n// A-Z\nfor(i = 65; i < 91; ++i) {\n  output[i] = String.fromCharCode(i)\n}\n\n// num0-9\nfor(i = 96; i < 106; ++i) {\n  output[i] = '<num-'+(i - 96)+'>'\n}\n\n// F1-F24\nfor(i = 112; i < 136; ++i) {\n  output[i] = 'F'+(i-111)\n}\n","\"use strict\"\n\nfunction invert(hash) {\n  var result = {}\n  for(var i in hash) {\n    if(hash.hasOwnProperty(i)) {\n      result[hash[i]] = i\n    }\n  }\n  return result\n}\n\nmodule.exports = invert","\"use strict\"\n\nfunction unique_pred(list, compare) {\n  var ptr = 1\n    , len = list.length\n    , a=list[0], b=list[0]\n  for(var i=1; i<len; ++i) {\n    b = a\n    a = list[i]\n    if(compare(a, b)) {\n      if(i === ptr) {\n        ptr++\n        continue\n      }\n      list[ptr++] = a\n    }\n  }\n  list.length = ptr\n  return list\n}\n\nfunction unique_eq(list) {\n  var ptr = 1\n    , len = list.length\n    , a=list[0], b = list[0]\n  for(var i=1; i<len; ++i, b=a) {\n    b = a\n    a = list[i]\n    if(a !== b) {\n      if(i === ptr) {\n        ptr++\n        continue\n      }\n      list[ptr++] = a\n    }\n  }\n  list.length = ptr\n  return list\n}\n\nfunction unique(list, compare, sorted) {\n  if(list.length === 0) {\n    return list\n  }\n  if(compare) {\n    if(!sorted) {\n      list.sort(compare)\n    }\n    return unique_pred(list, compare)\n  }\n  if(!sorted) {\n    list.sort()\n  }\n  return unique_eq(list)\n}\n\nmodule.exports = unique\n","\"use strict\"\n\nfunction compileSearch(funcName, predicate, reversed, extraArgs, useNdarray, earlyOut) {\n  var code = [\n    \"function \", funcName, \"(a,l,h,\", extraArgs.join(\",\"),  \"){\",\nearlyOut ? \"\" : \"var i=\", (reversed ? \"l-1\" : \"h+1\"),\n\";while(l<=h){\\\nvar m=(l+h)>>>1,x=a\", useNdarray ? \".get(m)\" : \"[m]\"]\n  if(earlyOut) {\n    if(predicate.indexOf(\"c\") < 0) {\n      code.push(\";if(x===y){return m}else if(x<=y){\")\n    } else {\n      code.push(\";var p=c(x,y);if(p===0){return m}else if(p<=0){\")\n    }\n  } else {\n    code.push(\";if(\", predicate, \"){i=m;\")\n  }\n  if(reversed) {\n    code.push(\"l=m+1}else{h=m-1}\")\n  } else {\n    code.push(\"h=m-1}else{l=m+1}\")\n  }\n  code.push(\"}\")\n  if(earlyOut) {\n    code.push(\"return -1};\")\n  } else {\n    code.push(\"return i};\")\n  }\n  return code.join(\"\")\n}\n\nfunction compileBoundsSearch(predicate, reversed, suffix, earlyOut) {\n  var result = new Function([\n  compileSearch(\"A\", \"x\" + predicate + \"y\", reversed, [\"y\"], false, earlyOut),\n  compileSearch(\"B\", \"x\" + predicate + \"y\", reversed, [\"y\"], true, earlyOut),\n  compileSearch(\"P\", \"c(x,y)\" + predicate + \"0\", reversed, [\"y\", \"c\"], false, earlyOut),\n  compileSearch(\"Q\", \"c(x,y)\" + predicate + \"0\", reversed, [\"y\", \"c\"], true, earlyOut),\n\"function dispatchBsearch\", suffix, \"(a,y,c,l,h){\\\nif(a.shape){\\\nif(typeof(c)==='function'){\\\nreturn Q(a,(l===undefined)?0:l|0,(h===undefined)?a.shape[0]-1:h|0,y,c)\\\n}else{\\\nreturn B(a,(c===undefined)?0:c|0,(l===undefined)?a.shape[0]-1:l|0,y)\\\n}}else{\\\nif(typeof(c)==='function'){\\\nreturn P(a,(l===undefined)?0:l|0,(h===undefined)?a.length-1:h|0,y,c)\\\n}else{\\\nreturn A(a,(c===undefined)?0:c|0,(l===undefined)?a.length-1:l|0,y)\\\n}}}\\\nreturn dispatchBsearch\", suffix].join(\"\"))\n  return result()\n}\n\nmodule.exports = {\n  ge: compileBoundsSearch(\">=\", false, \"GE\"),\n  gt: compileBoundsSearch(\">\", false, \"GT\"),\n  lt: compileBoundsSearch(\"<\", true, \"LT\"),\n  le: compileBoundsSearch(\"<=\", true, \"LE\"),\n  eq: compileBoundsSearch(\"-\", true, \"EQ\", true)\n}\n","// http://paulirish.com/2011/requestanimationframe-for-smart-animating/\n// http://my.opera.com/emoller/blog/2011/12/20/requestanimationframe-for-smart-er-animating\n \n// requestAnimationFrame polyfill by Erik Möller. fixes from Paul Irish and Tino Zijdel\n \n// MIT license\nvar lastTime = 0;\nvar vendors = ['ms', 'moz', 'webkit', 'o'];\nfor(var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {\n    window.requestAnimationFrame = window[vendors[x]+'RequestAnimationFrame'];\n    window.cancelAnimationFrame = window[vendors[x]+'CancelAnimationFrame'] \n                               || window[vendors[x]+'CancelRequestAnimationFrame'];\n}\n\nif (!window.requestAnimationFrame)\n    window.requestAnimationFrame = function(callback, element) {\n        var currTime = new Date().getTime();\n        var timeToCall = Math.max(0, 16 - (currTime - lastTime));\n        var id = window.setTimeout(function() { callback(currTime + timeToCall); }, \n          timeToCall);\n        lastTime = currTime + timeToCall;\n        return id;\n    };\n\nif (!window.cancelAnimationFrame)\n    window.cancelAnimationFrame = function(id) {\n        clearTimeout(id);\n    };\n","//Adapted from here: https://developer.mozilla.org/en-US/docs/Web/Reference/Events/wheel?redirectlocale=en-US&redirectslug=DOM%2FMozilla_event_reference%2Fwheel\n\nvar prefix = \"\", _addEventListener, onwheel, support;\n\n// detect event model\nif ( window.addEventListener ) {\n  _addEventListener = \"addEventListener\";\n} else {\n  _addEventListener = \"attachEvent\";\n  prefix = \"on\";\n}\n\n// detect available wheel event\nsupport = \"onwheel\" in document.createElement(\"div\") ? \"wheel\" : // Modern browsers support \"wheel\"\n          document.onmousewheel !== undefined ? \"mousewheel\" : // Webkit and IE support at least \"mousewheel\"\n          \"DOMMouseScroll\"; // let's assume that remaining browsers are older Firefox\n\nfunction _addWheelListener( elem, eventName, callback, useCapture ) {\n  elem[ _addEventListener ]( prefix + eventName, support == \"wheel\" ? callback : function( originalEvent ) {\n    !originalEvent && ( originalEvent = window.event );\n\n    // create a normalized event object\n    var event = {\n      // keep a ref to the original event object\n      originalEvent: originalEvent,\n      target: originalEvent.target || originalEvent.srcElement,\n      type: \"wheel\",\n      deltaMode: originalEvent.type == \"MozMousePixelScroll\" ? 0 : 1,\n      deltaX: 0,\n      delatZ: 0,\n      preventDefault: function() {\n        originalEvent.preventDefault ?\n          originalEvent.preventDefault() :\n          originalEvent.returnValue = false;\n      }\n    };\n    \n    // calculate deltaY (and deltaX) according to the event\n    if ( support == \"mousewheel\" ) {\n      event.deltaY = - 1/40 * originalEvent.wheelDelta;\n      // Webkit also support wheelDeltaX\n      originalEvent.wheelDeltaX && ( event.deltaX = - 1/40 * originalEvent.wheelDeltaX );\n    } else {\n      event.deltaY = originalEvent.detail;\n    }\n\n    // it's time to fire the callback\n    return callback( event );\n  }, useCapture || false );\n}\n\nmodule.exports = function( elem, callback, useCapture ) {\n  _addWheelListener( elem, support, callback, useCapture );\n\n  // handle MozMousePixelScroll in older Firefox\n  if( support == \"DOMMouseScroll\" ) {\n    _addWheelListener( elem, \"MozMousePixelScroll\", callback, useCapture );\n  }\n};","if(typeof window.performance === \"object\") {\n  if(window.performance.now) {\n    module.exports = function() { return window.performance.now() }\n  } else if(window.performance.webkitNow) {\n    module.exports = function() { return window.performance.webkitNow() }\n  }\n} else if(Date.now) {\n  module.exports = Date.now\n} else {\n  module.exports = function() { return (new Date()).getTime() }\n}\n","\nvar vkey = require('vkey')\nvar EventEmitter = require('events').EventEmitter\n// mousewheel polyfill borrowed directly from game-shell\nvar addMouseWheel = require(\"./lib/mousewheel-polyfill.js\")\n\nmodule.exports = function (domElement, options) {\n    return new Inputs(domElement, options)\n}\n\n\n/*\n *   Simple inputs manager to abstract key/mouse inputs.\n *        Inspired by (and where applicable stealing code from) \n *        game-shell: https://github.com/mikolalysenko/game-shell\n *  \n *  inputs.bind( 'move-right', 'D', '<right>' )\n *  inputs.bind( 'move-left',  'A' )\n *  inputs.unbind( 'move-left' )\n *  \n *  inputs.down.on( 'move-right',  function( binding, event ) {})\n *  inputs.up.on(   'move-right',  function( binding, event ) {})\n *\n *  inputs.state['move-right']  // true when corresponding keys are down\n *  inputs.state.dx             // mouse x movement since tick() was last called\n *  inputs.getBindings()        // [ 'move-right', 'move-left', ... ]\n*/\n\n\nfunction Inputs(element, opts) {\n\n    // settings\n    this.element = element || document\n    opts = opts || {}\n    this.preventDefaults = !!opts.preventDefaults\n    this.stopPropagation = !!opts.stopPropagation\n    this.allowContextMenu = !!opts.allowContextMenu\n    this.disabled = !!opts.disabled\n\n    // emitters\n    this.down = new EventEmitter()\n    this.up = new EventEmitter()\n\n    // state object to be queried\n    this.state = {\n        dx: 0, dy: 0,\n        scrollx: 0, scrolly: 0, scrollz: 0\n    }\n\n    // internal state\n    this._keybindmap = {}       // { 'vkeycode' : [ 'binding', 'binding2' ] }\n    this._keyStates = {}        // { 'vkeycode' : boolean }\n    this._bindPressCounts = {}  // { 'binding' : int }\n\n    // needed to work around a bug in Mac Chrome 75\n    // https://bugs.chromium.org/p/chromium/issues/detail?id=977093\n    this._ignoreMousemoveOnce = false\n\n    // register for dom events\n    this.initEvents()\n}\n\n\n/*\n *\n *   PUBLIC API \n *\n*/\n\nInputs.prototype.initEvents = function () {\n    // keys\n    window.addEventListener('keydown', onKeyEvent.bind(undefined, this, true), false)\n    window.addEventListener('keyup', onKeyEvent.bind(undefined, this, false), false)\n    // mouse buttons\n    this.element.addEventListener(\"mousedown\", onMouseEvent.bind(undefined, this, true), false)\n    this.element.addEventListener(\"mouseup\", onMouseEvent.bind(undefined, this, false), false)\n    this.element.oncontextmenu = onContextMenu.bind(undefined, this)\n    // treat dragstart like mouseup - idiotically, mouseup doesn't fire after a drag starts (!)\n    this.element.addEventListener(\"dragstart\", onMouseEvent.bind(undefined, this, false), false)\n    // touch/mouse movement\n    this.element.addEventListener(\"mousemove\", onMouseMove.bind(undefined, this), false)\n    this.element.addEventListener(\"touchmove\", onMouseMove.bind(undefined, this), false)\n    this.element.addEventListener(\"touchstart\", onTouchStart.bind(undefined, this), false)\n    // scroll/mousewheel\n    addMouseWheel(this.element, onMouseWheel.bind(undefined, this), false)\n    // temp bug workaround, see above\n    document.addEventListener(\"pointerlockchange\", onLockChange.bind(undefined, this), false)\n    document.addEventListener(\"mozpointerlockchange\", onLockChange.bind(undefined, this), false)\n}\n\n\n// Usage:  bind( bindingName, vkeyCode, vkeyCode.. )\n//    Note that inputs._keybindmap maps vkey codes to binding names\n//    e.g. this._keybindmap['a'] = 'move-left'\nInputs.prototype.bind = function (binding) {\n    for (var i = 1; i < arguments.length; ++i) {\n        var vkeyCode = arguments[i]\n        var arr = this._keybindmap[vkeyCode] || []\n        if (arr.indexOf(binding) == -1) {\n            arr.push(binding)\n        }\n        this._keybindmap[vkeyCode] = arr\n    }\n    this.state[binding] = !!this.state[binding]\n}\n\n// search out and remove all keycodes bound to a given binding\nInputs.prototype.unbind = function (binding) {\n    for (var b in this._keybindmap) {\n        var arr = this._keybindmap[b]\n        var i = arr.indexOf(binding)\n        if (i > -1) { arr.splice(i, 1) }\n    }\n}\n\n// tick function - clears out cumulative mouse movement state variables\nInputs.prototype.tick = function () {\n    this.state.dx = this.state.dy = 0\n    this.state.scrollx = this.state.scrolly = this.state.scrollz = 0\n}\n\n\n\nInputs.prototype.getBoundKeys = function () {\n    var arr = []\n    for (var b in this._keybindmap) { arr.push(b) }\n    return arr\n}\n\n\n\n/*\n *\n *\n *      INTERNALS - DOM EVENT HANDLERS\n *\n *\n*/\n\n\nfunction onKeyEvent(inputs, wasDown, ev) {\n    handleKeyEvent(ev.keyCode, vkey[ev.keyCode], wasDown, inputs, ev)\n}\n\nfunction onMouseEvent(inputs, wasDown, ev) {\n    // simulate a code out of range of vkey\n    var keycode = -1 - ev.button\n    var vkeycode = '<mouse ' + (ev.button + 1) + '>'\n    handleKeyEvent(keycode, vkeycode, wasDown, inputs, ev)\n    return false\n}\n\nfunction onContextMenu(inputs) {\n    if (!inputs.allowContextMenu) return false\n}\n\nfunction onMouseMove(inputs, ev) {\n    // bug workaround, see top of file\n    if (inputs._ignoreMousemoveOnce) {\n        inputs._ignoreMousemoveOnce = false\n        return\n    }\n    // for now, just populate the state object with mouse movement\n    var dx = ev.movementX || ev.mozMovementX || 0,\n        dy = ev.movementY || ev.mozMovementY || 0\n    // ad-hoc experimental touch support\n    if (ev.touches && (dx | dy) === 0) {\n        var xy = getTouchMovement(ev)\n        dx = xy[0]\n        dy = xy[1]\n    }\n    inputs.state.dx += dx\n    inputs.state.dy += dy\n}\n\n// experimental - for touch events, extract useful dx/dy\nvar lastTouchX = 0\nvar lastTouchY = 0\nvar lastTouchID = null\n\nfunction onTouchStart(inputs, ev) {\n    var touch = ev.changedTouches[0]\n    lastTouchX = touch.clientX\n    lastTouchY = touch.clientY\n    lastTouchID = touch.identifier\n}\n\nfunction getTouchMovement(ev) {\n    var touch\n    var touches = ev.changedTouches\n    for (var i = 0; i < touches.length; ++i) {\n        if (touches[i].identifier == lastTouchID) touch = touches[i]\n    }\n    if (!touch) return [0, 0]\n    var res = [touch.clientX - lastTouchX, touch.clientY - lastTouchY]\n    lastTouchX = touch.clientX\n    lastTouchY = touch.clientY\n    return res\n}\n\nfunction onMouseWheel(inputs, ev) {\n    // basically borrowed from game-shell\n    var scale = 1\n    switch (ev.deltaMode) {\n        case 0: scale = 1; break  // Pixel\n        case 1: scale = 12; break  // Line\n        case 2:  // page\n            // TODO: investigate when this happens, what correct handling is\n            scale = inputs.element.clientHeight || window.innerHeight\n            break\n    }\n    // accumulate state\n    inputs.state.scrollx += ev.deltaX * scale\n    inputs.state.scrolly += ev.deltaY * scale\n    inputs.state.scrollz += (ev.deltaZ * scale) || 0\n    return false\n}\n\nfunction onLockChange(inputs, ev) {\n    var locked = document.pointerLockElement\n        || document.mozPointerLockElement\n        || null\n    if (locked) inputs._ignoreMousemoveOnce = true\n}\n\n\n\n\n/*\n *\n *\n *   KEY BIND HANDLING\n *\n *\n*/\n\n\nfunction handleKeyEvent(keycode, vcode, wasDown, inputs, ev) {\n    var arr = inputs._keybindmap[vcode]\n    // don't prevent defaults if there's no binding\n    if (!arr) { return }\n    if (inputs.preventDefaults) ev.preventDefault()\n    if (inputs.stopPropagation) ev.stopPropagation()\n\n    // if the key's state has changed, handle an event for all bindings\n    var currstate = inputs._keyStates[keycode]\n    if (XOR(currstate, wasDown)) {\n        // for each binding: emit an event, and update cached state information\n        for (var i = 0; i < arr.length; ++i) {\n            handleBindingEvent(arr[i], wasDown, inputs, ev)\n        }\n    }\n    inputs._keyStates[keycode] = wasDown\n}\n\n\nfunction handleBindingEvent(binding, wasDown, inputs, ev) {\n    // keep count of presses mapped by binding\n    // (to handle two keys with the same binding pressed at once)\n    var ct = inputs._bindPressCounts[binding] || 0\n    ct += wasDown ? 1 : -1\n    if (ct < 0) { ct = 0 } // shouldn't happen\n    inputs._bindPressCounts[binding] = ct\n\n    // emit event if binding's state has changed\n    var currstate = inputs.state[binding]\n    if (XOR(currstate, ct)) {\n        var emitter = wasDown ? inputs.down : inputs.up\n        if (!inputs.disabled) emitter.emit(binding, ev)\n    }\n    inputs.state[binding] = !!ct\n}\n\n\n\n\n/*\n *\n *\n *    HELPERS\n *\n *\n*/\n\n\n// how is this not part of Javascript?\nfunction XOR(a, b) {\n    return a ? !b : b\n}\n\n\n\n\n","'use strict'\n\nvar ua = typeof window !== 'undefined' ? window.navigator.userAgent : ''\n  , isOSX = /OS X/.test(ua)\n  , isOpera = /Opera/.test(ua)\n  , maybeFirefox = !/like Gecko/.test(ua) && !isOpera\n\nvar i, output = module.exports = {\n  0:  isOSX ? '<menu>' : '<UNK>'\n, 1:  '<mouse 1>'\n, 2:  '<mouse 2>'\n, 3:  '<break>'\n, 4:  '<mouse 3>'\n, 5:  '<mouse 4>'\n, 6:  '<mouse 5>'\n, 8:  '<backspace>'\n, 9:  '<tab>'\n, 12: '<clear>'\n, 13: '<enter>'\n, 16: '<shift>'\n, 17: '<control>'\n, 18: '<alt>'\n, 19: '<pause>'\n, 20: '<caps-lock>'\n, 21: '<ime-hangul>'\n, 23: '<ime-junja>'\n, 24: '<ime-final>'\n, 25: '<ime-kanji>'\n, 27: '<escape>'\n, 28: '<ime-convert>'\n, 29: '<ime-nonconvert>'\n, 30: '<ime-accept>'\n, 31: '<ime-mode-change>'\n, 32: '<space>'\n, 33: '<page-up>'\n, 34: '<page-down>'\n, 35: '<end>'\n, 36: '<home>'\n, 37: '<left>'\n, 38: '<up>'\n, 39: '<right>'\n, 40: '<down>'\n, 41: '<select>'\n, 42: '<print>'\n, 43: '<execute>'\n, 44: '<snapshot>'\n, 45: '<insert>'\n, 46: '<delete>'\n, 47: '<help>'\n, 91: '<meta>'  // meta-left -- no one handles left and right properly, so we coerce into one.\n, 92: '<meta>'  // meta-right\n, 93: isOSX ? '<meta>' : '<menu>'      // chrome,opera,safari all report this for meta-right (osx mbp).\n, 95: '<sleep>'\n, 106: '<num-*>'\n, 107: '<num-+>'\n, 108: '<num-enter>'\n, 109: '<num-->'\n, 110: '<num-.>'\n, 111: '<num-/>'\n, 144: '<num-lock>'\n, 145: '<scroll-lock>'\n, 160: '<shift-left>'\n, 161: '<shift-right>'\n, 162: '<control-left>'\n, 163: '<control-right>'\n, 164: '<alt-left>'\n, 165: '<alt-right>'\n, 166: '<browser-back>'\n, 167: '<browser-forward>'\n, 168: '<browser-refresh>'\n, 169: '<browser-stop>'\n, 170: '<browser-search>'\n, 171: '<browser-favorites>'\n, 172: '<browser-home>'\n\n  // ff/osx reports '<volume-mute>' for '-'\n, 173: isOSX && maybeFirefox ? '-' : '<volume-mute>'\n, 174: '<volume-down>'\n, 175: '<volume-up>'\n, 176: '<next-track>'\n, 177: '<prev-track>'\n, 178: '<stop>'\n, 179: '<play-pause>'\n, 180: '<launch-mail>'\n, 181: '<launch-media-select>'\n, 182: '<launch-app 1>'\n, 183: '<launch-app 2>'\n, 186: ';'\n, 187: '='\n, 188: ','\n, 189: '-'\n, 190: '.'\n, 191: '/'\n, 192: '`'\n, 219: '['\n, 220: '\\\\'\n, 221: ']'\n, 222: \"'\"\n, 223: '<meta>'\n, 224: '<meta>'       // firefox reports meta here.\n, 226: '<alt-gr>'\n, 229: '<ime-process>'\n, 231: isOpera ? '`' : '<unicode>'\n, 246: '<attention>'\n, 247: '<crsel>'\n, 248: '<exsel>'\n, 249: '<erase-eof>'\n, 250: '<play>'\n, 251: '<zoom>'\n, 252: '<no-name>'\n, 253: '<pa-1>'\n, 254: '<clear>'\n}\n\nfor(i = 58; i < 65; ++i) {\n  output[i] = String.fromCharCode(i)\n}\n\n// 0-9\nfor(i = 48; i < 58; ++i) {\n  output[i] = (i - 48)+''\n}\n\n// A-Z\nfor(i = 65; i < 91; ++i) {\n  output[i] = String.fromCharCode(i)\n}\n\n// num0-9\nfor(i = 96; i < 106; ++i) {\n  output[i] = '<num-'+(i - 96)+'>'\n}\n\n// F1-F24\nfor(i = 112; i < 136; ++i) {\n  output[i] = 'F'+(i-111)\n}\n","//Adapted from here: https://developer.mozilla.org/en-US/docs/Web/Reference/Events/wheel?redirectlocale=en-US&redirectslug=DOM%2FMozilla_event_reference%2Fwheel\n\nvar prefix = \"\", _addEventListener, onwheel, support;\n\n// detect event model\nif ( window.addEventListener ) {\n  _addEventListener = \"addEventListener\";\n} else {\n  _addEventListener = \"attachEvent\";\n  prefix = \"on\";\n}\n\n// detect available wheel event\nsupport = \"onwheel\" in document.createElement(\"div\") ? \"wheel\" : // Modern browsers support \"wheel\"\n          document.onmousewheel !== undefined ? \"mousewheel\" : // Webkit and IE support at least \"mousewheel\"\n          \"DOMMouseScroll\"; // let's assume that remaining browsers are older Firefox\n\nfunction _addWheelListener( elem, eventName, callback, useCapture ) {\n  elem[ _addEventListener ]( prefix + eventName, support == \"wheel\" ? callback : function( originalEvent ) {\n    !originalEvent && ( originalEvent = window.event );\n\n    // create a normalized event object\n    var event = {\n      // keep a ref to the original event object\n      originalEvent: originalEvent,\n      target: originalEvent.target || originalEvent.srcElement,\n      type: \"wheel\",\n      deltaMode: originalEvent.type == \"MozMousePixelScroll\" ? 0 : 1,\n      deltaX: 0,\n      delatZ: 0,\n      preventDefault: function() {\n        originalEvent.preventDefault ?\n          originalEvent.preventDefault() :\n          originalEvent.returnValue = false;\n      }\n    };\n    \n    // calculate deltaY (and deltaX) according to the event\n    if ( support == \"mousewheel\" ) {\n      event.deltaY = - 1/40 * originalEvent.wheelDelta;\n      // Webkit also support wheelDeltaX\n      originalEvent.wheelDeltaX && ( event.deltaX = - 1/40 * originalEvent.wheelDeltaX );\n    } else {\n      event.deltaY = originalEvent.detail;\n    }\n\n    // it's time to fire the callback\n    return callback( event );\n  }, useCapture || false );\n}\n\nmodule.exports = function( elem, callback, useCapture ) {\n  _addWheelListener( elem, support, callback, useCapture );\n\n  // handle MozMousePixelScroll in older Firefox\n  if( support == \"DOMMouseScroll\" ) {\n    _addWheelListener( elem, \"MozMousePixelScroll\", callback, useCapture );\n  }\n};","'use strict'\n\nvar aabb = require('aabb-3d')\nvar vec3 = require('gl-vec3')\nvar sweep = require('voxel-aabb-sweep')\nvar RigidBody = require('./rigidBody')\n\n\nvar DEBUG = 0\n\n\nmodule.exports = function (opts, testSolid, testFluid) {\n    return new Physics(opts, testSolid, testFluid)\n}\n\nvar defaults = {\n    gravity: [0, -10, 0],\n    minBounceImpulse: .5, // lowest collision impulse that bounces\n    airDrag: 0.1,\n    fluidDrag: 0.4,\n    fluidDensity: 2.0,\n}\n\n\n/* \n *    CONSTRUCTOR - represents a world of rigid bodies.\n * \n *  Takes testSolid(x,y,z) function to query block solidity\n *  Takes testFluid(x,y,z) function to query if a block is a fluid\n*/\nfunction Physics(opts, testSolid, testFluid) {\n    opts = Object.assign({}, defaults, opts)\n\n    this.gravity = opts.gravity\n    this.airDrag = opts.airDrag\n    this.fluidDensity = opts.fluidDensity\n    this.fluidDrag = opts.fluidDrag\n    this.minBounceImpulse = opts.minBounceImpulse\n    this.bodies = []\n\n    // collision function - TODO: abstract this into a setter?\n    this.testSolid = testSolid\n    this.testFluid = testFluid\n}\n\n\n/*\n *    ADDING AND REMOVING RIGID BODIES\n*/\n\nPhysics.prototype.addBody = function (_aabb, mass, friction,\n    restitution, gravMult, onCollide) {\n    _aabb = _aabb || new aabb([0, 0, 0], [1, 1, 1])\n    if (typeof mass == 'undefined') mass = 1\n    if (typeof friction == 'undefined') friction = 1\n    if (typeof restitution == 'undefined') restitution = 0\n    if (typeof gravMult == 'undefined') gravMult = 1\n    var b = new RigidBody(_aabb, mass, friction, restitution, gravMult, onCollide)\n    this.bodies.push(b)\n    return b\n}\n\nPhysics.prototype.removeBody = function (b) {\n    var i = this.bodies.indexOf(b)\n    if (i < 0) return undefined\n    this.bodies.splice(i, 1)\n    b.aabb = b.onCollide = null\n}\n\n\n\n\n/*\n *    PHYSICS AND COLLISIONS\n*/\n\nvar a = vec3.create()\nvar dv = vec3.create()\nvar dx = vec3.create()\nvar impacts = vec3.create()\nvar oldResting = vec3.create()\n\n\n/*\n *    TICK HANDLER\n*/\nPhysics.prototype.tick = function (dt) {\n    // convert dt to seconds\n    dt = dt / 1000\n    var noGravity = equals(0, vec3.squaredLength(this.gravity))\n\n    this.bodies.forEach(b => iterateBody(this, b, dt, noGravity))\n}\n\n\n\n/*\n *    PER-BODY MAIN PHYSICS ROUTINE\n*/\n\nfunction iterateBody(self, b, dt, noGravity) {\n    vec3.copy(oldResting, b.resting)\n\n    // treat bodies with <= mass as static\n    if (b.mass <= 0) {\n        vec3.set(b.velocity, 0, 0, 0)\n        vec3.set(b._forces, 0, 0, 0)\n        vec3.set(b._impulses, 0, 0, 0)\n        return\n    }\n\n    // skip bodies if static or no velocity/forces/impulses\n    var localNoGrav = noGravity || (b.gravityMultiplier === 0)\n    if (bodyAsleep(self, b, dt, localNoGrav)) return\n    b._sleepFrameCount--\n\n    // check if under water, if so apply buoyancy and drag forces\n    applyFluidForces(self, b)\n\n    // debug hooks\n    sanityCheck(b._forces)\n    sanityCheck(b._impulses)\n    sanityCheck(b.velocity)\n    sanityCheck(b.resting)\n\n    // semi-implicit Euler integration\n\n    // a = f/m + gravity*gravityMultiplier\n    vec3.scale(a, b._forces, 1 / b.mass)\n    vec3.scaleAndAdd(a, a, self.gravity, b.gravityMultiplier)\n\n    // dv = i/m + a*dt\n    // v1 = v0 + dv\n    vec3.scale(dv, b._impulses, 1 / b.mass)\n    vec3.scaleAndAdd(dv, dv, a, dt)\n    vec3.add(b.velocity, b.velocity, dv)\n\n    // apply friction based on change in velocity this frame\n    if (b.friction) {\n        applyFrictionByAxis(0, b, dv)\n        applyFrictionByAxis(1, b, dv)\n        applyFrictionByAxis(2, b, dv)\n    }\n\n    // linear air or fluid friction - effectively v *= drag\n    // body settings override global settings\n    var drag = (b.airDrag >= 0) ? b.airDrag : self.airDrag\n    if (b.inFluid) {\n        drag = (b.fluidDrag >= 0) ? b.fluidDrag : self.fluidDrag\n        drag *= 1 - (1 - b.ratioInFluid) ** 2\n    }\n    var mult = Math.max(1 - drag * dt / b.mass, 0)\n    vec3.scale(b.velocity, b.velocity, mult)\n\n    // x1-x0 = v1*dt\n    vec3.scale(dx, b.velocity, dt)\n\n    // clear forces and impulses for next timestep\n    vec3.set(b._forces, 0, 0, 0)\n    vec3.set(b._impulses, 0, 0, 0)\n\n    // cache old position for use in autostepping\n    if (b.autoStep) {\n        cloneAABB(tmpBox, b.aabb)\n    }\n\n    // sweeps aabb along dx and accounts for collisions\n    processCollisions(self, b.aabb, dx, b.resting)\n\n    // if autostep, and on ground, run collisions again with stepped up aabb\n    if (b.autoStep) {\n        tryAutoStepping(self, b, tmpBox, dx)\n    }\n\n    // Collision impacts. b.resting shows which axes had collisions:\n    for (var i = 0; i < 3; ++i) {\n        impacts[i] = 0\n        if (b.resting[i]) {\n            // count impact only if wasn't collided last frame\n            if (!oldResting[i]) impacts[i] = -b.velocity[i]\n            b.velocity[i] = 0\n        }\n    }\n    var mag = vec3.length(impacts)\n    if (mag > .001) { // epsilon\n        // send collision event - allows client to optionally change\n        // body's restitution depending on what terrain it hit\n        // event argument is impulse J = m * dv\n        vec3.scale(impacts, impacts, b.mass)\n        if (b.onCollide) b.onCollide(impacts)\n\n        // bounce depending on restitution and minBounceImpulse\n        if (b.restitution > 0 && mag > self.minBounceImpulse) {\n            vec3.scale(impacts, impacts, b.restitution)\n            b.applyImpulse(impacts)\n        }\n    }\n\n\n    // sleep check\n    var vsq = vec3.squaredLength(b.velocity)\n    if (vsq > 1e-5) b._markActive()\n}\n\n\n\n\n\n\n\n\n/*\n *    FLUIDS\n*/\n\nfunction applyFluidForces(self, body) {\n    // First pass at handling fluids. Assumes fluids are settled\n    //   thus, only check at corner of body, and only from bottom up\n    var box = body.aabb\n    var cx = Math.floor(box.base[0])\n    var cz = Math.floor(box.base[2])\n    var y0 = Math.floor(box.base[1])\n    var y1 = Math.floor(box.max[1])\n\n    if (!self.testFluid(cx, y0, cz)) {\n        body.inFluid = false\n        body.ratioInFluid = 0\n        return\n    }\n\n    // body is in a fluid - find out how much of body is submerged\n    var submerged = 1\n    var cy = y0 + 1\n    while (cy <= y1 && self.testFluid(cx, cy, cz)) {\n        submerged++\n        cy++\n    }\n    var fluidLevel = y0 + submerged\n    var heightInFluid = fluidLevel - box.base[1]\n    var ratioInFluid = heightInFluid / box.vec[1]\n    if (ratioInFluid > 1) ratioInFluid = 1\n    var vol = box.vec[0] * box.vec[1] * box.vec[2]\n    var displaced = vol * ratioInFluid\n    // bouyant force = -gravity * fluidDensity * volumeDisplaced\n    var f = _fluidVec\n    vec3.scale(f, self.gravity, -self.fluidDensity * displaced)\n    body.applyForce(f)\n\n    body.inFluid = true\n    body.ratioInFluid = ratioInFluid\n}\n\nvar _fluidVec = vec3.create()\n\n\n\n\n\n/*\n *    FRICTION\n*/\n\n\nfunction applyFrictionByAxis(axis, body, dvel) {\n    // friction applies only if moving into a touched surface\n    var restDir = body.resting[axis]\n    var vNormal = dvel[axis]\n    if (restDir === 0) return\n    if (restDir * vNormal <= 0) return\n\n    // current vel lateral to friction axis\n    vec3.copy(lateralVel, body.velocity)\n    lateralVel[axis] = 0\n    var vCurr = vec3.length(lateralVel)\n    if (equals(vCurr, 0)) return\n\n    // treat current change in velocity as the result of a pseudoforce\n    //        Fpseudo = m*dv/dt\n    // Base friction force on normal component of the pseudoforce\n    //        Ff = u * Fnormal\n    //        Ff = u * m * dvnormal / dt\n    // change in velocity due to friction force\n    //        dvF = dt * Ff / m\n    //            = dt * (u * m * dvnormal / dt) / m\n    //            = u * dvnormal\n    var dvMax = Math.abs(body.friction * vNormal)\n\n    // decrease lateral vel by dvMax (or clamp to zero)\n    var scaler = (vCurr > dvMax) ? (vCurr - dvMax) / vCurr : 0\n    body.velocity[(axis + 1) % 3] *= scaler\n    body.velocity[(axis + 2) % 3] *= scaler\n}\nvar lateralVel = vec3.create()\n\n\n\n\n\n\n/*\n *    COLLISION HANDLER\n*/\n\n// sweep aabb along velocity vector and set resting vector\nfunction processCollisions(self, box, velocity, resting) {\n    vec3.set(resting, 0, 0, 0)\n    return sweep(self.testSolid, box, velocity, function (dist, axis, dir, vec) {\n        resting[axis] = dir\n        vec[axis] = 0\n    })\n}\n\n\n\n\n\n/*\n *    AUTO-STEPPING\n*/\n\nvar tmpBox = new aabb([], [])\nvar tmpResting = vec3.create()\nvar targetPos = vec3.create()\nvar upvec = vec3.create()\nvar leftover = vec3.create()\n\nfunction tryAutoStepping(self, b, oldBox, dx) {\n    if (b.resting[1] >= 0 && !b.inFluid) return\n\n    // // direction movement was blocked before trying a step\n    var xBlocked = (b.resting[0] !== 0)\n    var zBlocked = (b.resting[2] !== 0)\n    if (!(xBlocked || zBlocked)) return\n\n    // continue autostepping only if headed sufficiently into obstruction\n    var ratio = Math.abs(dx[0] / dx[2])\n    var cutoff = 4\n    if (!xBlocked && ratio > cutoff) return\n    if (!zBlocked && ratio < 1 / cutoff) return\n\n    // original target position before being obstructed\n    vec3.add(targetPos, oldBox.base, dx)\n\n    // move towards the target until the first X/Z collision\n    var getVoxels = self.testSolid\n    sweep(getVoxels, oldBox, dx, function (dist, axis, dir, vec) {\n        if (axis === 1) vec[axis] = 0\n        else return true\n    })\n\n    var y = b.aabb.base[1]\n    var ydist = Math.floor(y + 1.001) - y\n    vec3.set(upvec, 0, ydist, 0)\n    var collided = false\n    // sweep up, bailing on any obstruction\n    sweep(getVoxels, oldBox, upvec, function (dist, axis, dir, vec) {\n        collided = true\n        return true\n    })\n    if (collided) return // could't move upwards\n\n    // now move in X/Z however far was left over before hitting the obstruction\n    vec3.subtract(leftover, targetPos, oldBox.base)\n    leftover[1] = 0\n    processCollisions(self, oldBox, leftover, tmpResting)\n\n    // bail if no movement happened in the originally blocked direction\n    if (xBlocked && !equals(oldBox.base[0], targetPos[0])) return\n    if (zBlocked && !equals(oldBox.base[2], targetPos[2])) return\n\n    // done - oldBox is now at the target autostepped position\n    cloneAABB(b.aabb, oldBox)\n    b.resting[0] = tmpResting[0]\n    b.resting[2] = tmpResting[2]\n    if (b.onStep) b.onStep()\n}\n\n\n\n\n\n/*\n *    SLEEP CHECK\n*/\n\nfunction bodyAsleep(self, body, dt, noGravity) {\n    if (body._sleepFrameCount > 0) return false\n    // without gravity bodies stay asleep until a force/impulse wakes them up\n    if (noGravity) return true\n    // otherwise check body is resting against something\n    // i.e. sweep along by distance d = 1/2 g*t^2\n    // and check there's still a collision\n    var isResting = false\n    var gmult = 0.5 * dt * dt * body.gravityMultiplier\n    vec3.scale(sleepVec, self.gravity, gmult)\n    sweep(self.testSolid, body.aabb, sleepVec, function () {\n        isResting = true\n        return true\n    }, true)\n    return isResting\n}\nvar sleepVec = vec3.create()\n\n\n\n\n\nfunction equals(a, b) { return Math.abs(a - b) < 1e-5 }\n\nfunction cloneAABB(tgt, src) {\n    for (var i = 0; i < 3; i++) {\n        tgt.base[i] = src.base[i]\n        tgt.max[i] = src.max[i]\n        tgt.vec[i] = src.vec[i]\n    }\n}\n\n\n\nvar sanityCheck = function () { }\nif (DEBUG) sanityCheck = function (v) {\n    if (isNaN(vec3.length(v))) throw 'Vector with NAN: ', v\n}\n","'use strict'\n\nvar aabb = require('aabb-3d')\nvar vec3 = require('gl-vec3')\n\n\nvar DEBUG = 0\n\n\nmodule.exports = RigidBody\n\n\n\n/*\n *    RIGID BODY - internal data structure\n *  Only AABB bodies right now. Someday will likely need spheres?\n*/\n\nfunction RigidBody(_aabb, mass, friction, restitution, gravMult, onCollide, autoStep) {\n    this.aabb = new aabb(_aabb.base, _aabb.vec) // clone\n    this.mass = mass\n    this.friction = friction\n    this.restitution = restitution\n    this.gravityMultiplier = gravMult\n    this.onCollide = onCollide\n    this.autoStep = !!autoStep\n    this.airDrag = -1   // overrides global airDrag when >= 0\n    this.fluidDrag = -1 // overrides global fluidDrag when >= 0\n    this.onStep = null\n    \n    // internals\n    this.velocity = vec3.create()\n    this.resting = [0, 0, 0]\n    this.inFluid = false\n    this._ratioInFluid = 0\n    this._forces = vec3.create()\n    this._impulses = vec3.create()\n    this._sleepFrameCount = 10 | 0\n}\n\nRigidBody.prototype.setPosition = function (p) {\n    sanityCheck(p)\n    vec3.subtract(p, p, this.aabb.base)\n    this.aabb.translate(p)\n    this._markActive()\n}\nRigidBody.prototype.getPosition = function () {\n    return vec3.clone(this.aabb.base)\n}\nRigidBody.prototype.applyForce = function (f) {\n    sanityCheck(f)\n    vec3.add(this._forces, this._forces, f)\n    this._markActive()\n}\nRigidBody.prototype.applyImpulse = function (i) {\n    sanityCheck(i)\n    vec3.add(this._impulses, this._impulses, i)\n    this._markActive()\n}\nRigidBody.prototype._markActive = function () {\n    this._sleepFrameCount = 10 | 0\n}\n\n\n\n// temp\nRigidBody.prototype.atRestX = function () { return this.resting[0] }\nRigidBody.prototype.atRestY = function () { return this.resting[1] }\nRigidBody.prototype.atRestZ = function () { return this.resting[2] }\n\n\n\n\n\nvar sanityCheck = function () { }\nif (DEBUG) sanityCheck = function (v) {\n    if (isNaN(vec3.length(v))) throw 'Vector with NAN: ', v\n}\n","'use strict'\n\nmodule.exports = ECS\nvar DataStore = require('./dataStore')\n\n\n\n/*!\n * ent-comp: a light, *fast* Entity Component System in JS\n * @url      github.com/andyhall/ent-comp\n * @author   Andy Hall <andy@fenomas.com>\n * @license  MIT\n*/\n\n\n\n/**\n * Constructor for a new entity-component-system manager.\n * \n * ```js\n * var ECS = require('ent-comp')\n * var ecs = new ECS()\n * ```\n * @class\n * @constructor\n * @exports ECS\n * @typicalname ecs\n*/\n\nfunction ECS() {\n\tvar self = this\n\n\t/** \n\t * Hash of component definitions. Also aliased to `comps`.\n\t * \n\t * ```js\n\t * var comp = { name: 'foo' }\n\t * ecs.createComponent(comp)\n\t * ecs.components['foo'] === comp // true\n\t * ecs.comps['foo']               // same\n\t * ```\n\t*/\n\tthis.components = {}\n\tthis.comps = this.components\n\n\n\n\t/*\n\t * \n\t * \t\tinternal properties:\n\t * \n\t*/\n\n\tvar components = this.components\n\n\t// counter for entity IDs\n\tvar UID = 1\n\n\t// Storage for all component state data:\n\t// storage['component-name'] = { hash:{}, list:[] }\n\tvar storage = {}\n\n\t// flat arrays of names of components with systems\n\tvar systems = []\n\tvar renderSystems = []\n\n\t// queues for deferred operations\n\tvar deferredEntityRemovals = []\n\tvar deferredCompRemovals = []\n\tvar deferredMultiCompRemovals = []\n\n\n\t// add references to internals, for debugging/hacking\n\tthis._storage = storage\n\tthis._systems = systems\n\tthis._renderSystems = renderSystems\n\n\n\t/*\n\t * \n\t * \n\t * \t\t\t\tPublic API\n\t * \n\t * \n\t*/\n\n\n\n\n\t/**\n\t * Creates a new entity id (currently just an incrementing integer).\n\t * \n\t * Optionally takes a list of component names to add to the entity (with default state data).\n\t * \n\t * ```js\n\t * var id1 = ecs.createEntity()\n\t * var id2 = ecs.createEntity([ 'some-component', 'other-component' ])\n\t * ```\n\t*/\n\tthis.createEntity = function (compList) {\n\t\tvar id = UID++\n\t\tif (compList && compList.length) {\n\t\t\tcompList.forEach(compName => self.addComponent(id, compName))\n\t\t}\n\t\treturn id\n\t}\n\n\n\n\t/**\n\t * Deletes an entity, which in practice just means removing all its components.\n\t * By default the actual removal is deferred (since entities often\n\t * delete themselves from their system function, etc).\n\t * Pass a truthy second parameter to force immediate removal.\n\t * \n\t * ```js\n\t * ecs.deleteEntity(id)\n\t * ecs.deleteEntity(id2, true) // deletes immediately\n\t * ```\n\t*/\n\tthis.deleteEntity = function (entID, immediately) {\n\t\tif (immediately) {\n\t\t\tdeleteEntityNow(entID)\n\t\t} else {\n\t\t\tdeferredEntityRemovals.push(entID)\n\t\t\tmakeDeferralTimeout()\n\t\t}\n\t\treturn self\n\t}\n\n\n\n\n\n\n\n\t/**\n\t * Creates a new component from a definition object. \n\t * The definition must have a `name`; all other properties are optional.\n\t * \n\t * Returns the component name, to make it easy to grab when the component\n\t * is being `require`d from a module.\n\t * \n\t * ```js\n\t * var comp = {\n\t * \t name: 'some-unique-string',\n\t * \t state: {},\n\t * \t order: 99,\n\t * \t onAdd:        function(id, state){ },\n\t * \t onRemove:     function(id, state){ },\n\t * \t system:       function(dt, states){ },\n\t * \t renderSystem: function(dt, states){ },\n\t * \t multi: false,\n\t * }\n\t * \n\t * var name = ecs.createComponent( comp )\n\t * // name == 'some-unique-string'\n\t * ```\n\t * \n\t * Note the `multi` flag - for components where this is true, a given \n\t * entity can have multiple state objects for that component.\n\t * For multi-components, APIs that would normally return a state object \n\t * (like `getState`) will instead return an array of them.\n\t*/\n\tthis.createComponent = function (compDefn) {\n\t\tif (!compDefn) throw 'Missing component definition'\n\t\tvar name = compDefn.name\n\t\tif (!name) throw 'Component definition must have a name property.'\n\t\tif (typeof name !== 'string') throw 'Component name must be a string.'\n\t\tif (name === '') throw 'Component name must be a non-empty string.'\n\t\tif (storage[name]) throw `Component ${name} already exists.`\n\n\t\t// rebuild definition object for monomorphism\n\t\tvar internalDef = {}\n\t\tinternalDef.name = name\n\t\tinternalDef.order = isNaN(compDefn.order) ? 99 : compDefn.order\n\t\tinternalDef.state = compDefn.state || {}\n\t\tinternalDef.onAdd = compDefn.onAdd || null\n\t\tinternalDef.onRemove = compDefn.onRemove || null\n\t\tinternalDef.system = compDefn.system || null\n\t\tinternalDef.renderSystem = compDefn.renderSystem || null\n\t\tinternalDef.multi = !!compDefn.multi\n\n\t\tcomponents[name] = internalDef\n\t\tstorage[name] = DataStore.create()\n\n\t\tif (internalDef.system) {\n\t\t\tsystems.push(name)\n\t\t\tsystems.sort((a, b) => components[a].order - components[b].order)\n\t\t}\n\t\tif (internalDef.renderSystem) {\n\t\t\trenderSystems.push(name)\n\t\t\trenderSystems.sort((a, b) => components[a].order - components[b].order)\n\t\t}\n\n\t\treturn name\n\t}\n\n\n\n\n\n\t/**\n\t * Deletes the component definition with the given name. \n\t * First removes the component from all entities that have it.\n\t * \n\t * (This probably shouldn't be called in real-world usage - \n\t * better to define all components when you begin and leave them be - \n\t * but it's here if you need it.)\n\t * \n\t * ```js\n\t * ecs.deleteComponent( comp.name )\n\t * ```\n\t*/\n\tthis.deleteComponent = function (compName) {\n\t\tvar data = storage[compName]\n\t\tif (!data) throw `Unknown component: ${compName}`\n\n\t\tdata.list.forEach(obj => {\n\t\t\tvar id = obj.__id || obj[0].__id\n\t\t\tself.removeComponent(id, compName, true)\n\t\t})\n\n\t\tvar i = systems.indexOf(compName)\n\t\tvar j = renderSystems.indexOf(compName)\n\t\tif (i > -1) systems.splice(i, 1)\n\t\tif (j > -1) renderSystems.splice(j, 1)\n\n\t\tdelete components[compName]\n\t\tdelete storage[compName]\n\n\t\treturn self\n\t}\n\n\n\n\n\t/**\n\t * Adds a component to an entity, optionally initializing the state object.\n\t * \n\t * ```js\n\t * ecs.createComponent({\n\t * \tname: 'foo',\n\t * \tstate: { val: 0 }\n\t * })\n\t * ecs.addComponent(id, 'foo', {val:20})\n\t * ecs.getState(id, 'foo').val // 20\n\t * ```\n\t*/\n\tthis.addComponent = function (entID, compName, state) {\n\t\tvar def = components[compName]\n\t\tvar data = storage[compName]\n\t\tif (!data) throw `Unknown component: ${compName}.`\n\n\t\t// if the component is pending removal, remove it so it can be readded\n\t\tvar pendingRemoval = false\n\t\tdeferredCompRemovals.forEach(obj => {\n\t\t\tif (obj.id === entID && obj.compName === compName) pendingRemoval = true\n\t\t})\n\t\tif (pendingRemoval) doDeferredComponentRemovals()\n\n\t\tif (data.hash[entID] && !def.multi) throw `Entity ${entID} already has component: ${compName}.`\n\n\t\t// create new component state object for this entity\n\t\tvar newState = Object.assign({}, { __id: entID }, def.state, state)\n\n\t\t// just in case passed-in state object had an __id property\n\t\tnewState.__id = entID\n\n\t\t// add to dataStore - for multi components, may already be present\n\t\tif (def.multi) {\n\t\t\tvar statesArr = data.hash[entID]\n\t\t\tif (!statesArr) {\n\t\t\t\tstatesArr = []\n\t\t\t\tDataStore.add(data, entID, statesArr)\n\t\t\t}\n\t\t\tstatesArr.push(newState)\n\t\t} else {\n\t\t\tDataStore.add(data, entID, newState)\n\t\t}\n\n\t\t// call handler and return\n\t\tif (def.onAdd) def.onAdd(entID, newState)\n\n\t\treturn this\n\t}\n\n\n\n\t/**\n\t * Checks if an entity has a component.\n\t * \n\t * ```js\n\t * ecs.addComponent(id, 'comp-name')\n\t * ecs.hasComponent(id, 'comp-name') // true\n\t * ```\n\t*/\n\n\tthis.hasComponent = function (entID, compName) {\n\t\tvar data = storage[compName]\n\t\tif (!data) throw `Unknown component: ${compName}.`\n\t\treturn (data.hash[entID] !== undefined)\n\t}\n\n\n\n\n\n\t/**\n\t * Removes a component from an entity, deleting any state data.\n\t * \n\t * ```js\n\t * ecs.removeComponent(id, 'foo', true) // final arg means \"immediately\"\n\t * ecs.hasComponent(id, 'foo')          // false\n\t * ecs.removeComponent(id, 'bar')\n\t * ecs.hasComponent(id, 'bar')          // true, removal is deferred by default\n\t * ```\n\t*/\n\tthis.removeComponent = function (entID, compName, immediately) {\n\t\tvar def = components[compName]\n\t\tvar data = storage[compName]\n\t\tif (!data) throw `Unknown component: ${compName}.`\n\n\t\t// if comp isn't present, fail silently for multi or throw otherwise\n\t\tif (!data.hash[entID]) {\n\t\t\tif (def.multi) return self\n\t\t\telse throw `Entity ${entID} does not have component: ${compName} to remove.`\n\t\t}\n\n\t\t// defer or remove\n\t\tif (immediately) {\n\t\t\tremoveComponentNow(entID, compName)\n\t\t} else {\n\t\t\tdeferredCompRemovals.push({\n\t\t\t\tid: entID,\n\t\t\t\tcompName: compName,\n\t\t\t})\n\t\t\tmakeDeferralTimeout()\n\t\t}\n\n\t\treturn self\n\t}\n\n\n\n\n\n\t/**\n\t * Get the component state for a given entity.\n\t * It will automatically have an `__id` property for the entity id.\n\t * \n\t * ```js\n\t * ecs.createComponent({\n\t * \tname: 'foo',\n\t * \tstate: { val: 0 }\n\t * })\n\t * ecs.addComponent(id, 'foo')\n\t * ecs.getState(id, 'foo').val   // 0\n\t * ecs.getState(id, 'foo').__id  // equals id\n\t * ```\n\t*/\n\n\tthis.getState = function (entID, compName) {\n\t\tvar data = storage[compName]\n\t\tif (!data) throw `Unknown component: ${compName}.`\n\t\treturn data.hash[entID]\n\t}\n\n\n\n\n\t/**\n\t * Get an array of state objects for every entity with the given component. \n\t * Each one will have an `__id` property for the entity id it refers to.\n\t * Don't add or remove elements from the returned list!\n\t * \n\t * ```js\n\t * var arr = ecs.getStatesList('foo')\n\t * // returns something shaped like:\n\t * //   [ {__id:0, x:1}, \n\t * //     {__id:7, x:2}  ]\n\t * ```  \n\t*/\n\n\tECS.prototype.getStatesList = function (compName) {\n\t\tvar data = storage[compName]\n\t\tif (!data) throw `Unknown component: ${compName}.`\n\t\treturn data.list\n\t}\n\n\n\n\n\t/**\n\t * Returns a `getState`-like accessor bound to a given component name. \n\t * The accessor is faster than `getState`, so you may want to create \n\t * an accessor for any component you'll be accessing a lot.\n\t * \n\t * ```js\n\t * ecs.createComponent({\n\t * \tname: 'size',\n\t * \tstate: { val: 0 }\n\t * })\n\t * ecs.addComponent(id, 'size')\n\t * var getSize = ecs.getStateAccessor('size')\n\t * getSize(id).val // 0\n\t * ```  \n\t*/\n\n\tthis.getStateAccessor = function (compName) {\n\t\tif (!storage[compName]) throw `Unknown component: ${compName}.`\n\t\tvar hash = storage[compName].hash\n\t\treturn function (entID) {\n\t\t\treturn hash[entID]\n\t\t}\n\t}\n\n\n\n\n\t/**\n\t * Returns a `hasComponent`-like accessor function bound to a given component name. \n\t * The accessor is much faster than `hasComponent`.\n\t * \n\t * ```js\n\t * ecs.createComponent({\n\t * \tname: 'foo',\n\t * })\n\t * ecs.addComponent(id, 'foo')\n\t * var hasFoo = ecs.getComponentAccessor('foo')\n\t * hasFoo(id) // true\n\t * ```  \n\t*/\n\n\tthis.getComponentAccessor = function (compName) {\n\t\tif (!storage[compName]) throw `Unknown component: ${compName}.`\n\t\tvar hash = storage[compName].hash\n\t\treturn function (entID) {\n\t\t\treturn (hash[entID] !== undefined) // TODO\n\t\t}\n\t}\n\n\n\n\n\n\t/**\n\t * Tells the ECS that a game tick has occurred, causing component \n\t * `system` functions to get called.\n\t * \n\t * The optional parameter simply gets passed to the system functions. \n\t * It's meant to be a timestep, but can be used (or not used) as you like.    \n\t * \n\t * If components have an `order` property, they'll get called in that order\n\t * (lowest to highest). Component order defaults to `99`.\n\t * ```js\n\t * ecs.createComponent({\n\t * \tname: foo,\n\t * \torder: 1,\n\t * \tsystem: function(dt, states) {\n\t * \t\t// states is the same array you'd get from #getStatesList()\n\t * \t\tstates.forEach(state => {\n\t * \t\t\tconsole.log('Entity ID: ', state.__id)\n\t * \t\t})\n\t * \t}\n\t * })\n\t * ecs.tick(30) // triggers log statements\n\t * ```\n\t*/\n\n\tthis.tick = function (dt) {\n\t\trunAllDeferredRemovals()\n\t\tsystems.forEach(compName => {\n\t\t\tvar list = storage[compName].list\n\t\t\tvar comp = components[compName]\n\t\t\tcomp.system(dt, list)\n\t\t})\n\t\trunAllDeferredRemovals()\n\t\treturn self\n\t}\n\n\n\n\t/**\n\t * Functions exactly like `tick`, but calls `renderSystem` functions.\n\t * this effectively gives you a second set of systems that are \n\t * called with separate timing, in case you want to \n\t * [tick and render in separate loops](http://gafferongames.com/game-physics/fix-your-timestep/)\n\t * (which you should!).\n\t * \n\t * ```js\n\t * ecs.createComponent({\n\t * \tname: foo,\n\t * \torder: 5,\n\t * \trenderSystem: function(dt, states) {\n\t * \t\t// states is the same array you'd get from #getStatesList()\n\t * \t}\n\t * })\n\t * ecs.render(1000/60)\n\t * ```\n\t*/\n\n\tthis.render = function (dt) {\n\t\trunAllDeferredRemovals()\n\t\trenderSystems.forEach(compName => {\n\t\t\tvar list = storage[compName].list\n\t\t\tvar comp = components[compName]\n\t\t\tcomp.renderSystem(dt, list)\n\t\t})\n\t\trunAllDeferredRemovals()\n\t\treturn self\n\t}\n\n\n\n\n\t/**\n\t * Removes a particular state instance of a multi-component.\n\t * Pass a final truthy argument to make this happen synchronously - \n\t * but be careful, that will splice an element out of the multi-component array,\n\t * changing the indexes of subsequent elements.\n\t * \n\t * ```js\n\t * ecs.getState(id, 'foo')   // [ state1, state2, state3 ]\n\t * ecs.removeMultiComponent(id, 'foo', 1, true)  // true means: immediately\n\t * ecs.getState(id, 'foo')   // [ state1, state3 ]\n\t * ```\n\t */\n\tthis.removeMultiComponent = function (entID, compName, index, immediately) {\n\t\tvar def = components[compName]\n\t\tvar data = storage[compName]\n\t\tif (!data) throw `Unknown component: ${compName}.`\n\t\tif (!def.multi) throw 'removeMultiComponent called on non-multi component'\n\n\t\t// throw if comp isn't present, or multicomp isn't present at index\n\t\tvar statesArr = data.hash[entID]\n\t\tif (!statesArr || !statesArr[index]) {\n\t\t\tthrow `Multicomponent ${compName} instance not found at index ${index}`\n\t\t}\n\n\t\t// index removals by object, in case indexes change later\n\t\tvar stateToRemove = statesArr[index]\n\t\tif (immediately) {\n\t\t\tremoveMultiCompNow(entID, compName, stateToRemove)\n\t\t} else {\n\t\t\tdeferredMultiCompRemovals.push({\n\t\t\t\tid: entID,\n\t\t\t\tcompName: compName,\n\t\t\t\tstate: stateToRemove,\n\t\t\t})\n\t\t}\n\n\t\treturn self\n\t}\n\n\n\n\n\n\n\n\n\t/*\n\t * \n\t * \n\t *\t\tinternal implementation of various delete operations\n\t * \n\t * \n\t*/\n\n\n\t// delete entity - meaning simply remove all its components\n\tfunction deleteEntityNow(entID) {\n\t\t// For now loop over all components\n\t\t// Could speed this up by keeping a hash of components held by each entity?\n\t\tObject.keys(storage).forEach(compName => {\n\t\t\tvar data = storage[compName]\n\t\t\tif (data.hash[entID]) removeComponentNow(entID, compName)\n\t\t})\n\t}\n\n\n\t// remove given component from an entity\n\tfunction removeComponentNow(entID, compName) {\n\t\tvar def = components[compName]\n\t\tvar data = storage[compName]\n\t\tif (!data) return\n\t\tif (!data.hash[entID]) return // probably got removed twice during deferral\n\n\t\t// call onRemove handler - on each instance for multi components\n\t\tif (def.onRemove) {\n\t\t\tif (def.multi) {\n\t\t\t\tdata.hash[entID].forEach(state => {\n\t\t\t\t\tdef.onRemove(entID, state)\n\t\t\t\t})\n\t\t\t} else {\n\t\t\t\tdef.onRemove(entID, data.hash[entID])\n\t\t\t}\n\t\t}\n\n\t\t// if multi, kill the states array to hopefully free the objects\n\t\tif (def.multi) data.hash[entID].length = 0\n\n\t\t// actual removal from data store\n\t\tDataStore.remove(data, entID)\n\t}\n\n\n\n\t// remove one state from a multi component\n\tfunction removeMultiCompNow(entID, compName, stateObj) {\n\t\tvar def = components[compName]\n\t\tvar data = storage[compName]\n\t\tvar statesArr = data.hash[entID]\n\t\tif (!statesArr) return\n\n\t\tvar i = statesArr.indexOf(stateObj)\n\t\tif (i < 0) return\n\t\tif (def.onRemove) {\n\t\t\tdef.onRemove(entID, stateObj)\n\t\t}\n\t\tstatesArr.splice(i, 1)\n\n\t\t// if this leaves the states list empty, remove the whole component\n\t\tif (statesArr.length === 0) {\n\t\t\tremoveComponentNow(entID, compName)\n\t\t}\n\t}\n\n\n\n\n\n\n\t/*\n\t * \n\t * \n\t *\t\tinternals for handling deferrals\n\t * \n\t * \n\t*/\n\n\n\n\t// debouncer - called whenever a deferral is queued\n\tfunction makeDeferralTimeout() {\n\t\tif (deferralTimeoutPending) return\n\t\tdeferralTimeoutPending = true\n\t\tsetTimeout(function () {\n\t\t\tdeferralTimeoutPending = false\n\t\t\trunAllDeferredRemovals()\n\t\t}, 1)\n\t}\n\tvar deferralTimeoutPending = false\n\n\n\t// Ping all removal queues. \n\t// called before and after tick/render, and after deferrals are queued\n\tfunction runAllDeferredRemovals() {\n\t\tdoDeferredComponentRemovals()\n\t\tdoDeferredMultiComponentRemovals()\n\t\tdoDeferredEntityRemovals()\n\t}\n\n\n\t// entities - queue of entity IDs\n\tfunction doDeferredEntityRemovals() {\n\t\twhile (deferredEntityRemovals.length) {\n\t\t\tvar entID = deferredEntityRemovals.pop()\n\t\t\tdeleteEntityNow(entID)\n\t\t}\n\t}\n\n\n\t// components - queue of { id, compName }\n\tfunction doDeferredComponentRemovals() {\n\t\twhile (deferredCompRemovals.length) {\n\t\t\tvar obj = deferredCompRemovals.pop()\n\t\t\tremoveComponentNow(obj.id, obj.compName)\n\t\t}\n\t}\n\n\n\t// multi components - queue of { id, compName, state }\n\tfunction doDeferredMultiComponentRemovals(ecs) {\n\t\twhile (deferredMultiCompRemovals.length) {\n\t\t\tvar obj = deferredMultiCompRemovals.pop()\n\t\t\tremoveMultiCompNow(obj.id, obj.compName, obj.state)\n\t\t\tobj.state = null\n\t\t}\n\t}\n\n\n\n}\n\n","'use strict'\n\n\n/*\n * \n *      Encapsulates (mostly) a collection of objects, \n *      exposed both as a hash and as an array\n *      _map maps hash id to list index\n * \n *      Note this is a dumb store, it doesn't check any inputs at all.\n *      It also assumes every stored data object is stored like:\n *          DataStore.add(data, 37, {__id:37} )\n * \n*/\n\n\nmodule.exports = {\n\n    create: function () {\n        return {\n            list: [],\n            hash: {},\n            _map: {},\n        }\n    },\n\n\n    add: function (data, id, object) {\n        data.list.push(object)\n        data.hash[id] = object\n        data._map[id] = data.list.length - 1\n    },\n\n\n    remove: function (data, id) {\n        // splice out of list\n        var index = data._map[id]\n        if (index === data.list.length - 1) {\n            data.list.pop()\n        } else {\n            // replace element to be spliced with element from end\n            var movedItem = data.list.pop()\n            data.list[index] = movedItem\n            // watch out, this bit breaks encapsulation by assuming object's contents\n            // alternative would be to look through map for movedID's index\n            var movedID = movedItem.__id || movedItem[0].__id\n            data._map[movedID] = index\n        }\n        // finish\n        delete data.hash[id]\n        delete data._map[id]\n    },\n\n\n}\n\n\n","var map = {\n\t\"./collideEntities.js\": 143,\n\t\"./collideTerrain.js\": 155,\n\t\"./fadeOnZoom.js\": 156,\n\t\"./followsEntity.js\": 157,\n\t\"./mesh.js\": 158,\n\t\"./movement.js\": 159,\n\t\"./physics.js\": 54,\n\t\"./position.js\": 53,\n\t\"./receivesInputs.js\": 160,\n\t\"./shadow.js\": 161,\n\t\"./smoothCamera.js\": 162\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 142;","\nvar boxIntersect = require('box-intersect')\n\n\n/*\n * \tEvery frame, entities with this component will get mutually checked for colliions\n * \n *   * cylinder: flag for checking collisions as a vertical cylindar (rather than AABB)\n *   * collideBits: category for this entity\n *   * collideMask: categories this entity collides with\n *   * callback: function(other_id) - called when `own.collideBits & other.collideMask` is true\n * \n * \n * \t\tNotes:\n * \tSet collideBits=0 for entities like bullets, which can collide with things \n * \t\tbut are never the target of a collision.\n * \tSet collideMask=0 for things with no callback - things that get collided with,\n * \t\tbut don't themselves instigate collisions.\n * \n */\n\n\n\nexport default function (noa) {\n\n    var intervals = []\n\n    return {\n\n        name: 'collideEntities',\n\n        order: 70,\n\n        state: {\n            cylinder: false,\n            collideBits: 1 | 0,\n            collideMask: 1 | 0,\n            callback: null,\n        },\n\n        onAdd: null,\n\n        onRemove: null,\n\n\n        system: function entityCollider(dt, states) {\n            var ents = noa.ents\n\n            // data struct that boxIntersect looks for\n            // - array of [lo, lo, lo, hi, hi, hi] extents\n            for (var i = 0; i < states.length; i++) {\n                var id = states[i].__id\n                var dat = ents.getPositionData(id)\n                intervals[i] = dat._extents\n            }\n            intervals.length = states.length\n\n            // run the intersect library\n            boxIntersect(intervals, function (a, b) {\n                var stateA = states[a]\n                var stateB = states[b]\n                var intervalA = intervals[a]\n                var intervalB = intervals[b]\n                if (cylindricalHitTest(stateA, stateB, intervalA, intervalB)) {\n                    handleCollision(noa, stateA, stateB)\n                }\n            })\n\n        }\n    }\n\n\n\n    /*\n     * \n     * \t\tIMPLEMENTATION\n     * \n     */\n\n\n    function handleCollision(noa, stateA, stateB) {\n        var idA = stateA.__id\n        var idB = stateB.__id\n\n        // entities really do overlap, so check masks and call event handlers\n        if (stateA.collideMask & stateB.collideBits) {\n            if (stateA.callback) stateA.callback(idB)\n        }\n        if (stateB.collideMask & stateA.collideBits) {\n            if (stateB.callback) stateB.callback(idA)\n        }\n\n        // general pairwise handler\n        noa.ents.onPairwiseEntityCollision(idA, idB)\n    }\n\n\n\n    // For entities whose extents overlap, \n    // test if collision still happens when taking cylinder flags into account\n\n    function cylindricalHitTest(stateA, stateB, intervalA, intervalB) {\n        if (stateA.cylinder) {\n            if (stateB.cylinder) {\n                return cylinderCylinderTest(intervalA, intervalB)\n            } else {\n                return cylinderBoxTest(intervalA, intervalB)\n            }\n        } else if (stateB.cylinder) {\n            return cylinderBoxTest(intervalB, intervalA)\n        }\n        return true\n    }\n\n\n\n\n    // Cylinder-cylinder hit test (AABBs are known to overlap)\n    // given their extent arrays [lo, lo, lo, hi, hi, hi]\n\n    function cylinderCylinderTest(a, b) {\n        // distance between cylinder centers\n        var rada = (a[3] - a[0]) / 2\n        var radb = (b[3] - b[0]) / 2\n        var dx = a[0] + rada - (b[0] + radb)\n        var dz = a[2] + rada - (b[2] + radb)\n        // collide if dist <= sum of radii\n        var distsq = dx * dx + dz * dz\n        var radsum = rada + radb\n        return (distsq <= radsum * radsum)\n    }\n\n\n\n\n    // Cylinder-Box hit test (AABBs are known to overlap)\n    // given their extent arrays [lo, lo, lo, hi, hi, hi]\n\n    function cylinderBoxTest(cyl, cube) {\n        // X-z center of cylinder\n        var rad = (cyl[3] - cyl[0]) / 2\n        var cx = cyl[0] + rad\n        var cz = cyl[2] + rad\n        // point in X-Z square closest to cylinder\n        var px = clamp(cx, cube[0], cube[3])\n        var pz = clamp(cz, cube[2], cube[5])\n        // collision if distance from that point to circle <= cylinder radius\n        var dx = px - cx\n        var dz = pz - cz\n        var distsq = dx * dx + dz * dz\n        return (distsq <= rad * rad)\n    }\n\n    function clamp(val, lo, hi) {\n        return (val < lo) ? lo : (val > hi) ? hi : val\n    }\n\n\n\n\n}\n","'use strict'\n\nmodule.exports = boxIntersectWrapper\n\nvar pool = require('typedarray-pool')\nvar sweep = require('./lib/sweep')\nvar boxIntersectIter = require('./lib/intersect')\n\nfunction boxEmpty(d, box) {\n  for(var j=0; j<d; ++j) {\n    if(!(box[j] <= box[j+d])) {\n      return true\n    }\n  }\n  return false\n}\n\n//Unpack boxes into a flat typed array, remove empty boxes\nfunction convertBoxes(boxes, d, data, ids) {\n  var ptr = 0\n  var count = 0\n  for(var i=0, n=boxes.length; i<n; ++i) {\n    var b = boxes[i]\n    if(boxEmpty(d, b)) {\n      continue\n    }\n    for(var j=0; j<2*d; ++j) {\n      data[ptr++] = b[j]\n    }\n    ids[count++] = i\n  }\n  return count\n}\n\n//Perform type conversions, check bounds\nfunction boxIntersect(red, blue, visit, full) {\n  var n = red.length\n  var m = blue.length\n\n  //If either array is empty, then we can skip this whole thing\n  if(n <= 0 || m <= 0) {\n    return\n  }\n\n  //Compute dimension, if it is 0 then we skip\n  var d = (red[0].length)>>>1\n  if(d <= 0) {\n    return\n  }\n\n  var retval\n\n  //Convert red boxes\n  var redList  = pool.mallocDouble(2*d*n)\n  var redIds   = pool.mallocInt32(n)\n  n = convertBoxes(red, d, redList, redIds)\n\n  if(n > 0) {\n    if(d === 1 && full) {\n      //Special case: 1d complete\n      sweep.init(n)\n      retval = sweep.sweepComplete(\n        d, visit, \n        0, n, redList, redIds,\n        0, n, redList, redIds)\n    } else {\n\n      //Convert blue boxes\n      var blueList = pool.mallocDouble(2*d*m)\n      var blueIds  = pool.mallocInt32(m)\n      m = convertBoxes(blue, d, blueList, blueIds)\n\n      if(m > 0) {\n        sweep.init(n+m)\n\n        if(d === 1) {\n          //Special case: 1d bipartite\n          retval = sweep.sweepBipartite(\n            d, visit, \n            0, n, redList,  redIds,\n            0, m, blueList, blueIds)\n        } else {\n          //General case:  d>1\n          retval = boxIntersectIter(\n            d, visit,    full,\n            n, redList,  redIds,\n            m, blueList, blueIds)\n        }\n\n        pool.free(blueList)\n        pool.free(blueIds)\n      }\n    }\n\n    pool.free(redList)\n    pool.free(redIds)\n  }\n\n  return retval\n}\n\n\nvar RESULT\n\nfunction appendItem(i,j) {\n  RESULT.push([i,j])\n}\n\nfunction intersectFullArray(x) {\n  RESULT = []\n  boxIntersect(x, x, appendItem, true)\n  return RESULT\n}\n\nfunction intersectBipartiteArray(x, y) {\n  RESULT = []\n  boxIntersect(x, y, appendItem, false)\n  return RESULT\n}\n\n//User-friendly wrapper, handle full input and no-visitor cases\nfunction boxIntersectWrapper(arg0, arg1, arg2) {\n  var result\n  switch(arguments.length) {\n    case 1:\n      return intersectFullArray(arg0)\n    case 2:\n      if(typeof arg1 === 'function') {\n        return boxIntersect(arg0, arg0, arg1, true)\n      } else {\n        return intersectBipartiteArray(arg0, arg1)\n      }\n    case 3:\n      return boxIntersect(arg0, arg1, arg2, false)\n    default:\n      throw new Error('box-intersect: Invalid arguments')\n  }\n}","/**\n * Bit twiddling hacks for JavaScript.\n *\n * Author: Mikola Lysenko\n *\n * Ported from Stanford bit twiddling hack library:\n *    http://graphics.stanford.edu/~seander/bithacks.html\n */\n\n\"use strict\"; \"use restrict\";\n\n//Number of bits in an integer\nvar INT_BITS = 32;\n\n//Constants\nexports.INT_BITS  = INT_BITS;\nexports.INT_MAX   =  0x7fffffff;\nexports.INT_MIN   = -1<<(INT_BITS-1);\n\n//Returns -1, 0, +1 depending on sign of x\nexports.sign = function(v) {\n  return (v > 0) - (v < 0);\n}\n\n//Computes absolute value of integer\nexports.abs = function(v) {\n  var mask = v >> (INT_BITS-1);\n  return (v ^ mask) - mask;\n}\n\n//Computes minimum of integers x and y\nexports.min = function(x, y) {\n  return y ^ ((x ^ y) & -(x < y));\n}\n\n//Computes maximum of integers x and y\nexports.max = function(x, y) {\n  return x ^ ((x ^ y) & -(x < y));\n}\n\n//Checks if a number is a power of two\nexports.isPow2 = function(v) {\n  return !(v & (v-1)) && (!!v);\n}\n\n//Computes log base 2 of v\nexports.log2 = function(v) {\n  var r, shift;\n  r =     (v > 0xFFFF) << 4; v >>>= r;\n  shift = (v > 0xFF  ) << 3; v >>>= shift; r |= shift;\n  shift = (v > 0xF   ) << 2; v >>>= shift; r |= shift;\n  shift = (v > 0x3   ) << 1; v >>>= shift; r |= shift;\n  return r | (v >> 1);\n}\n\n//Computes log base 10 of v\nexports.log10 = function(v) {\n  return  (v >= 1000000000) ? 9 : (v >= 100000000) ? 8 : (v >= 10000000) ? 7 :\n          (v >= 1000000) ? 6 : (v >= 100000) ? 5 : (v >= 10000) ? 4 :\n          (v >= 1000) ? 3 : (v >= 100) ? 2 : (v >= 10) ? 1 : 0;\n}\n\n//Counts number of bits\nexports.popCount = function(v) {\n  v = v - ((v >>> 1) & 0x55555555);\n  v = (v & 0x33333333) + ((v >>> 2) & 0x33333333);\n  return ((v + (v >>> 4) & 0xF0F0F0F) * 0x1010101) >>> 24;\n}\n\n//Counts number of trailing zeros\nfunction countTrailingZeros(v) {\n  var c = 32;\n  v &= -v;\n  if (v) c--;\n  if (v & 0x0000FFFF) c -= 16;\n  if (v & 0x00FF00FF) c -= 8;\n  if (v & 0x0F0F0F0F) c -= 4;\n  if (v & 0x33333333) c -= 2;\n  if (v & 0x55555555) c -= 1;\n  return c;\n}\nexports.countTrailingZeros = countTrailingZeros;\n\n//Rounds to next power of 2\nexports.nextPow2 = function(v) {\n  v += v === 0;\n  --v;\n  v |= v >>> 1;\n  v |= v >>> 2;\n  v |= v >>> 4;\n  v |= v >>> 8;\n  v |= v >>> 16;\n  return v + 1;\n}\n\n//Rounds down to previous power of 2\nexports.prevPow2 = function(v) {\n  v |= v >>> 1;\n  v |= v >>> 2;\n  v |= v >>> 4;\n  v |= v >>> 8;\n  v |= v >>> 16;\n  return v - (v>>>1);\n}\n\n//Computes parity of word\nexports.parity = function(v) {\n  v ^= v >>> 16;\n  v ^= v >>> 8;\n  v ^= v >>> 4;\n  v &= 0xf;\n  return (0x6996 >>> v) & 1;\n}\n\nvar REVERSE_TABLE = new Array(256);\n\n(function(tab) {\n  for(var i=0; i<256; ++i) {\n    var v = i, r = i, s = 7;\n    for (v >>>= 1; v; v >>>= 1) {\n      r <<= 1;\n      r |= v & 1;\n      --s;\n    }\n    tab[i] = (r << s) & 0xff;\n  }\n})(REVERSE_TABLE);\n\n//Reverse bits in a 32 bit word\nexports.reverse = function(v) {\n  return  (REVERSE_TABLE[ v         & 0xff] << 24) |\n          (REVERSE_TABLE[(v >>> 8)  & 0xff] << 16) |\n          (REVERSE_TABLE[(v >>> 16) & 0xff] << 8)  |\n           REVERSE_TABLE[(v >>> 24) & 0xff];\n}\n\n//Interleave bits of 2 coordinates with 16 bits.  Useful for fast quadtree codes\nexports.interleave2 = function(x, y) {\n  x &= 0xFFFF;\n  x = (x | (x << 8)) & 0x00FF00FF;\n  x = (x | (x << 4)) & 0x0F0F0F0F;\n  x = (x | (x << 2)) & 0x33333333;\n  x = (x | (x << 1)) & 0x55555555;\n\n  y &= 0xFFFF;\n  y = (y | (y << 8)) & 0x00FF00FF;\n  y = (y | (y << 4)) & 0x0F0F0F0F;\n  y = (y | (y << 2)) & 0x33333333;\n  y = (y | (y << 1)) & 0x55555555;\n\n  return x | (y << 1);\n}\n\n//Extracts the nth interleaved component\nexports.deinterleave2 = function(v, n) {\n  v = (v >>> n) & 0x55555555;\n  v = (v | (v >>> 1))  & 0x33333333;\n  v = (v | (v >>> 2))  & 0x0F0F0F0F;\n  v = (v | (v >>> 4))  & 0x00FF00FF;\n  v = (v | (v >>> 16)) & 0x000FFFF;\n  return (v << 16) >> 16;\n}\n\n\n//Interleave bits of 3 coordinates, each with 10 bits.  Useful for fast octree codes\nexports.interleave3 = function(x, y, z) {\n  x &= 0x3FF;\n  x  = (x | (x<<16)) & 4278190335;\n  x  = (x | (x<<8))  & 251719695;\n  x  = (x | (x<<4))  & 3272356035;\n  x  = (x | (x<<2))  & 1227133513;\n\n  y &= 0x3FF;\n  y  = (y | (y<<16)) & 4278190335;\n  y  = (y | (y<<8))  & 251719695;\n  y  = (y | (y<<4))  & 3272356035;\n  y  = (y | (y<<2))  & 1227133513;\n  x |= (y << 1);\n  \n  z &= 0x3FF;\n  z  = (z | (z<<16)) & 4278190335;\n  z  = (z | (z<<8))  & 251719695;\n  z  = (z | (z<<4))  & 3272356035;\n  z  = (z | (z<<2))  & 1227133513;\n  \n  return x | (z << 2);\n}\n\n//Extracts nth interleaved component of a 3-tuple\nexports.deinterleave3 = function(v, n) {\n  v = (v >>> n)       & 1227133513;\n  v = (v | (v>>>2))   & 3272356035;\n  v = (v | (v>>>4))   & 251719695;\n  v = (v | (v>>>8))   & 4278190335;\n  v = (v | (v>>>16))  & 0x3FF;\n  return (v<<22)>>22;\n}\n\n//Computes next combination in colexicographic order (this is mistakenly called nextPermutation on the bit twiddling hacks page)\nexports.nextCombination = function(v) {\n  var t = v | (v - 1);\n  return (t + 1) | (((~t & -~t) - 1) >>> (countTrailingZeros(v) + 1));\n}\n\n","\"use strict\"\n\nfunction dupe_array(count, value, i) {\n  var c = count[i]|0\n  if(c <= 0) {\n    return []\n  }\n  var result = new Array(c), j\n  if(i === count.length-1) {\n    for(j=0; j<c; ++j) {\n      result[j] = value\n    }\n  } else {\n    for(j=0; j<c; ++j) {\n      result[j] = dupe_array(count, value, i+1)\n    }\n  }\n  return result\n}\n\nfunction dupe_number(count, value) {\n  var result, i\n  result = new Array(count)\n  for(i=0; i<count; ++i) {\n    result[i] = value\n  }\n  return result\n}\n\nfunction dupe(count, value) {\n  if(typeof value === \"undefined\") {\n    value = 0\n  }\n  switch(typeof count) {\n    case \"number\":\n      if(count > 0) {\n        return dupe_number(count|0, value)\n      }\n    break\n    case \"object\":\n      if(typeof (count.length) === \"number\") {\n        return dupe_array(count, value, 0)\n      }\n    break\n  }\n  return []\n}\n\nmodule.exports = dupe","/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <http://feross.org>\n * @license  MIT\n */\n/* eslint-disable no-proto */\n\n'use strict'\n\nvar base64 = require('base64-js')\nvar ieee754 = require('ieee754')\nvar isArray = require('isarray')\n\nexports.Buffer = Buffer\nexports.SlowBuffer = SlowBuffer\nexports.INSPECT_MAX_BYTES = 50\n\n/**\n * If `Buffer.TYPED_ARRAY_SUPPORT`:\n *   === true    Use Uint8Array implementation (fastest)\n *   === false   Use Object implementation (most compatible, even IE6)\n *\n * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,\n * Opera 11.6+, iOS 4.2+.\n *\n * Due to various browser bugs, sometimes the Object implementation will be used even\n * when the browser supports typed arrays.\n *\n * Note:\n *\n *   - Firefox 4-29 lacks support for adding new properties to `Uint8Array` instances,\n *     See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.\n *\n *   - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.\n *\n *   - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of\n *     incorrect length in some situations.\n\n * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they\n * get the Object implementation, which is slower but behaves correctly.\n */\nBuffer.TYPED_ARRAY_SUPPORT = global.TYPED_ARRAY_SUPPORT !== undefined\n  ? global.TYPED_ARRAY_SUPPORT\n  : typedArraySupport()\n\n/*\n * Export kMaxLength after typed array support is determined.\n */\nexports.kMaxLength = kMaxLength()\n\nfunction typedArraySupport () {\n  try {\n    var arr = new Uint8Array(1)\n    arr.__proto__ = {__proto__: Uint8Array.prototype, foo: function () { return 42 }}\n    return arr.foo() === 42 && // typed array instances can be augmented\n        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`\n        arr.subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`\n  } catch (e) {\n    return false\n  }\n}\n\nfunction kMaxLength () {\n  return Buffer.TYPED_ARRAY_SUPPORT\n    ? 0x7fffffff\n    : 0x3fffffff\n}\n\nfunction createBuffer (that, length) {\n  if (kMaxLength() < length) {\n    throw new RangeError('Invalid typed array length')\n  }\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = new Uint8Array(length)\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    if (that === null) {\n      that = new Buffer(length)\n    }\n    that.length = length\n  }\n\n  return that\n}\n\n/**\n * The Buffer constructor returns instances of `Uint8Array` that have their\n * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of\n * `Uint8Array`, so the returned instances will have all the node `Buffer` methods\n * and the `Uint8Array` methods. Square bracket notation works as expected -- it\n * returns a single octet.\n *\n * The `Uint8Array` prototype remains unmodified.\n */\n\nfunction Buffer (arg, encodingOrOffset, length) {\n  if (!Buffer.TYPED_ARRAY_SUPPORT && !(this instanceof Buffer)) {\n    return new Buffer(arg, encodingOrOffset, length)\n  }\n\n  // Common case.\n  if (typeof arg === 'number') {\n    if (typeof encodingOrOffset === 'string') {\n      throw new Error(\n        'If encoding is specified then the first argument must be a string'\n      )\n    }\n    return allocUnsafe(this, arg)\n  }\n  return from(this, arg, encodingOrOffset, length)\n}\n\nBuffer.poolSize = 8192 // not used by this implementation\n\n// TODO: Legacy, not needed anymore. Remove in next major version.\nBuffer._augment = function (arr) {\n  arr.__proto__ = Buffer.prototype\n  return arr\n}\n\nfunction from (that, value, encodingOrOffset, length) {\n  if (typeof value === 'number') {\n    throw new TypeError('\"value\" argument must not be a number')\n  }\n\n  if (typeof ArrayBuffer !== 'undefined' && value instanceof ArrayBuffer) {\n    return fromArrayBuffer(that, value, encodingOrOffset, length)\n  }\n\n  if (typeof value === 'string') {\n    return fromString(that, value, encodingOrOffset)\n  }\n\n  return fromObject(that, value)\n}\n\n/**\n * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError\n * if value is a number.\n * Buffer.from(str[, encoding])\n * Buffer.from(array)\n * Buffer.from(buffer)\n * Buffer.from(arrayBuffer[, byteOffset[, length]])\n **/\nBuffer.from = function (value, encodingOrOffset, length) {\n  return from(null, value, encodingOrOffset, length)\n}\n\nif (Buffer.TYPED_ARRAY_SUPPORT) {\n  Buffer.prototype.__proto__ = Uint8Array.prototype\n  Buffer.__proto__ = Uint8Array\n  if (typeof Symbol !== 'undefined' && Symbol.species &&\n      Buffer[Symbol.species] === Buffer) {\n    // Fix subarray() in ES2016. See: https://github.com/feross/buffer/pull/97\n    Object.defineProperty(Buffer, Symbol.species, {\n      value: null,\n      configurable: true\n    })\n  }\n}\n\nfunction assertSize (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('\"size\" argument must be a number')\n  } else if (size < 0) {\n    throw new RangeError('\"size\" argument must not be negative')\n  }\n}\n\nfunction alloc (that, size, fill, encoding) {\n  assertSize(size)\n  if (size <= 0) {\n    return createBuffer(that, size)\n  }\n  if (fill !== undefined) {\n    // Only pay attention to encoding if it's a string. This\n    // prevents accidentally sending in a number that would\n    // be interpretted as a start offset.\n    return typeof encoding === 'string'\n      ? createBuffer(that, size).fill(fill, encoding)\n      : createBuffer(that, size).fill(fill)\n  }\n  return createBuffer(that, size)\n}\n\n/**\n * Creates a new filled Buffer instance.\n * alloc(size[, fill[, encoding]])\n **/\nBuffer.alloc = function (size, fill, encoding) {\n  return alloc(null, size, fill, encoding)\n}\n\nfunction allocUnsafe (that, size) {\n  assertSize(size)\n  that = createBuffer(that, size < 0 ? 0 : checked(size) | 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) {\n    for (var i = 0; i < size; ++i) {\n      that[i] = 0\n    }\n  }\n  return that\n}\n\n/**\n * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.\n * */\nBuffer.allocUnsafe = function (size) {\n  return allocUnsafe(null, size)\n}\n/**\n * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.\n */\nBuffer.allocUnsafeSlow = function (size) {\n  return allocUnsafe(null, size)\n}\n\nfunction fromString (that, string, encoding) {\n  if (typeof encoding !== 'string' || encoding === '') {\n    encoding = 'utf8'\n  }\n\n  if (!Buffer.isEncoding(encoding)) {\n    throw new TypeError('\"encoding\" must be a valid string encoding')\n  }\n\n  var length = byteLength(string, encoding) | 0\n  that = createBuffer(that, length)\n\n  var actual = that.write(string, encoding)\n\n  if (actual !== length) {\n    // Writing a hex string, for example, that contains invalid characters will\n    // cause everything after the first invalid character to be ignored. (e.g.\n    // 'abxxcd' will be treated as 'ab')\n    that = that.slice(0, actual)\n  }\n\n  return that\n}\n\nfunction fromArrayLike (that, array) {\n  var length = array.length < 0 ? 0 : checked(array.length) | 0\n  that = createBuffer(that, length)\n  for (var i = 0; i < length; i += 1) {\n    that[i] = array[i] & 255\n  }\n  return that\n}\n\nfunction fromArrayBuffer (that, array, byteOffset, length) {\n  array.byteLength // this throws if `array` is not a valid ArrayBuffer\n\n  if (byteOffset < 0 || array.byteLength < byteOffset) {\n    throw new RangeError('\\'offset\\' is out of bounds')\n  }\n\n  if (array.byteLength < byteOffset + (length || 0)) {\n    throw new RangeError('\\'length\\' is out of bounds')\n  }\n\n  if (byteOffset === undefined && length === undefined) {\n    array = new Uint8Array(array)\n  } else if (length === undefined) {\n    array = new Uint8Array(array, byteOffset)\n  } else {\n    array = new Uint8Array(array, byteOffset, length)\n  }\n\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = array\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    that = fromArrayLike(that, array)\n  }\n  return that\n}\n\nfunction fromObject (that, obj) {\n  if (Buffer.isBuffer(obj)) {\n    var len = checked(obj.length) | 0\n    that = createBuffer(that, len)\n\n    if (that.length === 0) {\n      return that\n    }\n\n    obj.copy(that, 0, 0, len)\n    return that\n  }\n\n  if (obj) {\n    if ((typeof ArrayBuffer !== 'undefined' &&\n        obj.buffer instanceof ArrayBuffer) || 'length' in obj) {\n      if (typeof obj.length !== 'number' || isnan(obj.length)) {\n        return createBuffer(that, 0)\n      }\n      return fromArrayLike(that, obj)\n    }\n\n    if (obj.type === 'Buffer' && isArray(obj.data)) {\n      return fromArrayLike(that, obj.data)\n    }\n  }\n\n  throw new TypeError('First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.')\n}\n\nfunction checked (length) {\n  // Note: cannot use `length < kMaxLength()` here because that fails when\n  // length is NaN (which is otherwise coerced to zero.)\n  if (length >= kMaxLength()) {\n    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +\n                         'size: 0x' + kMaxLength().toString(16) + ' bytes')\n  }\n  return length | 0\n}\n\nfunction SlowBuffer (length) {\n  if (+length != length) { // eslint-disable-line eqeqeq\n    length = 0\n  }\n  return Buffer.alloc(+length)\n}\n\nBuffer.isBuffer = function isBuffer (b) {\n  return !!(b != null && b._isBuffer)\n}\n\nBuffer.compare = function compare (a, b) {\n  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {\n    throw new TypeError('Arguments must be Buffers')\n  }\n\n  if (a === b) return 0\n\n  var x = a.length\n  var y = b.length\n\n  for (var i = 0, len = Math.min(x, y); i < len; ++i) {\n    if (a[i] !== b[i]) {\n      x = a[i]\n      y = b[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\nBuffer.isEncoding = function isEncoding (encoding) {\n  switch (String(encoding).toLowerCase()) {\n    case 'hex':\n    case 'utf8':\n    case 'utf-8':\n    case 'ascii':\n    case 'latin1':\n    case 'binary':\n    case 'base64':\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      return true\n    default:\n      return false\n  }\n}\n\nBuffer.concat = function concat (list, length) {\n  if (!isArray(list)) {\n    throw new TypeError('\"list\" argument must be an Array of Buffers')\n  }\n\n  if (list.length === 0) {\n    return Buffer.alloc(0)\n  }\n\n  var i\n  if (length === undefined) {\n    length = 0\n    for (i = 0; i < list.length; ++i) {\n      length += list[i].length\n    }\n  }\n\n  var buffer = Buffer.allocUnsafe(length)\n  var pos = 0\n  for (i = 0; i < list.length; ++i) {\n    var buf = list[i]\n    if (!Buffer.isBuffer(buf)) {\n      throw new TypeError('\"list\" argument must be an Array of Buffers')\n    }\n    buf.copy(buffer, pos)\n    pos += buf.length\n  }\n  return buffer\n}\n\nfunction byteLength (string, encoding) {\n  if (Buffer.isBuffer(string)) {\n    return string.length\n  }\n  if (typeof ArrayBuffer !== 'undefined' && typeof ArrayBuffer.isView === 'function' &&\n      (ArrayBuffer.isView(string) || string instanceof ArrayBuffer)) {\n    return string.byteLength\n  }\n  if (typeof string !== 'string') {\n    string = '' + string\n  }\n\n  var len = string.length\n  if (len === 0) return 0\n\n  // Use a for loop to avoid recursion\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'ascii':\n      case 'latin1':\n      case 'binary':\n        return len\n      case 'utf8':\n      case 'utf-8':\n      case undefined:\n        return utf8ToBytes(string).length\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return len * 2\n      case 'hex':\n        return len >>> 1\n      case 'base64':\n        return base64ToBytes(string).length\n      default:\n        if (loweredCase) return utf8ToBytes(string).length // assume utf8\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\nBuffer.byteLength = byteLength\n\nfunction slowToString (encoding, start, end) {\n  var loweredCase = false\n\n  // No need to verify that \"this.length <= MAX_UINT32\" since it's a read-only\n  // property of a typed array.\n\n  // This behaves neither like String nor Uint8Array in that we set start/end\n  // to their upper/lower bounds if the value passed is out of range.\n  // undefined is handled specially as per ECMA-262 6th Edition,\n  // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.\n  if (start === undefined || start < 0) {\n    start = 0\n  }\n  // Return early if start > this.length. Done here to prevent potential uint32\n  // coercion fail below.\n  if (start > this.length) {\n    return ''\n  }\n\n  if (end === undefined || end > this.length) {\n    end = this.length\n  }\n\n  if (end <= 0) {\n    return ''\n  }\n\n  // Force coersion to uint32. This will also coerce falsey/NaN values to 0.\n  end >>>= 0\n  start >>>= 0\n\n  if (end <= start) {\n    return ''\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  while (true) {\n    switch (encoding) {\n      case 'hex':\n        return hexSlice(this, start, end)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Slice(this, start, end)\n\n      case 'ascii':\n        return asciiSlice(this, start, end)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Slice(this, start, end)\n\n      case 'base64':\n        return base64Slice(this, start, end)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return utf16leSlice(this, start, end)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = (encoding + '').toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\n// The property is used by `Buffer.isBuffer` and `is-buffer` (in Safari 5-7) to detect\n// Buffer instances.\nBuffer.prototype._isBuffer = true\n\nfunction swap (b, n, m) {\n  var i = b[n]\n  b[n] = b[m]\n  b[m] = i\n}\n\nBuffer.prototype.swap16 = function swap16 () {\n  var len = this.length\n  if (len % 2 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 16-bits')\n  }\n  for (var i = 0; i < len; i += 2) {\n    swap(this, i, i + 1)\n  }\n  return this\n}\n\nBuffer.prototype.swap32 = function swap32 () {\n  var len = this.length\n  if (len % 4 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 32-bits')\n  }\n  for (var i = 0; i < len; i += 4) {\n    swap(this, i, i + 3)\n    swap(this, i + 1, i + 2)\n  }\n  return this\n}\n\nBuffer.prototype.swap64 = function swap64 () {\n  var len = this.length\n  if (len % 8 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 64-bits')\n  }\n  for (var i = 0; i < len; i += 8) {\n    swap(this, i, i + 7)\n    swap(this, i + 1, i + 6)\n    swap(this, i + 2, i + 5)\n    swap(this, i + 3, i + 4)\n  }\n  return this\n}\n\nBuffer.prototype.toString = function toString () {\n  var length = this.length | 0\n  if (length === 0) return ''\n  if (arguments.length === 0) return utf8Slice(this, 0, length)\n  return slowToString.apply(this, arguments)\n}\n\nBuffer.prototype.equals = function equals (b) {\n  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')\n  if (this === b) return true\n  return Buffer.compare(this, b) === 0\n}\n\nBuffer.prototype.inspect = function inspect () {\n  var str = ''\n  var max = exports.INSPECT_MAX_BYTES\n  if (this.length > 0) {\n    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')\n    if (this.length > max) str += ' ... '\n  }\n  return '<Buffer ' + str + '>'\n}\n\nBuffer.prototype.compare = function compare (target, start, end, thisStart, thisEnd) {\n  if (!Buffer.isBuffer(target)) {\n    throw new TypeError('Argument must be a Buffer')\n  }\n\n  if (start === undefined) {\n    start = 0\n  }\n  if (end === undefined) {\n    end = target ? target.length : 0\n  }\n  if (thisStart === undefined) {\n    thisStart = 0\n  }\n  if (thisEnd === undefined) {\n    thisEnd = this.length\n  }\n\n  if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {\n    throw new RangeError('out of range index')\n  }\n\n  if (thisStart >= thisEnd && start >= end) {\n    return 0\n  }\n  if (thisStart >= thisEnd) {\n    return -1\n  }\n  if (start >= end) {\n    return 1\n  }\n\n  start >>>= 0\n  end >>>= 0\n  thisStart >>>= 0\n  thisEnd >>>= 0\n\n  if (this === target) return 0\n\n  var x = thisEnd - thisStart\n  var y = end - start\n  var len = Math.min(x, y)\n\n  var thisCopy = this.slice(thisStart, thisEnd)\n  var targetCopy = target.slice(start, end)\n\n  for (var i = 0; i < len; ++i) {\n    if (thisCopy[i] !== targetCopy[i]) {\n      x = thisCopy[i]\n      y = targetCopy[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\n// Finds either the first index of `val` in `buffer` at offset >= `byteOffset`,\n// OR the last index of `val` in `buffer` at offset <= `byteOffset`.\n//\n// Arguments:\n// - buffer - a Buffer to search\n// - val - a string, Buffer, or number\n// - byteOffset - an index into `buffer`; will be clamped to an int32\n// - encoding - an optional encoding, relevant is val is a string\n// - dir - true for indexOf, false for lastIndexOf\nfunction bidirectionalIndexOf (buffer, val, byteOffset, encoding, dir) {\n  // Empty buffer means no match\n  if (buffer.length === 0) return -1\n\n  // Normalize byteOffset\n  if (typeof byteOffset === 'string') {\n    encoding = byteOffset\n    byteOffset = 0\n  } else if (byteOffset > 0x7fffffff) {\n    byteOffset = 0x7fffffff\n  } else if (byteOffset < -0x80000000) {\n    byteOffset = -0x80000000\n  }\n  byteOffset = +byteOffset  // Coerce to Number.\n  if (isNaN(byteOffset)) {\n    // byteOffset: it it's undefined, null, NaN, \"foo\", etc, search whole buffer\n    byteOffset = dir ? 0 : (buffer.length - 1)\n  }\n\n  // Normalize byteOffset: negative offsets start from the end of the buffer\n  if (byteOffset < 0) byteOffset = buffer.length + byteOffset\n  if (byteOffset >= buffer.length) {\n    if (dir) return -1\n    else byteOffset = buffer.length - 1\n  } else if (byteOffset < 0) {\n    if (dir) byteOffset = 0\n    else return -1\n  }\n\n  // Normalize val\n  if (typeof val === 'string') {\n    val = Buffer.from(val, encoding)\n  }\n\n  // Finally, search either indexOf (if dir is true) or lastIndexOf\n  if (Buffer.isBuffer(val)) {\n    // Special case: looking for empty string/buffer always fails\n    if (val.length === 0) {\n      return -1\n    }\n    return arrayIndexOf(buffer, val, byteOffset, encoding, dir)\n  } else if (typeof val === 'number') {\n    val = val & 0xFF // Search for a byte value [0-255]\n    if (Buffer.TYPED_ARRAY_SUPPORT &&\n        typeof Uint8Array.prototype.indexOf === 'function') {\n      if (dir) {\n        return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset)\n      } else {\n        return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset)\n      }\n    }\n    return arrayIndexOf(buffer, [ val ], byteOffset, encoding, dir)\n  }\n\n  throw new TypeError('val must be string, number or Buffer')\n}\n\nfunction arrayIndexOf (arr, val, byteOffset, encoding, dir) {\n  var indexSize = 1\n  var arrLength = arr.length\n  var valLength = val.length\n\n  if (encoding !== undefined) {\n    encoding = String(encoding).toLowerCase()\n    if (encoding === 'ucs2' || encoding === 'ucs-2' ||\n        encoding === 'utf16le' || encoding === 'utf-16le') {\n      if (arr.length < 2 || val.length < 2) {\n        return -1\n      }\n      indexSize = 2\n      arrLength /= 2\n      valLength /= 2\n      byteOffset /= 2\n    }\n  }\n\n  function read (buf, i) {\n    if (indexSize === 1) {\n      return buf[i]\n    } else {\n      return buf.readUInt16BE(i * indexSize)\n    }\n  }\n\n  var i\n  if (dir) {\n    var foundIndex = -1\n    for (i = byteOffset; i < arrLength; i++) {\n      if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {\n        if (foundIndex === -1) foundIndex = i\n        if (i - foundIndex + 1 === valLength) return foundIndex * indexSize\n      } else {\n        if (foundIndex !== -1) i -= i - foundIndex\n        foundIndex = -1\n      }\n    }\n  } else {\n    if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength\n    for (i = byteOffset; i >= 0; i--) {\n      var found = true\n      for (var j = 0; j < valLength; j++) {\n        if (read(arr, i + j) !== read(val, j)) {\n          found = false\n          break\n        }\n      }\n      if (found) return i\n    }\n  }\n\n  return -1\n}\n\nBuffer.prototype.includes = function includes (val, byteOffset, encoding) {\n  return this.indexOf(val, byteOffset, encoding) !== -1\n}\n\nBuffer.prototype.indexOf = function indexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, true)\n}\n\nBuffer.prototype.lastIndexOf = function lastIndexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, false)\n}\n\nfunction hexWrite (buf, string, offset, length) {\n  offset = Number(offset) || 0\n  var remaining = buf.length - offset\n  if (!length) {\n    length = remaining\n  } else {\n    length = Number(length)\n    if (length > remaining) {\n      length = remaining\n    }\n  }\n\n  // must be an even number of digits\n  var strLen = string.length\n  if (strLen % 2 !== 0) throw new TypeError('Invalid hex string')\n\n  if (length > strLen / 2) {\n    length = strLen / 2\n  }\n  for (var i = 0; i < length; ++i) {\n    var parsed = parseInt(string.substr(i * 2, 2), 16)\n    if (isNaN(parsed)) return i\n    buf[offset + i] = parsed\n  }\n  return i\n}\n\nfunction utf8Write (buf, string, offset, length) {\n  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nfunction asciiWrite (buf, string, offset, length) {\n  return blitBuffer(asciiToBytes(string), buf, offset, length)\n}\n\nfunction latin1Write (buf, string, offset, length) {\n  return asciiWrite(buf, string, offset, length)\n}\n\nfunction base64Write (buf, string, offset, length) {\n  return blitBuffer(base64ToBytes(string), buf, offset, length)\n}\n\nfunction ucs2Write (buf, string, offset, length) {\n  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nBuffer.prototype.write = function write (string, offset, length, encoding) {\n  // Buffer#write(string)\n  if (offset === undefined) {\n    encoding = 'utf8'\n    length = this.length\n    offset = 0\n  // Buffer#write(string, encoding)\n  } else if (length === undefined && typeof offset === 'string') {\n    encoding = offset\n    length = this.length\n    offset = 0\n  // Buffer#write(string, offset[, length][, encoding])\n  } else if (isFinite(offset)) {\n    offset = offset | 0\n    if (isFinite(length)) {\n      length = length | 0\n      if (encoding === undefined) encoding = 'utf8'\n    } else {\n      encoding = length\n      length = undefined\n    }\n  // legacy write(string, encoding, offset, length) - remove in v0.13\n  } else {\n    throw new Error(\n      'Buffer.write(string, encoding, offset[, length]) is no longer supported'\n    )\n  }\n\n  var remaining = this.length - offset\n  if (length === undefined || length > remaining) length = remaining\n\n  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {\n    throw new RangeError('Attempt to write outside buffer bounds')\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'hex':\n        return hexWrite(this, string, offset, length)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Write(this, string, offset, length)\n\n      case 'ascii':\n        return asciiWrite(this, string, offset, length)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Write(this, string, offset, length)\n\n      case 'base64':\n        // Warning: maxLength not taken into account in base64Write\n        return base64Write(this, string, offset, length)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return ucs2Write(this, string, offset, length)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\nBuffer.prototype.toJSON = function toJSON () {\n  return {\n    type: 'Buffer',\n    data: Array.prototype.slice.call(this._arr || this, 0)\n  }\n}\n\nfunction base64Slice (buf, start, end) {\n  if (start === 0 && end === buf.length) {\n    return base64.fromByteArray(buf)\n  } else {\n    return base64.fromByteArray(buf.slice(start, end))\n  }\n}\n\nfunction utf8Slice (buf, start, end) {\n  end = Math.min(buf.length, end)\n  var res = []\n\n  var i = start\n  while (i < end) {\n    var firstByte = buf[i]\n    var codePoint = null\n    var bytesPerSequence = (firstByte > 0xEF) ? 4\n      : (firstByte > 0xDF) ? 3\n      : (firstByte > 0xBF) ? 2\n      : 1\n\n    if (i + bytesPerSequence <= end) {\n      var secondByte, thirdByte, fourthByte, tempCodePoint\n\n      switch (bytesPerSequence) {\n        case 1:\n          if (firstByte < 0x80) {\n            codePoint = firstByte\n          }\n          break\n        case 2:\n          secondByte = buf[i + 1]\n          if ((secondByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)\n            if (tempCodePoint > 0x7F) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 3:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)\n            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 4:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          fourthByte = buf[i + 3]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)\n            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {\n              codePoint = tempCodePoint\n            }\n          }\n      }\n    }\n\n    if (codePoint === null) {\n      // we did not generate a valid codePoint so insert a\n      // replacement char (U+FFFD) and advance only 1 byte\n      codePoint = 0xFFFD\n      bytesPerSequence = 1\n    } else if (codePoint > 0xFFFF) {\n      // encode to utf16 (surrogate pair dance)\n      codePoint -= 0x10000\n      res.push(codePoint >>> 10 & 0x3FF | 0xD800)\n      codePoint = 0xDC00 | codePoint & 0x3FF\n    }\n\n    res.push(codePoint)\n    i += bytesPerSequence\n  }\n\n  return decodeCodePointsArray(res)\n}\n\n// Based on http://stackoverflow.com/a/22747272/680742, the browser with\n// the lowest limit is Chrome, with 0x10000 args.\n// We go 1 magnitude less, for safety\nvar MAX_ARGUMENTS_LENGTH = 0x1000\n\nfunction decodeCodePointsArray (codePoints) {\n  var len = codePoints.length\n  if (len <= MAX_ARGUMENTS_LENGTH) {\n    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()\n  }\n\n  // Decode in chunks to avoid \"call stack size exceeded\".\n  var res = ''\n  var i = 0\n  while (i < len) {\n    res += String.fromCharCode.apply(\n      String,\n      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)\n    )\n  }\n  return res\n}\n\nfunction asciiSlice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i] & 0x7F)\n  }\n  return ret\n}\n\nfunction latin1Slice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i])\n  }\n  return ret\n}\n\nfunction hexSlice (buf, start, end) {\n  var len = buf.length\n\n  if (!start || start < 0) start = 0\n  if (!end || end < 0 || end > len) end = len\n\n  var out = ''\n  for (var i = start; i < end; ++i) {\n    out += toHex(buf[i])\n  }\n  return out\n}\n\nfunction utf16leSlice (buf, start, end) {\n  var bytes = buf.slice(start, end)\n  var res = ''\n  for (var i = 0; i < bytes.length; i += 2) {\n    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)\n  }\n  return res\n}\n\nBuffer.prototype.slice = function slice (start, end) {\n  var len = this.length\n  start = ~~start\n  end = end === undefined ? len : ~~end\n\n  if (start < 0) {\n    start += len\n    if (start < 0) start = 0\n  } else if (start > len) {\n    start = len\n  }\n\n  if (end < 0) {\n    end += len\n    if (end < 0) end = 0\n  } else if (end > len) {\n    end = len\n  }\n\n  if (end < start) end = start\n\n  var newBuf\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    newBuf = this.subarray(start, end)\n    newBuf.__proto__ = Buffer.prototype\n  } else {\n    var sliceLen = end - start\n    newBuf = new Buffer(sliceLen, undefined)\n    for (var i = 0; i < sliceLen; ++i) {\n      newBuf[i] = this[i + start]\n    }\n  }\n\n  return newBuf\n}\n\n/*\n * Need to make sure that buffer isn't trying to write out of bounds.\n */\nfunction checkOffset (offset, ext, length) {\n  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')\n  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')\n}\n\nBuffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    checkOffset(offset, byteLength, this.length)\n  }\n\n  var val = this[offset + --byteLength]\n  var mul = 1\n  while (byteLength > 0 && (mul *= 0x100)) {\n    val += this[offset + --byteLength] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  return this[offset]\n}\n\nBuffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return this[offset] | (this[offset + 1] << 8)\n}\n\nBuffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return (this[offset] << 8) | this[offset + 1]\n}\n\nBuffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return ((this[offset]) |\n      (this[offset + 1] << 8) |\n      (this[offset + 2] << 16)) +\n      (this[offset + 3] * 0x1000000)\n}\n\nBuffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] * 0x1000000) +\n    ((this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    this[offset + 3])\n}\n\nBuffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var i = byteLength\n  var mul = 1\n  var val = this[offset + --i]\n  while (i > 0 && (mul *= 0x100)) {\n    val += this[offset + --i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readInt8 = function readInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  if (!(this[offset] & 0x80)) return (this[offset])\n  return ((0xff - this[offset] + 1) * -1)\n}\n\nBuffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset] | (this[offset + 1] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset + 1] | (this[offset] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset]) |\n    (this[offset + 1] << 8) |\n    (this[offset + 2] << 16) |\n    (this[offset + 3] << 24)\n}\n\nBuffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] << 24) |\n    (this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    (this[offset + 3])\n}\n\nBuffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, true, 23, 4)\n}\n\nBuffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, false, 23, 4)\n}\n\nBuffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, true, 52, 8)\n}\n\nBuffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, false, 52, 8)\n}\n\nfunction checkInt (buf, value, offset, ext, max, min) {\n  if (!Buffer.isBuffer(buf)) throw new TypeError('\"buffer\" argument must be a Buffer instance')\n  if (value > max || value < min) throw new RangeError('\"value\" argument is out of bounds')\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n}\n\nBuffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var mul = 1\n  var i = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nfunction objectWriteUInt16 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; ++i) {\n    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>\n      (littleEndian ? i : 1 - i) * 8\n  }\n}\n\nBuffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nfunction objectWriteUInt32 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffffffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; ++i) {\n    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff\n  }\n}\n\nBuffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset + 3] = (value >>> 24)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 1] = (value >>> 8)\n    this[offset] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = 0\n  var mul = 1\n  var sub = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  var sub = 0\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  if (value < 0) value = 0xff + value + 1\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nBuffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 3] = (value >>> 24)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (value < 0) value = 0xffffffff + value + 1\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nfunction checkIEEE754 (buf, value, offset, ext, max, min) {\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n  if (offset < 0) throw new RangeError('Index out of range')\n}\n\nfunction writeFloat (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 23, 4)\n  return offset + 4\n}\n\nBuffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, false, noAssert)\n}\n\nfunction writeDouble (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 52, 8)\n  return offset + 8\n}\n\nBuffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, false, noAssert)\n}\n\n// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)\nBuffer.prototype.copy = function copy (target, targetStart, start, end) {\n  if (!start) start = 0\n  if (!end && end !== 0) end = this.length\n  if (targetStart >= target.length) targetStart = target.length\n  if (!targetStart) targetStart = 0\n  if (end > 0 && end < start) end = start\n\n  // Copy 0 bytes; we're done\n  if (end === start) return 0\n  if (target.length === 0 || this.length === 0) return 0\n\n  // Fatal error conditions\n  if (targetStart < 0) {\n    throw new RangeError('targetStart out of bounds')\n  }\n  if (start < 0 || start >= this.length) throw new RangeError('sourceStart out of bounds')\n  if (end < 0) throw new RangeError('sourceEnd out of bounds')\n\n  // Are we oob?\n  if (end > this.length) end = this.length\n  if (target.length - targetStart < end - start) {\n    end = target.length - targetStart + start\n  }\n\n  var len = end - start\n  var i\n\n  if (this === target && start < targetStart && targetStart < end) {\n    // descending copy from end\n    for (i = len - 1; i >= 0; --i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else if (len < 1000 || !Buffer.TYPED_ARRAY_SUPPORT) {\n    // ascending copy from start\n    for (i = 0; i < len; ++i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else {\n    Uint8Array.prototype.set.call(\n      target,\n      this.subarray(start, start + len),\n      targetStart\n    )\n  }\n\n  return len\n}\n\n// Usage:\n//    buffer.fill(number[, offset[, end]])\n//    buffer.fill(buffer[, offset[, end]])\n//    buffer.fill(string[, offset[, end]][, encoding])\nBuffer.prototype.fill = function fill (val, start, end, encoding) {\n  // Handle string cases:\n  if (typeof val === 'string') {\n    if (typeof start === 'string') {\n      encoding = start\n      start = 0\n      end = this.length\n    } else if (typeof end === 'string') {\n      encoding = end\n      end = this.length\n    }\n    if (val.length === 1) {\n      var code = val.charCodeAt(0)\n      if (code < 256) {\n        val = code\n      }\n    }\n    if (encoding !== undefined && typeof encoding !== 'string') {\n      throw new TypeError('encoding must be a string')\n    }\n    if (typeof encoding === 'string' && !Buffer.isEncoding(encoding)) {\n      throw new TypeError('Unknown encoding: ' + encoding)\n    }\n  } else if (typeof val === 'number') {\n    val = val & 255\n  }\n\n  // Invalid ranges are not set to a default, so can range check early.\n  if (start < 0 || this.length < start || this.length < end) {\n    throw new RangeError('Out of range index')\n  }\n\n  if (end <= start) {\n    return this\n  }\n\n  start = start >>> 0\n  end = end === undefined ? this.length : end >>> 0\n\n  if (!val) val = 0\n\n  var i\n  if (typeof val === 'number') {\n    for (i = start; i < end; ++i) {\n      this[i] = val\n    }\n  } else {\n    var bytes = Buffer.isBuffer(val)\n      ? val\n      : utf8ToBytes(new Buffer(val, encoding).toString())\n    var len = bytes.length\n    for (i = 0; i < end - start; ++i) {\n      this[i + start] = bytes[i % len]\n    }\n  }\n\n  return this\n}\n\n// HELPER FUNCTIONS\n// ================\n\nvar INVALID_BASE64_RE = /[^+\\/0-9A-Za-z-_]/g\n\nfunction base64clean (str) {\n  // Node strips out invalid characters like \\n and \\t from the string, base64-js does not\n  str = stringtrim(str).replace(INVALID_BASE64_RE, '')\n  // Node converts strings with length < 2 to ''\n  if (str.length < 2) return ''\n  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not\n  while (str.length % 4 !== 0) {\n    str = str + '='\n  }\n  return str\n}\n\nfunction stringtrim (str) {\n  if (str.trim) return str.trim()\n  return str.replace(/^\\s+|\\s+$/g, '')\n}\n\nfunction toHex (n) {\n  if (n < 16) return '0' + n.toString(16)\n  return n.toString(16)\n}\n\nfunction utf8ToBytes (string, units) {\n  units = units || Infinity\n  var codePoint\n  var length = string.length\n  var leadSurrogate = null\n  var bytes = []\n\n  for (var i = 0; i < length; ++i) {\n    codePoint = string.charCodeAt(i)\n\n    // is surrogate component\n    if (codePoint > 0xD7FF && codePoint < 0xE000) {\n      // last char was a lead\n      if (!leadSurrogate) {\n        // no lead yet\n        if (codePoint > 0xDBFF) {\n          // unexpected trail\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        } else if (i + 1 === length) {\n          // unpaired lead\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        }\n\n        // valid lead\n        leadSurrogate = codePoint\n\n        continue\n      }\n\n      // 2 leads in a row\n      if (codePoint < 0xDC00) {\n        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n        leadSurrogate = codePoint\n        continue\n      }\n\n      // valid surrogate pair\n      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000\n    } else if (leadSurrogate) {\n      // valid bmp char, but last char was a lead\n      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n    }\n\n    leadSurrogate = null\n\n    // encode utf8\n    if (codePoint < 0x80) {\n      if ((units -= 1) < 0) break\n      bytes.push(codePoint)\n    } else if (codePoint < 0x800) {\n      if ((units -= 2) < 0) break\n      bytes.push(\n        codePoint >> 0x6 | 0xC0,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x10000) {\n      if ((units -= 3) < 0) break\n      bytes.push(\n        codePoint >> 0xC | 0xE0,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x110000) {\n      if ((units -= 4) < 0) break\n      bytes.push(\n        codePoint >> 0x12 | 0xF0,\n        codePoint >> 0xC & 0x3F | 0x80,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else {\n      throw new Error('Invalid code point')\n    }\n  }\n\n  return bytes\n}\n\nfunction asciiToBytes (str) {\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    // Node's code seems to be doing this and not & 0x7F..\n    byteArray.push(str.charCodeAt(i) & 0xFF)\n  }\n  return byteArray\n}\n\nfunction utf16leToBytes (str, units) {\n  var c, hi, lo\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    if ((units -= 2) < 0) break\n\n    c = str.charCodeAt(i)\n    hi = c >> 8\n    lo = c % 256\n    byteArray.push(lo)\n    byteArray.push(hi)\n  }\n\n  return byteArray\n}\n\nfunction base64ToBytes (str) {\n  return base64.toByteArray(base64clean(str))\n}\n\nfunction blitBuffer (src, dst, offset, length) {\n  for (var i = 0; i < length; ++i) {\n    if ((i + offset >= dst.length) || (i >= src.length)) break\n    dst[i + offset] = src[i]\n  }\n  return i\n}\n\nfunction isnan (val) {\n  return val !== val // eslint-disable-line no-self-compare\n}\n","'use strict'\n\nexports.byteLength = byteLength\nexports.toByteArray = toByteArray\nexports.fromByteArray = fromByteArray\n\nvar lookup = []\nvar revLookup = []\nvar Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array\n\nvar code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\nfor (var i = 0, len = code.length; i < len; ++i) {\n  lookup[i] = code[i]\n  revLookup[code.charCodeAt(i)] = i\n}\n\n// Support decoding URL-safe base64 strings, as Node.js does.\n// See: https://en.wikipedia.org/wiki/Base64#URL_applications\nrevLookup['-'.charCodeAt(0)] = 62\nrevLookup['_'.charCodeAt(0)] = 63\n\nfunction getLens (b64) {\n  var len = b64.length\n\n  if (len % 4 > 0) {\n    throw new Error('Invalid string. Length must be a multiple of 4')\n  }\n\n  // Trim off extra bytes after placeholder bytes are found\n  // See: https://github.com/beatgammit/base64-js/issues/42\n  var validLen = b64.indexOf('=')\n  if (validLen === -1) validLen = len\n\n  var placeHoldersLen = validLen === len\n    ? 0\n    : 4 - (validLen % 4)\n\n  return [validLen, placeHoldersLen]\n}\n\n// base64 is 4/3 + up to two characters of the original data\nfunction byteLength (b64) {\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction _byteLength (b64, validLen, placeHoldersLen) {\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction toByteArray (b64) {\n  var tmp\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n\n  var arr = new Arr(_byteLength(b64, validLen, placeHoldersLen))\n\n  var curByte = 0\n\n  // if there are placeholders, only get up to the last complete 4 chars\n  var len = placeHoldersLen > 0\n    ? validLen - 4\n    : validLen\n\n  var i\n  for (i = 0; i < len; i += 4) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 18) |\n      (revLookup[b64.charCodeAt(i + 1)] << 12) |\n      (revLookup[b64.charCodeAt(i + 2)] << 6) |\n      revLookup[b64.charCodeAt(i + 3)]\n    arr[curByte++] = (tmp >> 16) & 0xFF\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 2) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 2) |\n      (revLookup[b64.charCodeAt(i + 1)] >> 4)\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 1) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 10) |\n      (revLookup[b64.charCodeAt(i + 1)] << 4) |\n      (revLookup[b64.charCodeAt(i + 2)] >> 2)\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  return arr\n}\n\nfunction tripletToBase64 (num) {\n  return lookup[num >> 18 & 0x3F] +\n    lookup[num >> 12 & 0x3F] +\n    lookup[num >> 6 & 0x3F] +\n    lookup[num & 0x3F]\n}\n\nfunction encodeChunk (uint8, start, end) {\n  var tmp\n  var output = []\n  for (var i = start; i < end; i += 3) {\n    tmp =\n      ((uint8[i] << 16) & 0xFF0000) +\n      ((uint8[i + 1] << 8) & 0xFF00) +\n      (uint8[i + 2] & 0xFF)\n    output.push(tripletToBase64(tmp))\n  }\n  return output.join('')\n}\n\nfunction fromByteArray (uint8) {\n  var tmp\n  var len = uint8.length\n  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes\n  var parts = []\n  var maxChunkLength = 16383 // must be multiple of 3\n\n  // go through the array every three bytes, we'll deal with trailing stuff later\n  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {\n    parts.push(encodeChunk(\n      uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)\n    ))\n  }\n\n  // pad the end with zeros, but make sure to not forget the extra bytes\n  if (extraBytes === 1) {\n    tmp = uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 2] +\n      lookup[(tmp << 4) & 0x3F] +\n      '=='\n    )\n  } else if (extraBytes === 2) {\n    tmp = (uint8[len - 2] << 8) + uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 10] +\n      lookup[(tmp >> 4) & 0x3F] +\n      lookup[(tmp << 2) & 0x3F] +\n      '='\n    )\n  }\n\n  return parts.join('')\n}\n","exports.read = function (buffer, offset, isLE, mLen, nBytes) {\n  var e, m\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var nBits = -7\n  var i = isLE ? (nBytes - 1) : 0\n  var d = isLE ? -1 : 1\n  var s = buffer[offset + i]\n\n  i += d\n\n  e = s & ((1 << (-nBits)) - 1)\n  s >>= (-nBits)\n  nBits += eLen\n  for (; nBits > 0; e = (e * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  m = e & ((1 << (-nBits)) - 1)\n  e >>= (-nBits)\n  nBits += mLen\n  for (; nBits > 0; m = (m * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  if (e === 0) {\n    e = 1 - eBias\n  } else if (e === eMax) {\n    return m ? NaN : ((s ? -1 : 1) * Infinity)\n  } else {\n    m = m + Math.pow(2, mLen)\n    e = e - eBias\n  }\n  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)\n}\n\nexports.write = function (buffer, value, offset, isLE, mLen, nBytes) {\n  var e, m, c\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)\n  var i = isLE ? 0 : (nBytes - 1)\n  var d = isLE ? 1 : -1\n  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0\n\n  value = Math.abs(value)\n\n  if (isNaN(value) || value === Infinity) {\n    m = isNaN(value) ? 1 : 0\n    e = eMax\n  } else {\n    e = Math.floor(Math.log(value) / Math.LN2)\n    if (value * (c = Math.pow(2, -e)) < 1) {\n      e--\n      c *= 2\n    }\n    if (e + eBias >= 1) {\n      value += rt / c\n    } else {\n      value += rt * Math.pow(2, 1 - eBias)\n    }\n    if (value * c >= 2) {\n      e++\n      c /= 2\n    }\n\n    if (e + eBias >= eMax) {\n      m = 0\n      e = eMax\n    } else if (e + eBias >= 1) {\n      m = ((value * c) - 1) * Math.pow(2, mLen)\n      e = e + eBias\n    } else {\n      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)\n      e = 0\n    }\n  }\n\n  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}\n\n  e = (e << mLen) | m\n  eLen += mLen\n  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}\n\n  buffer[offset + i - d] |= s * 128\n}\n","var toString = {}.toString;\n\nmodule.exports = Array.isArray || function (arr) {\n  return toString.call(arr) == '[object Array]';\n};\n","'use strict';\n\n//This code is extracted from ndarray-sort\n//It is inlined here as a temporary workaround\n\nmodule.exports = wrapper;\n\nvar INSERT_SORT_CUTOFF = 32\n\nfunction wrapper(data, n0) {\n  if (n0 <= 4*INSERT_SORT_CUTOFF) {\n    insertionSort(0, n0 - 1, data);\n  } else {\n    quickSort(0, n0 - 1, data);\n  }\n}\n\nfunction insertionSort(left, right, data) {\n  var ptr = 2*(left+1)\n  for(var i=left+1; i<=right; ++i) {\n    var a = data[ptr++]\n    var b = data[ptr++]\n    var j = i\n    var jptr = ptr-2\n    while(j-- > left) {\n      var x = data[jptr-2]\n      var y = data[jptr-1]\n      if(x < a) {\n        break\n      } else if(x === a && y < b) {\n        break\n      }\n      data[jptr]   = x\n      data[jptr+1] = y\n      jptr -= 2\n    }\n    data[jptr]   = a\n    data[jptr+1] = b\n  }\n}\n\nfunction swap(i, j, data) {\n  i *= 2\n  j *= 2\n  var x = data[i]\n  var y = data[i+1]\n  data[i] = data[j]\n  data[i+1] = data[j+1]\n  data[j] = x\n  data[j+1] = y\n}\n\nfunction move(i, j, data) {\n  i *= 2\n  j *= 2\n  data[i] = data[j]\n  data[i+1] = data[j+1]\n}\n\nfunction rotate(i, j, k, data) {\n  i *= 2\n  j *= 2\n  k *= 2\n  var x = data[i]\n  var y = data[i+1]\n  data[i] = data[j]\n  data[i+1] = data[j+1]\n  data[j] = data[k]\n  data[j+1] = data[k+1]\n  data[k] = x\n  data[k+1] = y\n}\n\nfunction shufflePivot(i, j, px, py, data) {\n  i *= 2\n  j *= 2\n  data[i] = data[j]\n  data[j] = px\n  data[i+1] = data[j+1]\n  data[j+1] = py\n}\n\nfunction compare(i, j, data) {\n  i *= 2\n  j *= 2\n  var x = data[i],\n      y = data[j]\n  if(x < y) {\n    return false\n  } else if(x === y) {\n    return data[i+1] > data[j+1]\n  }\n  return true\n}\n\nfunction comparePivot(i, y, b, data) {\n  i *= 2\n  var x = data[i]\n  if(x < y) {\n    return true\n  } else if(x === y) {\n    return data[i+1] < b\n  }\n  return false\n}\n\nfunction quickSort(left, right, data) {\n  var sixth = (right - left + 1) / 6 | 0, \n      index1 = left + sixth, \n      index5 = right - sixth, \n      index3 = left + right >> 1, \n      index2 = index3 - sixth, \n      index4 = index3 + sixth, \n      el1 = index1, \n      el2 = index2, \n      el3 = index3, \n      el4 = index4, \n      el5 = index5, \n      less = left + 1, \n      great = right - 1, \n      tmp = 0\n  if(compare(el1, el2, data)) {\n    tmp = el1\n    el1 = el2\n    el2 = tmp\n  }\n  if(compare(el4, el5, data)) {\n    tmp = el4\n    el4 = el5\n    el5 = tmp\n  }\n  if(compare(el1, el3, data)) {\n    tmp = el1\n    el1 = el3\n    el3 = tmp\n  }\n  if(compare(el2, el3, data)) {\n    tmp = el2\n    el2 = el3\n    el3 = tmp\n  }\n  if(compare(el1, el4, data)) {\n    tmp = el1\n    el1 = el4\n    el4 = tmp\n  }\n  if(compare(el3, el4, data)) {\n    tmp = el3\n    el3 = el4\n    el4 = tmp\n  }\n  if(compare(el2, el5, data)) {\n    tmp = el2\n    el2 = el5\n    el5 = tmp\n  }\n  if(compare(el2, el3, data)) {\n    tmp = el2\n    el2 = el3\n    el3 = tmp\n  }\n  if(compare(el4, el5, data)) {\n    tmp = el4\n    el4 = el5\n    el5 = tmp\n  }\n\n  var pivot1X = data[2*el2]\n  var pivot1Y = data[2*el2+1]\n  var pivot2X = data[2*el4]\n  var pivot2Y = data[2*el4+1]\n\n  var ptr0 = 2 * el1;\n  var ptr2 = 2 * el3;\n  var ptr4 = 2 * el5;\n  var ptr5 = 2 * index1;\n  var ptr6 = 2 * index3;\n  var ptr7 = 2 * index5;\n  for (var i1 = 0; i1 < 2; ++i1) {\n    var x = data[ptr0+i1];\n    var y = data[ptr2+i1];\n    var z = data[ptr4+i1];\n    data[ptr5+i1] = x;\n    data[ptr6+i1] = y;\n    data[ptr7+i1] = z;\n  }\n\n  move(index2, left, data)\n  move(index4, right, data)\n  for (var k = less; k <= great; ++k) {\n    if (comparePivot(k, pivot1X, pivot1Y, data)) {\n      if (k !== less) {\n        swap(k, less, data)\n      }\n      ++less;\n    } else {\n      if (!comparePivot(k, pivot2X, pivot2Y, data)) {\n        while (true) {\n          if (!comparePivot(great, pivot2X, pivot2Y, data)) {\n            if (--great < k) {\n              break;\n            }\n            continue;\n          } else {\n            if (comparePivot(great, pivot1X, pivot1Y, data)) {\n              rotate(k, less, great, data)\n              ++less;\n              --great;\n            } else {\n              swap(k, great, data)\n              --great;\n            }\n            break;\n          }\n        }\n      }\n    }\n  }\n  shufflePivot(left, less-1, pivot1X, pivot1Y, data)\n  shufflePivot(right, great+1, pivot2X, pivot2Y, data)\n  if (less - 2 - left <= INSERT_SORT_CUTOFF) {\n    insertionSort(left, less - 2, data);\n  } else {\n    quickSort(left, less - 2, data);\n  }\n  if (right - (great + 2) <= INSERT_SORT_CUTOFF) {\n    insertionSort(great + 2, right, data);\n  } else {\n    quickSort(great + 2, right, data);\n  }\n  if (great - less <= INSERT_SORT_CUTOFF) {\n    insertionSort(less, great, data);\n  } else {\n    quickSort(less, great, data);\n  }\n}","'use strict'\n\nmodule.exports = boxIntersectIter\n\nvar pool = require('typedarray-pool')\nvar bits = require('bit-twiddle')\nvar bruteForce = require('./brute')\nvar bruteForcePartial = bruteForce.partial\nvar bruteForceFull = bruteForce.full\nvar sweep = require('./sweep')\nvar findMedian = require('./median')\nvar genPartition = require('./partition')\n\n//Twiddle parameters\nvar BRUTE_FORCE_CUTOFF    = 128       //Cut off for brute force search\nvar SCAN_CUTOFF           = (1<<22)   //Cut off for two way scan\nvar SCAN_COMPLETE_CUTOFF  = (1<<22)  \n\n//Partition functions\nvar partitionInteriorContainsInterval = genPartition(\n  '!(lo>=p0)&&!(p1>=hi)', \n  ['p0', 'p1'])\n\nvar partitionStartEqual = genPartition(\n  'lo===p0',\n  ['p0'])\n\nvar partitionStartLessThan = genPartition(\n  'lo<p0',\n  ['p0'])\n\nvar partitionEndLessThanEqual = genPartition(\n  'hi<=p0',\n  ['p0'])\n\nvar partitionContainsPoint = genPartition(\n  'lo<=p0&&p0<=hi',\n  ['p0'])\n\nvar partitionContainsPointProper = genPartition(\n  'lo<p0&&p0<=hi',\n  ['p0'])\n\n//Frame size for iterative loop\nvar IFRAME_SIZE = 6\nvar DFRAME_SIZE = 2\n\n//Data for box statck\nvar INIT_CAPACITY = 1024\nvar BOX_ISTACK  = pool.mallocInt32(INIT_CAPACITY)\nvar BOX_DSTACK  = pool.mallocDouble(INIT_CAPACITY)\n\n//Initialize iterative loop queue\nfunction iterInit(d, count) {\n  var levels = (8 * bits.log2(count+1) * (d+1))|0\n  var maxInts = bits.nextPow2(IFRAME_SIZE*levels)\n  if(BOX_ISTACK.length < maxInts) {\n    pool.free(BOX_ISTACK)\n    BOX_ISTACK = pool.mallocInt32(maxInts)\n  }\n  var maxDoubles = bits.nextPow2(DFRAME_SIZE*levels)\n  if(BOX_DSTACK.length < maxDoubles) {\n    pool.free(BOX_DSTACK)\n    BOX_DSTACK = pool.mallocDouble(maxDoubles)\n  }\n}\n\n//Append item to queue\nfunction iterPush(ptr,\n  axis, \n  redStart, redEnd, \n  blueStart, blueEnd, \n  state, \n  lo, hi) {\n\n  var iptr = IFRAME_SIZE * ptr\n  BOX_ISTACK[iptr]   = axis\n  BOX_ISTACK[iptr+1] = redStart\n  BOX_ISTACK[iptr+2] = redEnd\n  BOX_ISTACK[iptr+3] = blueStart\n  BOX_ISTACK[iptr+4] = blueEnd\n  BOX_ISTACK[iptr+5] = state\n\n  var dptr = DFRAME_SIZE * ptr\n  BOX_DSTACK[dptr]   = lo\n  BOX_DSTACK[dptr+1] = hi\n}\n\n//Special case:  Intersect single point with list of intervals\nfunction onePointPartial(\n  d, axis, visit, flip,\n  redStart, redEnd, red, redIndex,\n  blueOffset, blue, blueId) {\n\n  var elemSize = 2 * d\n  var bluePtr  = blueOffset * elemSize\n  var blueX    = blue[bluePtr + axis]\n\nred_loop:\n  for(var i=redStart, redPtr=redStart*elemSize; i<redEnd; ++i, redPtr+=elemSize) {\n    var r0 = red[redPtr+axis]\n    var r1 = red[redPtr+axis+d]\n    if(blueX < r0 || r1 < blueX) {\n      continue\n    }\n    if(flip && blueX === r0) {\n      continue\n    }\n    var redId = redIndex[i]\n    for(var j=axis+1; j<d; ++j) {\n      var r0 = red[redPtr+j]\n      var r1 = red[redPtr+j+d]\n      var b0 = blue[bluePtr+j]\n      var b1 = blue[bluePtr+j+d]\n      if(r1 < b0 || b1 < r0) {\n        continue red_loop\n      }\n    }\n    var retval\n    if(flip) {\n      retval = visit(blueId, redId)\n    } else {\n      retval = visit(redId, blueId)\n    }\n    if(retval !== void 0) {\n      return retval\n    }\n  }\n}\n\n//Special case:  Intersect one point with list of intervals\nfunction onePointFull(\n  d, axis, visit,\n  redStart, redEnd, red, redIndex,\n  blueOffset, blue, blueId) {\n\n  var elemSize = 2 * d\n  var bluePtr  = blueOffset * elemSize\n  var blueX    = blue[bluePtr + axis]\n\nred_loop:\n  for(var i=redStart, redPtr=redStart*elemSize; i<redEnd; ++i, redPtr+=elemSize) {\n    var redId = redIndex[i]\n    if(redId === blueId) {\n      continue\n    }\n    var r0 = red[redPtr+axis]\n    var r1 = red[redPtr+axis+d]\n    if(blueX < r0 || r1 < blueX) {\n      continue\n    }\n    for(var j=axis+1; j<d; ++j) {\n      var r0 = red[redPtr+j]\n      var r1 = red[redPtr+j+d]\n      var b0 = blue[bluePtr+j]\n      var b1 = blue[bluePtr+j+d]\n      if(r1 < b0 || b1 < r0) {\n        continue red_loop\n      }\n    }\n    var retval = visit(redId, blueId)\n    if(retval !== void 0) {\n      return retval\n    }\n  }\n}\n\n//The main box intersection routine\nfunction boxIntersectIter(\n  d, visit, initFull,\n  xSize, xBoxes, xIndex,\n  ySize, yBoxes, yIndex) {\n\n  //Reserve memory for stack\n  iterInit(d, xSize + ySize)\n\n  var top  = 0\n  var elemSize = 2 * d\n  var retval\n\n  iterPush(top++,\n      0,\n      0, xSize,\n      0, ySize,\n      initFull ? 16 : 0, \n      -Infinity, Infinity)\n  if(!initFull) {\n    iterPush(top++,\n      0,\n      0, ySize,\n      0, xSize,\n      1, \n      -Infinity, Infinity)\n  }\n\n  while(top > 0) {\n    top  -= 1\n\n    var iptr = top * IFRAME_SIZE\n    var axis      = BOX_ISTACK[iptr]\n    var redStart  = BOX_ISTACK[iptr+1]\n    var redEnd    = BOX_ISTACK[iptr+2]\n    var blueStart = BOX_ISTACK[iptr+3]\n    var blueEnd   = BOX_ISTACK[iptr+4]\n    var state     = BOX_ISTACK[iptr+5]\n\n    var dptr = top * DFRAME_SIZE\n    var lo        = BOX_DSTACK[dptr]\n    var hi        = BOX_DSTACK[dptr+1]\n\n    //Unpack state info\n    var flip      = (state & 1)\n    var full      = !!(state & 16)\n\n    //Unpack indices\n    var red       = xBoxes\n    var redIndex  = xIndex\n    var blue      = yBoxes\n    var blueIndex = yIndex\n    if(flip) {\n      red         = yBoxes\n      redIndex    = yIndex\n      blue        = xBoxes\n      blueIndex   = xIndex\n    }\n\n    if(state & 2) {\n      redEnd = partitionStartLessThan(\n        d, axis,\n        redStart, redEnd, red, redIndex,\n        hi)\n      if(redStart >= redEnd) {\n        continue\n      }\n    }\n    if(state & 4) {\n      redStart = partitionEndLessThanEqual(\n        d, axis,\n        redStart, redEnd, red, redIndex,\n        lo)\n      if(redStart >= redEnd) {\n        continue\n      }\n    }\n    \n    var redCount  = redEnd  - redStart\n    var blueCount = blueEnd - blueStart\n\n    if(full) {\n      if(d * redCount * (redCount + blueCount) < SCAN_COMPLETE_CUTOFF) {\n        retval = sweep.scanComplete(\n          d, axis, visit, \n          redStart, redEnd, red, redIndex,\n          blueStart, blueEnd, blue, blueIndex)\n        if(retval !== void 0) {\n          return retval\n        }\n        continue\n      }\n    } else {\n      if(d * Math.min(redCount, blueCount) < BRUTE_FORCE_CUTOFF) {\n        //If input small, then use brute force\n        retval = bruteForcePartial(\n            d, axis, visit, flip,\n            redStart,  redEnd,  red,  redIndex,\n            blueStart, blueEnd, blue, blueIndex)\n        if(retval !== void 0) {\n          return retval\n        }\n        continue\n      } else if(d * redCount * blueCount < SCAN_CUTOFF) {\n        //If input medium sized, then use sweep and prune\n        retval = sweep.scanBipartite(\n          d, axis, visit, flip, \n          redStart, redEnd, red, redIndex,\n          blueStart, blueEnd, blue, blueIndex)\n        if(retval !== void 0) {\n          return retval\n        }\n        continue\n      }\n    }\n    \n    //First, find all red intervals whose interior contains (lo,hi)\n    var red0 = partitionInteriorContainsInterval(\n      d, axis, \n      redStart, redEnd, red, redIndex,\n      lo, hi)\n\n    //Lower dimensional case\n    if(redStart < red0) {\n\n      if(d * (red0 - redStart) < BRUTE_FORCE_CUTOFF) {\n        //Special case for small inputs: use brute force\n        retval = bruteForceFull(\n          d, axis+1, visit,\n          redStart, red0, red, redIndex,\n          blueStart, blueEnd, blue, blueIndex)\n        if(retval !== void 0) {\n          return retval\n        }\n      } else if(axis === d-2) {\n        if(flip) {\n          retval = sweep.sweepBipartite(\n            d, visit,\n            blueStart, blueEnd, blue, blueIndex,\n            redStart, red0, red, redIndex)\n        } else {\n          retval = sweep.sweepBipartite(\n            d, visit,\n            redStart, red0, red, redIndex,\n            blueStart, blueEnd, blue, blueIndex)\n        }\n        if(retval !== void 0) {\n          return retval\n        }\n      } else {\n        iterPush(top++,\n          axis+1,\n          redStart, red0,\n          blueStart, blueEnd,\n          flip,\n          -Infinity, Infinity)\n        iterPush(top++,\n          axis+1,\n          blueStart, blueEnd,\n          redStart, red0,\n          flip^1,\n          -Infinity, Infinity)\n      }\n    }\n\n    //Divide and conquer phase\n    if(red0 < redEnd) {\n\n      //Cut blue into 3 parts:\n      //\n      //  Points < mid point\n      //  Points = mid point\n      //  Points > mid point\n      //\n      var blue0 = findMedian(\n        d, axis, \n        blueStart, blueEnd, blue, blueIndex)\n      var mid = blue[elemSize * blue0 + axis]\n      var blue1 = partitionStartEqual(\n        d, axis,\n        blue0, blueEnd, blue, blueIndex,\n        mid)\n\n      //Right case\n      if(blue1 < blueEnd) {\n        iterPush(top++,\n          axis,\n          red0, redEnd,\n          blue1, blueEnd,\n          (flip|4) + (full ? 16 : 0),\n          mid, hi)\n      }\n\n      //Left case\n      if(blueStart < blue0) {\n        iterPush(top++,\n          axis,\n          red0, redEnd,\n          blueStart, blue0,\n          (flip|2) + (full ? 16 : 0),\n          lo, mid)\n      }\n\n      //Center case (the hard part)\n      if(blue0 + 1 === blue1) {\n        //Optimization: Range with exactly 1 point, use a brute force scan\n        if(full) {\n          retval = onePointFull(\n            d, axis, visit,\n            red0, redEnd, red, redIndex,\n            blue0, blue, blueIndex[blue0])\n        } else {\n          retval = onePointPartial(\n            d, axis, visit, flip,\n            red0, redEnd, red, redIndex,\n            blue0, blue, blueIndex[blue0])\n        }\n        if(retval !== void 0) {\n          return retval\n        }\n      } else if(blue0 < blue1) {\n        var red1\n        if(full) {\n          //If full intersection, need to handle special case\n          red1 = partitionContainsPoint(\n            d, axis,\n            red0, redEnd, red, redIndex,\n            mid)\n          if(red0 < red1) {\n            var redX = partitionStartEqual(\n              d, axis,\n              red0, red1, red, redIndex,\n              mid)\n            if(axis === d-2) {\n              //Degenerate sweep intersection:\n              //  [red0, redX] with [blue0, blue1]\n              if(red0 < redX) {\n                retval = sweep.sweepComplete(\n                  d, visit,\n                  red0, redX, red, redIndex,\n                  blue0, blue1, blue, blueIndex)\n                if(retval !== void 0) {\n                  return retval\n                }\n              }\n\n              //Normal sweep intersection:\n              //  [redX, red1] with [blue0, blue1]\n              if(redX < red1) {\n                retval = sweep.sweepBipartite(\n                  d, visit,\n                  redX, red1, red, redIndex,\n                  blue0, blue1, blue, blueIndex)\n                if(retval !== void 0) {\n                  return retval\n                }\n              }\n            } else {\n              if(red0 < redX) {\n                iterPush(top++,\n                  axis+1,\n                  red0, redX,\n                  blue0, blue1,\n                  16,\n                  -Infinity, Infinity)\n              }\n              if(redX < red1) {\n                iterPush(top++,\n                  axis+1,\n                  redX, red1,\n                  blue0, blue1,\n                  0,\n                  -Infinity, Infinity)\n                iterPush(top++,\n                  axis+1,\n                  blue0, blue1,\n                  redX, red1,\n                  1,\n                  -Infinity, Infinity)\n              }\n            }\n          }\n        } else {\n          if(flip) {\n            red1 = partitionContainsPointProper(\n              d, axis,\n              red0, redEnd, red, redIndex,\n              mid)\n          } else {\n            red1 = partitionContainsPoint(\n              d, axis,\n              red0, redEnd, red, redIndex,\n              mid)\n          }\n          if(red0 < red1) {\n            if(axis === d-2) {\n              if(flip) {\n                retval = sweep.sweepBipartite(\n                  d, visit,\n                  blue0, blue1, blue, blueIndex,\n                  red0, red1, red, redIndex)\n              } else {\n                retval = sweep.sweepBipartite(\n                  d, visit,\n                  red0, red1, red, redIndex,\n                  blue0, blue1, blue, blueIndex)\n              }\n            } else {\n              iterPush(top++,\n                axis+1,\n                red0, red1,\n                blue0, blue1,\n                flip,\n                -Infinity, Infinity)\n              iterPush(top++,\n                axis+1,\n                blue0, blue1,\n                red0, red1,\n                flip^1,\n                -Infinity, Infinity)\n            }\n          }\n        }\n      }\n    }\n  }\n}","'use strict'\n\nvar DIMENSION   = 'd'\nvar AXIS        = 'ax'\nvar VISIT       = 'vv'\nvar FLIP        = 'fp'\n\nvar ELEM_SIZE   = 'es'\n\nvar RED_START   = 'rs'\nvar RED_END     = 're'\nvar RED_BOXES   = 'rb'\nvar RED_INDEX   = 'ri'\nvar RED_PTR     = 'rp'\n\nvar BLUE_START  = 'bs'\nvar BLUE_END    = 'be'\nvar BLUE_BOXES  = 'bb'\nvar BLUE_INDEX  = 'bi'\nvar BLUE_PTR    = 'bp'\n\nvar RETVAL      = 'rv'\n\nvar INNER_LABEL = 'Q'\n\nvar ARGS = [\n  DIMENSION,\n  AXIS,\n  VISIT,\n  RED_START,\n  RED_END,\n  RED_BOXES,\n  RED_INDEX,\n  BLUE_START,\n  BLUE_END,\n  BLUE_BOXES,\n  BLUE_INDEX\n]\n\nfunction generateBruteForce(redMajor, flip, full) {\n  var funcName = 'bruteForce' + \n    (redMajor ? 'Red' : 'Blue') + \n    (flip ? 'Flip' : '') +\n    (full ? 'Full' : '')\n\n  var code = ['function ', funcName, '(', ARGS.join(), '){',\n    'var ', ELEM_SIZE, '=2*', DIMENSION, ';']\n\n  var redLoop = \n    'for(var i=' + RED_START + ',' + RED_PTR + '=' + ELEM_SIZE + '*' + RED_START + ';' +\n        'i<' + RED_END +';' +\n        '++i,' + RED_PTR + '+=' + ELEM_SIZE + '){' +\n        'var x0=' + RED_BOXES + '[' + AXIS + '+' + RED_PTR + '],' +\n            'x1=' + RED_BOXES + '[' + AXIS + '+' + RED_PTR + '+' + DIMENSION + '],' +\n            'xi=' + RED_INDEX + '[i];'\n\n  var blueLoop = \n    'for(var j=' + BLUE_START + ',' + BLUE_PTR + '=' + ELEM_SIZE + '*' + BLUE_START + ';' +\n        'j<' + BLUE_END + ';' +\n        '++j,' + BLUE_PTR + '+=' + ELEM_SIZE + '){' +\n        'var y0=' + BLUE_BOXES + '[' + AXIS + '+' + BLUE_PTR + '],' +\n            (full ? 'y1=' + BLUE_BOXES + '[' + AXIS + '+' + BLUE_PTR + '+' + DIMENSION + '],' : '') +\n            'yi=' + BLUE_INDEX + '[j];'\n\n  if(redMajor) {\n    code.push(redLoop, INNER_LABEL, ':', blueLoop)\n  } else {\n    code.push(blueLoop, INNER_LABEL, ':', redLoop)\n  }\n\n  if(full) {\n    code.push('if(y1<x0||x1<y0)continue;')\n  } else if(flip) {\n    code.push('if(y0<=x0||x1<y0)continue;')\n  } else {\n    code.push('if(y0<x0||x1<y0)continue;')\n  }\n\n  code.push('for(var k='+AXIS+'+1;k<'+DIMENSION+';++k){'+\n    'var r0='+RED_BOXES+'[k+'+RED_PTR+'],'+\n        'r1='+RED_BOXES+'[k+'+DIMENSION+'+'+RED_PTR+'],'+\n        'b0='+BLUE_BOXES+'[k+'+BLUE_PTR+'],'+\n        'b1='+BLUE_BOXES+'[k+'+DIMENSION+'+'+BLUE_PTR+'];'+\n      'if(r1<b0||b1<r0)continue ' + INNER_LABEL + ';}' +\n      'var ' + RETVAL + '=' + VISIT + '(')\n\n  if(flip) {\n    code.push('yi,xi')\n  } else {\n    code.push('xi,yi')\n  }\n\n  code.push(');if(' + RETVAL + '!==void 0)return ' + RETVAL + ';}}}')\n\n  return {\n    name: funcName, \n    code: code.join('')\n  }\n}\n\nfunction bruteForcePlanner(full) {\n  var funcName = 'bruteForce' + (full ? 'Full' : 'Partial')\n  var prefix = []\n  var fargs = ARGS.slice()\n  if(!full) {\n    fargs.splice(3, 0, FLIP)\n  }\n\n  var code = ['function ' + funcName + '(' + fargs.join() + '){']\n\n  function invoke(redMajor, flip) {\n    var res = generateBruteForce(redMajor, flip, full)\n    prefix.push(res.code)\n    code.push('return ' + res.name + '(' + ARGS.join() + ');')\n  }\n\n  code.push('if(' + RED_END + '-' + RED_START + '>' +\n                    BLUE_END + '-' + BLUE_START + '){')\n\n  if(full) {\n    invoke(true, false)\n    code.push('}else{')\n    invoke(false, false)\n  } else {\n    code.push('if(' + FLIP + '){')\n    invoke(true, true)\n    code.push('}else{')\n    invoke(true, false)\n    code.push('}}else{if(' + FLIP + '){')\n    invoke(false, true)\n    code.push('}else{')\n    invoke(false, false)\n    code.push('}')\n  }\n  code.push('}}return ' + funcName)\n\n  var codeStr = prefix.join('') + code.join('')\n  var proc = new Function(codeStr)\n  return proc()\n}\n\n\nexports.partial = bruteForcePlanner(false)\nexports.full    = bruteForcePlanner(true)","'use strict'\n\nmodule.exports = findMedian\n\nvar genPartition = require('./partition')\n\nvar partitionStartLessThan = genPartition('lo<p0', ['p0'])\n\nvar PARTITION_THRESHOLD = 8   //Cut off for using insertion sort in findMedian\n\n//Base case for median finding:  Use insertion sort\nfunction insertionSort(d, axis, start, end, boxes, ids) {\n  var elemSize = 2 * d\n  var boxPtr = elemSize * (start+1) + axis\n  for(var i=start+1; i<end; ++i, boxPtr+=elemSize) {\n    var x = boxes[boxPtr]\n    for(var j=i, ptr=elemSize*(i-1); \n        j>start && boxes[ptr+axis] > x; \n        --j, ptr-=elemSize) {\n      //Swap\n      var aPtr = ptr\n      var bPtr = ptr+elemSize\n      for(var k=0; k<elemSize; ++k, ++aPtr, ++bPtr) {\n        var y = boxes[aPtr]\n        boxes[aPtr] = boxes[bPtr]\n        boxes[bPtr] = y\n      }\n      var tmp = ids[j]\n      ids[j] = ids[j-1]\n      ids[j-1] = tmp\n    }\n  }\n}\n\n//Find median using quick select algorithm\n//  takes O(n) time with high probability\nfunction findMedian(d, axis, start, end, boxes, ids) {\n  if(end <= start+1) {\n    return start\n  }\n\n  var lo       = start\n  var hi       = end\n  var mid      = ((end + start) >>> 1)\n  var elemSize = 2*d\n  var pivot    = mid\n  var value    = boxes[elemSize*mid+axis]\n  \n  while(lo < hi) {\n    if(hi - lo < PARTITION_THRESHOLD) {\n      insertionSort(d, axis, lo, hi, boxes, ids)\n      value = boxes[elemSize*mid+axis]\n      break\n    }\n    \n    //Select pivot using median-of-3\n    var count  = hi - lo\n    var pivot0 = (Math.random()*count+lo)|0\n    var value0 = boxes[elemSize*pivot0 + axis]\n    var pivot1 = (Math.random()*count+lo)|0\n    var value1 = boxes[elemSize*pivot1 + axis]\n    var pivot2 = (Math.random()*count+lo)|0\n    var value2 = boxes[elemSize*pivot2 + axis]\n    if(value0 <= value1) {\n      if(value2 >= value1) {\n        pivot = pivot1\n        value = value1\n      } else if(value0 >= value2) {\n        pivot = pivot0\n        value = value0\n      } else {\n        pivot = pivot2\n        value = value2\n      }\n    } else {\n      if(value1 >= value2) {\n        pivot = pivot1\n        value = value1\n      } else if(value2 >= value0) {\n        pivot = pivot0\n        value = value0\n      } else {\n        pivot = pivot2\n        value = value2\n      }\n    }\n\n    //Swap pivot to end of array\n    var aPtr = elemSize * (hi-1)\n    var bPtr = elemSize * pivot\n    for(var i=0; i<elemSize; ++i, ++aPtr, ++bPtr) {\n      var x = boxes[aPtr]\n      boxes[aPtr] = boxes[bPtr]\n      boxes[bPtr] = x\n    }\n    var y = ids[hi-1]\n    ids[hi-1] = ids[pivot]\n    ids[pivot] = y\n\n    //Partition using pivot\n    pivot = partitionStartLessThan(\n      d, axis, \n      lo, hi-1, boxes, ids,\n      value)\n\n    //Swap pivot back\n    var aPtr = elemSize * (hi-1)\n    var bPtr = elemSize * pivot\n    for(var i=0; i<elemSize; ++i, ++aPtr, ++bPtr) {\n      var x = boxes[aPtr]\n      boxes[aPtr] = boxes[bPtr]\n      boxes[bPtr] = x\n    }\n    var y = ids[hi-1]\n    ids[hi-1] = ids[pivot]\n    ids[pivot] = y\n\n    //Swap pivot to last pivot\n    if(mid < pivot) {\n      hi = pivot-1\n      while(lo < hi && \n        boxes[elemSize*(hi-1)+axis] === value) {\n        hi -= 1\n      }\n      hi += 1\n    } else if(pivot < mid) {\n      lo = pivot + 1\n      while(lo < hi &&\n        boxes[elemSize*lo+axis] === value) {\n        lo += 1\n      }\n    } else {\n      break\n    }\n  }\n\n  //Make sure pivot is at start\n  return partitionStartLessThan(\n    d, axis, \n    start, mid, boxes, ids,\n    boxes[elemSize*mid+axis])\n}","\n\nexport default function (noa) {\n    return {\n\n        name: 'collideTerrain',\n\n        order: 0,\n\n        state: {\n            callback: null\n        },\n\n        onAdd: function (eid, state) {\n            // add collide handler for physics engine to call\n            var ents = noa.entities\n            if (ents.hasPhysics(eid)) {\n                var body = ents.getPhysicsBody(eid)\n                body.onCollide = function bodyOnCollide(impulse) {\n                    var cb = noa.ents.getCollideTerrain(eid).callback\n                    if (cb) cb(impulse, eid)\n                }\n            }\n        },\n\n        onRemove: function (eid, state) {\n            var ents = noa.entities\n            if (ents.hasPhysics(eid)) {\n                ents.getPhysicsBody(eid).onCollide = null\n            }\n        },\n\n\n\n    }\n}\n","\n/**\n * Component for the player entity, when active hides the player's mesh \n * when camera zoom is less than a certain amount\n */\n\nexport default function (noa) {\n    return {\n\n        name: 'fadeOnZoom',\n\n        order: 99,\n\n        state: {\n            cutoff: 1.5,\n            _showing: true\n        },\n\n        onAdd: null,\n\n        onRemove: null,\n\n        system: function fadeOnZoomProc(dt, states) {\n            var zoom = noa.camera.currentZoom\n            var ents = noa.entities\n            states.forEach(state => {\n                checkZoom(state, state.__id, zoom, ents)\n            })\n        }\n    }\n}\n\n\nfunction checkZoom(state, id, zoom, ents) {\n    if (!ents.hasMesh(id)) return\n\n    if (state._showing && zoom < state.cutoff || !state._showing && zoom > state.cutoff) {\n        var mesh = ents.getMeshData(id).mesh\n        mesh.visibility = state._showing = (zoom > state.cutoff)\n    }\n}\n","var vec3 = require('gl-vec3')\n\n\n/*\n * Indicates that an entity should be moved to another entity's position each tick,\n * possibly by a fixed offset, and the same for renderPositions each render\n */\n\nexport default function (noa) {\n\n    return {\n\n        name: 'followsEntity',\n\n        order: 50,\n\n        state: {\n            entity: 0 | 0,\n            offset: null,\n        },\n\n        onAdd: function (eid, state) {\n            var off = vec3.create()\n            state.offset = (state.offset) ? vec3.copy(off, state.offset) : off\n            updatePosition(state)\n            updateRenderPosition(state)\n        },\n\n        onRemove: null,\n\n\n        // on tick, copy over regular positions\n        system: function followEntity(dt, states) {\n            states.forEach(state => updatePosition(state))\n        },\n\n\n        // on render, copy over render positions\n        renderSystem: function followEntityMesh(dt, states) {\n            states.forEach(state => updateRenderPosition(state))\n        }\n    }\n\n\n\n    function updatePosition(state) {\n        var id = state.__id\n        var self = noa.ents.getPositionData(id)\n        var other = noa.ents.getPositionData(state.entity)\n        if (!other) {\n            return noa.ents.removeComponent(id, noa.ents.names.followsEntity)\n        }\n        vec3.add(self._localPosition, other._localPosition, state.offset)\n    }\n    \n    function updateRenderPosition(state) {\n        var id = state.__id\n        var self = noa.ents.getPositionData(id)\n        var other = noa.ents.getPositionData(state.entity)\n        if (!other) {\n            return noa.ents.removeComponent(id, noa.ents.names.followsEntity)\n        }\n        vec3.add(self._renderPosition, other._renderPosition, state.offset)\n    }\n\n}\n","\nvar vec3 = require('gl-vec3')\n\n\nexport default function (noa) {\n    return {\n\n        name: 'mesh',\n\n        order: 100,\n\n        state: {\n            mesh: null,\n            offset: null\n        },\n\n\n        onAdd: function (eid, state) {\n            // implicitly assume there's already a position component\n            var posDat = noa.ents.getPositionData(eid)\n            if (state.mesh) {\n                noa.rendering.addMeshToScene(state.mesh, false, posDat.position)\n            } else {\n                throw new Error('Mesh component added without a mesh - probably a bug!')\n            }\n            if (!state.offset) state.offset = new vec3.create()\n\n            // set mesh to correct position\n            var rpos = posDat._renderPosition\n            state.mesh.position.copyFromFloats(\n                rpos[0] + state.offset[0],\n                rpos[1] + state.offset[1],\n                rpos[2] + state.offset[2])\n        },\n\n\n        onRemove: function (eid, state) {\n            state.mesh.dispose()\n        },\n\n\n\n        renderSystem: function (dt, states) {\n            // before render move each mesh to its render position, \n            // set by the physics engine or driving logic\n\n            states.forEach(state => {\n                var id = state.__id\n\n                var rpos = noa.ents.getPositionData(id)._renderPosition\n                state.mesh.position.copyFromFloats(\n                    rpos[0] + state.offset[0],\n                    rpos[1] + state.offset[1],\n                    rpos[2] + state.offset[2])\n            })\n        }\n\n\n    }\n}\n","var vec3 = require('gl-vec3')\n\n/**\n * \n * Movement component. State stores settings like jump height, etc.,\n * as well as current state (running, jumping, heading angle).\n * Processor checks state and applies movement/friction/jump forces\n * to the entity's physics body. \n * \n */\n\nexport default function (noa) {\n    return {\n\n        name: 'movement',\n\n        order: 30,\n\n        state: {\n            // current state\n            heading: 0, // radians\n            running: false,\n            jumping: false,\n\n            // options:\n            maxSpeed: 10,\n            moveForce: 30,\n            responsiveness: 15,\n            runningFriction: 0,\n            standingFriction: 2,\n\n            airMoveMult: 0.5,\n            jumpImpulse: 10,\n            jumpForce: 12,\n            jumpTime: 500, // ms\n            airJumps: 1,\n\n            // internal state\n            _jumpCount: 0,\n            _isJumping: 0,\n            _currjumptime: 0,\n        },\n\n        onAdd: null,\n\n        onRemove: null,\n\n\n        system: function movementProcessor(dt, states) {\n            var ents = noa.entities\n\n            states.forEach(state => {\n                var body = ents.getPhysicsBody(state.__id)\n                applyMovementPhysics(dt, state, body)\n            })\n\n        }\n\n\n    }\n}\n\n\nvar tempvec = vec3.create()\nvar tempvec2 = vec3.create()\nvar zeroVec = vec3.create()\n\n\nfunction applyMovementPhysics(dt, state, body) {\n    // move implementation originally written as external module\n    //   see https://github.com/andyhall/voxel-fps-controller\n    //   for original code\n\n    // jumping\n    var onGround = (body.atRestY() < 0)\n    var canjump = (onGround || state._jumpCount < state.airJumps)\n    if (onGround) {\n        state._isJumping = false\n        state._jumpCount = 0\n    }\n\n    // process jump input\n    if (state.jumping) {\n        if (state._isJumping) { // continue previous jump\n            if (state._currjumptime > 0) {\n                var jf = state.jumpForce\n                if (state._currjumptime < dt) jf *= state._currjumptime / dt\n                body.applyForce([0, jf, 0])\n                state._currjumptime -= dt\n            }\n        } else if (canjump) { // start new jump\n            state._isJumping = true\n            if (!onGround) state._jumpCount++\n            state._currjumptime = state.jumpTime\n            body.applyImpulse([0, state.jumpImpulse, 0])\n            // clear downward velocity on airjump\n            if (!onGround && body.velocity[1] < 0) body.velocity[1] = 0\n        }\n    } else {\n        state._isJumping = false\n    }\n\n    // apply movement forces if entity is moving, otherwise just friction\n    var m = tempvec\n    var push = tempvec2\n    if (state.running) {\n\n        var speed = state.maxSpeed\n        // todo: add crouch/sprint modifiers if needed\n        // if (state.sprint) speed *= state.sprintMoveMult\n        // if (state.crouch) speed *= state.crouchMoveMult\n        vec3.set(m, 0, 0, speed)\n\n        // rotate move vector to entity's heading\n        vec3.rotateY(m, m, zeroVec, state.heading)\n\n        // push vector to achieve desired speed & dir\n        // following code to adjust 2D velocity to desired amount is patterned on Quake: \n        // https://github.com/id-Software/Quake-III-Arena/blob/master/code/game/bg_pmove.c#L275\n        vec3.subtract(push, m, body.velocity)\n        push[1] = 0\n        var pushLen = vec3.length(push)\n        vec3.normalize(push, push)\n\n        if (pushLen > 0) {\n            // pushing force vector\n            var canPush = state.moveForce\n            if (!onGround) canPush *= state.airMoveMult\n\n            // apply final force\n            var pushAmt = state.responsiveness * pushLen\n            if (canPush > pushAmt) canPush = pushAmt\n\n            vec3.scale(push, push, canPush)\n            body.applyForce(push)\n        }\n\n        // different friction when not moving\n        // idea from Sonic: http://info.sonicretro.org/SPG:Running\n        body.friction = state.runningFriction\n    } else {\n        body.friction = state.standingFriction\n    }\n\n\n\n}\n","\n/**\n * \n * Input processing component - gets (key) input state and  \n * applies it to receiving entities by updating their movement \n * component state (heading, movespeed, jumping, etc.)\n * \n */\n\nexport default function (noa) {\n    return {\n\n        name: 'receivesInputs',\n\n        order: 20,\n\n        state: {},\n\n        onAdd: null,\n\n        onRemove: null,\n\n        system: function inputProcessor(dt, states) {\n            var ents = noa.entities\n            var inputState = noa.inputs.state\n            var camHeading = noa.camera.heading\n\n            states.forEach(state => {\n                var moveState = ents.getMovement(state.__id)\n                setMovementState(moveState, inputState, camHeading)\n            })\n        }\n\n    }\n}\n\n\n\nfunction setMovementState(state, inputs, camHeading) {\n    state.jumping = !!inputs.jump\n\n    var fb = inputs.forward ? (inputs.backward ? 0 : 1) : (inputs.backward ? -1 : 0)\n    var rl = inputs.right ? (inputs.left ? 0 : 1) : (inputs.left ? -1 : 0)\n\n    if ((fb | rl) === 0) {\n        state.running = false\n    } else {\n        state.running = true\n        if (fb) {\n            if (fb == -1) camHeading += Math.PI\n            if (rl) {\n                camHeading += Math.PI / 4 * fb * rl // didn't plan this but it works!\n            }\n        } else {\n            camHeading += rl * Math.PI / 2\n        }\n        state.heading = camHeading\n    }\n\n}\n","\nimport { Mesh } from '@babylonjs/core/Meshes/mesh'\nimport { Color3 } from '@babylonjs/core/Maths/math'\nvar vec3 = require('gl-vec3')\n\n\nexport default function (noa, dist) {\n\n    var shadowDist = dist\n\n    // create a mesh to re-use for shadows\n    var scene = noa.rendering.getScene()\n    var disc = Mesh.CreateDisc('shadow', 0.75, 30, scene)\n    disc.rotation.x = Math.PI / 2\n    disc.material = noa.rendering.makeStandardMaterial('shadowMat')\n    disc.material.diffuseColor = Color3.Black()\n    disc.material.ambientColor = Color3.Black()\n    disc.material.alpha = 0.5\n    disc.setEnabled(false)\n\n    // source mesh needn't be in the scene graph\n    scene.removeMesh(disc)\n\n\n    return {\n\n        name: 'shadow',\n\n        order: 80,\n\n        state: {\n            size: 0.5,\n            _mesh: null,\n        },\n\n\n        onAdd: function (eid, state) {\n            var mesh = disc.createInstance('shadow_instance')\n            noa.rendering.addMeshToScene(mesh)\n            mesh.setEnabled(false)\n            state._mesh = mesh\n        },\n\n\n        onRemove: function (eid, state) {\n            state._mesh.dispose()\n        },\n\n\n        system: function shadowSystem(dt, states) {\n            var cpos = noa.camera._localGetPosition()\n            var dist = shadowDist\n            states.forEach(state => {\n                var posState = noa.ents.getPositionData(state.__id)\n                var physState = noa.ents.getPhysics(state.__id)\n                updateShadowHeight(noa, posState, physState, state._mesh, state.size, dist, cpos)\n            })\n        },\n\n\n        renderSystem: function (dt, states) {\n            // before render adjust shadow x/z to render positions\n            states.forEach(state => {\n                var rpos = noa.ents.getPositionData(state.__id)._renderPosition\n                var spos = state._mesh.position\n                spos.x = rpos[0]\n                spos.z = rpos[2]\n            })\n        }\n\n\n\n\n    }\n}\n\nvar shadowPos = vec3.fromValues(0, 0, 0)\nvar down = vec3.fromValues(0, -1, 0)\n\nfunction updateShadowHeight(noa, posDat, physDat, mesh, size, shadowDist, camPos) {\n\n    // local Y ground position - from physics or raycast\n    var localY\n    if (physDat && physDat.body.resting[1] < 0) {\n        localY = posDat._localPosition[1]\n    } else {\n        var res = noa._localPick(posDat._localPosition, down, shadowDist)\n        if (!res) {\n            mesh.setEnabled(false)\n            return\n        }\n        localY = res.position[1] - noa.worldOriginOffset[1]\n    }\n\n    // round Y pos and offset upwards slightly to avoid z-fighting\n    localY = Math.round(localY) \n    vec3.copy(shadowPos, posDat._localPosition)\n    shadowPos[1] = localY\n    var sqdist = vec3.squaredDistance(camPos, shadowPos)\n    // offset ~ 0.01 for nearby shadows, up to 0.1 at distance of ~40\n    var offset = 0.01 + 0.1 * (sqdist / 1600)\n    if (offset > 0.1) offset = 0.1\n    mesh.position.y = localY + offset\n    // set shadow scale\n    var dist = posDat._localPosition[1] - localY\n    var scale = size * 0.7 * (1 - dist / shadowDist)\n    mesh.scaling.copyFromFloats(scale, scale, scale)\n    mesh.setEnabled(true)\n}\n","\n\nexport default function (noa) {\n    return {\n\n        name: 'smooth-camera',\n\n        order: 99,\n\n        state: {\n            time: 100.1\n        },\n\n        onAdd: null,\n\n        onRemove: null,\n\n        system: function (dt, states) {\n            // remove self after time elapses\n            states.forEach(state => {\n                state.time -= dt\n                if (state.time < 0) noa.ents.removeComponent(state.__id, 'smooth-camera')\n            })\n        },\n\n    }\n}\n","\nvar createGameShell = require('game-shell')\n// var createGameShell = require('../../../../npm-modules/game-shell')\nvar EventEmitter = require('events').EventEmitter\n\n\nexport default function (noa, opts) {\n    return new Container(noa, opts)\n}\n\n/**\n * @class\n * @typicalname noa.container\n * @emits DOMready\n * @classdesc Wraps `game-shell` module \n * and manages HTML container, canvas, etc.\n */\n\nfunction Container(noa, opts) {\n    opts = opts || {}\n    this._noa = noa\n    this.element = opts.domElement || createContainerDiv()\n    this.canvas = getOrCreateCanvas(this.element)\n    this._shell = createShell(this.canvas, opts)\n\n    // mouse state/feature detection\n    this.hasPointerLock = false\n    this.supportsPointerLock = false\n    this.pointerInGame = false\n    this.isFocused = document.hasFocus()\n\n    // basic listeners\n    var self = this\n    var lockChange = function (ev) { onLockChange(self, ev) }\n    document.addEventListener(\"pointerlockchange\", lockChange, false)\n    document.addEventListener(\"mozpointerlockchange\", lockChange, false)\n    document.addEventListener(\"webkitpointerlockchange\", lockChange, false)\n    detectPointerLock(self)\n\n    self.element.addEventListener('mouseenter', function () { self.pointerInGame = true })\n    self.element.addEventListener('mouseleave', function () { self.pointerInGame = false })\n\n    window.addEventListener('focus', function () { self.isFocused = true })\n    window.addEventListener('blur', function () { self.isFocused = false })\n\n    // get shell events after it's initialized\n    this._shell.on('init', onShellInit.bind(null, this))\n}\n\nContainer.prototype = Object.create(EventEmitter.prototype)\n\n\n\n/*\n *   SHELL EVENTS\n */\n\nfunction onShellInit(self) {\n    // create shell listeners that drive engine functions\n    var noa = self._noa\n    var shell = self._shell\n    shell.on('tick', function onTick(n) { noa.tick(n) })\n    shell.on('render', function onRender(n) { noa.render(n) })\n    shell.on('resize', noa.rendering.resize.bind(noa.rendering))\n\n    // let other components know DOM is ready\n    self.emit('DOMready')\n}\n\n\n\n/*\n *   PUBLIC API \n */\n\nContainer.prototype.appendTo = function (htmlElement) {\n    this.element.appendChild(htmlElement)\n}\n\n\n\nContainer.prototype.setPointerLock = function (lock) {\n    // not sure if this will work robustly\n    this._shell.pointerLock = !!lock\n}\n\n\n\n\n\n/*\n *   INTERNALS\n */\n\n\n\nfunction createContainerDiv() {\n    // based on github.com/mikolalysenko/game-shell - makeDefaultContainer()\n    var container = document.createElement(\"div\")\n    container.tabindex = 1\n    container.style.position = \"fixed\"\n    container.style.left = \"0px\"\n    container.style.right = \"0px\"\n    container.style.top = \"0px\"\n    container.style.bottom = \"0px\"\n    container.style.height = \"100%\"\n    container.style.overflow = \"hidden\"\n    document.body.appendChild(container)\n    document.body.style.overflow = \"hidden\" //Prevent bounce\n    document.body.style.height = \"100%\"\n    container.id = 'noa-container'\n    return container\n}\n\n\nfunction createShell(canvas, opts) {\n    var shellDefaults = {\n        pointerLock: true,\n        preventDefaults: false\n    }\n    opts = Object.assign(shellDefaults, opts)\n    opts.element = canvas\n    var shell = createGameShell(opts)\n    shell.preventDefaults = opts.preventDefaults\n    return shell\n}\n\nfunction getOrCreateCanvas(el) {\n    // based on github.com/stackgl/gl-now - default canvas\n    var canvas = el.querySelector('canvas')\n    if (!canvas) {\n        canvas = document.createElement('canvas')\n        canvas.style.position = \"absolute\"\n        canvas.style.left = \"0px\"\n        canvas.style.top = \"0px\"\n        canvas.style.height = \"100%\"\n        canvas.style.width = \"100%\"\n        canvas.id = 'noa-canvas'\n        el.insertBefore(canvas, el.firstChild)\n    }\n    return canvas\n}\n\n\n// track changes in Pointer Lock state\nfunction onLockChange(self, ev) {\n    var el = document.pointerLockElement ||\n        document.mozPointerLockElement ||\n        document.webkitPointerLockElement\n    if (el) {\n        self.hasPointerLock = true\n        self.emit('gainedPointerLock')\n    } else {\n        self.hasPointerLock = false\n        self.emit('lostPointerLock')\n    }\n    // this works around a Firefox bug where no mouse-in event \n    // gets issued after starting pointerlock\n    if (el) {\n        // act as if pointer is in game window while pointerLock is true\n        self.pointerInGame = true\n    }\n}\n\n\n// set up stuff to detect pointer lock support.\n// Needlessly complex because Chrome/Android claims to support but doesn't.\n// For now, just feature detect, but assume no support if a touch event occurs\n// TODO: see if this makes sense on hybrid touch/mouse devices\nfunction detectPointerLock(self) {\n    var lockElementExists =\n        ('pointerLockElement' in document) ||\n        ('mozPointerLockElement' in document) ||\n        ('webkitPointerLockElement' in document)\n    if (lockElementExists) {\n        self.supportsPointerLock = true\n        var listener = function (e) {\n            self.supportsPointerLock = false\n            document.removeEventListener(e.type, listener)\n        }\n        document.addEventListener('touchmove', listener)\n    }\n}\n","\n\n// helper to swap item to end and pop(), instead of splice()ing\nexport function removeUnorderedListItem(list, item) {\n    var i = list.indexOf(item)\n    if (i < 0) return\n    if (i === list.length - 1) {\n        list.pop()\n    } else {\n        list[i] = list.pop()\n    }\n}\n\n\n\n// loop over a function for a few ms, or until it returns true\nexport function loopForTime(maxTimeInMS, callback, startTime) {\n    var cutoff = (startTime || performance.now()) + maxTimeInMS\n    var maxIter = 1000 // sanity check\n    for (var i = 0; i < maxIter; i++) {\n        var res = callback()\n        if (res || performance.now() > cutoff) return\n    }\n}\n\n\n\n\n\n// ....\nexport function numberOfVoxelsInSphere(rad) {\n    if (rad === prevRad) return prevAnswer\n    var ext = Math.ceil(rad), ct = 0, rsq = rad * rad\n    for (var i = -ext; i <= ext; ++i) {\n        for (var j = -ext; j <= ext; ++j) {\n            for (var k = -ext; k <= ext; ++k) {\n                var dsq = i * i + j * j + k * k\n                if (dsq < rsq) ct++\n            }\n        }\n    }\n    prevRad = rad\n    prevAnswer = ct\n    return ct\n}\nvar prevRad = 0, prevAnswer = 0\n\n\n\n\n\n// partly \"unrolled\" loops to copy contents of ndarrays\n// when there's no source, zeroes out the array instead\nexport function copyNdarrayContents(src, tgt, pos, size, tgtPos) {\n    if (src) {\n        doNdarrayCopy(src, tgt, pos[0], pos[1], pos[2],\n            size[0], size[1], size[2], tgtPos[0], tgtPos[1], tgtPos[2])\n    } else {\n        doNdarrayZero(tgt, tgtPos[0], tgtPos[1], tgtPos[2],\n            size[0], size[1], size[2])\n    }\n}\nfunction doNdarrayCopy(src, tgt, i0, j0, k0, si, sj, sk, ti, tj, tk) {\n    for (var i = 0; i < si; i++) {\n        for (var j = 0; j < sj; j++) {\n            var six = src.index(i0 + i, j0 + j, k0)\n            var tix = tgt.index(ti + i, tj + j, tk)\n            for (var k = 0; k < sk; k++) {\n                tgt.data[tix] = src.data[six]\n                six += src.stride[2]\n                tix += tgt.stride[2]\n            }\n        }\n    }\n}\n\nfunction doNdarrayZero(tgt, i0, j0, k0, si, sj, sk) {\n    for (var i = 0; i < si; i++) {\n        for (var j = 0; j < sj; j++) {\n            var ix = tgt.index(i0 + i, j0 + j, k0)\n            for (var k = 0; k < sk; k++) {\n                tgt.data[ix] = 0\n                ix += tgt.stride[2]\n            }\n        }\n    }\n}\n\n\n\n\n\n\n\n/*\n * \n *      strList - internal data structure for lists of chunk IDs\n * \n*/\n\nexport function StringList() {\n    this.arr = []\n    this.hash = {}\n}\nStringList.prototype.includes = function (key) {\n    return this.hash[key]\n}\nStringList.prototype.add = function (key) {\n    if (this.hash[key]) return\n    this.arr.push(key)\n    this.hash[key] = true\n}\nStringList.prototype.remove = function (key) {\n    if (!this.hash[key]) return\n    this.arr.splice(this.arr.indexOf(key), 1)\n    delete this.hash[key]\n}\nStringList.prototype.count = function () { return this.arr.length }\nStringList.prototype.forEach = function (a, b) { return this.arr.forEach(a, b) }\nStringList.prototype.slice = function (a, b) { return this.arr.slice(a, b) }\nStringList.prototype.isEmpty = function () { return (this.arr.length === 0) }\nStringList.prototype.empty = function () {\n    this.arr.length = 0\n    this.hash = {}\n}\nStringList.prototype.pop = function () {\n    var key = this.arr.pop()\n    delete this.hash[key]\n    return key\n}\nStringList.prototype.sort = function (keyToDistanceFn) {\n    var mapping = {}\n    this.arr.forEach(key => { mapping[key] = keyToDistanceFn(key) })\n    this.arr.sort((a, b) => mapping[b] - mapping[a]) // DESCENDING!\n}\nStringList.prototype.copyFrom = function (list) {\n    this.arr = list.arr.slice()\n    this.hash = Object.assign({}, list.hash)\n}\n\n\n\n\n\n\n\n\n\n\n\n// simple thing for reporting time split up between several activities\nexport function makeProfileHook(_every, _title) {\n    var title = _title || ''\n    var every = _every || 1\n    var times = []\n    var names = []\n    var started = 0\n    var last = 0\n    var iter = 0\n    var total = 0\n    var clearNext = true\n\n    var start = function () {\n        if (clearNext) {\n            times.length = names.length = 0\n            clearNext = false\n        }\n        started = last = performance.now()\n        iter++\n    }\n    var add = function (name) {\n        var t = performance.now()\n        if (names.indexOf(name) < 0) names.push(name)\n        var i = names.indexOf(name)\n        if (!times[i]) times[i] = 0\n        times[i] += t - last\n        last = t\n    }\n    var report = function () {\n        total += performance.now() - started\n        if (iter === every) {\n            var head = title + ' total ' + (total / every).toFixed(2) + 'ms (avg, ' + every + ' runs)    '\n            console.log(head, names.map(function (name, i) {\n                return name + ': ' + (times[i] / every).toFixed(2) + 'ms    '\n            }).join(''))\n            clearNext = true\n            iter = 0\n            total = 0\n        }\n    }\n    return function profile_hook(state) {\n        if (state === 'start') start()\n        else if (state === 'end') report()\n        else add(state)\n    }\n}\n\n\n\n\n// simple thing for reporting time actions/sec\nexport function makeThroughputHook(_every, _title) {\n    var title = _title || ''\n    var every = _every || 1\n    var counts = {}\n    var started = performance.now()\n    var iter = 0\n    return function profile_hook(state) {\n        if (state === 'start') return\n        if (state === 'end') {\n            if (++iter < every) return\n            var t = performance.now()\n            console.log(title + '   ' + Object.keys(counts).map(k => {\n                var through = counts[k] / (t - started) * 1000\n                counts[k] = 0\n                return k + ':' + through.toFixed(2) + '   '\n            }).join(''))\n            started = t\n            iter = 0\n        } else {\n            if (!counts[state]) counts[state] = 0\n            counts[state]++\n        }\n    }\n}\n","var glvec3 = require('gl-vec3')\nimport { removeUnorderedListItem } from './util'\n\nimport { Scene } from '@babylonjs/core/scene'\nimport { FreeCamera } from '@babylonjs/core/Cameras/freeCamera'\nimport { Octree } from '@babylonjs/core/Culling/Octrees/octree'\nimport { OctreeBlock } from '@babylonjs/core/Culling/Octrees/octreeBlock'\nimport { Engine } from '@babylonjs/core/Engines/engine'\nimport { HemisphericLight } from '@babylonjs/core/Lights/hemisphericLight'\nimport { StandardMaterial } from '@babylonjs/core/Materials/standardMaterial'\nimport { Vector3, Color3 } from '@babylonjs/core/Maths/math'\nimport { Mesh } from '@babylonjs/core/Meshes/mesh'\nimport { OctreeSceneComponent } from '@babylonjs/core/Culling/Octrees/'\nimport '@babylonjs/core/Meshes/meshBuilder'\n\n\n\nexport default function (noa, opts, canvas) {\n    return new Rendering(noa, opts, canvas)\n}\n\n\n\n// profiling flag\nvar PROFILE = 0\n\n\n\nvar defaults = {\n    showFPS: false,\n    antiAlias: true,\n    clearColor: [0.8, 0.9, 1],\n    ambientColor: [1, 1, 1],\n    lightDiffuse: [1, 1, 1],\n    lightSpecular: [1, 1, 1],\n    groundLightColor: [0.5, 0.5, 0.5],\n    useAO: true,\n    AOmultipliers: [0.93, 0.8, 0.5],\n    reverseAOmultiplier: 1.0,\n    preserveDrawingBuffer: true,\n}\n\n\n\n/**\n * @class\n * @typicalname noa.rendering\n * @classdesc Manages all rendering, and the BABYLON scene, materials, etc.\n */\n\nfunction Rendering(noa, opts, canvas) {\n    this.noa = noa\n\n    /**\n     * `noa.rendering` uses the following options (from the root `noa(opts)` options):\n     * ```js\n     * {\n     *   showFPS: false,\n     *   antiAlias: true,\n     *   clearColor: [0.8, 0.9, 1],\n     *   ambientColor: [1, 1, 1],\n     *   lightDiffuse: [1, 1, 1],\n     *   lightSpecular: [1, 1, 1],\n     *   groundLightColor: [0.5, 0.5, 0.5],\n     *   useAO: true,\n     *   AOmultipliers: [0.93, 0.8, 0.5],\n     *   reverseAOmultiplier: 1.0,\n     *   preserveDrawingBuffer: true,\n     * }\n     * ```\n     */\n    opts = Object.assign({}, defaults, opts)\n\n    // internals\n    this.useAO = !!opts.useAO\n    this.aoVals = opts.AOmultipliers\n    this.revAoVal = opts.reverseAOmultiplier\n    this.meshingCutoffTime = 6 // ms\n    this._resizeDebounce = 250 // ms\n\n    // set up babylon scene\n    initScene(this, canvas, opts)\n\n    // for debugging\n    if (opts.showFPS) setUpFPS()\n}\n\n\n// Constructor helper - set up the Babylon.js scene and basic components\nfunction initScene(self, canvas, opts) {\n\n    // init internal properties\n    self._engine = new Engine(canvas, opts.antiAlias, {\n        preserveDrawingBuffer: opts.preserveDrawingBuffer,\n    })\n    self._scene = new Scene(self._engine)\n    var scene = self._scene\n    // remove built-in listeners\n    scene.detachControl()\n\n    // octree setup\n    scene._addComponent(new OctreeSceneComponent(scene))\n    self._octree = new Octree($ => { })\n    self._octree.blocks = []\n    scene._selectionOctree = self._octree\n\n    // camera, and empty mesh to hold it, and one to accumulate rotations\n    self._cameraHolder = new Mesh('camHolder', scene)\n    self._camera = new FreeCamera('camera', new Vector3(0, 0, 0), scene)\n    self._camera.parent = self._cameraHolder\n    self._camera.minZ = .01\n    self._cameraHolder.visibility = false\n\n    // plane obscuring the camera - for overlaying an effect on the whole view\n    self._camScreen = Mesh.CreatePlane('camScreen', 10, scene)\n    self.addMeshToScene(self._camScreen)\n    self._camScreen.position.z = .1\n    self._camScreen.parent = self._camera\n    self._camScreenMat = self.makeStandardMaterial('camscreenmat')\n    self._camScreen.material = self._camScreenMat\n    self._camScreen.setEnabled(false)\n    self._camLocBlock = 0\n\n    // apply some defaults\n    var lightVec = new Vector3(0.1, 1, 0.3)\n    self._light = new HemisphericLight('light', lightVec, scene)\n\n    function arrToColor(a) { return new Color3(a[0], a[1], a[2]) }\n    scene.clearColor = arrToColor(opts.clearColor)\n    scene.ambientColor = arrToColor(opts.ambientColor)\n    self._light.diffuse = arrToColor(opts.lightDiffuse)\n    self._light.specular = arrToColor(opts.lightSpecular)\n    self._light.groundColor = arrToColor(opts.groundLightColor)\n\n    // make a default flat material (used or clone by terrain, etc)\n    self.flatMaterial = self.makeStandardMaterial('flatmat')\n\n}\n\n\n\n/*\n *   PUBLIC API \n */\n\n\n/**\n * The Babylon `scene` object representing the game world.\n * @member\n */\nRendering.prototype.getScene = function () {\n    return this._scene\n}\n\n// per-tick listener for rendering-related stuff\nRendering.prototype.tick = function (dt) {\n    // nothing here at the moment\n}\n\n\n\n\n\nRendering.prototype.render = function (dt) {\n    profile_hook('start')\n    updateCameraForRender(this)\n    profile_hook('updateCamera')\n    this._engine.beginFrame()\n    profile_hook('beginFrame')\n    this._scene.render()\n    profile_hook('render')\n    fps_hook()\n    this._engine.endFrame()\n    profile_hook('endFrame')\n    profile_hook('end')\n}\n\n\n\nRendering.prototype.resize = function (e) {\n    if (!pendingResize) {\n        pendingResize = true\n        setTimeout(() => {\n            this._engine.resize()\n            pendingResize = false\n        }, this._resizeDebounce)\n    }\n}\nvar pendingResize = false\n\n\n\nRendering.prototype.highlightBlockFace = function (show, posArr, normArr) {\n    var m = getHighlightMesh(this)\n    if (show) {\n        // floored local coords for highlight mesh\n        this.noa.globalToLocal(posArr, null, hlpos)\n        // offset to avoid z-fighting, bigger when camera is far away\n        var dist = glvec3.dist(this.noa.camera._localGetPosition(), hlpos)\n        var slop = 0.001 + 0.001 * dist\n        for (var i = 0; i < 3; i++) {\n            if (normArr[i] === 0) {\n                hlpos[i] += 0.5\n            } else {\n                hlpos[i] += (normArr[i] > 0) ? 1 + slop : -slop\n            }\n        }\n        m.position.copyFromFloats(hlpos[0], hlpos[1], hlpos[2])\n        m.rotation.x = (normArr[1]) ? Math.PI / 2 : 0\n        m.rotation.y = (normArr[0]) ? Math.PI / 2 : 0\n    }\n    m.setEnabled(show)\n}\nvar hlpos = []\n\n\n\n\n/**\n * Add a mesh to the scene's octree setup so that it renders. \n * \n * @param mesh: the mesh to add to the scene\n * @param isStatic: pass in true if mesh never moves (i.e. change octree blocks)\n * @param position: (optional) global position where the mesh should be\n * @param chunk: (optional) chunk to which the mesh is statically bound\n * @method\n */\nRendering.prototype.addMeshToScene = function (mesh, isStatic, pos, _containingChunk) {\n    // exit silently if mesh has already been added and not removed\n    if (mesh._noaContainingChunk) return\n    if (this._octree.dynamicContent.includes(mesh)) return\n\n    // find local position for mesh and move it there (unless it's parented)\n    if (!mesh.parent) {\n        if (!pos) pos = [mesh.position.x, mesh.position.y, mesh.position.z]\n        var lpos = []\n        this.noa.globalToLocal(pos, null, lpos)\n        mesh.position.copyFromFloats(lpos[0], lpos[1], lpos[2])\n    }\n\n    // statically tie to a chunk's octree, or treat as dynamic?\n    var addToOctree = false\n    if (isStatic) {\n        var chunk = _containingChunk ||\n            this.noa.world._getChunkByCoords(pos[0], pos[1], pos[2])\n        addToOctree = !!(chunk && chunk.octreeBlock)\n    }\n\n    if (addToOctree) {\n        chunk.octreeBlock.entries.push(mesh)\n        mesh._noaContainingChunk = chunk\n    } else {\n        this._octree.dynamicContent.push(mesh)\n    }\n\n    if (isStatic) {\n        mesh.freezeWorldMatrix()\n        mesh.freezeNormals()\n    }\n\n    // add dispose event to undo everything done here\n    var remover = this.removeMeshFromScene.bind(this, mesh)\n    mesh.onDisposeObservable.add(remover)\n}\n\n\n\n/**  Undoes everything `addMeshToScene` does\n * @method\n */\nRendering.prototype.removeMeshFromScene = function (mesh) {\n    if (mesh._noaContainingChunk && mesh._noaContainingChunk.octreeBlock) {\n        removeUnorderedListItem(mesh._noaContainingChunk.octreeBlock.entries, mesh)\n    }\n    mesh._noaContainingChunk = null\n    removeUnorderedListItem(this._octree.dynamicContent, mesh)\n}\n\n\n\n\n\n\n\n\n\n// Create a default standardMaterial:\n//      flat, nonspecular, fully reflects diffuse and ambient light\nRendering.prototype.makeStandardMaterial = function (name) {\n    var mat = new StandardMaterial(name, this._scene)\n    mat.specularColor.copyFromFloats(0, 0, 0)\n    mat.ambientColor.copyFromFloats(1, 1, 1)\n    mat.diffuseColor.copyFromFloats(1, 1, 1)\n    return mat\n}\n\n\n\n\n\n\n\n/*\n *\n * \n *   ACCESSORS FOR CHUNK ADD/REMOVAL/MESHING\n *\n * \n */\n\nRendering.prototype.prepareChunkForRendering = function (chunk) {\n    var cs = chunk.size\n    var loc = []\n    this.noa.globalToLocal([chunk.x, chunk.y, chunk.z], null, loc)\n    var min = new Vector3(loc[0], loc[1], loc[2])\n    var max = new Vector3(loc[0] + cs, loc[1] + cs, loc[2] + cs)\n    chunk.octreeBlock = new OctreeBlock(min, max, undefined, undefined, undefined, $ => { })\n    this._octree.blocks.push(chunk.octreeBlock)\n}\n\nRendering.prototype.disposeChunkForRendering = function (chunk) {\n    if (!chunk.octreeBlock) return\n    removeUnorderedListItem(this._octree.blocks, chunk.octreeBlock)\n    chunk.octreeBlock.entries.length = 0\n    chunk.octreeBlock = null\n}\n\n\n\n\n\n\n\n\n\n/*\n *\n *   INTERNALS\n *\n */\n\n\n\n// change world origin offset, and rebase everything with a position\n\nRendering.prototype._rebaseOrigin = function (delta) {\n    var dvec = new Vector3(delta[0], delta[1], delta[2])\n\n    this._scene.meshes.forEach(mesh => {\n        // parented meshes don't live in the world coord system\n        if (mesh.parent) return\n\n        // move each mesh by delta (even though most are managed by components)\n        mesh.position.subtractInPlace(dvec)\n\n        if (mesh._isWorldMatrixFrozen) mesh.markAsDirty()\n    })\n\n    // update octree block extents\n    this._octree.blocks.forEach(octreeBlock => {\n        octreeBlock.minPoint.subtractInPlace(dvec)\n        octreeBlock.maxPoint.subtractInPlace(dvec)\n        octreeBlock._boundingVectors.forEach(v => {\n            v.subtractInPlace(dvec)\n        })\n    })\n}\n\n\n\n\n\n// updates camera position/rotation to match settings from noa.camera\n\nfunction updateCameraForRender(self) {\n    var cam = self.noa.camera\n    var tgtLoc = cam._localGetTargetPosition()\n    self._cameraHolder.position.copyFromFloats(tgtLoc[0], tgtLoc[1], tgtLoc[2])\n    self._cameraHolder.rotation.x = cam.pitch\n    self._cameraHolder.rotation.y = cam.heading\n    self._camera.position.z = -cam.currentZoom\n\n    // applies screen effect when camera is inside a transparent voxel\n    var cloc = cam._localGetPosition()\n    var off = self.noa.worldOriginOffset\n    var cx = Math.floor(cloc[0] + off[0])\n    var cy = Math.floor(cloc[1] + off[1])\n    var cz = Math.floor(cloc[2] + off[2])\n    var id = self.noa.getBlock(cx, cy, cz)\n    checkCameraEffect(self, id)\n}\n\n\n\n//  If camera's current location block id has alpha color (e.g. water), apply/remove an effect\n\nfunction checkCameraEffect(self, id) {\n    if (id === self._camLocBlock) return\n    if (id === 0) {\n        self._camScreen.setEnabled(false)\n    } else {\n        var matId = self.noa.registry.getBlockFaceMaterial(id, 0)\n        if (matId) {\n            var matData = self.noa.registry.getMaterialData(matId)\n            var col = matData.color\n            var alpha = matData.alpha\n            if (col && alpha && alpha < 1) {\n                self._camScreenMat.diffuseColor.set(0, 0, 0)\n                self._camScreenMat.ambientColor.set(col[0], col[1], col[2])\n                self._camScreenMat.alpha = alpha\n                self._camScreen.setEnabled(true)\n            }\n        }\n    }\n    self._camLocBlock = id\n}\n\n\n\n\n\n\n// make or get a mesh for highlighting active voxel\nfunction getHighlightMesh(rendering) {\n    var mesh = rendering._highlightMesh\n    if (!mesh) {\n        mesh = Mesh.CreatePlane(\"highlight\", 1.0, rendering._scene)\n        var hlm = rendering.makeStandardMaterial('highlightMat')\n        hlm.backFaceCulling = false\n        hlm.emissiveColor = new Color3(1, 1, 1)\n        hlm.alpha = 0.2\n        mesh.material = hlm\n\n        // outline\n        var s = 0.5\n        var lines = Mesh.CreateLines(\"hightlightLines\", [\n            new Vector3(s, s, 0),\n            new Vector3(s, -s, 0),\n            new Vector3(-s, -s, 0),\n            new Vector3(-s, s, 0),\n            new Vector3(s, s, 0)\n        ], rendering._scene)\n        lines.color = new Color3(1, 1, 1)\n        lines.parent = mesh\n\n        rendering.addMeshToScene(mesh)\n        rendering.addMeshToScene(lines)\n        rendering._highlightMesh = mesh\n    }\n    return mesh\n}\n\n\n\n\n\n\n\n\n\n/*\n * \n *      sanity checks:\n * \n */\n\nRendering.prototype.debug_SceneCheck = function () {\n    var meshes = this._scene.meshes\n    var dyns = this._octree.dynamicContent\n    var octs = []\n    var numOcts = 0\n    var numSubs = 0\n    var mats = this._scene.materials\n    var allmats = []\n    mats.forEach(mat => {\n        if (mat.subMaterials) mat.subMaterials.forEach(mat => allmats.push(mat))\n        else allmats.push(mat)\n    })\n    this._octree.blocks.forEach(function (block) {\n        numOcts++\n        block.entries.forEach(m => octs.push(m))\n    })\n    meshes.forEach(function (m) {\n        if (m._isDisposed) warn(m, 'disposed mesh in scene')\n        if (empty(m)) return\n        if (missing(m, dyns, octs)) warn(m, 'non-empty mesh missing from octree')\n        if (!m.material) { warn(m, 'non-empty scene mesh with no material'); return }\n        numSubs += (m.subMeshes) ? m.subMeshes.length : 1\n        var mats = m.material.subMaterials || [m.material]\n        mats.forEach(function (mat) {\n            if (missing(mat, mats)) warn(mat, 'mesh material not in scene')\n        })\n    })\n    var unusedMats = []\n    allmats.forEach(mat => {\n        var used = false\n        meshes.forEach(mesh => {\n            if (mesh.material === mat) used = true\n            if (!mesh.material || !mesh.material.subMaterials) return\n            if (mesh.material.subMaterials.includes(mat)) used = true\n        })\n        if (!used) unusedMats.push(mat.name)\n    })\n    if (unusedMats.length) {\n        console.warn('Materials unused by any mesh: ', unusedMats.join(', '))\n    }\n    dyns.forEach(function (m) {\n        if (missing(m, meshes)) warn(m, 'octree/dynamic mesh not in scene')\n    })\n    octs.forEach(function (m) {\n        if (missing(m, meshes)) warn(m, 'octree block mesh not in scene')\n    })\n    var avgPerOct = Math.round(10 * octs.length / numOcts) / 10\n    console.log('meshes - octree:', octs.length, '  dynamic:', dyns.length,\n        '   subMeshes:', numSubs,\n        '   avg meshes/octreeBlock:', avgPerOct)\n\n    function warn(obj, msg) { console.warn(obj.name + ' --- ' + msg) }\n\n    function empty(mesh) { return (mesh.getIndices().length === 0) }\n\n    function missing(obj, list1, list2) {\n        if (!obj) return false\n        if (list1.includes(obj)) return false\n        if (list2 && list2.includes(obj)) return false\n        return true\n    }\n    return 'done.'\n}\n\nRendering.prototype.debug_MeshCount = function () {\n    var ct = {}\n    this._scene.meshes.forEach(m => {\n        var n = m.name || ''\n        n = n.replace(/-\\d+.*/, '#')\n        n = n.replace(/\\d+.*/, '#')\n        n = n.replace(/(rotHolder|camHolder|camScreen)/, 'rendering use')\n        n = n.replace(/atlas sprite .*/, 'atlas sprites')\n        ct[n] = ct[n] || 0\n        ct[n]++\n    })\n    for (var s in ct) console.log('   ' + (ct[s] + '       ').substr(0, 7) + s)\n}\n\n\n\n\n\n\n\nimport { makeProfileHook } from './util'\nvar profile_hook = (PROFILE) ?\n    makeProfileHook(200, 'render internals') : () => { }\n\n\n\nvar fps_hook = function () { }\n\nfunction setUpFPS() {\n    var div = document.createElement('div')\n    div.id = 'noa_fps'\n    var style = 'position:absolute; top:0; right:0; z-index:0;'\n    style += 'color:white; background-color:rgba(0,0,0,0.5);'\n    style += 'font:14px monospace; text-align:center;'\n    style += 'min-width:2em; margin:4px;'\n    div.style = style\n    document.body.appendChild(div)\n    var every = 1000\n    var ct = 0\n    var longest = 0\n    var start = performance.now()\n    var last = start\n    fps_hook = function () {\n        ct++\n        var nt = performance.now()\n        if (nt - last > longest) longest = nt - last\n        last = nt\n        if (nt - start < every) return\n        var fps = Math.round(ct / (nt - start) * 1000)\n        var min = Math.round(1 / longest * 1000)\n        div.innerHTML = fps + '<br>' + min\n        ct = 0\n        longest = 0\n        start = nt\n    }\n}\n","\n/* \n *  Internal voxel data representation\n *\n *  Each voxel is stored as a Uint16.\n *  Voxel id is stored in lowest bits, and flags stored in upper bits for fast retrieval\n *  \n *  Stores, from right to left:\n *     9 bits of voxel ID\n *     4 bits of variation (e.g. orientation)  --- Not yet being used!\n *     1 bit solidity (i.e. physics-wise)\n *     1 bit opacity (whether voxel obscures neighboring faces)\n *     1 bit object marker (marks non-terrain blocks with custom meshes)\n */\n\n\nvar ID_BITS = 9\nvar ID_MASK = (1 << ID_BITS) - 1\n\nvar VAR_BITS = 4\nvar VAR_OFFSET = ID_BITS\nvar VAR_MASK = ((1 << VAR_BITS) - 1) << VAR_OFFSET\n\nvar n = ID_BITS + VAR_BITS\nvar SOLID_BIT = 1 << n++\nvar OPAQUE_BIT = 1 << n++\nvar OBJECT_BIT = 1 << n++\n\n// exports\n\nexport var constants = {}\n\nconstants.ID_MASK = ID_MASK\nconstants.VAR_MASK = VAR_MASK\nconstants.SOLID_BIT = SOLID_BIT\nconstants.OPAQUE_BIT = OPAQUE_BIT\nconstants.OBJECT_BIT = OBJECT_BIT\n\n","\nimport ndarray from 'ndarray'\nimport { Mesh } from '@babylonjs/core/Meshes/mesh'\nimport { SubMesh } from '@babylonjs/core/Meshes/subMesh'\nimport { VertexData } from '@babylonjs/core/Meshes/mesh.vertexData'\nimport { MultiMaterial } from '@babylonjs/core/Materials/multiMaterial'\nimport { Texture } from '@babylonjs/core/Materials/Textures/texture'\nimport '@babylonjs/core/Meshes/meshBuilder'\n\nimport { constants } from './constants'\nimport { copyNdarrayContents } from './util'\n\nexport default new TerrainMesher()\n\n\n\n\n// enable for profiling..\nvar PROFILE_EVERY = 0 // 100\n\n\n\n\n/*\n * \n *          TERRAIN MESHER!!\n * \n */\n\n\nfunction TerrainMesher() {\n\n    var greedyMesher = new GreedyMesher()\n    var meshBuilder = new MeshBuilder()\n\n\n    /*\n     * \n     * Entry point and high-level flow\n     * \n     */\n\n    this.meshChunk = function (chunk, matGetter, colGetter, ignoreMaterials, useAO, aoVals, revAoVal) {\n        profile_hook('start')\n        var noa = chunk.noa\n\n        // args\n        var mats = matGetter || noa.registry.getBlockFaceMaterial\n        var cols = colGetter || noa.registry._getMaterialVertexColor\n        var ao = (useAO === undefined) ? noa.rendering.useAO : useAO\n        var vals = aoVals || noa.rendering.aoVals\n        var rev = isNaN(revAoVal) ? noa.rendering.revAoVal : revAoVal\n\n        // copy voxel data into array padded with neighbor values\n        var voxels = buildPaddedVoxelArray(chunk)\n        profile_hook('copy')\n\n        // greedy mesher creates an array of Submesh structs\n        var edgesOnly = chunk.isFull || chunk.isEmpty\n        var subMeshes = greedyMesher.mesh(voxels, mats, cols, ao, vals, rev, edgesOnly)\n\n        // builds the babylon mesh that will be added to the scene\n        var mesh\n        if (subMeshes.length) {\n            mesh = meshBuilder.build(chunk, subMeshes, ignoreMaterials)\n            profile_hook('terrain')\n        }\n\n        profile_hook('end')\n        return mesh || null\n    }\n}\n\n\n\n\n\n\n\n\n\n/*\n * \n *      Padded voxel data assembler\n * \n * Takes the chunk of size n, and copies its data into center of an (n+2) ndarray\n * Then copies in edge data from neighbors, or if not available zeroes it out\n * Actual mesher will then run on the padded ndarray\n * \n*/\n\nfunction buildPaddedVoxelArray(chunk) {\n    var src = chunk.voxels\n    var cs = src.shape[0]\n    var tgt = cachedPadded\n\n    // embiggen cached target array\n    if (cs + 2 !== tgt.shape[0]) {\n        var s2 = cs + 2\n        tgt = new ndarray(new Uint16Array(s2 * s2 * s2), [s2, s2, s2])\n        cachedPadded = tgt\n    }\n\n    // loop through neighbors (neighbor(0,0,0) is the chunk itself)\n    // copying or zeroing voxel body/edge data into padded target array\n    var loc = _vecs[0]\n    var pos = _vecs[1]\n    var size = _vecs[2]\n    var tgtPos = _vecs[3]\n    var posValues = _vecs[4]\n    var sizeValues = _vecs[5]\n    var tgtPosValues = _vecs[6]\n    if (cs !== _cachedVecSize) {\n        _cachedVecSize = cs\n        allocateVectors(cs, posValues, sizeValues, tgtPosValues)\n    }\n\n    for (var i = 0; i < 3; i++) {\n        loc[0] = i\n        for (var j = 0; j < 3; j++) {\n            loc[1] = j\n            for (var k = 0; k < 3; k++) {\n                loc[2] = k\n                for (var n = 0; n < 3; n++) {\n                    var coord = loc[n]\n                    pos[n] = posValues[coord]\n                    size[n] = sizeValues[coord]\n                    tgtPos[n] = tgtPosValues[coord]\n                }\n                var nab = chunk._neighbors.get(i - 1, j - 1, k - 1)\n                var nsrc = (nab) ? nab.voxels : null\n                copyNdarrayContents(nsrc, tgt, pos, size, tgtPos)\n            }\n        }\n    }\n    return tgt\n}\nvar cachedPadded = new ndarray(new Uint16Array(27), [3, 3, 3])\nvar _vecs = Array.from(Array(10)).map(n => [0, 0, 0])\nvar _cachedVecSize\nfunction allocateVectors(size, posValues, sizeValues, tgtPosValues) {\n    for (var i = 0; i < 3; i++) {\n        posValues[i] = [size - 1, 0, 0][i]\n        sizeValues[i] = [1, size, 1][i]\n        tgtPosValues[i] = [0, 1, size + 1][i]\n    }\n}\n\n\n\n\n\n\n\n\n/*\n * \n *  Submesh - holds one submesh worth of greedy-meshed data\n * \n *  Basically, the greedy mesher builds these and the mesh builder consumes them\n * \n */\n\nfunction Submesh(id) {\n    this.id = id | 0\n    this.positions = []\n    this.indices = []\n    this.normals = []\n    this.colors = []\n    this.uvs = []\n    this.mergeable = false      // flag used during terrain meshing\n}\n\nSubmesh.prototype.dispose = function () {\n    this.positions = null\n    this.indices = null\n    this.normals = null\n    this.colors = null\n    this.uvs = null\n}\n\n\n\n\n\n\n\n\n/*\n * \n *  Mesh Builder - turns an array of Submesh data into a \n *  Babylon.js mesh/submeshes, ready to be added to the scene\n * \n */\n\nfunction MeshBuilder() {\n\n    var noa\n\n    // core\n    this.build = function (chunk, meshDataList, ignoreMaterials) {\n        noa = chunk.noa\n\n        // flag and merge submesh data that can share the default terrain material\n        var numMergeable = 0\n        for (var i = 0; i < meshDataList.length; i++) {\n            var mdat = meshDataList[i]\n            if (ignoreMaterials) {\n                mdat.mergeable = true\n            } else {\n                var url = noa.registry.getMaterialTexture(mdat.id)\n                var matData = noa.registry.getMaterialData(mdat.id)\n                mdat.mergeable = (!url)\n                    && (matData.alpha === 1)\n                    && (!matData.renderMat)\n            }\n            if (mdat.mergeable) numMergeable++\n        }\n        if (numMergeable > 1) mergeSubmeshes(meshDataList, false)\n\n        // now merge everything, keeping track of vertices/indices/materials\n        var results = mergeSubmeshes(meshDataList, true)\n\n        // merge sole remaining submesh instance into a babylon mesh\n        var merged = meshDataList[0]\n        var name = 'chunk_' + chunk.id\n        var mats = results.matIDs.map(id => getTerrainMaterial(id, ignoreMaterials))\n        var mesh = buildMeshFromSubmesh(merged, name, mats, results.vertices, results.indices)\n\n        // done, mesh will be positioned later when added to the scene\n        return mesh\n    }\n\n\n\n    // given a set of submesh objects, merge some or all of them\n    //      while tracking vertex/index offsets for each material ID\n    // Note: modifies meshDataList in place!\n    function mergeSubmeshes(meshDataList, mergeAll) {\n        var vertices = []\n        var indices = []\n        var matIDs = []\n\n        var target = null\n        for (var i = 0; i < meshDataList.length; ++i) {\n            var mdat = meshDataList[i]\n            if (!(mergeAll || mdat.mergeable)) continue\n\n            vertices.push(mdat.positions.length)\n            indices.push(mdat.indices.length)\n            matIDs.push(mdat.id)\n\n            if (!target) {\n                target = mdat\n\n            } else {\n                var indexOffset = target.positions.length / 3\n                // merge data in \"mdat\" onto \"target\"\n                mergeArrays(target.positions, mdat.positions)\n                mergeArrays(target.normals, mdat.normals)\n                mergeArrays(target.colors, mdat.colors)\n                mergeArrays(target.uvs, mdat.uvs)\n                // indices must be offset relative to data being merged onto\n                for (var j = 0, len = mdat.indices.length; j < len; ++j) {\n                    target.indices.push(mdat.indices[j] + indexOffset)\n                }\n                // get rid of entry that's been merged\n                meshDataList.splice(i, 1)\n                mdat.dispose()\n                i--\n            }\n        }\n\n        return {\n            vertices: vertices,\n            indices: indices,\n            matIDs: matIDs,\n        }\n    }\n\n    function mergeArrays(tgt, src) {\n        for (var i = 0; i < src.length; i++) tgt.push(src[i])\n    }\n\n\n    function buildMeshFromSubmesh(submesh, name, mats, verts, inds) {\n\n        // base mesh and vertexData object\n        var scene = noa.rendering.getScene()\n        var mesh = new Mesh(name, scene)\n        var vdat = new VertexData()\n        vdat.positions = submesh.positions\n        vdat.indices = submesh.indices\n        vdat.normals = submesh.normals\n        vdat.colors = submesh.colors\n        vdat.uvs = submesh.uvs\n        vdat.applyToMesh(mesh)\n        submesh.dispose()\n\n        if (mats.length === 1) {\n            // if only one material ID, assign as a regular mesh and return\n            mesh.material = mats[0]\n\n        } else {\n            // else we need to make a multimaterial and define (babylon) submeshes\n            var multiMat = new MultiMaterial('multimat ' + name, scene)\n            mesh.subMeshes = []\n            // var totalVerts = vdat.positions.length\n            // var totalInds = vdat.indices.length\n            var vertStart = 0\n            var indStart = 0\n            for (var i = 0; i < mats.length; i++) {\n                multiMat.subMaterials[i] = mats[i]\n                var sub = new SubMesh(i, vertStart, verts[i], indStart, inds[i], mesh)\n                mesh.subMeshes[i] = sub\n                vertStart += verts[i]\n                indStart += inds[i]\n            }\n            mesh.material = multiMat\n        }\n\n        return mesh\n    }\n\n\n\n\n    //                         Material wrangling\n\n\n    var materialCache = {}\n\n    // manage materials/textures to avoid duplicating them\n    function getTerrainMaterial(matID, ignore) {\n        if (ignore) return noa.rendering.flatMaterial\n        var name = 'terrain mat ' + matID\n        if (!materialCache[name]) materialCache[name] = makeTerrainMaterial(matID)\n        return materialCache[name]\n    }\n\n\n    // canonical function to make a terrain material\n    function makeTerrainMaterial(id) {\n        // if user-specified render material is defined, use it\n        var matData = noa.registry.getMaterialData(id)\n        if (matData.renderMat) return matData.renderMat\n        // otherwise determine which built-in material to use\n        var url = noa.registry.getMaterialTexture(id)\n        var alpha = matData.alpha\n        if (!url && alpha == 1) {\n            // base material is fine for non-textured case, if no alpha\n            return noa.rendering.flatMaterial\n        }\n        var mat = noa.rendering.flatMaterial.clone('terrain' + id)\n        if (url) {\n            var scene = noa.rendering.getScene()\n            var tex = new Texture(url, scene, true, false, Texture.NEAREST_SAMPLINGMODE)\n            if (matData.textureAlpha) tex.hasAlpha = true\n            mat.diffuseTexture = tex\n        }\n        if (matData.alpha < 1) {\n            mat.alpha = matData.alpha\n        }\n        return mat\n    }\n}\n\n\n\n\n\n\n\n\n/*\n *    Greedy voxel meshing algorithm\n *        based initially on algo by Mikola Lysenko:\n *          http://0fps.net/2012/07/07/meshing-minecraft-part-2/\n *          but evolved quite a bit since then\n *        AO handling by me, stitched together out of cobwebs and dreams\n *    \n *    Arguments:\n *        arr: 3D ndarray of dimensions X,Y,Z\n *             packed with solidity/opacity booleans in higher bits\n *        getMaterial: function( blockID, dir )\n *             returns a material ID based on block id and which cube face it is\n *             (assume for now that each mat ID should get its own mesh)\n *        getColor: function( materialID )\n *             looks up a color (3-array) by material ID\n *             TODO: replace this with a lookup array?\n *        doAO: whether or not to bake ambient occlusion into vertex colors\n *        aoValues: array[3] of color multipliers for AO (least to most occluded)\n *        revAoVal: \"reverse ao\" - color multiplier for unoccluded exposed edges\n *\n *    Return object: array of mesh objects keyed by material ID\n *        arr[id] = {\n *          id:       material id for mesh\n *          vertices: ints, range 0 .. X/Y/Z\n *          indices:  ints\n *          normals:  ints,   -1 .. 1\n *          colors:   floats,  0 .. 1\n *          uvs:      floats,  0 .. X/Y/Z\n *        }\n */\n\nfunction GreedyMesher() {\n\n    var ID_MASK = constants.ID_MASK\n    var SOLID_BIT = constants.SOLID_BIT\n    var OPAQUE_BIT = constants.OPAQUE_BIT\n    // var VAR_MASK = constants.VAR_MASK // NYI\n    // var OBJECT_BIT = constants.OBJECT_BIT // not needed here\n\n\n    var maskCache = new Int16Array(16)\n    var aomaskCache = new Uint16Array(16)\n\n\n\n\n    this.mesh = function (voxels, getMaterial, getColor, doAO, aoValues, revAoVal, edgesOnly) {\n\n        // hash of Submeshes, keyed by material ID\n        var subMeshes = {}\n\n        // precalc how to apply AO packing in first masking function\n        var skipReverseAO = (doAO && (revAoVal === aoValues[0]))\n        var aoPackFcn\n        if (doAO) aoPackFcn = (skipReverseAO) ? packAOMaskNoReverse : packAOMask\n\n\n        //Sweep over each axis, mapping axes to [d,u,v]\n        for (var d = 0; d < 3; ++d) {\n            var u = (d + 1) % 3\n            var v = (d + 2) % 3\n\n            // make transposed ndarray so index i is the axis we're sweeping\n            var shape = voxels.shape\n            var arrT = voxels.transpose(d, u, v).lo(1, 1, 1).hi(shape[d] - 2, shape[u] - 2, shape[v] - 2)\n\n            // shorten len0 by 1 so faces at edges don't get drawn in both chunks\n            var len0 = arrT.shape[0] - 1\n            var len1 = arrT.shape[1]\n            var len2 = arrT.shape[2]\n\n            // embiggen mask arrays as needed\n            if (maskCache.length < len1 * len2) {\n                maskCache = new Int16Array(len1 * len2)\n                aomaskCache = new Uint16Array(len1 * len2)\n            }\n\n            // iterate along current major axis..\n            for (var i = 0; i <= len0; ++i) {\n\n                // fills mask and aomask arrays with values\n                constructMeshMasks(i, d, arrT, getMaterial, aoPackFcn)\n                profile_hook('masks')\n\n                // parses the masks to do greedy meshing\n                constructMeshDataFromMasks(i, d, u, v, len1, len2,\n                    doAO, subMeshes, getColor, aoValues, revAoVal)\n\n                // process edges only by jumping to other edge\n                if (edgesOnly) i += (len0 - 1)\n\n                profile_hook('submeshes')\n            }\n        }\n\n        // done, return hash of subMeshes as an array\n        return Object.keys(subMeshes).map(k => subMeshes[k])\n    }\n\n\n\n\n\n\n\n    //      Greedy meshing inner loop one\n    //\n    // iterating across ith 2d plane, with n being index into masks\n\n    function constructMeshMasks(i, d, arrT, getMaterial, aoPackFcn) {\n        var len = arrT.shape[1]\n        var mask = maskCache\n        var aomask = aomaskCache\n        // set up for quick array traversals\n        var n = 0\n        var materialDir = d * 2\n        var data = arrT.data\n        var dbase = arrT.index(i - 1, 0, 0)\n        var istride = arrT.stride[0]\n        var jstride = arrT.stride[1]\n        var kstride = arrT.stride[2]\n\n        for (var k = 0; k < len; ++k) {\n            var d0 = dbase\n            dbase += kstride\n            for (var j = 0; j < len; j++, n++, d0 += jstride) {\n\n                // mask[n] will represent the face needed between i-1,j,k and i,j,k\n                // for now, assume we never have two faces in both directions\n\n                // note that mesher zeroes out the mask as it goes, so there's \n                // no need to zero it here when no face is needed\n\n                // IDs at i-1,j,k  and  i,j,k\n                var id0 = data[d0]\n                var id1 = data[d0 + istride]\n\n                // most common case: never a face between same voxel IDs, \n                // so skip out early\n                if (id0 === id1) continue\n\n                var faceDir = getFaceDir(id0, id1, getMaterial, materialDir)\n                if (faceDir) {\n                    // set regular mask value to material ID, sign indicating direction\n                    mask[n] = (faceDir > 0) ?\n                        getMaterial(id0 & ID_MASK, materialDir) :\n                        -getMaterial(id1 & ID_MASK, materialDir + 1)\n\n                    // if doing AO, precalculate AO level for each face into second mask\n                    if (aoPackFcn) {\n                        // i values in direction face is/isn't pointing{\n                        aomask[n] = (faceDir > 0) ?\n                            aoPackFcn(arrT, i, i - 1, j, k) :\n                            aoPackFcn(arrT, i - 1, i, j, k)\n                    }\n                }\n            }\n        }\n    }\n\n\n\n    function getFaceDir(id0, id1, getMaterial, materialDir) {\n        // no face if both blocks are opaque\n        var op0 = id0 & OPAQUE_BIT\n        var op1 = id1 & OPAQUE_BIT\n        if (op0 && op1) return 0\n        // if either block is opaque draw a face for it\n        if (op0) return 1\n        if (op1) return -1\n        // can't tell from block IDs, so compare block materials of each face\n        var m0 = getMaterial(id0 & ID_MASK, materialDir)\n        var m1 = getMaterial(id1 & ID_MASK, materialDir + 1)\n        // if same material, draw no face. If one is missing, draw the other\n        if (m0 === m1) { return 0 }\n        else if (m0 === 0) { return -1 }\n        else if (m1 === 0) { return 1 }\n        // remaining case is two different non-opaque block materials\n        // facing each other. for now, draw neither..\n        return 0\n    }\n\n\n\n\n\n\n\n    //      Greedy meshing inner loop two\n    //\n    // construct data for mesh using the masks\n\n    function constructMeshDataFromMasks(i, d, u, v, len1, len2,\n        doAO, submeshes, getColor, aoValues, revAoVal) {\n        var n = 0\n        var mask = maskCache\n        var aomask = aomaskCache\n\n        // some logic is broken into helper functions for AO and non-AO\n        // this fixes deopts in Chrome (for reasons unknown)\n        var maskCompareFcn = (doAO) ? maskCompare : maskCompare_noAO\n        var meshColorFcn = (doAO) ? pushMeshColors : pushMeshColors_noAO\n\n        for (var k = 0; k < len2; ++k) {\n            var w = 1\n            var h = 1\n            for (var j = 0; j < len1; j += w, n += w) {\n\n                var maskVal = mask[n] | 0\n                if (!maskVal) {\n                    w = 1\n                    continue\n                }\n                var ao = aomask[n] | 0\n\n                // Compute width and height of area with same mask/aomask values\n                for (w = 1; w < len1 - j; ++w) {\n                    if (!maskCompareFcn(n + w, mask, maskVal, aomask, ao)) break\n                }\n\n                OUTER:\n                for (h = 1; h < len2 - k; ++h) {\n                    for (var m = 0; m < w; ++m) {\n                        var ix = n + m + h * len1\n                        if (!maskCompareFcn(ix, mask, maskVal, aomask, ao)) break OUTER\n                    }\n                }\n\n                // for testing: doing the following will disable greediness\n                //w=h=1\n\n                // material and mesh for this face\n                var matID = Math.abs(maskVal)\n                if (!submeshes[matID]) submeshes[matID] = new Submesh(matID)\n                var mesh = submeshes[matID]\n                var colors = mesh.colors\n                var c = getColor(matID)\n\n                // colors are pushed in helper function - avoids deopts\n                // tridir is boolean for which way to split the quad into triangles\n\n                var triDir = meshColorFcn(colors, c, ao, aoValues, revAoVal)\n\n\n                //Add quad, vertices = x -> x+du -> x+du+dv -> x+dv\n                var x = [0, 0, 0]\n                x[d] = i\n                x[u] = j\n                x[v] = k\n                var du = [0, 0, 0]\n                var dv = [0, 0, 0]\n                du[u] = w\n                dv[v] = h\n\n                var pos = mesh.positions\n                pos.push(\n                    x[0], x[1], x[2],\n                    x[0] + du[0], x[1] + du[1], x[2] + du[2],\n                    x[0] + du[0] + dv[0], x[1] + du[1] + dv[1], x[2] + du[2] + dv[2],\n                    x[0] + dv[0], x[1] + dv[1], x[2] + dv[2])\n\n\n                // add uv values, with the order and sign depending on \n                // axis and direction so as to avoid mirror-image textures\n                var dir = (maskVal > 0) ? 1 : -1\n\n                if (d === 2) {\n                    mesh.uvs.push(\n                        0, h,\n                        -dir * w, h,\n                        -dir * w, 0,\n                        0, 0)\n                } else {\n                    mesh.uvs.push(\n                        0, w,\n                        0, 0,\n                        dir * h, 0,\n                        dir * h, w)\n                }\n\n\n                // Add indexes, ordered clockwise for the facing direction;\n\n                var vs = pos.length / 3 - 4\n\n                if (maskVal < 0) {\n                    if (triDir) {\n                        mesh.indices.push(vs, vs + 1, vs + 2, vs, vs + 2, vs + 3)\n                    } else {\n                        mesh.indices.push(vs + 1, vs + 2, vs + 3, vs, vs + 1, vs + 3)\n                    }\n                } else {\n                    if (triDir) {\n                        mesh.indices.push(vs, vs + 2, vs + 1, vs, vs + 3, vs + 2)\n                    } else {\n                        mesh.indices.push(vs + 3, vs + 1, vs, vs + 3, vs + 2, vs + 1)\n                    }\n                }\n\n\n                // norms depend on which direction the mask was solid in..\n                var norm0 = d === 0 ? dir : 0\n                var norm1 = d === 1 ? dir : 0\n                var norm2 = d === 2 ? dir : 0\n\n                // same norm for all vertices\n                mesh.normals.push(\n                    norm0, norm1, norm2,\n                    norm0, norm1, norm2,\n                    norm0, norm1, norm2,\n                    norm0, norm1, norm2)\n\n\n                //Zero-out mask\n                for (var hx = 0; hx < h; ++hx) {\n                    for (var wx = 0; wx < w; ++wx) {\n                        mask[n + wx + hx * len1] = 0\n                    }\n                }\n\n            }\n        }\n    }\n\n\n\n    // Two helper functions with AO and non-AO implementations:\n\n    function maskCompare(index, mask, maskVal, aomask, aoVal) {\n        if (maskVal !== mask[index]) return false\n        if (aoVal !== aomask[index]) return false\n        return true\n    }\n\n    function maskCompare_noAO(index, mask, maskVal, aomask, aoVal) {\n        if (maskVal !== mask[index]) return false\n        return true\n    }\n\n    function pushMeshColors_noAO(colors, c, ao, aoValues, revAoVal) {\n        colors.push(c[0], c[1], c[2], 1)\n        colors.push(c[0], c[1], c[2], 1)\n        colors.push(c[0], c[1], c[2], 1)\n        colors.push(c[0], c[1], c[2], 1)\n        return true // triangle direction doesn't matter for non-AO\n    }\n\n    function pushMeshColors(colors, c, ao, aoValues, revAoVal) {\n        var ao00 = unpackAOMask(ao, 0, 0)\n        var ao10 = unpackAOMask(ao, 1, 0)\n        var ao11 = unpackAOMask(ao, 1, 1)\n        var ao01 = unpackAOMask(ao, 0, 1)\n        pushAOColor(colors, c, ao00, aoValues, revAoVal)\n        pushAOColor(colors, c, ao10, aoValues, revAoVal)\n        pushAOColor(colors, c, ao11, aoValues, revAoVal)\n        pushAOColor(colors, c, ao01, aoValues, revAoVal)\n\n        // this bit is pretty magical..\n        var triDir = true\n        if (ao00 === ao11) {\n            triDir = (ao01 === ao10) ? (ao01 == 2) : true\n        } else {\n            triDir = (ao01 === ao10) ? false : (ao00 + ao11 > ao01 + ao10)\n        }\n        return triDir\n    }\n\n\n\n\n\n    /* \n     *  packAOMask:\n     *\n     *    For a given face, find occlusion levels for each vertex, then\n     *    pack 4 such (2-bit) values into one Uint8 value\n     * \n     *  Occlusion levels:\n     *    1 is flat ground, 2 is partial occlusion, 3 is max (corners)\n     *    0 is \"reverse occlusion\" - an unoccluded exposed edge \n     *  Packing order var(bit offset):\n     *      a01(2)  -   a11(6)   ^  K\n     *        -     -            +> J\n     *      a00(0)  -   a10(4)\n     */\n\n    // when skipping reverse AO, uses this simpler version of the function:\n\n    function packAOMaskNoReverse(data, ipos, ineg, j, k) {\n        var a00 = 1\n        var a01 = 1\n        var a10 = 1\n        var a11 = 1\n        var solidBit = SOLID_BIT\n\n        // facing into a solid (non-opaque) block?\n        var facingSolid = (solidBit & data.get(ipos, j, k))\n\n        // inc occlusion of vertex next to obstructed side\n        if (data.get(ipos, j + 1, k) & solidBit) { ++a10; ++a11 }\n        if (data.get(ipos, j - 1, k) & solidBit) { ++a00; ++a01 }\n        if (data.get(ipos, j, k + 1) & solidBit) { ++a01; ++a11 }\n        if (data.get(ipos, j, k - 1) & solidBit) { ++a00; ++a10 }\n\n        // treat corners differently based when facing a solid block\n        if (facingSolid) {\n            // always 2, or 3 in corners\n            a11 = (a11 == 3 || data.get(ipos, j + 1, k + 1) & solidBit) ? 3 : 2\n            a01 = (a01 == 3 || data.get(ipos, j - 1, k + 1) & solidBit) ? 3 : 2\n            a10 = (a10 == 3 || data.get(ipos, j + 1, k - 1) & solidBit) ? 3 : 2\n            a00 = (a00 == 3 || data.get(ipos, j - 1, k - 1) & solidBit) ? 3 : 2\n        } else {\n            // treat corner as occlusion 3 only if not occluded already\n            if (a11 === 1 && (data.get(ipos, j + 1, k + 1) & solidBit)) { a11 = 2 }\n            if (a01 === 1 && (data.get(ipos, j - 1, k + 1) & solidBit)) { a01 = 2 }\n            if (a10 === 1 && (data.get(ipos, j + 1, k - 1) & solidBit)) { a10 = 2 }\n            if (a00 === 1 && (data.get(ipos, j - 1, k - 1) & solidBit)) { a00 = 2 }\n        }\n\n        return a11 << 6 | a10 << 4 | a01 << 2 | a00\n    }\n\n    // more complicated AO packing when doing reverse AO on corners\n\n    function packAOMask(data, ipos, ineg, j, k) {\n        var a00 = 1\n        var a01 = 1\n        var a10 = 1\n        var a11 = 1\n        var solidBit = SOLID_BIT\n\n        // facing into a solid (non-opaque) block?\n        var facingSolid = (solidBit & data.get(ipos, j, k))\n\n        // inc occlusion of vertex next to obstructed side\n        if (data.get(ipos, j + 1, k) & solidBit) { ++a10; ++a11 }\n        if (data.get(ipos, j - 1, k) & solidBit) { ++a00; ++a01 }\n        if (data.get(ipos, j, k + 1) & solidBit) { ++a01; ++a11 }\n        if (data.get(ipos, j, k - 1) & solidBit) { ++a00; ++a10 }\n\n        if (facingSolid) {\n            // always 2, or 3 in corners\n            a11 = (a11 == 3 || data.get(ipos, j + 1, k + 1) & solidBit) ? 3 : 2\n            a01 = (a01 == 3 || data.get(ipos, j - 1, k + 1) & solidBit) ? 3 : 2\n            a10 = (a10 == 3 || data.get(ipos, j + 1, k - 1) & solidBit) ? 3 : 2\n            a00 = (a00 == 3 || data.get(ipos, j - 1, k - 1) & solidBit) ? 3 : 2\n        } else {\n\n            // check each corner, and if not present do reverse AO\n            if (a11 === 1) {\n                if (data.get(ipos, j + 1, k + 1) & solidBit) {\n                    a11 = 2\n                } else if (!(data.get(ineg, j, k + 1) & solidBit) ||\n                    !(data.get(ineg, j + 1, k) & solidBit) ||\n                    !(data.get(ineg, j + 1, k + 1) & solidBit)) {\n                    a11 = 0\n                }\n            }\n\n            if (a10 === 1) {\n                if (data.get(ipos, j + 1, k - 1) & solidBit) {\n                    a10 = 2\n                } else if (!(data.get(ineg, j, k - 1) & solidBit) ||\n                    !(data.get(ineg, j + 1, k) & solidBit) ||\n                    !(data.get(ineg, j + 1, k - 1) & solidBit)) {\n                    a10 = 0\n                }\n            }\n\n            if (a01 === 1) {\n                if (data.get(ipos, j - 1, k + 1) & solidBit) {\n                    a01 = 2\n                } else if (!(data.get(ineg, j, k + 1) & solidBit) ||\n                    !(data.get(ineg, j - 1, k) & solidBit) ||\n                    !(data.get(ineg, j - 1, k + 1) & solidBit)) {\n                    a01 = 0\n                }\n            }\n\n            if (a00 === 1) {\n                if (data.get(ipos, j - 1, k - 1) & solidBit) {\n                    a00 = 2\n                } else if (!(data.get(ineg, j, k - 1) & solidBit) ||\n                    !(data.get(ineg, j - 1, k) & solidBit) ||\n                    !(data.get(ineg, j - 1, k - 1) & solidBit)) {\n                    a00 = 0\n                }\n            }\n        }\n\n        return a11 << 6 | a10 << 4 | a01 << 2 | a00\n    }\n\n\n\n    // unpack (2 bit) ao value from ao mask\n    // see above for details\n    function unpackAOMask(aomask, jpos, kpos) {\n        var offset = jpos ? (kpos ? 6 : 4) : (kpos ? 2 : 0)\n        return aomask >> offset & 3\n    }\n\n\n    // premultiply vertex colors by value depending on AO level\n    // then push them into color array\n    function pushAOColor(colors, baseCol, ao, aoVals, revAoVal) {\n        var mult = (ao === 0) ? revAoVal : aoVals[ao - 1]\n        colors.push(baseCol[0] * mult, baseCol[1] * mult, baseCol[2] * mult, 1)\n    }\n\n}\n\n\n\n\n\n\n\nimport { makeProfileHook } from './util'\nvar profile_hook = (PROFILE_EVERY) ?\n    makeProfileHook(PROFILE_EVERY, 'Terrain meshing') : () => { }\n","import { SolidParticleSystem } from '@babylonjs/core/Particles/solidParticleSystem'\n\n\nexport default new ObjectMesher()\n\n\n// enable for profiling..\nvar PROFILE = 0\n\n\n\n\n// helper class to hold data about a single object mesh\nfunction ObjMeshDat(id, x, y, z) {\n    this.id = id | 0\n    this.x = x | 0\n    this.y = y | 0\n    this.z = z | 0\n}\n\n\n\n\n\n\n\n/*\n * \n * \n *          Object meshing\n *  Per-chunk handling of the creation/disposal of voxels with static meshes\n * \n * \n */\n\n\nfunction ObjectMesher() {\n\n\n    // adds properties to the new chunk that will be used when processing\n    this.initChunk = function (chunk) {\n        chunk._objectBlocks = {}\n        chunk._objectSystems = []\n    }\n\n    this.disposeChunk = function (chunk) {\n        this.removeObjectMeshes(chunk)\n        chunk._objectBlocks = null\n    }\n\n\n\n\n    // accessors for the chunk to regester as object voxels are set/unset\n    this.addObjectBlock = function (chunk, id, x, y, z) {\n        var key = x + '|' + y + '|' + z\n        chunk._objectBlocks[key] = new ObjMeshDat(id, x, y, z, null)\n    }\n\n    this.removeObjectBlock = function (chunk, x, y, z) {\n        var key = x + '|' + y + '|' + z\n        if (chunk._objectBlocks[key]) delete chunk._objectBlocks[key]\n    }\n\n\n\n\n    /*\n     * \n     *    main implementation - remove / rebuild all needed object mesh instances\n     * \n     */\n\n    this.removeObjectMeshes = function (chunk) {\n        // remove the current (if any) sps/mesh\n        var systems = chunk._objectSystems || []\n        while (systems.length) {\n            var sps = systems.pop()\n            if (sps.mesh) sps.mesh.dispose()\n            sps.dispose()\n        }\n    }\n\n    this.buildObjectMeshes = function (chunk) {\n        profile_hook('start')\n\n        var scene = chunk.noa.rendering.getScene()\n        var objectMeshLookup = chunk.noa.registry._blockMeshLookup\n\n        // preprocess everything to build lists of object block keys\n        // hashed by material ID and then by block ID\n        var matIndexes = {}\n        for (var key in chunk._objectBlocks) {\n            var blockDat = chunk._objectBlocks[key]\n            var blockID = blockDat.id\n            var mat = objectMeshLookup[blockID].material\n            var matIndex = (mat) ? scene.materials.indexOf(mat) : -1\n            if (!matIndexes[matIndex]) matIndexes[matIndex] = {}\n            if (!matIndexes[matIndex][blockID]) matIndexes[matIndex][blockID] = []\n            matIndexes[matIndex][blockID].push(key)\n        }\n        profile_hook('preprocess')\n\n        // data structure now looks like:\n        // matIndexes = {\n        //      2: {                    // i.e. 2nd material in scene\n        //          14: {               // i.e. voxel ID 14 from registry\n        //              [ '2|3|4' ]     // key of block's local coords\n        //          }\n        //      }\n        // }\n\n        var x0 = chunk.i * chunk.size\n        var y0 = chunk.j * chunk.size\n        var z0 = chunk.k * chunk.size\n\n        // build one SPS mesh for each material\n        var meshes = []\n        for (var ix in matIndexes) {\n\n            var meshHash = matIndexes[ix]\n            var sps = buildSPSforMaterialIndex(chunk, scene, meshHash, x0, y0, z0)\n            profile_hook('made SPS')\n\n            // build SPS into the scene\n            var merged = sps.buildMesh()\n            profile_hook('built mesh')\n\n            // finish up\n            merged.material = (ix > -1) ? scene.materials[ix] : null\n            meshes.push(merged)\n            chunk._objectSystems.push(sps)\n        }\n\n        profile_hook('end')\n        return meshes\n    }\n\n\n\n\n    function buildSPSforMaterialIndex(chunk, scene, meshHash, x0, y0, z0) {\n        var blockHash = chunk._objectBlocks\n        // base sps\n        var sps = new SolidParticleSystem('object_sps_' + chunk.id, scene, {\n            updatable: false,\n        })\n\n        var blockHandlerLookup = chunk.noa.registry._blockHandlerLookup\n        var objectMeshLookup = chunk.noa.registry._blockMeshLookup\n\n        // run through mesh hash adding shapes and position functions\n        for (var blockID in meshHash) {\n            var mesh = objectMeshLookup[blockID]\n            var blockArr = meshHash[blockID]\n            var count = blockArr.length\n\n            var handlerFn\n            var handlers = blockHandlerLookup[blockID]\n            if (handlers) handlerFn = handlers.onCustomMeshCreate\n            var setShape = function (particle, partIndex, shapeIndex) {\n                var key = blockArr[shapeIndex]\n                var dat = blockHash[key]\n\n                // set (local) pos and call handler (with global coords)\n                particle.position.set(dat.x + 0.5, dat.y, dat.z + 0.5)\n                if (handlerFn) handlerFn(particle, x0 + dat.x, y0 + dat.y, z0 + dat.z)\n            }\n            sps.addShape(mesh, count, { positionFunction: setShape })\n            blockArr.length = 0\n        }\n\n        return sps\n    }\n\n\n\n\n}\n\n\n\n\n\n\n\nimport { makeProfileHook } from './util'\nvar profile_hook = (PROFILE) ?\n    makeProfileHook(50, 'Object meshing') : () => { }\n","\nvar ndarray = require('ndarray')\n\n// shared references to terrain/object meshers\nimport terrainMesher from './terrainMesher'\nimport objectMesher from './objectMesher'\nimport { constants } from './constants'\n\n\nexport default Chunk\n\n\n/* \n * \n *   Chunk\n * \n *  Stores and manages voxel ids and flags for each voxel within chunk\n *  See constants.js for internal data representation\n * \n */\n\n\n\n// data representation\nvar ID_MASK = constants.ID_MASK\n// var VAR_MASK = constants.VAR_MASK // NYI\nvar SOLID_BIT = constants.SOLID_BIT\nvar OPAQUE_BIT = constants.OPAQUE_BIT\nvar OBJECT_BIT = constants.OBJECT_BIT\n\n\n\n\n/*\n *\n *    Chunk constructor\n *\n */\n\nfunction Chunk(noa, id, i, j, k, size, dataArray) {\n    this.id = id            // id used by noa\n    this.requestID = ''     // id sent to game client\n\n    this.noa = noa\n    this.isDisposed = false\n    this.octreeBlock = null\n\n    // voxel data and properties\n    this.voxels = dataArray\n    this.i = i\n    this.j = j\n    this.k = k\n    this.size = size\n    this.x = i * size\n    this.y = j * size\n    this.z = k * size\n\n    // flags to track if things need re-meshing\n    this._terrainDirty = false\n    this._objectsDirty = false\n\n    // init references shared among all chunks\n    setBlockLookups(noa)\n\n    // makes data for terrain / object meshing\n    this._terrainMesh = null\n    this._objectBlocks = null\n    this._objectSystems = null\n    objectMesher.initChunk(this)\n\n    this.isFull = false\n    this.isEmpty = false\n\n    // references to neighboring chunks, if they exist (filled in by `world`)\n    var narr = Array.from(Array(27)).map(() => null)\n    this._neighbors = new ndarray(narr, [3, 3, 3]).lo(1, 1, 1)\n    this._neighbors.set(0, 0, 0, this)\n    this._neighborCount = 0\n    this._maxMeshedNeighbors = 0\n    this._timesMeshed = 0\n\n    // converts raw voxelID data into packed ID+solidity etc.\n    packVoxelData(this)\n}\n\n\n// expose logic internally to create and update the voxel data array\nChunk._createVoxelArray = function (size) {\n    var arr = new Uint16Array(size * size * size)\n    return new ndarray(arr, [size, size, size])\n}\n\nChunk.prototype._updateVoxelArray = function (dataArray) {\n    // dispose current object blocks\n    callAllBlockHandlers(this, 'onUnload')\n    objectMesher.disposeChunk(this)\n    this.voxels = dataArray\n    this._terrainDirty = false\n    this._objectsDirty = false\n    objectMesher.initChunk(this)\n    packVoxelData(this)\n}\n\n\n// Registry lookup references shared by all chunks\nvar solidLookup\nvar opaqueLookup\nvar objectMeshLookup\nvar blockHandlerLookup\n\nfunction setBlockLookups(noa) {\n    solidLookup = noa.registry._solidityLookup\n    opaqueLookup = noa.registry._opacityLookup\n    objectMeshLookup = noa.registry._blockMeshLookup\n    blockHandlerLookup = noa.registry._blockHandlerLookup\n}\n\n\n\n\n\n\n\n\n/*\n *\n *    Chunk API\n *\n */\n\n// get/set deal with block IDs, so that this class acts like an ndarray\n\nChunk.prototype.get = function (x, y, z) {\n    return ID_MASK & this.voxels.get(x, y, z)\n}\n\nChunk.prototype.getSolidityAt = function (x, y, z) {\n    return (SOLID_BIT & this.voxels.get(x, y, z)) ? true : false\n}\n\nChunk.prototype.set = function (x, y, z, id) {\n    var oldID = this.voxels.get(x, y, z)\n    var oldIDnum = oldID & ID_MASK\n    if (id === oldIDnum) return\n\n    // manage data\n    var newID = packID(id)\n    this.voxels.set(x, y, z, newID)\n\n    // voxel lifecycle handling\n    if (oldID & OBJECT_BIT) removeObjectBlock(this, x, y, z)\n    if (newID & OBJECT_BIT) addObjectBlock(this, id, x, y, z)\n    callBlockHandler(this, oldIDnum, 'onUnset', x, y, z)\n    callBlockHandler(this, id, 'onSet', x, y, z)\n\n    // track full/emptiness and info about terrain\n    if ((newID & OPAQUE_BIT) === 0) this.isFull = false\n    if (newID !== 0) this.isEmpty = false\n    if (affectsTerrain(newID) || affectsTerrain(oldID)) {\n        this._terrainDirty = true\n    }\n\n    if (this._terrainDirty || this._objectsDirty) {\n        this.noa.world._queueChunkForRemesh(this)\n    }\n\n    // neighbors only affected if solidity or opacity changed on an edge\n    var prevSO = oldID & (SOLID_BIT | OPAQUE_BIT)\n    var newSO = newID & (SOLID_BIT | OPAQUE_BIT)\n    if (newSO !== prevSO) {\n        var edge = this.size - 1\n        var iedge = (x === 0) ? -1 : (x < edge) ? 0 : 1\n        var jedge = (y === 0) ? -1 : (y < edge) ? 0 : 1\n        var kedge = (z === 0) ? -1 : (z < edge) ? 0 : 1\n        if (iedge | jedge | kedge) {\n            var is = (iedge) ? [0, iedge] : [0]\n            var js = (jedge) ? [0, jedge] : [0]\n            var ks = (kedge) ? [0, kedge] : [0]\n            is.forEach(i => {\n                js.forEach(j => {\n                    ks.forEach(k => {\n                        if ((i | j | k) === 0) return\n                        var nab = this._neighbors.get(i, j, k)\n                        if (!nab) return\n                        nab._terrainDirty = true\n                        this.noa.world._queueChunkForRemesh(nab)\n                    })\n                })\n            })\n        }\n    }\n}\n\n\n\n\n\n\n// helper to call handler of a given type at a particular xyz\nfunction callBlockHandler(chunk, blockID, type, x, y, z) {\n    var hobj = blockHandlerLookup[blockID]\n    if (!hobj) return\n    var handler = hobj[type]\n    if (!handler) return\n    handler(chunk.x + x, chunk.y + y, chunk.z + z)\n}\n\n\n\n// Convert chunk's voxel terrain into a babylon.js mesh\n// Used internally, but needs to be public so mesh-building hacks can call it\nChunk.prototype.mesh = function (matGetter, colGetter, useAO, aoVals, revAoVal) {\n    return terrainMesher.meshChunk(this, matGetter, colGetter, useAO, aoVals, revAoVal)\n}\n\n\n\n\n\n// gets called by World when this chunk has been queued for remeshing\nChunk.prototype.updateMeshes = function () {\n    var rendering = this.noa.rendering\n    if (this._terrainDirty) {\n        if (this._terrainMesh) this._terrainMesh.dispose()\n        var mesh = this.mesh()\n        if (mesh && mesh.getIndices().length > 0) {\n            var pos = [this.x, this.y, this.z]\n            rendering.addMeshToScene(mesh, true, pos, this)\n        }\n        this._terrainMesh = mesh || null\n        this._terrainDirty = false\n        this._timesMeshed++\n        this._maxMeshedNeighbors = Math.max(this._maxMeshedNeighbors, this._neighborCount)\n    }\n    if (this._objectsDirty) {\n        objectMesher.removeObjectMeshes(this)\n        var meshes = objectMesher.buildObjectMeshes(this)\n        var pos2 = [this.x, this.y, this.z]\n        meshes.forEach(mesh => rendering.addMeshToScene(mesh, true, pos2, this))\n        this._objectsDirty = false\n    }\n}\n\n\n\n\n\n\n\n// helpers to determine which blocks are, or can affect, terrain meshes\nfunction affectsTerrain(id) {\n    if (id === 0) return false\n    if (id & SOLID_BIT) return true\n    return ((id & OBJECT_BIT) === 0)\n}\n\n// helper to pack a block ID into the internally stored form, given lookup tables\nfunction packID(id) {\n    var newID = id\n    if (solidLookup[id]) newID |= SOLID_BIT\n    if (opaqueLookup[id]) newID |= OPAQUE_BIT\n    if (objectMeshLookup[id]) newID |= OBJECT_BIT\n    return newID\n}\n\n\n\n\n\n\n\n\n/*\n * \n *      Init\n * \n *  Converts raw voxel ID data into packed ID + solidity etc.\n * \n*/\n\nfunction packVoxelData(chunk) {\n    // flags for tracking if chunk is entirely opaque or transparent\n    var fullyOpaque = OPAQUE_BIT\n    var fullyAir = true\n    var hasObj = false\n\n    var voxels = chunk.voxels\n    var len = voxels.shape[0]\n    for (var i = 0; i < len; ++i) {\n        for (var j = 0; j < len; ++j) {\n            var index = voxels.index(i, j, 0)\n            for (var k = 0; k < len; ++k, ++index) {\n                // pull raw ID - could in principle be packed, so mask it\n                var id = voxels.data[index] & ID_MASK\n                // skip air blocks\n                if (id === 0) {\n                    fullyOpaque = 0\n                    continue\n                }\n                // store ID as packed internal representation\n                var packed = packID(id) | 0\n                voxels.data[index] = packed\n                fullyOpaque &= packed\n                fullyAir = false\n                // within unpadded view, handle object blocks and handlers\n                if (OBJECT_BIT & packed) {\n                    addObjectBlock(chunk, id, i, j, k)\n                    hasObj = true\n                }\n                callBlockHandler(chunk, id, 'onLoad', i, j, k)\n            }\n        }\n    }\n\n    chunk.isFull = !!(fullyOpaque & OPAQUE_BIT)\n    chunk.isEmpty = !!(fullyAir)\n    chunk._terrainDirty = !chunk.isEmpty\n    chunk._objectsDirty = hasObj\n}\n\n\n\n\n\n// accessors related to meshing\n\nfunction addObjectBlock(chunk, id, x, y, z) {\n    objectMesher.addObjectBlock(chunk, id, x, y, z)\n    chunk._objectsDirty = true\n}\n\nfunction removeObjectBlock(chunk, x, y, z) {\n    objectMesher.removeObjectBlock(chunk, x, y, z)\n    chunk._objectsDirty = true\n}\n\n\n\n\n\n// dispose function - just clears properties and references\n\nChunk.prototype.dispose = function () {\n    // look through the data for onUnload handlers\n    callAllBlockHandlers(this, 'onUnload')\n\n    // let meshers dispose their stuff\n    objectMesher.disposeChunk(this)\n    if (this._terrainMesh) this._terrainMesh.dispose()\n\n    // apparently there's no way to dispose typed arrays, so just null everything\n    this.voxels.data = null\n    this.voxels = null\n    this._neighbors.data = null\n    this._neighbors = null\n\n    this.isDisposed = true\n}\n\n\n// helper to call a given handler for all blocks in the chunk\nfunction callAllBlockHandlers(chunk, type) {\n    var arr = chunk.voxels\n    var size = arr.shape[0]\n    for (var i = 0; i < size; ++i) {\n        for (var j = 0; j < size; ++j) {\n            for (var k = 0; k < size; ++k) {\n                var id = ID_MASK & arr.get(i, j, k)\n                if (id > 0) callBlockHandler(chunk, id, type, i, j, k)\n            }\n        }\n    }\n}\n","\nvar EventEmitter = require('events').EventEmitter\nimport Chunk from './chunk'\nimport { StringList } from './util'\nimport { loopForTime, numberOfVoxelsInSphere } from './util'\n\nvar PROFILE = 0\nvar PROFILE_QUEUES = 0\n\n\nexport default function (noa, opts) {\n    return new World(noa, opts)\n}\n\n\n\n\nvar defaultOptions = {\n    chunkSize: 24,\n    chunkAddDistance: 3,\n    chunkRemoveDistance: 4,\n    worldGenWhilePaused: false,\n}\n\n/**\n * @class\n * @typicalname noa.world\n * @emits worldDataNeeded(id, ndarray, x, y, z, worldName)\n * @emits chunkAdded(chunk)\n * @emits chunkBeingRemoved(id, ndarray, userData)\n * @classdesc Manages the world and its chunks\n * \n * Extends `EventEmitter`\n */\n\nfunction World(noa, opts) {\n    this.noa = noa\n    opts = Object.assign({}, defaultOptions, opts)\n\n    this.playerChunkLoaded = false\n    this.Chunk = Chunk\n\n    this.chunkSize = opts.chunkSize\n    this.chunkAddDistance = opts.chunkAddDistance\n    this.chunkRemoveDistance = opts.chunkRemoveDistance\n    if (this.chunkRemoveDistance < this.chunkAddDistance) {\n        this.chunkRemoveDistance = this.chunkAddDistance\n    }\n\n    // set this higher to cause chunks not to mesh until they have some neighbors\n    this.minNeighborsToMesh = 6\n\n    // settings for tuning worldgen behavior and throughput\n    this.maxChunksPendingCreation = 10\n    this.maxChunksPendingMeshing = 10\n    this.maxProcessingPerTick = 9      // ms\n    this.maxProcessingPerRender = 5    // ms\n    this.worldGenWhilePaused = opts.worldGenWhilePaused\n\n    // set up internal state\n    this._cachedWorldName = ''\n    this._lastPlayerChunkID = ''\n    this._chunkStorage = {}\n    initChunkQueues(this)\n    initChunkStorage(this)\n\n    // instantiate coord conversion functions based on the chunk size\n    // use bit twiddling if chunk size is a power of 2\n    var cs = this.chunkSize\n    if ((cs & cs - 1) === 0) {\n        var shift = Math.log2(cs) | 0\n        var mask = (cs - 1) | 0\n        this._worldCoordToChunkCoord = coord => (coord >> shift) | 0\n        this._worldCoordToChunkIndex = coord => (coord & mask) | 0\n    } else {\n        this._worldCoordToChunkCoord = coord => Math.floor(coord / cs) | 0\n        this._worldCoordToChunkIndex = coord => (((coord % cs) + cs) % cs) | 0\n    }\n\n}\nWorld.prototype = Object.create(EventEmitter.prototype)\n\n\n\n\n\n\n/*\n *\n *\n *\n *\n *                  PUBLIC API \n *\n *\n *\n *\n*/\n\n/** @param x,y,z */\nWorld.prototype.getBlockID = function (x, y, z) {\n    var chunk = this._getChunkByCoords(x, y, z)\n    if (!chunk) return 0\n    return chunk.get(\n        this._worldCoordToChunkIndex(x),\n        this._worldCoordToChunkIndex(y),\n        this._worldCoordToChunkIndex(z))\n}\n\n/** @param x,y,z */\nWorld.prototype.getBlockSolidity = function (x, y, z) {\n    var chunk = this._getChunkByCoords(x, y, z)\n    if (!chunk) return false\n    return !!chunk.getSolidityAt(\n        this._worldCoordToChunkIndex(x),\n        this._worldCoordToChunkIndex(y),\n        this._worldCoordToChunkIndex(z))\n}\n\n/** @param x,y,z */\nWorld.prototype.getBlockOpacity = function (x, y, z) {\n    var id = this.getBlockID(x, y, z)\n    return this.noa.registry.getBlockOpacity(id)\n}\n\n/** @param x,y,z */\nWorld.prototype.getBlockFluidity = function (x, y, z) {\n    var id = this.getBlockID(x, y, z)\n    return this.noa.registry.getBlockFluidity(id)\n}\n\n/** @param x,y,z */\nWorld.prototype.getBlockProperties = function (x, y, z) {\n    var id = this.getBlockID(x, y, z)\n    return this.noa.registry.getBlockProps(id)\n}\n\n/** @param x,y,z */\nWorld.prototype.getBlockObjectMesh = function (x, y, z) {\n    var chunk = this._getChunkByCoords(x, y, z)\n    if (!chunk) return 0\n    return chunk.getObjectMeshAt(\n        this._worldCoordToChunkIndex(x),\n        this._worldCoordToChunkIndex(y),\n        this._worldCoordToChunkIndex(z))\n}\n\n\n/** @param x,y,z */\nWorld.prototype.setBlockID = function (val, x, y, z) {\n    var i = this._worldCoordToChunkCoord(x)\n    var j = this._worldCoordToChunkCoord(y)\n    var k = this._worldCoordToChunkCoord(z)\n    var ix = this._worldCoordToChunkIndex(x)\n    var iy = this._worldCoordToChunkIndex(y)\n    var iz = this._worldCoordToChunkIndex(z)\n\n    // logic inside the chunk will trigger a remesh for chunk and \n    // any neighbors that need it\n    var chunk = this._getChunk(i, j, k)\n    if (chunk) chunk.set(ix, iy, iz, val)\n}\n\n\n/** @param x,y,z */\nWorld.prototype.isBoxUnobstructed = function (box) {\n    var base = box.base\n    var max = box.max\n    for (var i = Math.floor(base[0]); i < max[0] + 1; i++) {\n        for (var j = Math.floor(base[1]); j < max[1] + 1; j++) {\n            for (var k = Math.floor(base[2]); k < max[2] + 1; k++) {\n                if (this.getBlockSolidity(i, j, k)) return false\n            }\n        }\n    }\n    return true\n}\n\n\n/** client should call this after creating a chunk's worth of data (as an ndarray)  \n * If userData is passed in it will be attached to the chunk\n * @param id\n * @param array\n * @param userData\n */\nWorld.prototype.setChunkData = function (id, array, userData) {\n    setChunkData(this, id, array, userData)\n}\n\n\n/** Tells noa to discard voxel data within a given `AABB` (e.g. because \n * the game client received updated data from a server). \n * The engine will mark all affected chunks for disposal, and will later emit \n * new `worldDataNeeded` events (if the chunk is still in draw range).\n * Note that chunks invalidated this way will not emit a `chunkBeingRemoved` event \n * for the client to save data from.\n */\nWorld.prototype.invalidateVoxelsInAABB = function (box) {\n    invalidateChunksInBox(this, box)\n}\n\n\n\n\n\n\n\n/*\n * \n * \n * \n *                  internals:\n * \n *          tick functions that process queues and trigger events\n * \n * \n * \n*/\n\n\nWorld.prototype.tick = function () {\n    var tickStartTime = performance.now()\n\n    // if world has changed, mark everything to be removed and re-requested\n    if (this._cachedWorldName !== this.noa.worldName) {\n        markAllChunksForRemoval(this)\n        this._cachedWorldName = this.noa.worldName\n    }\n\n    // current player chunk changed since last tick?\n    var pos = getPlayerChunkCoords(this)\n    var chunkID = getChunkID(pos[0], pos[1], pos[2])\n    var changedChunks = (chunkID != this._lastPlayerChunkID)\n    if (changedChunks) {\n        this.emit('playerEnteredChunk', pos[0], pos[1], pos[2])\n        this._lastPlayerChunkID = chunkID\n    }\n    profile_hook('start')\n    profile_queues_hook('start')\n\n    // possibly scan for chunks to add/remove\n    if (changedChunks) {\n        findDistantChunksToRemove(this, pos[0], pos[1], pos[2])\n        profile_hook('remQueue')\n    }\n    var numChunks = numberOfVoxelsInSphere(this.chunkAddDistance)\n    if (changedChunks || (this._chunkIDsKnown.count() < numChunks)) {\n        findNewChunksInRange(this, pos[0], pos[1], pos[2])\n        profile_hook('addQueue')\n    }\n\n    // process (create or mesh) some chunks, up to max iteration time\n    loopForTime(this.maxProcessingPerTick, () => {\n        var done = processRequestQueue(this)\n        profile_hook('requests')\n        done = done && processRemoveQueue(this)\n        profile_hook('removes')\n        done = done && processMeshingQueue(this, false)\n        profile_hook('meshes')\n        return done\n    }, tickStartTime)\n\n    // when time is left over, look for low-priority extra meshing\n    var dt = performance.now() - tickStartTime\n    if (dt + 2 < this.maxProcessingPerTick) {\n        lookForChunksToMesh(this)\n        profile_hook('looking')\n        loopForTime(this.maxProcessingPerTick, () => {\n            var done = processMeshingQueue(this, false)\n            profile_hook('meshes')\n            return done\n        }, tickStartTime, true)\n    }\n\n    // track whether the player's local chunk is loaded and ready or not\n    var pChunk = this._getChunk(pos[0], pos[1], pos[2])\n    this.playerChunkLoaded = !!pChunk\n\n    profile_queues_hook('end', this)\n    profile_hook('end')\n}\n\n\nWorld.prototype.render = function () {\n    // on render, quickly process the high-priority meshing queue\n    // to help avoid flashes of background while neighboring chunks update\n    loopForTime(this.maxProcessingPerRender, () => {\n        return processMeshingQueue(this, true)\n    })\n}\n\n\n\n\n\n\n\n\n/*\n * \n * \n * \n *              chunk IDs, storage, and lookup/retrieval\n * \n * \n * \n*/\n\nfunction getChunkID(i, j, k) {\n    // chunk coords -> canonical string ID\n    return i + '|' + j + '|' + k\n}\n\nfunction parseChunkID(id) {\n    // chunk ID -> coords\n    return id.split('|').map(s => parseInt(s))\n}\n\nfunction initChunkStorage(world) {\n    // var chunkHash = ndHash([1024, 1024, 1024])\n    world._getChunk = (i, j, k) => {\n        var id = getChunkID(i, j, k)\n        return world._chunkStorage[id] || null\n    }\n    world._setChunk = (i, j, k, value) => {\n        var id = getChunkID(i, j, k)\n        if (value) {\n            world._chunkStorage[id] = value\n        } else {\n            delete world._chunkStorage[id]\n        }\n    }\n    // chunk accessor for internal use\n    world._getChunkByCoords = function (x, y, z) {\n        var i = world._worldCoordToChunkCoord(x)\n        var j = world._worldCoordToChunkCoord(y)\n        var k = world._worldCoordToChunkCoord(z)\n        return world._getChunk(i, j, k)\n    }\n}\n\nfunction getPlayerChunkCoords(world) {\n    var pos = world.noa.entities.getPosition(world.noa.playerEntity)\n    var i = world._worldCoordToChunkCoord(pos[0])\n    var j = world._worldCoordToChunkCoord(pos[1])\n    var k = world._worldCoordToChunkCoord(pos[2])\n    return [i, j, k]\n}\n\n\n\n\n\n\n\n\n/*\n * \n * \n * \n *              chunk queues and queue processing\n * \n * \n * \n*/\n\n\nfunction initChunkQueues(world) {\n    // queue meanings:\n    //    Known:        all chunks existing in any queue\n    //    ToRequest:    needed but not yet requested from client\n    //    Pending:      requested, awaiting creation\n    //    ToMesh:       created but not yet meshed\n    //    ToMeshFirst:  priority meshing queue\n    //    ToRemove:     chunks awaiting disposal\n    world._chunkIDsKnown = new StringList()\n    world._chunkIDsToRequest = new StringList()\n    world._chunkIDsPending = new StringList()\n    world._chunkIDsToMesh = new StringList()\n    world._chunkIDsToMeshFirst = new StringList()\n    world._chunkIDsToRemove = new StringList()\n    // accessor for chunks to queue themselves for remeshing\n    world._queueChunkForRemesh = (chunk) => {\n        queueChunkForRemesh(world, chunk)\n    }\n}\n\n\n// process neighborhood chunks, add missing ones to \"toRequest\" and \"inMemory\"\nfunction findNewChunksInRange(world, ci, cj, ck) {\n    var add = Math.ceil(world.chunkAddDistance)\n    var addDistSq = world.chunkAddDistance * world.chunkAddDistance\n    var known = world._chunkIDsKnown\n    var toRequest = world._chunkIDsToRequest\n    // search all nearby chunk locations\n    for (var i = ci - add; i <= ci + add; ++i) {\n        for (var j = cj - add; j <= cj + add; ++j) {\n            for (var k = ck - add; k <= ck + add; ++k) {\n                var id = getChunkID(i, j, k)\n                if (known.includes(id)) continue\n                var di = i - ci\n                var dj = j - cj\n                var dk = k - ck\n                var distSq = di * di + dj * dj + dk * dk\n                if (distSq > addDistSq) continue\n                known.add(id)\n                toRequest.add(id)\n            }\n        }\n    }\n    sortIDListByDistanceFrom(toRequest, ci, cj, ck)\n}\n\n\n// rebuild queue of chunks to be removed from around (ci,cj,ck)\nfunction findDistantChunksToRemove(world, ci, cj, ck) {\n    var remDistSq = world.chunkRemoveDistance * world.chunkRemoveDistance\n    var toRemove = world._chunkIDsToRemove\n    world._chunkIDsKnown.forEach(id => {\n        if (toRemove.includes(id)) return\n        var loc = parseChunkID(id)\n        var di = loc[0] - ci\n        var dj = loc[1] - cj\n        var dk = loc[2] - ck\n        var distSq = di * di + dj * dj + dk * dk\n        if (distSq < remDistSq) return\n        // flag chunk for removal and remove it from work queues\n        world._chunkIDsToRemove.add(id)\n        world._chunkIDsToRequest.remove(id)\n        world._chunkIDsToMesh.remove(id)\n        world._chunkIDsToMeshFirst.remove(id)\n    })\n    sortIDListByDistanceFrom(toRemove, ci, cj, ck)\n}\n\n\n// invalidate chunks overlapping the given AABB\nfunction invalidateChunksInBox(world, box) {\n    var min = box.base.map(n => Math.floor(world._worldCoordToChunkCoord(n)))\n    var max = box.max.map(n => Math.floor(world._worldCoordToChunkCoord(n)))\n    world._chunkIDsKnown.forEach(id => {\n        var pos = parseChunkID(id)\n        for (var i = 0; i < 3; i++) {\n            if (pos[i] < min[i] || pos[i] > max[i]) return\n        }\n        if (world._chunkIDsToRemove.includes(id)) return\n        world._chunkIDsToRequest.add(id)\n    })\n}\n\n// when current world changes - empty work queues and mark all for removal\nfunction markAllChunksForRemoval(world) {\n    world._chunkIDsToRemove.copyFrom(world._chunkIDsKnown)\n    world._chunkIDsToRequest.empty()\n    world._chunkIDsToMesh.empty()\n    world._chunkIDsToMeshFirst.empty()\n    var loc = getPlayerChunkCoords(world)\n    sortIDListByDistanceFrom(world._chunkIDsToRemove, loc[0], loc[1], loc[2])\n}\n\n\n// incrementally look for chunks that could stand to be re-meshed\nfunction lookForChunksToMesh(world) {\n    var queue = world._chunkIDsKnown.arr\n    var ct = Math.min(50, queue.length)\n    var numQueued = world._chunkIDsToMesh.count() + world._chunkIDsToMeshFirst.count()\n    for (var i = 0; i < ct; i++) {\n        lookIndex = (lookIndex + 1) % queue.length\n        var id = queue[lookIndex]\n        var chunk = world._chunkStorage[id]\n        if (!chunk) continue\n        var nc = chunk._neighborCount\n        if (nc < world.minNeighborsToMesh) continue\n        if (nc <= chunk._maxMeshedNeighbors) continue\n        queueChunkForRemesh(world, chunk)\n        if (++numQueued > 10) return\n    }\n}\nvar lookIndex = -1\n\n\n\n// run through chunk tracking queues looking for work to do next\nfunction processRequestQueue(world) {\n    var toRequest = world._chunkIDsToRequest\n    if (toRequest.isEmpty()) return true\n    // skip if too many outstanding requests, or if meshing queue is full\n    var pending = world._chunkIDsPending.count()\n    var toMesh = world._chunkIDsToMesh.count()\n    if (pending >= world.maxChunksPendingCreation) return true\n    if (toMesh >= world.maxChunksPendingMeshing) return true\n    var id = toRequest.pop()\n    requestNewChunk(world, id)\n    return toRequest.isEmpty()\n}\n\n\nfunction processRemoveQueue(world) {\n    var toRemove = world._chunkIDsToRemove\n    if (toRemove.isEmpty()) return true\n    removeChunk(world, toRemove.pop())\n    return (toRemove.isEmpty())\n}\n\n\n// similar to above but for chunks waiting to be meshed\nfunction processMeshingQueue(world, firstOnly) {\n    var queue = world._chunkIDsToMeshFirst\n    if (queue.isEmpty() && !firstOnly) queue = world._chunkIDsToMesh\n    if (queue.isEmpty()) return true\n\n    var id = queue.pop()\n    if (world._chunkIDsToRemove.includes(id)) return\n    var chunk = world._chunkStorage[id]\n    if (chunk) doChunkRemesh(world, chunk)\n}\n\n\n\n\n\n\n\n\n\n/*\n * \n * \n * \n *              chunk lifecycle - create / set / remove / modify\n * \n * \n * \n*/\n\n\n// create chunk object and request voxel data from client\nfunction requestNewChunk(world, id) {\n    var pos = parseChunkID(id)\n    var i = pos[0]\n    var j = pos[1]\n    var k = pos[2]\n    var size = world.chunkSize\n    var dataArr = Chunk._createVoxelArray(world.chunkSize)\n    var worldName = world.noa.worldName\n    var requestID = [i, j, k, worldName].join('|')\n    var x = i * size\n    var y = j * size\n    var z = k * size\n    world._chunkIDsPending.add(id)\n    world.emit('worldDataNeeded', requestID, dataArr, x, y, z, worldName)\n    profile_queues_hook('request')\n}\n\n// called when client sets a chunk's voxel data\n// If userData is passed in it will be attached to the chunk\nfunction setChunkData(world, reqID, array, userData) {\n    var arr = reqID.split('|')\n    var i = parseInt(arr.shift())\n    var j = parseInt(arr.shift())\n    var k = parseInt(arr.shift())\n    var worldName = arr.join('|')\n    var id = getChunkID(i, j, k)\n    world._chunkIDsPending.remove(id)\n    // discard data if it's for a world that's no longer current\n    if (worldName !== world.noa.worldName) return\n    // discard if chunk is no longer needed\n    if (!world._chunkIDsKnown.includes(id)) return\n    if (world._chunkIDsToRemove.includes(id)) return\n    var chunk = world._chunkStorage[id]\n    if (!chunk) {\n        // if chunk doesn't exist, create and init\n        var size = world.chunkSize\n        chunk = new Chunk(world.noa, id, i, j, k, size, array)\n        world._setChunk(i, j, k, chunk)\n        chunk.requestID = reqID\n        chunk.userData = userData\n        updateNeighborsOfChunk(world, i, j, k, chunk)\n        world.noa.rendering.prepareChunkForRendering(chunk)\n        world.emit('chunkAdded', chunk)\n    } else {\n        // else we're updating data for an existing chunk\n        chunk._updateVoxelArray(array)\n        // assume neighbors need remeshing\n        var list = chunk._neighbors.data\n        list.forEach(nab => {\n            if (!nab || nab === chunk) return\n            if (nab._neighborCount > 20) queueChunkForRemesh(world, nab)\n        })\n    }\n    // chunk can now be meshed...\n    queueChunkForRemesh(world, chunk)\n    profile_queues_hook('receive')\n}\n\n\n\n// remove a chunk that wound up in the remove queue\nfunction removeChunk(world, id) {\n    var loc = parseChunkID(id)\n    var chunk = world._getChunk(loc[0], loc[1], loc[2])\n    if (chunk) {\n        world.emit('chunkBeingRemoved', chunk.requestID, chunk.voxels, chunk.userData)\n        world.noa.rendering.disposeChunkForRendering(chunk)\n        chunk.dispose()\n        profile_queues_hook('dispose')\n        updateNeighborsOfChunk(world, loc[0], loc[1], loc[2], null)\n    }\n    world._setChunk(loc[0], loc[1], loc[2], null)\n    world._chunkIDsKnown.remove(id)\n    world._chunkIDsToMesh.remove(id)\n    world._chunkIDsToMeshFirst.remove(id)\n}\n\n\nfunction queueChunkForRemesh(world, chunk) {\n    var nc = chunk._neighborCount\n    var limit = Math.min(world.minNeighborsToMesh, 26)\n    if (nc < limit) return\n    chunk._terrainDirty = true\n    var queue = (nc === 26) ?\n        world._chunkIDsToMeshFirst : world._chunkIDsToMesh\n    queue.add(chunk.id)\n}\n\n\nfunction doChunkRemesh(world, chunk) {\n    world._chunkIDsToMesh.remove(chunk.id)\n    world._chunkIDsToMeshFirst.remove(chunk.id)\n    chunk.updateMeshes()\n    profile_queues_hook('mesh')\n}\n\n\n\n\n\n\n\n\n\n\n\n\n/*\n * \n * \n * \n *          misc helpers and implementation functions\n * \n * \n * \n*/\n\n\nfunction sortIDListByDistanceFrom(list, i, j, k) {\n    list.sort(id => {\n        var pos = parseChunkID(id)\n        var dx = pos[0] - i\n        var dy = pos[1] - j\n        var dz = pos[2] - k\n        // bias towards keeping verticals together for now\n        return (dx * dx + dz * dz) + Math.abs(dy)\n    })\n}\n\n\n// keep neighbor data updated when chunk is added or removed\nfunction updateNeighborsOfChunk(world, ci, cj, ck, chunk) {\n    for (var i = -1; i <= 1; i++) {\n        for (var j = -1; j <= 1; j++) {\n            for (var k = -1; k <= 1; k++) {\n                if ((i | j | k) === 0) continue\n                var nid = getChunkID(ci + i, cj + j, ck + k)\n                var neighbor = world._chunkStorage[nid]\n                if (!neighbor) continue\n                if (chunk) {\n                    chunk._neighborCount++\n                    chunk._neighbors.set(i, j, k, neighbor)\n                    neighbor._neighborCount++\n                    neighbor._neighbors.set(-i, -j, -k, chunk)\n                    // flag for remesh when chunk gets its last neighbor\n                    if (neighbor._neighborCount === 26) {\n                        queueChunkForRemesh(world, neighbor)\n                    }\n                } else {\n                    neighbor._neighborCount--\n                    neighbor._neighbors.set(-i, -j, -k, null)\n                }\n            }\n        }\n    }\n}\n\n\n\n\n\n\n\n\n/*\n * \n * \n * \n * \n *                  debugging\n * \n * \n * \n * \n*/\n\nWorld.prototype.report = function () {\n    console.log('World report - playerChunkLoaded: ', this.playerChunkLoaded)\n    _report(this, '  known:     ', this._chunkIDsKnown.arr, true)\n    _report(this, '  to request:', this._chunkIDsToRequest.arr)\n    _report(this, '  to remove: ', this._chunkIDsToRemove.arr)\n    _report(this, '  creating:  ', this._chunkIDsPending.arr)\n    _report(this, '  to mesh:   ', this._chunkIDsToMesh.arr.concat(this._chunkIDsToMeshFirst.arr))\n}\n\nfunction _report(world, name, arr, ext) {\n    var full = 0,\n        empty = 0,\n        exist = 0,\n        surrounded = 0,\n        remeshes = []\n    arr.forEach(id => {\n        var chunk = world._chunkStorage[id]\n        if (!chunk) return\n        exist++\n        remeshes.push(chunk._timesMeshed)\n        if (chunk.isFull) full++\n        if (chunk.isEmpty) empty++\n        if (chunk._neighborCount === 26) surrounded++\n    })\n    var out = arr.length.toString().padEnd(8)\n    out += ('exist: ' + exist).padEnd(12)\n    out += ('full: ' + full).padEnd(12)\n    out += ('empty: ' + empty).padEnd(12)\n    out += ('surr: ' + surrounded).padEnd(12)\n    if (ext) {\n        var sum = remeshes.reduce((acc, val) => acc + val, 0)\n        var max = remeshes.reduce((acc, val) => Math.max(acc, val), 0)\n        var min = remeshes.reduce((acc, val) => Math.min(acc, val), 0)\n        out += 'times meshed: avg ' + (sum / exist).toFixed(2)\n        out += '  max ' + max\n        out += '  min ' + min\n    }\n    console.log(name, out)\n}\n\n\nimport { makeProfileHook } from './util'\nvar profile_hook = (PROFILE) ?\n    makeProfileHook(100, 'world ticks:') : () => { }\nvar profile_queues_hook = () => { }\nif (PROFILE_QUEUES) profile_queues_hook = ((every) => {\n    var iter = 0\n    var counts = {}\n    var queues = {}\n    var started = performance.now()\n    return function profile_queues_hook(state, world) {\n        if (state === 'start') return\n        if (state !== 'end') return counts[state] = (counts[state] || 0) + 1\n        queues.toreq = (queues.toreq || 0) + world._chunkIDsToRequest.count()\n        queues.toget = (queues.toget || 0) + world._chunkIDsPending.count()\n        queues.tomesh = (queues.tomesh || 0) + world._chunkIDsToMesh.count() + world._chunkIDsToMeshFirst.count()\n        queues.tomesh1 = (queues.tomesh1 || 0) + world._chunkIDsToMeshFirst.count()\n        queues.torem = (queues.torem || 0) + world._chunkIDsToRemove.count()\n        if (++iter < every) return\n        var t = performance.now(), dt = t - started\n        var res = {}\n        Object.keys(queues).forEach(k => {\n            var num = Math.round((queues[k] || 0) / iter)\n            res[k] = `[${num}]`.padStart(5)\n        })\n        Object.keys(counts).forEach(k => {\n            var num = Math.round((counts[k] || 0) * 1000 / dt)\n            res[k] = ('' + num).padStart(3)\n        })\n        console.log('chunk flow: ',\n            `${res.toreq}-> ${res.request} req/s  `,\n            `${res.toget}-> ${res.receive} got/s  `,\n            `${(res.tomesh)}-> ${res.mesh} mesh/s  `,\n            `${res.torem}-> ${res.dispose} rem/s  `,\n            `(meshFirst: ${res.tomesh1.trim()})`,\n        )\n        iter = 0\n        counts = {}\n        queues = {}\n        started = performance.now()\n    }\n})(100)","\nvar createInputs = require('game-inputs')\n// var createInputs = require('../../../../npm-modules/game-inputs')\n\n\nexport default function (noa, opts, element) {\n    return makeInputs(noa, opts, element)\n}\n\n\n/**\n * @class Inputs\n * @typicalname noa.inputs\n * @classdesc Abstracts key/mouse input. \n * For docs see [andyhall/game-inputs](https://github.com/andyhall/game-inputs)\n */\n\n\nvar defaultBindings = {\n    bindings: {\n        \"forward\": [\"W\", \"<up>\"],\n        \"left\": [\"A\", \"<left>\"],\n        \"backward\": [\"S\", \"<down>\"],\n        \"right\": [\"D\", \"<right>\"],\n        \"fire\": \"<mouse 1>\",\n        \"mid-fire\": [\"<mouse 2>\", \"Q\"],\n        \"alt-fire\": [\"<mouse 3>\", \"E\"],\n        \"jump\": \"<space>\",\n        \"sprint\": \"<shift>\",\n        \"crouch\": \"<control>\"\n    }\n}\n\n\nfunction makeInputs(noa, opts, element) {\n    opts = Object.assign({}, defaultBindings, opts)\n    var inputs = createInputs(element, opts)\n    var b = opts.bindings\n    for (var name in b) {\n        var arr = (Array.isArray(b[name])) ? b[name] : [b[name]]\n        arr.unshift(name)\n        inputs.bind.apply(inputs, arr)\n    }\n    return inputs\n}\n","\nvar createPhysics = require('voxel-physics-engine')\n// var createPhysics = require('../../../../npm-modules/voxel-physics-engine')\n\n\nexport default function (noa, opts) {\n    return makePhysics(noa, opts)\n}\n\n\n/**\n * @class Physics\n * @typicalname noa.physics\n * @classdesc Wrapper module for the physics engine. For docs see \n * [andyhall/voxel-physics-engine](https://github.com/andyhall/voxel-physics-engine)\n */\n\n\nvar defaults = {\n    gravity: [0, -10, 0],\n    airDrag: 0.1,\n}\n\n\nfunction makePhysics(noa, opts) {\n    opts = Object.assign({}, defaults, opts)\n    var world = noa.world\n    // physics engine runs in offset coords, so voxel getters need to match\n    var offset = noa.worldOriginOffset\n    var blockGetter = (x, y, z) => {\n        return world.getBlockSolidity(x + offset[0], y + offset[1], z + offset[2])\n    }\n    var isFluidGetter = (x, y, z) => {\n        return world.getBlockFluidity(x + offset[0], y + offset[1], z + offset[2])\n    }\n\n    var physics = createPhysics(opts, blockGetter, isFluidGetter)\n\n    return physics\n}\n","\nvar vec3 = require('gl-vec3')\nvar aabb = require('aabb-3d')\nvar sweep = require('voxel-aabb-sweep')\n\n\nexport default function (noa, opts) {\n    return new Camera(noa, opts)\n}\n\n\n\n\nvar defaults = {\n    inverseX: false,\n    inverseY: false,\n    sensitivityX: 10,\n    sensitivityY: 10,\n    initialZoom: 0,\n    zoomSpeed: 0.2,\n}\n\n\n/** \n * @class\n * @typicalname noa.camera\n * @classdesc Manages the camera, exposes camera position, direction, mouse sensitivity.\n */\n\n\nfunction Camera(noa, opts) {\n    this.noa = noa\n\n    /**\n     * `noa.camera` uses the following options (from the root `noa(opts)` options):\n     * ```js\n     * {\n     *   inverseX: false,\n     *   inverseY: false,\n     *   sensitivityX: 15,\n     *   sensitivityY: 15,\n     *   initialZoom: 0,\n     *   zoomSpeed: 0.2,\n     * }\n     * ```\n     */\n    opts = Object.assign({}, defaults, opts)\n\n    /** Horizontal mouse sensitivity. \n     * Same scale as Overwatch (typical values around `5..10`)\n     */\n    this.sensitivityX = opts.sensitivityX\n\n    /** Vertical mouse sensitivity.\n     * Same scale as Overwatch (typical values around `5..10`)\n     */\n    this.sensitivityY = opts.sensitivityY\n\n    /** Mouse look inverse (horizontal) */\n    this.inverseX = opts.inverseX\n\n    /** Mouse look inverse (vertical) */\n    this.inverseY = opts.inverseY\n\n\n    /** Camera yaw angle (read only) \n     * \n     * Returns the camera's rotation angle around the vertical axis. Range: `0..2π`\n     */\n    this.heading = 0\n\n    /** Camera pitch angle (read only)\n     * \n     * Returns the camera's up/down rotation angle. Range: `-π/2..π/2`. \n     * (The pitch angle is clamped by a small epsilon, such that \n     * the camera never quite points perfectly up or down.\n     */\n    this.pitch = 0\n\n\n    /** Entity ID of a special entity that exists for the camera to point at.\n     * \n     * By default this entity follows the player entity, so you can \n     * change the player's eye height by changing the `follow` component's offset:\n     * ```js\n     * var followState = noa.ents.getState(noa.camera.cameraTarget, 'followsEntity')\n     * followState.offset[1] = 0.9 * myPlayerHeight\n     * ```\n     * \n     * For customized camera controls you can change the follow \n     * target to some other entity, or override the behavior entirely:\n     * ```js\n     * // make cameraTarget stop following the player\n     * noa.ents.removeComponent(noa.camera.cameraTarget, 'followsEntity')\n     * // control cameraTarget position directly (or whatever..)\n     * noa.ents.setPosition(noa.camera.cameraTarget, [x,y,z])\n     * ```\n     */\n    this.cameraTarget = this.noa.ents.createEntity(['position'])\n\n    // follow component and default offset\n    var eyeOffset = 0.9 * noa.ents.getPositionData(noa.playerEntity).height\n    noa.ents.addComponent(this.cameraTarget, 'followsEntity', {\n        entity: noa.playerEntity,\n        offset: [0, eyeOffset, 0],\n    })\n\n    /** How far back the camera is zoomed from the camera target */\n    this.zoomDistance = opts.initialZoom\n\n    /** How quickly the camera moves to its `zoomDistance` (0..1) */\n    this.zoomSpeed = opts.zoomSpeed\n\n    /** Current actual zoom distance. This differs from `zoomDistance` when\n     * the camera is in the process of moving towards the desired distance, \n     * or when it's obstructed by solid terrain behind the player. */\n    this.currentZoom = opts.initialZoom\n\n    // internals\n    this._dirVector = vec3.fromValues(0, 1, 0)\n}\n\n\n/*\n * \n *  Local position functions for high precision\n * \n */\nCamera.prototype._localGetTargetPosition = function () {\n    var pdat = this.noa.ents.getPositionData(this.cameraTarget)\n    return vec3.copy(_camPos, pdat._renderPosition)\n}\n\nCamera.prototype._localGetPosition = function () {\n    var loc = this._localGetTargetPosition()\n    if (this.currentZoom === 0) return loc\n    return vec3.scaleAndAdd(loc, loc, this._dirVector, -this.currentZoom)\n}\nvar _camPos = vec3.create()\n\n\n\n\n/**\n * Camera target position (read only)\n * \n * This returns the point the camera looks at - i.e. the player's \n * eye position. When the camera is zoomed \n * all the way in, this is equivalent to `camera.getPosition()`.\n */\nCamera.prototype.getTargetPosition = function () {\n    var loc = this._localGetTargetPosition()\n    return this.noa.localToGlobal(loc, globalCamPos)\n}\nvar globalCamPos = []\n\n/**\n * Returns the current camera position (read only)\n */\nCamera.prototype.getPosition = function () {\n    var loc = this._localGetPosition()\n    return this.noa.localToGlobal(loc, globalCamPos)\n}\n\n\n\n/**\n * Returns the camera direction vector (read only)\n */\nCamera.prototype.getDirection = function () {\n    return this._dirVector\n}\n\n\n\n\n\n/*\n * \n * \n * \n *          internals below\n * \n * \n * \n */\n\n\n/*\n *  Called before render, if mouseLock etc. is applicable.\n *  Consumes input mouse events x/y, updates camera angle and zoom\n */\n\nCamera.prototype.applyInputsToCamera = function () {\n    // dx/dy from input state\n    var state = this.noa.inputs.state\n    bugFix(state) // TODO: REMOVE EVENTUALLY    \n\n    // convert to rads, using (sens * 0.0066 deg/pixel), like Overwatch\n    var conv = 0.0066 * Math.PI / 180\n    var dy = state.dy * this.sensitivityY * conv\n    var dx = state.dx * this.sensitivityX * conv\n    if (this.inverseY) dy = -dy\n    if (this.inverseX) dx = -dx\n\n    // normalize/clamp angles, update direction vector\n    var twopi = 2 * Math.PI\n    this.heading += (dx < 0) ? dx + twopi : dx\n    if (this.heading > twopi) this.heading -= twopi\n    var maxPitch = Math.PI / 2 - 0.001\n    this.pitch = Math.max(-maxPitch, Math.min(maxPitch, this.pitch + dy))\n\n    vec3.set(this._dirVector, 0, 0, 1)\n    vec3.rotateX(this._dirVector, this._dirVector, origin, this.pitch)\n    vec3.rotateY(this._dirVector, this._dirVector, origin, this.heading)\n}\nvar origin = vec3.create()\n\n\n\n/*\n *  Called before all renders, pre- and post- entity render systems\n */\n\nCamera.prototype.updateBeforeEntityRenderSystems = function () {\n    // zoom update\n    this.currentZoom += (this.zoomDistance - this.currentZoom) * this.zoomSpeed\n}\n\nCamera.prototype.updateAfterEntityRenderSystems = function () {\n    // clamp camera zoom not to clip into solid terrain\n    var maxZoom = cameraObstructionDistance(this)\n    if (this.currentZoom > maxZoom) this.currentZoom = maxZoom\n}\n\n\n\n\n\n\n/*\n *  check for obstructions behind camera by sweeping back an AABB\n */\n\nfunction cameraObstructionDistance(self) {\n    if (!_camBox) {\n        var off = self.noa.worldOriginOffset\n        _camBox = new aabb([0, 0, 0], vec3.clone(_camBoxVec))\n        _getVoxel = (x, y, z) => self.noa.world.getBlockSolidity(x + off[0], y + off[1], z + off[2])\n        vec3.scale(_camBoxVec, _camBoxVec, -0.5)\n    }\n    _camBox.setPosition(self._localGetTargetPosition())\n    _camBox.translate(_camBoxVec)\n    var dist = Math.max(self.zoomDistance, self.currentZoom) + 0.1\n    vec3.scale(_sweepVec, self.getDirection(), -dist)\n    return sweep(_getVoxel, _camBox, _sweepVec, _hitFn, true)\n}\n\nvar _camBoxVec = vec3.fromValues(0.2, 0.2, 0.2)\nvar _sweepVec = vec3.create()\nvar _camBox\nvar _getVoxel\nvar _hitFn = () => true\n\n\n\n\n\n\n// workaround for this Chrome 63 + Win10 bug\n// https://bugs.chromium.org/p/chromium/issues/detail?id=781182\nfunction bugFix(state) {\n    var dx = state.dx\n    var dy = state.dy\n    var wval = document.body.clientWidth / 6\n    var hval = document.body.clientHeight / 6\n    var badx = (Math.abs(dx) > wval && (dx / lastx) < -1)\n    var bady = (Math.abs(dy) > hval && (dy / lasty) < -1)\n    if (badx || bady) {\n        state.dx = lastx\n        state.dy = lasty\n        lastx = (dx > 0) ? 1 : -1\n        lasty = (dy > 0) ? 1 : -1\n    } else {\n        if (dx) lastx = dx\n        if (dy) lasty = dy\n    }\n}\n\nvar lastx = 0\nvar lasty = 0\n","\nimport { constants } from './constants'\n\nexport default function (noa, opts) {\n    return new Registry(noa, opts)\n}\n\n\n\n/*\n *  data structs in the registry:\n *  registry \n *      blockSolidity:     id -> boolean\n *      blockOpacity:      id -> boolean\n *      blockIsFluid:      id -> boolean\n *      blockMats:         id -> 6x matID  [-x, +x, -y, +y, -z, +z]\n *      blockProps         id -> obj of less-often accessed properties\n *      blockMeshes:       id -> obj/null (custom mesh to instantiate)\n *      blockHandlers      id -> instance of `BlockCallbackHolder` or null \n *      matIDs             matName -> matID (int)\n *      matData            matID -> { color, alpha, texture, textureAlpha }\n */\n\n\nvar defaults = {\n    texturePath: ''\n}\n\nvar blockDefaults = {\n    solid: true,\n    opaque: true,\n    fluidDensity: 1.0,\n    viscosity: 0.5,\n}\n\n\n// highest ID that fits into the bits used for voxel IDs\nvar MAX_BLOCK_ID = 0xFFFFFFFF & constants.ID_MASK\n\n\n/**\n * @class\n * @typicalname noa.registry\n * @classdesc for registering block types, materials & properties\n */\n\n\nfunction Registry(noa, opts) {\n    this.noa = noa\n    opts = Object.assign({}, defaults, opts)\n\n\n    /* \n     * \n     *      data structures\n     * \n     */\n\n    // lookup arrays for block props and flags - all keyed by blockID\n    // fill in first value for id=0, empty space\n    var blockSolidity = [false]\n    var blockOpacity = [false]\n    var blockIsFluid = [false]\n    var blockMats = [0, 0, 0, 0, 0, 0]\n    var blockProps = [null]\n    var blockMeshes = [null]\n    var blockHandlers = [null]\n\n    // material data structs\n    var matIDs = {} // mat name -> id\n    var matData = [null] // mat id -> { color, alpha, texture, textureAlpha }\n\n    // option data to save\n    var texturePath = opts.texturePath\n\n\n\n    /* \n     * \n     *      Block registration methods\n     * \n     */\n\n\n\n    /**\n     * Register (by integer ID) a block type and its parameters.\n     * \n     *  `id` param: integer, currently 1..255. This needs to be passed in by the \n     *    client because it goes into the chunk data, which someday will get serialized.\n     * \n     *  `options` param: Recognized fields for the options object:\n     * \n     *  * material: can be:\n     *      * one (String) material name\n     *      * array of 2 names: [top/bottom, sides]\n     *      * array of 3 names: [top, bottom, sides]\n     *      * array of 6 names: [-x, +x, -y, +y, -z, +z]\n     *    If not specified, terrain won't be meshed for the block type\n     *  * solid: (true) solidity for physics purposes\n     *  * opaque: (true) fully obscures neighboring blocks\n     *  * fluid: (false) whether nonsolid block is a fluid (buoyant, viscous..)\n     *  * blockMesh: (null) if specified, noa will create a copy this mesh in the voxel\n     *  * fluidDensity: (1.0) for fluid blocks\n     *  * viscosity: (0.5) for fluid blocks\n     *  * onLoad(): block event handler\n     *  * onUnload(): block event handler\n     *  * onSet(): block event handler\n     *  * onUnset(): block event handler\n     *  * onCustomMeshCreate(): block event handler\n     */\n\n    this.registerBlock = function (id, _options) {\n        _options = _options || {}\n        blockDefaults.solid = !_options.fluid\n        blockDefaults.opaque = !_options.fluid\n        var opts = Object.assign({}, blockDefaults, _options)\n\n        // console.log('register block: ', id, opts)\n        if (id < 1 || id > MAX_BLOCK_ID) throw 'Block id out of range: ' + id\n\n        // if block ID is greater than current highest ID, \n        // register fake blocks to avoid holes in lookup arrays\n        while (id > blockSolidity.length) {\n            this.registerBlock(blockSolidity.length, {})\n        }\n\n        // flags default to solid, opaque, nonfluid\n        blockSolidity[id] = !!opts.solid\n        blockOpacity[id] = !!opts.opaque\n        blockIsFluid[id] = !!opts.fluid\n\n        // store any custom mesh\n        blockMeshes[id] = opts.blockMesh || null\n\n        // parse out material parameter\n        // always store 6 material IDs per blockID, so material lookup is monomorphic\n        var mat = opts.material || null\n        var mats\n        if (!mat) {\n            mats = [null, null, null, null, null, null]\n        } else if (typeof mat == 'string') {\n            mats = [mat, mat, mat, mat, mat, mat]\n        } else if (mat.length && mat.length == 2) {\n            // interpret as [top/bottom, sides]\n            mats = [mat[1], mat[1], mat[0], mat[0], mat[1], mat[1]]\n        } else if (mat.length && mat.length == 3) {\n            // interpret as [top, bottom, sides]\n            mats = [mat[2], mat[2], mat[0], mat[1], mat[2], mat[2]]\n        } else if (mat.length && mat.length == 6) {\n            // interpret as [-x, +x, -y, +y, -z, +z]\n            mats = mat\n        } else throw 'Invalid material parameter: ' + mat\n\n        // argument is material name, but store as material id, allocating one if needed\n        for (var i = 0; i < 6; ++i) {\n            blockMats[id * 6 + i] = getMaterialId(this, matIDs, mats[i], true)\n        }\n\n        // props data object - currently only used for fluid properties\n        blockProps[id] = {}\n\n        // if block is fluid, initialize properties if needed\n        if (blockIsFluid[id]) {\n            blockProps[id].fluidDensity = opts.fluidDensity\n            blockProps[id].viscosity = opts.viscosity\n        }\n\n        // event callbacks\n        var hasHandler = opts.onLoad || opts.onUnload || opts.onSet || opts.onUnset || opts.onCustomMeshCreate\n        blockHandlers[id] = (hasHandler) ? new BlockCallbackHolder(opts) : null\n\n        return id\n    }\n\n\n\n\n    /**\n     * Register (by name) a material and its parameters.\n     * \n     * @param name\n     * @param color\n     * @param textureURL\n     * @param texHasAlpha\n     * @param renderMaterial an optional BABYLON material to be used for block faces with this block material\n     */\n\n    this.registerMaterial = function (name, color, textureURL, texHasAlpha, renderMaterial) {\n        // console.log('register mat: ', name, color, textureURL)\n        var id = matIDs[name] || matData.length\n        matIDs[name] = id\n        var alpha = 1\n        if (color && color.length == 4) {\n            alpha = color.pop()\n        }\n        matData[id] = {\n            color: color || [1, 1, 1],\n            alpha: alpha,\n            texture: textureURL ? texturePath + textureURL : '',\n            textureAlpha: !!texHasAlpha,\n            renderMat: renderMaterial || null,\n        }\n        return id\n    }\n\n\n\n    /*\n     *      quick accessors for querying block ID stuff\n     */\n\n    /** \n     * block solidity (as in physics) \n     * @param id\n     */\n    this.getBlockSolidity = function (id) {\n        return blockSolidity[id]\n    }\n\n    /**\n     * block opacity - whether it obscures the whole voxel (dirt) or \n     * can be partially seen through (like a fencepost, etc)\n     * @param id\n     */\n    this.getBlockOpacity = function (id) {\n        return blockOpacity[id]\n    }\n\n    /** \n     * block is fluid or not\n     * @param id\n     */\n    this.getBlockFluidity = function (id) {\n        return blockIsFluid[id]\n    }\n\n    /** \n     * Get block property object passed in at registration\n     * @param id\n     */\n    this.getBlockProps = function (id) {\n        return blockProps[id]\n    }\n\n    // look up a block ID's face material\n    // dir is a value 0..5: [ +x, -x, +y, -y, +z, -z ]\n    this.getBlockFaceMaterial = function (blockId, dir) {\n        return blockMats[blockId * 6 + dir]\n    }\n\n\n\n\n\n    // look up material color given ID\n    this.getMaterialColor = function (matID) {\n        return matData[matID].color\n    }\n\n    // look up material texture given ID\n    this.getMaterialTexture = function (matID) {\n        return matData[matID].texture\n    }\n\n    // look up material's properties: color, alpha, texture, textureAlpha\n    this.getMaterialData = function (matID) {\n        return matData[matID]\n    }\n\n\n\n\n\n    /*\n     * \n     *   Meant for internal use within the engine\n     * \n     */\n\n\n    // internal access to lookup arrays\n    this._solidityLookup = blockSolidity\n    this._opacityLookup = blockOpacity\n    this._blockMeshLookup = blockMeshes\n    this._blockHandlerLookup = blockHandlers\n\n\n\n\n\n\n    // look up color used for vertices of blocks of given material\n    // - i.e. white if it has a texture, color otherwise\n    this._getMaterialVertexColor = function (matID) {\n        if (matData[matID].texture) return white\n        return matData[matID].color\n    }\n    var white = [1, 1, 1]\n\n\n\n\n\n    /*\n     * \n     *      default initialization\n     * \n     */\n\n    // add a default material and set ID=1 to it\n    // note that registering new block data overwrites the old\n    this.registerMaterial('dirt', [0.4, 0.3, 0], null)\n    this.registerBlock(1, { material: 'dirt' })\n\n\n\n}\n\n\n\n/*\n * \n *          helpers\n * \n */\n\n\n\n// look up material ID given its name\n// if lazy is set, pre-register the name and return an ID\nfunction getMaterialId(reg, matIDs, name, lazyInit) {\n    if (!name) return 0\n    var id = matIDs[name]\n    if (id === undefined && lazyInit) id = reg.registerMaterial(name)\n    return id\n}\n\n\n\n// data class for holding block callback references\nfunction BlockCallbackHolder(opts) {\n    this.onLoad = opts.onLoad || null\n    this.onUnload = opts.onUnload || null\n    this.onSet = opts.onSet || null\n    this.onUnset = opts.onUnset || null\n    this.onCustomMeshCreate = opts.onCustomMeshCreate || null\n}\n","\nvar vec3 = require('gl-vec3')\nvar EntComp = require('ent-comp')\n// var EntComp = require('../../../../npm-modules/ent-comp')\n\n\nimport { updatePositionExtents } from '../components/position'\nimport { setPhysicsFromPosition } from '../components/physics'\n\n\n\nexport default function (noa, opts) {\n    return new Entities(noa, opts)\n}\n\n\n\nvar defaults = {\n    shadowDistance: 10,\n}\n\n\n/**\n * @class Entities\n * @typicalname noa.ents\n * @classdesc Wrangles entities. Aliased as `noa.ents`.\n * \n * This class is an instance of [ECS](https://github.com/andyhall/ent-comp), \n * and as such implements the usual ECS methods.\n * It's also decorated with helpers and accessor functions for getting component existence/state.\n * \n * Expects entity definitions in a specific format - see source `components` folder for examples.\n */\n\nfunction Entities(noa, opts) {\n    // inherit from the ECS library\n    EntComp.call(this)\n\n    this.noa = noa\n    opts = Object.assign({}, defaults, opts)\n\n    // properties\n    /** Hash containing the component names of built-in components. */\n    this.names = {}\n\n    // optional arguments to supply to component creation functions\n    var componentArgs = {\n        'shadow': opts.shadowDistance,\n    }\n\n    // Bundler magic to import everything in the ../components directory\n    // each component module exports a default function: (noa) => compDefinition\n    var reqContext = require.context('../components/', false, /\\.js$/)\n    reqContext.keys().forEach(name => {\n        // convert name ('./foo.js') to bare name ('foo')\n        var bareName = /\\.\\/(.*)\\.js/.exec(name)[1]\n        var arg = componentArgs[bareName] || undefined\n        var compFn = reqContext(name)\n        if (compFn.default) compFn = compFn.default\n        var compDef = compFn(noa, arg)\n        var comp = this.createComponent(compDef)\n        this.names[bareName] = comp\n    })\n\n\n    // decorate the entities object with accessor functions\n    /** @param id */\n    this.isPlayer = function (id) { return id === noa.playerEntity }\n\n    /** @param id */\n    this.hasPhysics = this.getComponentAccessor(this.names.physics)\n\n    /** @param id */\n    this.cameraSmoothed = this.getComponentAccessor(this.names.smoothCamera)\n\n    /** @param id */\n    this.hasMesh = this.getComponentAccessor(this.names.mesh)\n\n    // position functions\n    /** @param id */\n    this.hasPosition = this.getComponentAccessor(this.names.position)\n    var getPos = this.getStateAccessor(this.names.position)\n\n    /** @param id */\n    this.getPositionData = getPos\n\n    /** @param id */\n    this._localGetPosition = function (id) {\n        return getPos(id)._localPosition\n    }\n\n    /** @param id */\n    this.getPosition = function (id) {\n        return getPos(id).position\n    }\n\n    /** @param id */\n    this._localSetPosition = function (id, pos) {\n        var posDat = getPos(id)\n        vec3.copy(posDat._localPosition, pos)\n        updateDerivedPositionData(id, posDat)\n    }\n\n    /** @param id, positionArr */\n    this.setPosition = (id, pos, _yarg, _zarg) => {\n        // check if called with \"x, y, z\" args\n        if (typeof pos === 'number') pos = [pos, _yarg, _zarg]\n        // convert to local and defer impl\n        var loc = noa.globalToLocal(pos, null, [])\n        this._localSetPosition(id, loc)\n    }\n\n    /** @param id, xs, ys, zs */\n    this.setEntitySize = function (id, xs, ys, zs) {\n        var posDat = getPos(id)\n        posDat.width = (xs + zs) / 2\n        posDat.height = ys\n        updateDerivedPositionData(id, posDat)\n    }\n\n    // called when engine rebases its local coords\n    this._rebaseOrigin = function (delta) {\n        this.getStatesList(this.names.position).forEach(state => {\n            vec3.subtract(state._localPosition, state._localPosition, delta)\n            updateDerivedPositionData(state.__id, state)\n        })\n    }\n\n    // helper to update everything derived from `_localPosition`\n    function updateDerivedPositionData(id, posDat) {\n        vec3.copy(posDat._renderPosition, posDat._localPosition)\n        vec3.add(posDat.position, posDat._localPosition, noa.worldOriginOffset)\n        updatePositionExtents(posDat)\n        var physDat = getPhys(id)\n        if (physDat) setPhysicsFromPosition(physDat, posDat)\n    }\n\n\n\n    // physics\n    var getPhys = this.getStateAccessor(this.names.physics)\n    this.getPhysics = getPhys\n    this.getPhysicsBody = function (id) { return getPhys(id).body }\n\n    // misc\n    this.getMeshData = this.getStateAccessor(this.names.mesh)\n    this.getMovement = this.getStateAccessor(this.names.movement)\n    this.getCollideTerrain = this.getStateAccessor(this.names.collideTerrain)\n    this.getCollideEntities = this.getStateAccessor(this.names.collideEntities)\n\n    // pairwise collideEntities event - this is for client to override\n    this.onPairwiseEntityCollision = function (id1, id2) {}\n}\n\n// inherit from EntComp\nEntities.prototype = Object.create(EntComp.prototype)\nEntities.prototype.constructor = Entities\n\n\n\n\n/*\n *\n *    ENTITY MANAGER API\n * \n *  note most APIs are on the original ECS module (ent-comp)\n *  these are some overlaid extras for noa\n *\n */\n\n\n/** @param id,name,state */\nEntities.prototype.addComponentAgain = function (id, name, state) {\n    // removes component first if necessary\n    if (this.hasComponent(id, name)) this.removeComponent(id, name, true)\n    this.addComponent(id, name, state)\n}\n\n\n/** @param x,y,z */\nEntities.prototype.isTerrainBlocked = function (x, y, z) {\n    // checks if terrain location is blocked by entities\n    var off = this.noa.worldOriginOffset\n    var xlocal = Math.floor(x - off[0])\n    var ylocal = Math.floor(y - off[1])\n    var zlocal = Math.floor(z - off[2])\n    var blockExt = [\n        xlocal + 0.001, ylocal + 0.001, zlocal + 0.001,\n        xlocal + 0.999, ylocal + 0.999, zlocal + 0.999,\n    ]\n    var list = this.getStatesList(this.names.collideTerrain)\n    for (var i = 0; i < list.length; i++) {\n        var id = list[i].__id\n        var ext = this.getPositionData(id)._extents\n        if (extentsOverlap(blockExt, ext)) return true\n    }\n    return false\n}\n\n\n\nfunction extentsOverlap(extA, extB) {\n    if (extA[0] > extB[3]) return false\n    if (extA[1] > extB[4]) return false\n    if (extA[2] > extB[5]) return false\n    if (extA[3] < extB[0]) return false\n    if (extA[4] < extB[1]) return false\n    if (extA[5] < extB[2]) return false\n    return true\n}\n\n\n\n\n/** @param box */\nEntities.prototype.getEntitiesInAABB = function (box, withComponent) {\n    // extents to test against\n    var off = this.noa.worldOriginOffset\n    var testExtents = [\n        box.base[0] + off[0], box.base[1] + off[1], box.base[2] + off[2],\n        box.max[0] + off[0], box.max[1] + off[1], box.max[2] + off[2],\n    ]\n    // entity position state list\n    var entStates = (withComponent) ?\n        this.getStatesList(withComponent).map(state => {\n            return this.getPositionData(state.__id)\n        }) : this.getStatesList(this.names.position)\n    // run each test\n    var hits = []\n    entStates.forEach(state => {\n        if (extentsOverlap(testExtents, state._extents)) {\n            hits.push(state.__id)\n        }\n    })\n    return hits\n}\n\n\n\n/** \n * Helper to set up a general entity, and populate with some common components depending on arguments.\n * \n * Parameters: position, width, height [, mesh, meshOffset, doPhysics, shadow]\n * \n * @param position\n * @param width\n * @param height..\n */\nEntities.prototype.add = function (position, width, height, // required\n    mesh, meshOffset, doPhysics, shadow) {\n\n    var self = this\n\n    // new entity\n    var eid = this.createEntity()\n\n    // position component\n    this.addComponent(eid, this.names.position, {\n        position: position || [0, 0, 0],\n        width: width,\n        height: height\n    })\n\n    // rigid body in physics simulator\n    if (doPhysics) {\n        // body = this.noa.physics.addBody(box)\n        this.addComponent(eid, this.names.physics)\n        var body = this.getPhysicsBody(eid)\n\n        // handler for physics engine to call on auto-step\n        var smoothName = this.names.smoothCamera\n        body.onStep = function () {\n            self.addComponentAgain(eid, smoothName)\n        }\n    }\n\n    // mesh for the entity\n    if (mesh) {\n        if (!meshOffset) meshOffset = vec3.create()\n        this.addComponent(eid, this.names.mesh, {\n            mesh: mesh,\n            offset: meshOffset\n        })\n    }\n\n    // add shadow-drawing component\n    if (shadow) {\n        this.addComponent(eid, this.names.shadow, { size: width })\n    }\n\n    return eid\n}\n","/*!\n * noa: an experimental voxel game engine.\n * @url      github.com/andyhall/noa\n * @author   Andy Hall <andy@fenomas.com>\n * @license  MIT\n */\n\nvar vec3 = require('gl-vec3')\nvar ndarray = require('ndarray')\nvar raycast = require('fast-voxel-raycast')\nvar EventEmitter = require('events').EventEmitter\n\nimport createContainer from './lib/container'\nimport createRendering from './lib/rendering'\nimport createWorld from './lib/world'\nimport createInputs from './lib/inputs'\nimport createPhysics from './lib/physics'\nimport createCamera from './lib/camera'\nimport createRegistry from './lib/registry'\nimport createEntities from './lib/entities'\nimport { constants } from './lib/constants'\n\n\n\n\nexport default Engine\n\n\n// profiling flags\nvar PROFILE = 0\nvar PROFILE_RENDER = 0\n\n\n\n\nvar defaults = {\n    debug: false,\n    silent: false,\n    playerHeight: 1.8,\n    playerWidth: 0.6,\n    playerStart: [0, 10, 0],\n    playerAutoStep: false,\n    tickRate: 33, // ms per tick - not ticks per second\n    blockTestDistance: 10,\n    stickyPointerLock: true,\n    dragCameraOutsidePointerLock: true,\n    skipDefaultHighlighting: false,\n    originRebaseDistance: 25,\n}\n\n\n/**\n * Main engine object.\n * Takes a big options object full of flags and settings as a parameter.\n * \n * ```js\n * var opts = {\n *     debug: false,\n *     silent: false,\n *     playerHeight: 1.8,\n *     playerWidth: 0.6,\n *     playerStart: [0, 10, 0],\n *     playerAutoStep: false,\n *     tickRate: 33, // ms per tick - not ticks per second\n *     blockTestDistance: 10,\n *     stickyPointerLock: true,\n *     dragCameraOutsidePointerLock: true,\n *     skipDefaultHighlighting: false,\n *     originRebaseDistance: 25,\n * }\n * var NoaEngine = require('noa-engine')\n * var noa = NoaEngine(opts)\n * ```\n * \n * All option parameters are, well, optional. Note that \n * the root `opts` parameter object is also passed to \n * noa's child modules (rendering, camera, etc). \n * See docs for each module for which options they use.\n * \n * @class\n * @alias Noa\n * @typicalname noa\n * @emits tick(dt)\n * @emits beforeRender(dt)\n * @emits afterRender(dt)\n * @emits targetBlockChanged(blockDesc)\n * @classdesc Root class of the noa engine\n * \n * Extends: `EventEmitter`\n */\n\nfunction Engine(opts) {\n    if (!(this instanceof Engine)) return new Engine(opts)\n\n    /**  version string, e.g. `\"0.25.4\"` */\n    this.version = require('../package.json').version\n\n    opts = Object.assign({}, defaults, opts)\n    this._tickRate = opts.tickRate\n    this._lastRenderTime = 0\n    this._paused = false\n    this._dragOutsideLock = opts.dragCameraOutsidePointerLock\n    var self = this\n\n    if (!opts.silent) {\n        var debugstr = (opts.debug) ? ' (debug)' : ''\n        console.log(`noa-engine v${this.version}${debugstr}`)\n    }\n\n    // world origin offset, used throughout engine for origin rebasing\n    this.worldOriginOffset = [0, 0, 0]\n    this._originRebaseDistance = opts.originRebaseDistance\n\n    // vec3 library used throughout the engine\n    this.vec3 = vec3\n\n    // how far engine is into the current tick. Updated each render.\n    this.positionInCurrentTick = 0\n\n    /** String identifier for the current world. (It's safe to ignore this if\n     * your game doesn't need to swap between levels/worlds.)\n     */\n    this.worldName = 'default'\n\n    /**\n     * container (html/div) manager\n     * @type {Container}\n     */\n    this.container = createContainer(this, opts)\n\n    /**\n     * inputs manager - abstracts key/mouse input\n     * @type {Inputs}\n     */\n    this.inputs = createInputs(this, opts, this.container.element)\n\n    /**\n     * block/item property registry\n     * @type {Registry}\n     */\n    this.registry = createRegistry(this, opts)\n\n    /**\n     * world manager\n     * @type {World}\n     */\n    this.world = createWorld(this, opts)\n\n    /**\n     * Rendering manager\n     * @type {Rendering}\n     */\n    this.rendering = createRendering(this, opts, this.container.canvas)\n\n    /**\n     * physics engine - solves collisions, properties, etc.\n     * @type {Physics}\n     */\n    this.physics = createPhysics(this, opts)\n\n    /** Entity manager / Entity Component System (ECS) \n     * Aliased to `noa.ents` for convenience.\n     * @type {Entities}\n     */\n    this.entities = createEntities(this, opts)\n    this.ents = this.entities\n    var ents = this.ents\n\n    /** Entity id for the player entity */\n    this.playerEntity = ents.add(\n        opts.playerStart, // starting location\n        opts.playerWidth, opts.playerHeight,\n        null, null, // no mesh for now, no meshOffset, \n        true, true\n    )\n\n    // make player entity it collide with terrain and other entities\n    ents.addComponent(this.playerEntity, ents.names.collideTerrain)\n    ents.addComponent(this.playerEntity, ents.names.collideEntities)\n\n    // adjust default physics parameters\n    var body = ents.getPhysicsBody(this.playerEntity)\n    body.gravityMultiplier = 2 // less floaty\n    body.autoStep = opts.playerAutoStep // auto step onto blocks\n\n    // input component - sets entity's movement state from key inputs\n    ents.addComponent(this.playerEntity, ents.names.receivesInputs)\n\n    // add a component to make player mesh fade out when zooming in\n    ents.addComponent(this.playerEntity, ents.names.fadeOnZoom)\n\n    // movement component - applies movement forces\n    // todo: populate movement settings from options\n    var moveOpts = {\n        airJumps: 1\n    }\n    ents.addComponent(this.playerEntity, ents.names.movement, moveOpts)\n\n\n    /**\n     * Manages camera, view angle, etc.\n     * @type {Camera}\n     */\n    this.camera = createCamera(this, opts)\n\n\n    // set up block targeting\n    this.blockTestDistance = opts.blockTestDistance\n\n    /** function for which block IDs are targetable. \n     * Defaults to a solidity check, but can be overridden */\n    this.blockTargetIdCheck = this.registry.getBlockSolidity\n\n    /** Dynamically updated object describing the currently targeted block.\n     * Gets updated each tick, to `null` if not block is targeted, or \n     * to an object like:\n     * \n     *     {\n     *        blockID,   // voxel ID\n     *        position,  // the (solid) block being targeted\n     *        adjacent,  // the (non-solid) block adjacent to the targeted one\n     *        normal,    // e.g. [0, 1, 0] when player is targting the top face of a voxel\n     *     }\n     */\n    this.targetedBlock = null\n\n    // add a default block highlighting function\n    if (!opts.skipDefaultHighlighting) {\n        // the default listener, defined onto noa in case people want to remove it later\n        this.defaultBlockHighlightFunction = function (tgt) {\n            if (tgt) {\n                self.rendering.highlightBlockFace(true, tgt.position, tgt.normal)\n            } else {\n                self.rendering.highlightBlockFace(false)\n            }\n        }\n        this.on('targetBlockChanged', this.defaultBlockHighlightFunction)\n    }\n\n\n    // expose constants, for HACKING™\n    this._constants = constants\n\n    // temp hacks for development\n    if (opts.debug) {\n        window.noa = this\n        window.scene = this.rendering._scene\n        window.ndarray = ndarray\n        window.vec3 = vec3\n        ents.getMovement(1).airJumps = 999\n        this.setViewDistance = function (dist) {\n            var cs = this.world.chunkSize\n            this.world.chunkAddDistance = dist / cs\n            this.world.chunkRemoveDistance = dist / cs + 1\n            this.world._lastPlayerChunkID = '' // pings noa's chunk queues\n        }\n    }\n\n    // add hooks to throw helpful errors when using deprecated methods\n    deprecateStuff(this)\n}\n\nEngine.prototype = Object.create(EventEmitter.prototype)\n\n\n\n\n\n/*\n *\n *\n *   Core Engine API\n *\n *\n */\n\n\n/*\n * Tick function, called by container module at a fixed timestep. Emits #tick(dt),\n * where dt is the tick rate in ms (default 16.6)\n */\n\nEngine.prototype.tick = function () {\n    if (this._paused) {\n        if (this.world.worldGenWhilePaused) this.world.tick(dt)\n        return\n    }\n    profile_hook('start')\n    checkWorldOffset(this)\n    var dt = this._tickRate // fixed timesteps!\n    this.world.tick(dt) // chunk creation/removal\n    profile_hook('world')\n    if (!this.world.playerChunkLoaded) {\n        // when waiting on worldgen, just tick the meshing queue and exit\n        this.rendering.tick(dt)\n        return\n    }\n    this.physics.tick(dt) // iterates physics\n    profile_hook('physics')\n    this.rendering.tick(dt) // does deferred chunk meshing\n    profile_hook('rendering')\n    updateBlockTargets(this) // finds targeted blocks, and highlights one if needed\n    profile_hook('targets')\n    this.entities.tick(dt) // runs all entity systems\n    profile_hook('entities')\n    this.emit('tick', dt)\n    profile_hook('tick event')\n    profile_hook('end')\n    // clear accumulated scroll inputs (mouseMove is cleared on render)\n    var st = this.inputs.state\n    st.scrollx = st.scrolly = st.scrollz = 0\n}\n\n\n\n\n\n/*\n * Render function, called every animation frame. Emits #beforeRender(dt), #afterRender(dt) \n * where dt is the time in ms *since the last tick*.\n */\n\nEngine.prototype.render = function (framePart) {\n    // frame position - for rendering movement between ticks\n    this.positionInCurrentTick = framePart\n    // dt - actual time difference (in ms), for animating things\n    // that aren't tied to game tick rate\n    var t = performance.now()\n    var dt = t - (this._lastRenderTime || (t - 16))\n    this._lastRenderTime = t\n\n    // when paused, just optionally ping worldgen, then exit\n    if (this._paused) {\n        if (this.world.worldGenWhilePaused) this.world.render()\n        return\n    }\n\n    profile_hook_render('start')\n\n    // only move camera during pointerlock or mousedown, or if pointerlock is unsupported\n    if (this.container.hasPointerLock ||\n        !this.container.supportsPointerLock ||\n        (this._dragOutsideLock && this.inputs.state.fire)) {\n        this.camera.applyInputsToCamera()\n    }\n    profile_hook_render('init')\n\n    // brief run through meshing queue\n    this.world.render(dt)\n    profile_hook_render('meshing')\n\n    // entity render systems\n    this.camera.updateBeforeEntityRenderSystems()\n    this.entities.render(dt)\n    this.camera.updateAfterEntityRenderSystems()\n    profile_hook_render('entities')\n\n    // events and render\n    this.emit('beforeRender', dt)\n    profile_hook_render('before render')\n\n    this.rendering.render(dt)\n    profile_hook_render('render')\n\n    this.emit('afterRender', dt)\n    profile_hook_render('after render')\n    profile_hook_render('end')\n\n    // clear accumulated mouseMove inputs (scroll inputs cleared on render)\n    this.inputs.state.dx = this.inputs.state.dy = 0\n}\n\n\n\n\n\n\n\n\n\n/*\n *   Rebasing local <-> global coords\n */\n\n\n/** \n * Precisely converts a world position to the current internal \n * local frame of reference.\n * \n * See `/doc/positions.md` for more info.\n * \n * Params: \n *  * `global`: input position in global coords\n *  * `globalPrecise`: (optional) sub-voxel offset to the global position\n *  * `local`: output array which will receive the result\n */\nEngine.prototype.globalToLocal = function (global, globalPrecise, local) {\n    var off = this.worldOriginOffset\n    if (globalPrecise) {\n        for (var i = 0; i < 3; i++) {\n            var coord = global[i] - off[i]\n            coord += globalPrecise[i]\n            local[i] = coord\n        }\n        return local\n    } else {\n        return vec3.sub(local, global, off)\n    }\n}\n\n/** \n * Precisely converts a world position to the current internal \n * local frame of reference.\n * \n * See `/doc/positions.md` for more info.\n * \n * Params: \n *  * `local`: input array of local coords\n *  * `global`: output array which receives the result\n *  * `globalPrecise`: (optional) sub-voxel offset to the output global position\n * \n * If both output arrays are passed in, `global` will get int values and \n * `globalPrecise` will get fractional parts. If only one array is passed in,\n * `global` will get the whole output position.\n */\nEngine.prototype.localToGlobal = function (local, global, globalPrecise) {\n    var off = this.worldOriginOffset\n    if (globalPrecise) {\n        for (var i = 0; i < 3; i++) {\n            var floored = Math.floor(local[i])\n            global[i] = floored + off[i]\n            globalPrecise[i] = local[i] - floored\n        }\n        return global\n    } else {\n        return vec3.add(global, local, off)\n    }\n}\n\n\n\n\n/*\n * \n *   rebase world origin offset around the player if necessary\n * \n */\nfunction checkWorldOffset(noa) {\n    var lpos = noa.ents.getPositionData(noa.playerEntity)._localPosition\n    var cutoff = noa._originRebaseDistance\n    if (vec3.sqrLen(lpos) < cutoff * cutoff) return\n    var delta = []\n    for (var i = 0; i < 3; i++) {\n        var d = Math.floor(lpos[i])\n        delta[i] = d\n        noa.worldOriginOffset[i] += d\n    }\n    noa.rendering._rebaseOrigin(delta)\n    noa.entities._rebaseOrigin(delta)\n}\n\n\n\n\n\n\n/*\n *   Utility APIs\n */\n\n/** \n * Pausing the engine will also stop render/tick events, etc.\n * @param paused\n */\nEngine.prototype.setPaused = function (paused) {\n    this._paused = !!paused\n    // when unpausing, clear any built-up mouse inputs\n    if (!paused) {\n        this.inputs.state.dx = this.inputs.state.dy = 0\n    }\n}\n\n/** @param x,y,z */\nEngine.prototype.getBlock = function (x, y, z) {\n    if (x.length) {\n        return this.world.getBlockID(x[0], x[1], x[2])\n    } else {\n        return this.world.getBlockID(x, y, z)\n    }\n}\n\n/** @param x,y,z */\nEngine.prototype.setBlock = function (id, x, y, z) {\n    // skips the entity collision check\n    if (x.length) {\n        return this.world.setBlockID(id, x[0], x[1], x[2])\n    } else {\n        return this.world.setBlockID(id, x, y, z)\n    }\n}\n\n/**\n * Adds a block unless obstructed by entities \n * @param id,x,y,z */\nEngine.prototype.addBlock = function (id, x, y, z) {\n    // add a new terrain block, if nothing blocks the terrain there\n    if (x.length) {\n        if (this.entities.isTerrainBlocked(x[0], x[1], x[2])) return\n        this.world.setBlockID(id, x[0], x[1], x[2])\n        return id\n    } else {\n        if (this.entities.isTerrainBlocked(x, y, z)) return\n        this.world.setBlockID(id, x, y, z)\n        return id\n    }\n}\n\n\n\n\n\n\n\n\n/**\n * Raycast through the world, returning a result object for any non-air block\n * @param pos (default: to player eye position)\n * @param vec (default: to camera vector)\n * @param dist (default: `noa.blockTestDistance`)\n * @param blockTestFunction (default: voxel solidity)\n * \n * Returns: `null`, or an object with array properties: `position`, \n * `normal`, `_localPosition`. \n * \n * See `/doc/positions.md` for info on working with precise positions.\n */\nEngine.prototype.pick = function (pos, vec, dist, blockIdTestFunction) {\n    if (dist === 0) return null\n    // input position to local coords, if any\n    if (pos) {\n        this.globalToLocal(pos, null, _pickPos)\n        pos = _pickPos\n    }\n    return this._localPick(pos, vec, dist, blockIdTestFunction)\n}\nvar _pickPos = vec3.create()\n\n\n\n/**\n * Do a raycast in local coords. \n * See `/doc/positions.md` for more info.\n * @param pos\n * @param vec\n * @param dist\n * @param blockTestFunction\n */\n\nEngine.prototype._localPick = function (pos, vec, dist, blockIdTestFunction) {\n    // do a raycast in local coords - result obj will be in global coords\n    if (dist === 0) return null\n    var testFn = blockIdTestFunction || this.registry.getBlockSolidity\n    var world = this.world\n    var off = this.worldOriginOffset\n    var testVoxel = function (x, y, z) {\n        var id = world.getBlockID(x + off[0], y + off[1], z + off[2])\n        return testFn(id)\n    }\n    if (!pos) pos = this.camera._localGetTargetPosition()\n    vec = vec || this.camera.getDirection()\n    dist = dist || this.blockTestDistance\n    var rpos = _hitResult._localPosition\n    var rnorm = _hitResult.normal\n    var hit = raycast(testVoxel, pos, vec, dist, rpos, rnorm)\n    if (!hit) return null\n    // position is right on a voxel border - adjust it so that flooring works reliably\n    // adjust along normal direction, i.e. away from the block struck\n    vec3.scaleAndAdd(rpos, rpos, rnorm, 0.01)\n    // add global result\n    this.localToGlobal(rpos, _hitResult.position)\n    return _hitResult\n}\nvar _hitResult = {\n    _localPosition: vec3.create(),\n    position: [0, 0, 0],\n    normal: [0, 0, 0],\n}\n\n\n\n\n\n\n// Each frame, by default pick along the player's view vector \n// and tell rendering to highlight the struck block face\nfunction updateBlockTargets(noa) {\n    var newhash = ''\n    var blockIdFn = noa.blockTargetIdCheck || noa.registry.getBlockSolidity\n    var result = noa._localPick(null, null, null, blockIdFn)\n    if (result) {\n        var dat = _targetedBlockDat\n        // pick stops just shy of voxel boundary, so floored pos is the adjacent voxel\n        vec3.floor(dat.adjacent, result.position)\n        vec3.copy(dat.normal, result.normal)\n        vec3.sub(dat.position, dat.adjacent, dat.normal)\n        dat.blockID = noa.world.getBlockID(dat.position[0], dat.position[1], dat.position[2])\n        noa.targetedBlock = dat\n        newhash = dat.position.join('|') + dat.normal.join('|') + '|' + dat.blockID\n    } else {\n        noa.targetedBlock = null\n    }\n    if (newhash != _prevTargetHash) {\n        noa.emit('targetBlockChanged', noa.targetedBlock)\n        _prevTargetHash = newhash\n    }\n}\n\nvar _targetedBlockDat = {\n    blockID: 0,\n    position: [],\n    normal: [],\n    adjacent: [],\n}\n\nvar _prevTargetHash = ''\n\n\n\n\n/*\n * \n *  add some hooks for guidance on removed APIs\n * \n */\n\nfunction deprecateStuff(noa) {\n    var ver = `0.27`\n    var dep = (loc, name, msg) => {\n        var throwFn = () => { throw `This property changed in ${ver} - ${msg}` }\n        Object.defineProperty(loc, name, { get: throwFn, set: throwFn })\n    }\n    dep(noa, 'getPlayerEyePosition', 'to get the camera/player offset see API docs for `noa.camera.cameraTarget`')\n    dep(noa, 'setPlayerEyePosition', 'to set the camera/player offset see API docs for `noa.camera.cameraTarget`')\n    dep(noa, 'getPlayerPosition', 'use `noa.ents.getPosition(noa.playerEntity)` or similar')\n    dep(noa, 'getCameraVector', 'use `noa.camera.getDirection`')\n    dep(noa, 'getPlayerMesh', 'use `noa.ents.getMeshData(noa.playerEntity).mesh` or similar')\n    dep(noa, 'playerBody', 'use `noa.ents.getPhysicsBody(noa.playerEntity)`')\n    dep(noa.rendering, 'zoomDistance', 'use `noa.camera.zoomDistance`')\n    dep(noa.rendering, '_currentZoom', 'use `noa.camera.currentZoom`')\n    dep(noa.rendering, '_cameraZoomSpeed', 'use `noa.camera.zoomSpeed`')\n    dep(noa.rendering, 'getCameraVector', 'use `noa.camera.getDirection`')\n    dep(noa.rendering, 'getCameraPosition', 'use `noa.camera.getLocalPosition`')\n    dep(noa.rendering, 'getCameraRotation', 'use `noa.camera.heading` and `noa.camera.pitch`')\n    dep(noa.rendering, 'setCameraRotation', 'to customize camera behavior see API docs for `noa.camera`')\n    ver = '0.28'\n    dep(noa.rendering, 'makeMeshInstance', 'removed, use Babylon\\'s `mesh.createInstance`')\n    dep(noa.world, '_maxChunksPendingCreation', 'use `maxChunksPendingCreation` (no \"_\")')\n    dep(noa.world, '_maxChunksPendingMeshing', 'use `maxChunksPendingMeshing` (no \"_\")')\n    dep(noa.world, '_maxProcessingPerTick', 'use `maxProcessingPerTick` (no \"_\")')\n    dep(noa.world, '_maxProcessingPerRender', 'use `maxProcessingPerRender` (no \"_\")')\n}\n\n\n\n\n\n\n\nimport { makeProfileHook } from './lib/util'\nvar profile_hook = (PROFILE) ?\n    makeProfileHook(200, 'tick   ') : () => { }\nvar profile_hook_render = (PROFILE_RENDER) ?\n    makeProfileHook(200, 'render ') : () => { }\n","\n\n/* \n * \n *          noa hello-world example\n * \n *  This is a bare-minimum example world, intended to be a \n *  starting point for hacking on noa game world content.\n * \n*/\n\n\n\n// Engine options object, and engine instantiation:\nimport Engine from 'noa-engine'\n\nvar opts = {\n    debug: true,\n    showFPS: true,\n    chunkSize: 32,\n    chunkAddDistance: 2.5,\n    chunkRemoveDistance: 3.5,\n    // See `test` example, or noa docs/source, for more options\n}\nvar noa = new Engine(opts)\n\n\n\n/*\n *\n *      Registering voxel types\n * \n *  Two step process. First you register a material, specifying the \n *  color/texture/etc. of a given block face, then you register a \n *  block, which specifies the materials for a given block type.\n * \n*/\n\n// block materials (just colors for this demo)\nvar textureURL = null // replace that with a filename to specify textures\nvar brownish = [0.45, 0.36, 0.22]\nvar greenish = [0.1, 0.8, 0.2]\nnoa.registry.registerMaterial('dirt', brownish, textureURL)\nnoa.registry.registerMaterial('grass', greenish, textureURL)\n\n// block types and their material names\nvar dirtID = noa.registry.registerBlock(1, { material: 'dirt' })\nvar grassID = noa.registry.registerBlock(2, { material: 'grass' })\n\n\n\n\n/*\n * \n *      World generation\n * \n *  The world is divided into chunks, and `noa` will emit an \n *  `worldDataNeeded` event for each chunk of data it needs.\n *  The game client should catch this, and call \n *  `noa.world.setChunkData` whenever the world data is ready.\n *  (The latter can be done asynchronously.)\n * \n*/\n\n// simple height map worldgen function\nfunction getVoxelID(x, y, z) {\n    if (y < -3) return dirtID\n    var height = 2 * Math.sin(x / 10) + 3 * Math.cos(z / 20)\n    if (y < height) return grassID\n    return 0 // signifying empty space\n}\n\n// register for world events\nnoa.world.on('worldDataNeeded', function (id, data, x, y, z) {\n    // `id` - a unique string id for the chunk\n    // `data` - an `ndarray` of voxel ID data (see: https://github.com/scijs/ndarray)\n    // `x, y, z` - world coords of the corner of the chunk\n    for (var i = 0; i < data.shape[0]; i++) {\n        for (var j = 0; j < data.shape[1]; j++) {\n            for (var k = 0; k < data.shape[2]; k++) {\n                var voxelID = getVoxelID(x + i, y + j, z + k)\n                data.set(i, j, k, voxelID)\n            }\n        }\n    }\n    // tell noa the chunk's terrain data is now set\n    noa.world.setChunkData(id, data)\n})\n\n\n\n\n/*\n * \n *      Create a mesh to represent the player:\n * \n*/\n\n// get the player entity's ID and other info (position, size, ..)\nvar player = noa.playerEntity\nvar dat = noa.entities.getPositionData(player)\nvar w = dat.width\nvar h = dat.height\n\n\n// add a mesh to represent the player, and scale it, etc.\nimport { Mesh } from '@babylonjs/core/Meshes/mesh'\nvar scene = noa.rendering.getScene()\nvar mesh = Mesh.CreateBox('player-mesh', 1, scene)\nmesh.scaling.x = w\nmesh.scaling.z = w\nmesh.scaling.y = h\n\n\n// add \"mesh\" component to the player entity\n// this causes the mesh to move around in sync with the player entity\nnoa.entities.addComponent(player, noa.entities.names.mesh, {\n    mesh: mesh,\n    // offset vector is needed because noa positions are always the \n    // bottom-center of the entity, and Babylon's CreateBox gives a \n    // mesh registered at the center of the box\n    offset: [0, h / 2, 0],\n})\n\n\n\n/*\n * \n *      Minimal interactivity \n * \n*/\n\n// clear targeted block on on left click\nnoa.inputs.down.on('fire', function () {\n    if (noa.targetedBlock) noa.setBlock(0, noa.targetedBlock.position)\n})\n\n// place some grass on right click\nnoa.inputs.down.on('alt-fire', function () {\n    if (noa.targetedBlock) noa.addBlock(grassID, noa.targetedBlock.adjacent)\n})\n\n// add a key binding for \"E\" to do the same as alt-fire\nnoa.inputs.bind('alt-fire', 'E')\n\n\n// each tick, consume any scroll events and use them to zoom camera\nnoa.on('tick', function (dt) {\n    var scroll = noa.inputs.state.scrolly\n    if (scroll !== 0) {\n        noa.camera.zoomDistance += (scroll > 0) ? 1 : -1\n        if (noa.camera.zoomDistance < 0) noa.camera.zoomDistance = 0\n        if (noa.camera.zoomDistance > 10) noa.camera.zoomDistance = 10\n    }\n})\n"],"sourceRoot":""}