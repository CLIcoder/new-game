!function(e){function t(t){for(var r,s,a=t[0],u=t[1],c=t[2],h=0,f=[];h<a.length;h++)s=a[h],Object.prototype.hasOwnProperty.call(i,s)&&i[s]&&f.push(i[s][0]),i[s]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);for(l&&l(t);f.length;)f.shift()();return o.push.apply(o,c||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,a=1;a<n.length;a++){var u=n[a];0!==i[u]&&(r=!1)}r&&(o.splice(t--,1),e=s(s.s=n[0]))}return e}var r={},i={1:0},o=[];function s(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.e=function(e){var t=[],n=i[e];if(0!==n)if(n)t.push(n[2]);else{var r=new Promise((function(t,r){n=i[e]=[t,r]}));t.push(n[2]=r);var o,a=document.createElement("script");a.charset="utf-8",a.timeout=120,s.nc&&a.setAttribute("nonce",s.nc),a.src=function(e){return s.p+""+e+".bundle.js"}(e);var u=new Error;o=function(t){a.onerror=a.onload=null,clearTimeout(c);var n=i[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;u.message="Loading chunk "+e+" failed.\n("+r+": "+o+")",u.name="ChunkLoadError",u.type=r,u.request=o,n[1](u)}i[e]=void 0}};var c=setTimeout((function(){o({type:"timeout",target:a})}),12e4);a.onerror=a.onload=o,document.head.appendChild(a)}return Promise.all(t)},s.m=e,s.c=r,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(n,r,function(t){return e[t]}.bind(null,r));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s.oe=function(e){throw console.error(e),e};var a=window.webpackJsonp=window.webpackJsonp||[],u=a.push.bind(a);a.push=t,a=a.slice();for(var c=0;c<a.length;c++)t(a[c]);var l=u;o.push([335,0]),n()}([,function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return a})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return c}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function i(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function s(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}function a(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))}function u(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}Object.create;function c(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}Object.create},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){e.exports={EPSILON:n(202),create:n(203),clone:n(257),angle:n(258),fromValues:n(204),copy:n(259),set:n(260),equals:n(261),exactEquals:n(262),add:n(263),subtract:n(207),sub:n(264),multiply:n(208),mul:n(265),divide:n(209),div:n(266),min:n(267),max:n(268),floor:n(269),ceil:n(270),round:n(271),scale:n(272),scaleAndAdd:n(273),distance:n(210),dist:n(274),squaredDistance:n(211),sqrDist:n(275),length:n(212),len:n(276),squaredLength:n(213),sqrLen:n(277),negate:n(278),inverse:n(279),normalize:n(205),dot:n(206),cross:n(280),lerp:n(281),random:n(282),transformMat4:n(283),transformMat3:n(284),transformQuat:n(285),rotateX:n(286),rotateY:n(287),rotateZ:n(288),forEach:n(289)}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var r,i="object"==typeof Reflect?Reflect:null,o=i&&"function"==typeof i.apply?i.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};r=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var s=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}e.exports=a,e.exports.once=function(e,t){return new Promise((function(n,r){function i(){void 0!==o&&e.removeListener("error",o),n([].slice.call(arguments))}var o;"error"!==t&&(o=function(n){e.removeListener(t,i),r(n)},e.once("error",o)),e.once(t,i)}))},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var u=10;function c(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function l(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function h(e,t,n,r){var i,o,s,a;if(c(n),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),s=o[t]),void 0===s)s=o[t]=n,++e._eventsCount;else if("function"==typeof s?s=o[t]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),(i=l(e))>0&&s.length>i&&!s.warned){s.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=s.length,a=u,console&&console.warn&&console.warn(a)}return e}function f(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=f.bind(r);return i.listener=n,r.wrapFn=i,i}function p(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):v(i,i.length)}function m(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function v(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");u=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return l(this)},a.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var u=i[e];if(void 0===u)return!1;if("function"==typeof u)o(u,this,t);else{var c=u.length,l=v(u,c);for(n=0;n<c;++n)o(l[n],this,t)}return!0},a.prototype.addListener=function(e,t){return h(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return h(this,e,t,!0)},a.prototype.once=function(e,t){return c(t),this.on(e,d(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){return c(t),this.prependListener(e,d(this,e,t)),this},a.prototype.removeListener=function(e,t){var n,r,i,o,s;if(c(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){s=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,s||t)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},a.prototype.listeners=function(e){return p(this,e,!0)},a.prototype.rawListeners=function(e){return p(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):m.call(e,t)},a.prototype.listenerCount=m,a.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},,,,,function(e,t,n){var r=n(214),i=n(290),o="undefined"!=typeof Float64Array;function s(e,t){return e[0]-t[0]}function a(){var e,t=this.stride,n=new Array(t.length);for(e=0;e<n.length;++e)n[e]=[Math.abs(t[e]),e];n.sort(s);var r=new Array(n.length);for(e=0;e<r.length;++e)r[e]=n[e][1];return r}function u(e,t){var n=["View",t,"d",e].join("");t<0&&(n="View_Nil"+e);var i="generic"===e;if(-1===t){var o="function "+n+"(a){this.data=a;};var proto="+n+".prototype;proto.dtype='"+e+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+n+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+n+"(a){return new "+n+"(a);}";return new Function(o)()}if(0===t){o="function "+n+"(a,d) {this.data = a;this.offset = d};var proto="+n+".prototype;proto.dtype='"+e+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+n+"_copy() {return new "+n+"(this.data,this.offset)};proto.pick=function "+n+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+n+"_get(){return "+(i?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+n+"_set(v){return "+(i?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+n+"(a,b,c,d){return new "+n+"(a,d)}";return new Function("TrivialArray",o)(c[e][0])}o=["'use strict'"];var s=r(t),u=s.map((function(e){return"i"+e})),l="this.offset+"+s.map((function(e){return"this.stride["+e+"]*i"+e})).join("+"),h=s.map((function(e){return"b"+e})).join(","),f=s.map((function(e){return"c"+e})).join(",");o.push("function "+n+"(a,"+h+","+f+",d){this.data=a","this.shape=["+h+"]","this.stride=["+f+"]","this.offset=d|0}","var proto="+n+".prototype","proto.dtype='"+e+"'","proto.dimension="+t),o.push("Object.defineProperty(proto,'size',{get:function "+n+"_size(){return "+s.map((function(e){return"this.shape["+e+"]"})).join("*"),"}})"),1===t?o.push("proto.order=[0]"):(o.push("Object.defineProperty(proto,'order',{get:"),t<4?(o.push("function "+n+"_order(){"),2===t?o.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===t&&o.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):o.push("ORDER})")),o.push("proto.set=function "+n+"_set("+u.join(",")+",v){"),i?o.push("return this.data.set("+l+",v)}"):o.push("return this.data["+l+"]=v}"),o.push("proto.get=function "+n+"_get("+u.join(",")+"){"),i?o.push("return this.data.get("+l+")}"):o.push("return this.data["+l+"]}"),o.push("proto.index=function "+n+"_index(",u.join(),"){return "+l+"}"),o.push("proto.hi=function "+n+"_hi("+u.join(",")+"){return new "+n+"(this.data,"+s.map((function(e){return["(typeof i",e,"!=='number'||i",e,"<0)?this.shape[",e,"]:i",e,"|0"].join("")})).join(",")+","+s.map((function(e){return"this.stride["+e+"]"})).join(",")+",this.offset)}");var d=s.map((function(e){return"a"+e+"=this.shape["+e+"]"})),p=s.map((function(e){return"c"+e+"=this.stride["+e+"]"}));o.push("proto.lo=function "+n+"_lo("+u.join(",")+"){var b=this.offset,d=0,"+d.join(",")+","+p.join(","));for(var m=0;m<t;++m)o.push("if(typeof i"+m+"==='number'&&i"+m+">=0){d=i"+m+"|0;b+=c"+m+"*d;a"+m+"-=d}");o.push("return new "+n+"(this.data,"+s.map((function(e){return"a"+e})).join(",")+","+s.map((function(e){return"c"+e})).join(",")+",b)}"),o.push("proto.step=function "+n+"_step("+u.join(",")+"){var "+s.map((function(e){return"a"+e+"=this.shape["+e+"]"})).join(",")+","+s.map((function(e){return"b"+e+"=this.stride["+e+"]"})).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(m=0;m<t;++m)o.push("if(typeof i"+m+"==='number'){d=i"+m+"|0;if(d<0){c+=b"+m+"*(a"+m+"-1);a"+m+"=ceil(-a"+m+"/d)}else{a"+m+"=ceil(a"+m+"/d)}b"+m+"*=d}");o.push("return new "+n+"(this.data,"+s.map((function(e){return"a"+e})).join(",")+","+s.map((function(e){return"b"+e})).join(",")+",c)}");var v=new Array(t),g=new Array(t);for(m=0;m<t;++m)v[m]="a[i"+m+"]",g[m]="b[i"+m+"]";o.push("proto.transpose=function "+n+"_transpose("+u+"){"+u.map((function(e,t){return e+"=("+e+"===undefined?"+t+":"+e+"|0)"})).join(";"),"var a=this.shape,b=this.stride;return new "+n+"(this.data,"+v.join(",")+","+g.join(",")+",this.offset)}"),o.push("proto.pick=function "+n+"_pick("+u+"){var a=[],b=[],c=this.offset");for(m=0;m<t;++m)o.push("if(typeof i"+m+"==='number'&&i"+m+">=0){c=(c+this.stride["+m+"]*i"+m+")|0}else{a.push(this.shape["+m+"]);b.push(this.stride["+m+"])}");return o.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),o.push("return function construct_"+n+"(data,shape,stride,offset){return new "+n+"(data,"+s.map((function(e){return"shape["+e+"]"})).join(",")+","+s.map((function(e){return"stride["+e+"]"})).join(",")+",offset)}"),new Function("CTOR_LIST","ORDER",o.join("\n"))(c[e],a)}var c={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],bigint64:[],biguint64:[],buffer:[],generic:[]};e.exports=function(e,t,n,r){if(void 0===e)return(0,c.array[0])([]);"number"==typeof e&&(e=[e]),void 0===t&&(t=[e.length]);var s=t.length;if(void 0===n){n=new Array(s);for(var a=s-1,l=1;a>=0;--a)n[a]=l,l*=t[a]}if(void 0===r){r=0;for(a=0;a<s;++a)n[a]<0&&(r-=(t[a]-1)*n[a])}for(var h=function(e){if(i(e))return"buffer";if(o)switch(Object.prototype.toString.call(e)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(e)?"array":"generic"}(e),f=c[h];f.length<=s+1;)f.push(u(h,f.length-1));return(0,f[s+1])(e,t,n,r)}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){e.exports=i;var r=n(41);function i(e,t){if(!(this instanceof i))return new i(e,t);var n=r.create();r.add(n,e,t),this.base=r.min(r.create(),e,n),this.vec=r.clone(t),this.max=r.max(r.create(),e,n),this.mag=r.length(this.vec)}var o=i.prototype;o.width=function(){return this.vec[0]},o.height=function(){return this.vec[1]},o.depth=function(){return this.vec[2]},o.x0=function(){return this.base[0]},o.y0=function(){return this.base[1]},o.z0=function(){return this.base[2]},o.x1=function(){return this.max[0]},o.y1=function(){return this.max[1]},o.z1=function(){return this.max[2]},o.translate=function(e){return r.add(this.max,this.max,e),r.add(this.base,this.base,e),this},o.setPosition=function(e){return r.add(this.max,e,this.vec),r.copy(this.base,e),this},o.expand=function(e){var t=r.create(),n=r.create();return r.max(t,e.max,this.max),r.min(n,e.base,this.base),r.subtract(t,t,n),new i(n,t)},o.intersects=function(e){return!(e.base[0]>this.max[0])&&(!(e.base[1]>this.max[1])&&(!(e.base[2]>this.max[2])&&(!(e.max[0]<this.base[0])&&(!(e.max[1]<this.base[1])&&!(e.max[2]<this.base[2])))))},o.touches=function(e){var t=this.union(e);return null!==t&&(0==t.width()||0==t.height()||0==t.depth())},o.union=function(e){if(!this.intersects(e))return null;var t=Math.max(e.base[0],this.base[0]),n=Math.max(e.base[1],this.base[1]),r=Math.max(e.base[2],this.base[2]);return new i([t,n,r],[Math.min(e.max[0],this.max[0])-t,Math.min(e.max[1],this.max[1])-n,Math.min(e.max[2],this.max[2])-r])}},function(e,t,n){"use strict";(function(e){var r=n(124),i=n(315),o=n(316).Buffer;e.__TYPEDARRAY_POOL||(e.__TYPEDARRAY_POOL={UINT8:i([32,0]),UINT16:i([32,0]),UINT32:i([32,0]),BIGUINT64:i([32,0]),INT8:i([32,0]),INT16:i([32,0]),INT32:i([32,0]),BIGINT64:i([32,0]),FLOAT:i([32,0]),DOUBLE:i([32,0]),DATA:i([32,0]),UINT8C:i([32,0]),BUFFER:i([32,0])});var s="undefined"!=typeof Uint8ClampedArray,a="undefined"!=typeof BigUint64Array,u="undefined"!=typeof BigInt64Array,c=e.__TYPEDARRAY_POOL;c.UINT8C||(c.UINT8C=i([32,0])),c.BIGUINT64||(c.BIGUINT64=i([32,0])),c.BIGINT64||(c.BIGINT64=i([32,0])),c.BUFFER||(c.BUFFER=i([32,0]));var l=c.DATA,h=c.BUFFER;function f(e){if(e){var t=e.length||e.byteLength,n=r.log2(t);l[n].push(e)}}function d(e){e=r.nextPow2(e);var t=r.log2(e),n=l[t];return n.length>0?n.pop():new ArrayBuffer(e)}function p(e){return new Uint8Array(d(e),0,e)}function m(e){return new Uint16Array(d(2*e),0,e)}function v(e){return new Uint32Array(d(4*e),0,e)}function g(e){return new Int8Array(d(e),0,e)}function y(e){return new Int16Array(d(2*e),0,e)}function b(e){return new Int32Array(d(4*e),0,e)}function w(e){return new Float32Array(d(4*e),0,e)}function _(e){return new Float64Array(d(8*e),0,e)}function k(e){return s?new Uint8ClampedArray(d(e),0,e):p(e)}function x(e){return a?new BigUint64Array(d(8*e),0,e):null}function M(e){return u?new BigInt64Array(d(8*e),0,e):null}function C(e){return new DataView(d(e),0,e)}function P(e){e=r.nextPow2(e);var t=r.log2(e),n=h[t];return n.length>0?n.pop():new o(e)}t.free=function(e){if(o.isBuffer(e))h[r.log2(e.length)].push(e);else{if("[object ArrayBuffer]"!==Object.prototype.toString.call(e)&&(e=e.buffer),!e)return;var t=e.length||e.byteLength,n=0|r.log2(t);l[n].push(e)}},t.freeUint8=t.freeUint16=t.freeUint32=t.freeBigUint64=t.freeInt8=t.freeInt16=t.freeInt32=t.freeBigInt64=t.freeFloat32=t.freeFloat=t.freeFloat64=t.freeDouble=t.freeUint8Clamped=t.freeDataView=function(e){f(e.buffer)},t.freeArrayBuffer=f,t.freeBuffer=function(e){h[r.log2(e.length)].push(e)},t.malloc=function(e,t){if(void 0===t||"arraybuffer"===t)return d(e);switch(t){case"uint8":return p(e);case"uint16":return m(e);case"uint32":return v(e);case"int8":return g(e);case"int16":return y(e);case"int32":return b(e);case"float":case"float32":return w(e);case"double":case"float64":return _(e);case"uint8_clamped":return k(e);case"bigint64":return M(e);case"biguint64":return x(e);case"buffer":return P(e);case"data":case"dataview":return C(e);default:return null}return null},t.mallocArrayBuffer=d,t.mallocUint8=p,t.mallocUint16=m,t.mallocUint32=v,t.mallocInt8=g,t.mallocInt16=y,t.mallocInt32=b,t.mallocFloat32=t.mallocFloat=w,t.mallocFloat64=t.mallocDouble=_,t.mallocUint8Clamped=k,t.mallocBigUint64=x,t.mallocBigInt64=M,t.mallocDataView=C,t.mallocBuffer=P,t.clearCache=function(){for(var e=0;e<32;++e)c.UINT8[e].length=0,c.UINT16[e].length=0,c.UINT32[e].length=0,c.INT8[e].length=0,c.INT16[e].length=0,c.INT32[e].length=0,c.FLOAT[e].length=0,c.DOUBLE[e].length=0,c.BIGUINT64[e].length=0,c.BIGINT64[e].length=0,c.UINT8C[e].length=0,l[e].length=0,h[e].length=0}}).call(this,n(161))},function(e,t,n){"use strict";function r(e){var t=32;return(e&=-e)&&t--,65535&e&&(t-=16),16711935&e&&(t-=8),252645135&e&&(t-=4),858993459&e&&(t-=2),1431655765&e&&(t-=1),t}t.INT_BITS=32,t.INT_MAX=2147483647,t.INT_MIN=-1<<31,t.sign=function(e){return(e>0)-(e<0)},t.abs=function(e){var t=e>>31;return(e^t)-t},t.min=function(e,t){return t^(e^t)&-(e<t)},t.max=function(e,t){return e^(e^t)&-(e<t)},t.isPow2=function(e){return!(e&e-1||!e)},t.log2=function(e){var t,n;return t=(e>65535)<<4,t|=n=((e>>>=t)>255)<<3,t|=n=((e>>>=n)>15)<<2,(t|=n=((e>>>=n)>3)<<1)|(e>>>=n)>>1},t.log10=function(e){return e>=1e9?9:e>=1e8?8:e>=1e7?7:e>=1e6?6:e>=1e5?5:e>=1e4?4:e>=1e3?3:e>=100?2:e>=10?1:0},t.popCount=function(e){return 16843009*((e=(858993459&(e-=e>>>1&1431655765))+(e>>>2&858993459))+(e>>>4)&252645135)>>>24},t.countTrailingZeros=r,t.nextPow2=function(e){return e+=0===e,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,(e|=e>>>16)+1},t.prevPow2=function(e){return e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,(e|=e>>>16)-(e>>>1)},t.parity=function(e){return e^=e>>>16,e^=e>>>8,e^=e>>>4,27030>>>(e&=15)&1};var i=new Array(256);!function(e){for(var t=0;t<256;++t){var n=t,r=t,i=7;for(n>>>=1;n;n>>>=1)r<<=1,r|=1&n,--i;e[t]=r<<i&255}}(i),t.reverse=function(e){return i[255&e]<<24|i[e>>>8&255]<<16|i[e>>>16&255]<<8|i[e>>>24&255]},t.interleave2=function(e,t){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e&=65535)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t&=65535)|t<<8))|t<<4))|t<<2))|t<<1))<<1},t.deinterleave2=function(e,t){return(e=65535&((e=16711935&((e=252645135&((e=858993459&((e=e>>>t&1431655765)|e>>>1))|e>>>2))|e>>>4))|e>>>16))<<16>>16},t.interleave3=function(e,t,n){return e=1227133513&((e=3272356035&((e=251719695&((e=4278190335&((e&=1023)|e<<16))|e<<8))|e<<4))|e<<2),(e|=(t=1227133513&((t=3272356035&((t=251719695&((t=4278190335&((t&=1023)|t<<16))|t<<8))|t<<4))|t<<2))<<1)|(n=1227133513&((n=3272356035&((n=251719695&((n=4278190335&((n&=1023)|n<<16))|n<<8))|n<<4))|n<<2))<<2},t.deinterleave3=function(e,t){return(e=1023&((e=4278190335&((e=251719695&((e=3272356035&((e=e>>>t&1227133513)|e>>>2))|e>>>4))|e>>>8))|e>>>16))<<22>>22},t.nextCombination=function(e){var t=e|e-1;return t+1|(~t&-~t)-1>>>r(e)+1}},,,function(e,t,n){"use strict";n.r(t),n.d(t,"updatePositionExtents",(function(){return i}));var r=n(41);function i(e){var t=e.width/2,n=e._localPosition,r=e._extents;r[0]=n[0]-t,r[1]=n[1],r[2]=n[2]-t,r[3]=n[0]+t,r[4]=n[1]+e.height,r[5]=n[2]+t}t.default=function(e){return{name:"position",order:60,state:{position:null,width:1,height:1,_localPosition:null,_renderPosition:null,_extents:null},onAdd:function(t,n){var o=[0,0,0];n.position&&r.copy(o,n.position),n.position=o,n._localPosition=r.create(),n._renderPosition=r.create(),n._extents=new Float32Array(6),e.globalToLocal(n.position,null,n._localPosition),r.copy(n._renderPosition,n._localPosition),i(n)},onRemove:null,system:function(t,n){var o=e.worldOriginOffset;n.forEach(e=>{r.add(e.position,e._localPosition,o),i(e)})}}}},function(e,t,n){"use strict";n.r(t),n.d(t,"setPhysicsFromPosition",(function(){return o}));var r=n(41);t.default=function(e){return{name:"physics",order:40,state:{body:null},onAdd:function(t,n){n.body=e.physics.addBody(),o(n,e.ents.getPositionData(n.__id))},onRemove:function(t,n){if(e.ents.hasPosition(n.__id)){var r=e.ents.getPositionData(n.__id);s(n,r),a(n,r,0,!1)}e.physics.removeBody(n.body)},system:function(t,n){n.forEach(t=>{s(t,e.ents.getPositionData(t.__id))})},renderSystem:function(t,n){var r=(e.positionInCurrentTick*e._tickRate-e._tickRate)/1e3;n.forEach(t=>{var n=t.__id,i=e.ents.getPositionData(n),o=e.ents.cameraSmoothed(n);a(t,i,r,o)})}}};var i=r.create();function o(e,t){var n=e.body.aabb,i=t._extents;r.copy(n.base,i),r.set(n.vec,t.width,t.height,t.width),r.add(n.max,n.base,n.vec)}function s(e,t){var n=e.body.aabb.base,i=t.width/2;r.set(t._localPosition,n[0]+i,n[1],n[2]+i)}function a(e,t,n,o){var s=e.body.velocity;r.scaleAndAdd(i,t._localPosition,s,n),o&&r.lerp(i,t._renderPosition,i,.3),r.copy(t._renderPosition,i)}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){e.exports=1e-6},function(e,t){e.exports=function(){var e=new Float32Array(3);return e[0]=0,e[1]=0,e[2]=0,e}},function(e,t){e.exports=function(e,t,n){var r=new Float32Array(3);return r[0]=e,r[1]=t,r[2]=n,r}},function(e,t){e.exports=function(e,t){var n=t[0],r=t[1],i=t[2],o=n*n+r*r+i*i;o>0&&(o=1/Math.sqrt(o),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o);return e}},function(e,t){e.exports=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}},function(e,t){e.exports=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}},function(e,t){e.exports=function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e}},function(e,t){e.exports=function(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e}},function(e,t){e.exports=function(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return Math.sqrt(n*n+r*r+i*i)}},function(e,t){e.exports=function(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return n*n+r*r+i*i}},function(e,t){e.exports=function(e){var t=e[0],n=e[1],r=e[2];return Math.sqrt(t*t+n*n+r*r)}},function(e,t){e.exports=function(e){var t=e[0],n=e[1],r=e[2];return t*t+n*n+r*r}},function(e,t,n){"use strict";e.exports=function(e){for(var t=new Array(e),n=0;n<e;++n)t[n]=n;return t}},,function(e,t,n){"use strict";var r=[],i=[],o=[],s=[],a=[],u=[],c=[],l=[],h=[],f=[],d=[],p=[];e.exports=function(e,t,n,m,v,g){for(var y=c,b=h,w=f,_=p,k=0;k<3;k++)y[k]=+n[k],w[k]=+t.max[k],b[k]=+t.base[k];g||(g=1e-10);var x=function(e,t,n,c,h,f){var p=r,m=i,v=o,g=s,y=a,b=u,w=l,_=Math.floor,k=0,x=0,M=0,C=0,P=0;if(E(),0===M)return 0;for(C=A();x<=M;){if(D(C))if(I())return k;C=A()}for(k+=M,P=0;P<3;P++)c[P]+=n[P],h[P]+=n[P];return k;function E(){if(x=0,0!==(M=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2])))for(var e=0;e<3;e++){var t=n[e]>=0;g[e]=t?1:-1;var r=t?h[e]:c[e];p[e]=t?c[e]:h[e],m[e]=T(r,g[e]),v[e]=B(p[e],g[e]),w[e]=n[e]/M,y[e]=Math.abs(1/w[e]);var i=t?m[e]+1-r:r-m[e];b[e]=y[e]<1/0?y[e]*i:1/0}}function D(t){for(var n=g[0],r=0===t?m[0]:v[0],i=m[0]+n,o=g[1],s=1===t?m[1]:v[1],a=m[1]+o,u=g[2],c=2===t?m[2]:v[2],l=m[2]+u,h=r;h!=i;h+=n)for(var f=s;f!=a;f+=o)for(var d=c;d!=l;d+=u)if(e(h,f,d))return!0;return!1}function I(){k+=x;var e=g[C],r=x/M,i=d;for(P=0;P<3;P++){var o=n[P]*r;c[P]+=o,h[P]+=o,i[P]=n[P]-o}if(e>0?h[C]=Math.round(h[C]):c[C]=Math.round(c[C]),t(k,C,e,i))return!0;for(P=0;P<3;P++)n[P]=i[P];return E(),0===M}function A(){var e=b[0]<b[1]?b[0]<b[2]?0:2:b[1]<b[2]?1:2,t=b[e]-x;for(x=b[e],m[e]+=g[e],b[e]+=y[e],P=0;P<3;P++)p[P]+=t*w[P],v[P]=B(p[P],g[P]);return e}function T(e,t){return _(e-t*f)}function B(e,t){return _(e+t*f)}}(e,m,y,b,w,g);if(!v){for(k=0;k<3;k++)_[k]=n[k]>0?w[k]-t.max[k]:b[k]-t.base[k];t.translate(_)}return x}},function(e,t,n){"use strict";e.exports={init:function(e){var t=i.nextPow2(e);s.length<t&&(r.free(s),s=r.mallocInt32(t));a.length<t&&(r.free(a),a=r.mallocInt32(t));u.length<t&&(r.free(u),u=r.mallocInt32(t));c.length<t&&(r.free(c),c=r.mallocInt32(t));l.length<t&&(r.free(l),l=r.mallocInt32(t));h.length<t&&(r.free(h),h=r.mallocInt32(t));var n=8*t;f.length<n&&(r.free(f),f=r.mallocDouble(n))},sweepBipartite:function(e,t,n,r,i,l,h,m,v,g){for(var y=0,b=2*e,w=e-1,_=b-1,k=n;k<r;++k){var x=l[k],M=b*k;f[y++]=i[M+w],f[y++]=-(x+1),f[y++]=i[M+_],f[y++]=x}for(k=h;k<m;++k){x=g[k]+(1<<28);var C=b*k;f[y++]=v[C+w],f[y++]=-x,f[y++]=v[C+_],f[y++]=x}var P=y>>>1;o(f,P);var E=0,D=0;for(k=0;k<P;++k){var I=0|f[2*k+1];if(I>=1<<28)d(u,c,D--,I=I-(1<<28)|0);else if(I>=0)d(s,a,E--,I);else if(I<=-(1<<28)){I=-I-(1<<28)|0;for(var A=0;A<E;++A){if(void 0!==(T=t(s[A],I)))return T}p(u,c,D++,I)}else{I=-I-1|0;for(A=0;A<D;++A){var T;if(void 0!==(T=t(I,u[A])))return T}p(s,a,E++,I)}}},sweepComplete:function(e,t,n,r,i,m,v,g,y,b){for(var w=0,_=2*e,k=e-1,x=_-1,M=n;M<r;++M){var C=m[M]+1<<1,P=_*M;f[w++]=i[P+k],f[w++]=-C,f[w++]=i[P+x],f[w++]=C}for(M=v;M<g;++M){C=b[M]+1<<1;var E=_*M;f[w++]=y[E+k],f[w++]=1|-C,f[w++]=y[E+x],f[w++]=1|C}var D=w>>>1;o(f,D);var I=0,A=0,T=0;for(M=0;M<D;++M){var B=0|f[2*M+1],S=1&B;if(M<D-1&&B>>1==f[2*M+3]>>1&&(S=2,M+=1),B<0){for(var L=-(B>>1)-1,O=0;O<T;++O){if(void 0!==(j=t(l[O],L)))return j}if(0!==S)for(O=0;O<I;++O){if(void 0!==(j=t(s[O],L)))return j}if(1!==S)for(O=0;O<A;++O){var j;if(void 0!==(j=t(u[O],L)))return j}0===S?p(s,a,I++,L):1===S?p(u,c,A++,L):2===S&&p(l,h,T++,L)}else{L=(B>>1)-1;0===S?d(s,a,I--,L):1===S?d(u,c,A--,L):2===S&&d(l,h,T--,L)}}},scanBipartite:function(e,t,n,r,i,u,c,l,h,m,v,g){var y=0,b=2*e,w=t,_=t+e,k=1,x=1;r?x=1<<28:k=1<<28;for(var M=i;M<u;++M){var C=M+k,P=b*M;f[y++]=c[P+w],f[y++]=-C,f[y++]=c[P+_],f[y++]=C}for(M=h;M<m;++M){C=M+x;var E=b*M;f[y++]=v[E+w],f[y++]=-C}var D=y>>>1;o(f,D);var I=0;for(M=0;M<D;++M){var A=0|f[2*M+1];if(A<0){var T=!1;if((C=-A)>=1<<28?(T=!r,C-=1<<28):(T=!!r,C-=1),T)p(s,a,I++,C);else{var B=g[C],S=b*C,L=v[S+t+1],O=v[S+t+1+e];e:for(var j=0;j<I;++j){var R=s[j],F=b*R;if(!(O<c[F+t+1]||c[F+t+1+e]<L)){for(var z=t+2;z<e;++z)if(v[S+z+e]<c[F+z]||c[F+z+e]<v[S+z])continue e;var U,N=l[R];if(void 0!==(U=r?n(B,N):n(N,B)))return U}}}}else d(s,a,I--,A-k)}},scanComplete:function(e,t,n,r,i,a,u,c,l,h,d){for(var p=0,m=2*e,v=t,g=t+e,y=r;y<i;++y){var b=y+(1<<28),w=m*y;f[p++]=a[w+v],f[p++]=-b,f[p++]=a[w+g],f[p++]=b}for(y=c;y<l;++y){b=y+1;var _=m*y;f[p++]=h[_+v],f[p++]=-b}var k=p>>>1;o(f,k);var x=0;for(y=0;y<k;++y){var M=0|f[2*y+1];if(M<0){if((b=-M)>=1<<28)s[x++]=b-(1<<28);else{var C=d[b-=1],P=m*b,E=h[P+t+1],D=h[P+t+1+e];e:for(var I=0;I<x;++I){var A=s[I],T=u[A];if(T===C)break;var B=m*A;if(!(D<a[B+t+1]||a[B+t+1+e]<E)){for(var S=t+2;S<e;++S)if(h[P+S+e]<a[B+S]||a[B+S+e]<h[P+S])continue e;var L=n(T,C);if(void 0!==L)return L}}}}else{for(b=M-(1<<28),I=x-1;I>=0;--I)if(s[I]===b){for(S=I+1;S<x;++S)s[S-1]=s[S];break}--x}}}};var r=n(123),i=n(124),o=n(320),s=r.mallocInt32(1024),a=r.mallocInt32(1024),u=r.mallocInt32(1024),c=r.mallocInt32(1024),l=r.mallocInt32(1024),h=r.mallocInt32(1024),f=r.mallocDouble(8192);function d(e,t,n,r){var i=t[r],o=e[n-1];e[i]=o,t[o]=i}function p(e,t,n,r){e[n]=r,t[r]=n}},function(e,t,n){"use strict";e.exports=function(e,t){var n="abcdef".split("").concat(t),r=[];e.indexOf("lo")>=0&&r.push("lo=e[k+n]");e.indexOf("hi")>=0&&r.push("hi=e[k+o]");return n.push("for(var j=2*a,k=j*c,l=k,m=c,n=b,o=a+b,p=c;d>p;++p,k+=j){var _;if($)if(m===p)m+=1,l+=j;else{for(var s=0;j>s;++s){var t=e[k+s];e[k+s]=e[l],e[l++]=t}var u=f[p];f[p]=f[m],f[m++]=u}}return m".replace("_",r.join()).replace("$",e)),Function.apply(void 0,n)}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){e.exports=function(e){var t=new Float32Array(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}},function(e,t,n){e.exports=function(e,t){var n=r(e[0],e[1],e[2]),s=r(t[0],t[1],t[2]);i(n,n),i(s,s);var a=o(n,s);return a>1?0:Math.acos(a)};var r=n(204),i=n(205),o=n(206)},function(e,t){e.exports=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}},function(e,t){e.exports=function(e,t,n,r){return e[0]=t,e[1]=n,e[2]=r,e}},function(e,t,n){e.exports=function(e,t){var n=e[0],i=e[1],o=e[2],s=t[0],a=t[1],u=t[2];return Math.abs(n-s)<=r*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-a)<=r*Math.max(1,Math.abs(i),Math.abs(a))&&Math.abs(o-u)<=r*Math.max(1,Math.abs(o),Math.abs(u))};var r=n(202)},function(e,t){e.exports=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}},function(e,t){e.exports=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}},function(e,t,n){e.exports=n(207)},function(e,t,n){e.exports=n(208)},function(e,t,n){e.exports=n(209)},function(e,t){e.exports=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e}},function(e,t){e.exports=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e}},function(e,t){e.exports=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}},function(e,t){e.exports=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}},function(e,t){e.exports=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}},function(e,t){e.exports=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e}},function(e,t){e.exports=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e}},function(e,t,n){e.exports=n(210)},function(e,t,n){e.exports=n(211)},function(e,t,n){e.exports=n(212)},function(e,t,n){e.exports=n(213)},function(e,t){e.exports=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}},function(e,t){e.exports=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}},function(e,t){e.exports=function(e,t,n){var r=t[0],i=t[1],o=t[2],s=n[0],a=n[1],u=n[2];return e[0]=i*u-o*a,e[1]=o*s-r*u,e[2]=r*a-i*s,e}},function(e,t){e.exports=function(e,t,n,r){var i=t[0],o=t[1],s=t[2];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e[2]=s+r*(n[2]-s),e}},function(e,t){e.exports=function(e,t){t=t||1;var n=2*Math.random()*Math.PI,r=2*Math.random()-1,i=Math.sqrt(1-r*r)*t;return e[0]=Math.cos(n)*i,e[1]=Math.sin(n)*i,e[2]=r*t,e}},function(e,t){e.exports=function(e,t,n){var r=t[0],i=t[1],o=t[2],s=n[3]*r+n[7]*i+n[11]*o+n[15];return s=s||1,e[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/s,e[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/s,e[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/s,e}},function(e,t){e.exports=function(e,t,n){var r=t[0],i=t[1],o=t[2];return e[0]=r*n[0]+i*n[3]+o*n[6],e[1]=r*n[1]+i*n[4]+o*n[7],e[2]=r*n[2]+i*n[5]+o*n[8],e}},function(e,t){e.exports=function(e,t,n){var r=t[0],i=t[1],o=t[2],s=n[0],a=n[1],u=n[2],c=n[3],l=c*r+a*o-u*i,h=c*i+u*r-s*o,f=c*o+s*i-a*r,d=-s*r-a*i-u*o;return e[0]=l*c+d*-s+h*-u-f*-a,e[1]=h*c+d*-a+f*-s-l*-u,e[2]=f*c+d*-u+l*-a-h*-s,e}},function(e,t){e.exports=function(e,t,n,r){var i=n[1],o=n[2],s=t[1]-i,a=t[2]-o,u=Math.sin(r),c=Math.cos(r);return e[0]=t[0],e[1]=i+s*c-a*u,e[2]=o+s*u+a*c,e}},function(e,t){e.exports=function(e,t,n,r){var i=n[0],o=n[2],s=t[0]-i,a=t[2]-o,u=Math.sin(r),c=Math.cos(r);return e[0]=i+a*u+s*c,e[1]=t[1],e[2]=o+a*c-s*u,e}},function(e,t){e.exports=function(e,t,n,r){var i=n[0],o=n[1],s=t[0]-i,a=t[1]-o,u=Math.sin(r),c=Math.cos(r);return e[0]=i+s*c-a*u,e[1]=o+s*u+a*c,e[2]=t[2],e}},function(e,t,n){e.exports=function(e,t,n,i,o,s){var a,u;t||(t=3);n||(n=0);u=i?Math.min(i*t+n,e.length):e.length;for(a=n;a<u;a+=t)r[0]=e[a],r[1]=e[a+1],r[2]=e[a+2],o(r,r,s),e[a]=r[0],e[a+1]=r[1],e[a+2]=r[2];return e};var r=n(203)()},function(e,t){function n(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
e.exports=function(e){return null!=e&&(n(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&n(e.slice(0,0))}(e)||!!e._isBuffer)}},function(e,t,n){"use strict";e.exports=function(e,t,n,r,i,o){var s=+t[0],a=+t[1],u=+t[2],c=+n[0],l=+n[1],h=+n[2],f=Math.sqrt(c*c+l*l+h*h);if(0===f)throw new Error("Can't raycast along a zero vector");return function(e,t,n,r,i,o,s,a,u,c){for(var l=0,h=Math.floor,f=0|h(t),d=0|h(n),p=0|h(r),m=i>0?1:-1,v=o>0?1:-1,g=s>0?1:-1,y=Math.abs(1/i),b=Math.abs(1/o),w=Math.abs(1/s),_=y<1/0?y*(m>0?f+1-t:t-f):1/0,k=b<1/0?b*(v>0?d+1-n:n-d):1/0,x=w<1/0?w*(g>0?p+1-r:r-p):1/0,M=-1;l<=a;){var C=e(f,d,p);if(C)return u&&(u[0]=t+l*i,u[1]=n+l*o,u[2]=r+l*s),c&&(c[0]=c[1]=c[2]=0,0===M&&(c[0]=-m),1===M&&(c[1]=-v),2===M&&(c[2]=-g)),C;_<k?_<x?(f+=m,l=_,_+=y,M=0):(p+=g,l=x,x+=w,M=2):k<x?(d+=v,l=k,k+=b,M=1):(p+=g,l=x,x+=w,M=2)}return u&&(u[0]=t+l*i,u[1]=n+l*o,u[2]=r+l*s),c&&(c[0]=c[1]=c[2]=0),0}(e,s,a,u,c/=f,l/=f,h/=f,r=void 0===r?64:+r,i,o)}},function(e,t,n){"use strict";var r=n(81).EventEmitter,i=n(293),o=n(297),s=n(298),a=n(299),u=n(300),c=n(301),l=n(214),h=Math.min;n(302);var f=n(303),d=n(304),p=function(){var e,t,n=new Array(256);for(e=0;e<256;++e)n[e]="UNK";for(e in s)"<"===(t=s[e]).charAt(0)&&">"===t.charAt(t.length-1)&&(t=t.substring(1,t.length-1)),t=t.replace(/\s/g,"-"),n[parseInt(e)]=t;return n}(),m=u(Object.keys(a(p)));function v(e){return c.eq(m,e)}function g(e){return v(p[e])}function y(){r.call(this),this._curKeyState=new Array(m.length),this._pressCount=new Array(m.length),this._releaseCount=new Array(m.length),this._tickInterval=null,this._rafHandle=null,this._tickRate=0,this._lastTick=d(),this._frameTime=0,this._paused=!0,this._width=0,this._height=0,this._wantFullscreen=!1,this._wantPointerLock=!1,this._fullscreenActive=!1,this._pointerLockActive=!1,this._rafFunction=E.bind(void 0,this,!0),this.preventDefaults=!0,this.stopPropagation=!1;for(var e=0;e<m.length;++e)this._curKeyState[e]=!1,this._pressCount[e]=this._releaseCount[e]=0;this.element=null,this.bindings={},this.frameSkip=100,this.tickCount=0,this.frameCount=0,this.startTime=d(),this.tickTime=this._tickRate,this.frameTime=10,this.stickyFullscreen=!1,this.stickyPointerLock=!1,this.scroll=[0,0,0],this.mouseX=0,this.mouseY=0,this.prevMouseX=0,this.prevMouseY=0}i.inherits(y,r);var b=y.prototype;function w(e,t,n){if(n in t){for(var r=t[n],i=0,o=0,s=r.length;o<s;++o)i+=e[v(r[o])];return i}var a=v(n);return a>=0?e[a]:0}function _(e){var t=e.element;e._wantFullscreen&&!e._fullscreenActive&&(t.requestFullscreen||t.requestFullScreen||t.webkitRequestFullscreen||t.webkitRequestFullScreen||t.mozRequestFullscreen||t.mozRequestFullScreen||function(){}).call(t);e._wantPointerLock&&!e._pointerLockActive&&(t.requestPointerLock||t.webkitRequestPointerLock||t.mozRequestPointerLock||t.msRequestPointerLock||t.oRequestPointerLock||function(){}).call(t)}b.keyNames=m,b.bind=function(e){var t,n;t=e in this.bindings?this.bindings[e]:[];for(var r=1,i=arguments.length;r<i;++r)if(v(n=arguments[r])>=0)t.push(n);else if(n in this.bindings)for(var o=this.bindings[n],s=0;s<o.length;++s)t.push(o[s]);(t=u(t)).length>0&&(this.bindings[e]=t),this.emit("bind",e,t)},b.unbind=function(e){e in this.bindings&&delete this.bindings[e],this.emit("unbind",e)},b.down=function(e){return function(e,t,n){if(n in t){for(var r=t[n],i=0,o=r.length;i<o;++i)if(e[v(r[i])])return!0;return!1}var s=v(n);return s>=0&&e[s]}(this._curKeyState,this.bindings,e)},b.wasDown=function(e){return this.down(e)||!!this.press(e)},b.up=function(e){return!this.down(e)},b.wasUp=function(e){return this.up(e)||!!this.release(e)},b.press=function(e){return w(this._pressCount,this.bindings,e)},b.release=function(e){return w(this._releaseCount,this.bindings,e)},Object.defineProperty(b,"paused",{get:function(){return this._paused},set:function(e){!!e!==this._paused&&(this._paused?(this._paused=!1,this._lastTick=d()-Math.floor(this._frameTime*this._tickRate),this._tickInterval=setInterval(E,this._tickRate,this,!1),this._rafHandle=requestAnimationFrame(this._rafFunction)):(this._paused=!0,this._frameTime=h(1,(d()-this._lastTick)/this._tickRate),clearInterval(this._tickInterval)))}});var k=document.exitFullscreen||document.cancelFullscreen||document.cancelFullScreen||document.webkitCancelFullscreen||document.webkitCancelFullScreen||document.mozCancelFullscreen||document.mozCancelFullScreen||function(){};function x(e){e._fullscreenActive=document.fullscreen||document.mozFullScreen||document.webkitIsFullScreen||!1,!e.stickyFullscreen&&e._fullscreenActive&&(e._wantFullscreen=!1)}Object.defineProperty(b,"fullscreen",{get:function(){return this._fullscreenActive},set:function(e){!e?(this._wantFullscreen=!1,(document.fullscreen||document.mozFullScreen||document.webkitIsFullScreen||!1)&&k.call(document)):(this._wantFullscreen=!0,_(this));return this._fullscreenActive}});var M=document.exitPointerLock||document.webkitExitPointerLock||document.mozExitPointerLock||function(){};function C(e,t){e._pointerLockActive=e.element===(document.pointerLockElement||document.mozPointerLockElement||document.webkitPointerLockElement||null),!e.stickyPointerLock&&e._pointerLockActive&&(e._wantPointerLock=!1)}function P(e,t,n){e._curKeyState[t]!==n&&(n?e._pressCount[t]++:e._releaseCount[t]++,e._curKeyState[t]=n)}function E(e,t){!function(e){var t,n,r,i=d()+e.frameSkip,o=e._pressCount,s=e._releaseCount,a=e._tickRate,u=m.length;for(;!e._paused&&d()>=e._lastTick+a;){if(d()>i)return void(e._lastTick=d()+a);for(n=d(),e.emit("tick"),r=d(),e.tickTime=r-n,++e.tickCount,e._lastTick+=a,t=0;t<u;++t)o[t]=s[t]=0;e._pointerLockActive?(e.prevMouseX=e.mouseX=e.width>>1,e.prevMouseY=e.mouseY=e.height>>1):(e.prevMouseX=e.mouseX,e.prevMouseY=e.mouseY),e.scroll[0]=e.scroll[1]=e.scroll[2]=0}}(e),t&&function(e){var t;e._rafHandle=requestAnimationFrame(e._rafFunction),t=e._paused?e._frameTime:h(1,(d()-e._lastTick)/e._tickRate);++e.frameCount;var n=d();e.emit("render",t);var r=d();e.frameTime=r-n}(e)}function D(e,t){e.preventDefaults&&t.preventDefault(),e.stopPropagation&&t.stopPropagation()}function I(e,t){D(e,t);var n=g(t.keyCode||t.char||t.which||t.charCode);n>=0&&P(e,n,!1)}function A(e,t){if(function(e){return document.activeElement===document.body||document.activeElement===e.element}(e))if(D(e,t),t.metaKey)z(e,t);else{var n=g(t.keyCode||t.char||t.which||t.charCode);n>=0&&P(e,n,!0)}}Object.defineProperty(b,"pointerLock",{get:function(){return this._pointerLockActive},set:function(e){return!!e?(this._wantPointerLock=!0,_(this)):(this._wantPointerLock=!1,M.call(document)),this._pointerLockActive}}),Object.defineProperty(b,"width",{get:function(){return this.element.clientWidth}}),Object.defineProperty(b,"height",{get:function(){return this.element.clientHeight}});var T=l(32).map((function(e){return v("mouse-"+(e+1))}));function B(e,t){if(D(e,t),e._pointerLockActive){var n=t.movementX||t.mozMovementX||t.webkitMovementX||0,r=t.movementY||t.mozMovementY||t.webkitMovementY||0;e.mouseX+=n,e.mouseY+=r}else e.mouseX=t.clientX-e.element.offsetLeft,e.mouseY=t.clientY-e.element.offsetTop;return!1}function S(e,t){return D(e,t),P(e,T[t.button],!0),!1}function L(e,t){return D(e,t),P(e,T[t.button],!1),!1}function O(e,t){return D(e,t),e._pointerLockActive?(e.prevMouseX=e.mouseX=e.width>>1,e.prevMouseY=e.mouseY=e.height>>1):(e.prevMouseX=e.mouseX=t.clientX-e.element.offsetLeft,e.prevMouseY=e.mouseY=t.clientY-e.element.offsetTop),!1}function j(e,t){return D(e,t),function(e,t){for(var n=0;n<32;++n)P(e,T[n],!!(t&1<<n))}(e,0),!1}function R(e,t){D(e,t);var n=1;switch(t.deltaMode){case 0:n=1;break;case 1:n=12;break;case 2:n=e.height}return e.scroll[0]+=t.deltaX*n,e.scroll[1]+=t.deltaY*n,e.scroll[2]+=t.deltaZ*n||0,!1}function F(e,t){return D(e,t),!1}function z(e,t){var n,r=m.length,i=e._curKeyState,o=e._releaseCount;for(n=0;n<r;++n)i[n]&&++o[n],i[n]=!1;return!1}function U(e,t){var n=0|e.element.clientWidth,r=0|e.element.clientHeight;n===e._width&&r===e._height||(e._width=n,e._height=r,e.emit("resize",n,r))}function N(){var e=document.createElement("div");return e.tabindex=1,e.style.position="absolute",e.style.left="0px",e.style.right="0px",e.style.top="0px",e.style.bottom="0px",e.style.height="100%",e.style.overflow="hidden",document.body.appendChild(e),document.body.style.overflow="hidden",document.body.style.height="100%",e}e.exports=function(e){var t=!!(e=e||{}).fullscreen,n=t;void 0!==typeof e.pointerLock&&(n=!!e.pointerLock);var r=new y;return r._tickRate=e.tickRate||30,r.frameSkip=e.frameSkip||5*(r._tickRate+5),r.stickyFullscreen=!!e.stickyFullscreen||!!e.sticky,r.stickyPointerLock=!!e.stickyPointerLock||!!e.sticky,e.bindings&&(r.bindings=e.bindings),setTimeout((function(){o((function(){var i=e.element;if("string"==typeof i){var o=document.querySelector(i);o||(o=document.getElementById(i)),o||(o=document.getElementByClass(i)[0]),o||(o=N()),r.element=o}else r.element="object"==typeof i&&i?i:"function"==typeof i?i():N();r.element.style&&(r.element.style["-webkit-touch-callout"]="none",r.element.style["-webkit-user-select"]="none",r.element.style["-khtml-user-select"]="none",r.element.style["-moz-user-select"]="none",r.element.style["-ms-user-select"]="none",r.element.style["user-select"]="none"),r._width=r.element.clientWidth,r._height=r.element.clientHeight;var s=U.bind(void 0,r);"undefined"!=typeof MutationObserver?new MutationObserver(s).observe(r.element,{attributes:!0,subtree:!0}):r.element.addEventListener("DOMSubtreeModified",s,!1);window.addEventListener("resize",s,!1),window.addEventListener("keydown",A.bind(void 0,r),!1),window.addEventListener("keyup",I.bind(void 0,r),!1),r.element.oncontextmenu=F.bind(void 0,r),r.element.addEventListener("mousedown",S.bind(void 0,r),!1),r.element.addEventListener("mouseup",L.bind(void 0,r),!1),r.element.addEventListener("mousemove",B.bind(void 0,r),!1),r.element.addEventListener("mouseenter",O.bind(void 0,r),!1);var a=j.bind(void 0,r);r.element.addEventListener("mouseleave",a,!1),r.element.addEventListener("mouseout",a,!1),window.addEventListener("mouseleave",a,!1),window.addEventListener("mouseout",a,!1);var u=z.bind(void 0,r);r.element.addEventListener("blur",u,!1),r.element.addEventListener("focusout",u,!1),r.element.addEventListener("focus",u,!1),window.addEventListener("blur",u,!1),window.addEventListener("focusout",u,!1),window.addEventListener("focus",u,!1),f(r.element,R.bind(void 0,r),!1);var c=x.bind(void 0,r);document.addEventListener("fullscreenchange",c,!1),document.addEventListener("mozfullscreenchange",c,!1),document.addEventListener("webkitfullscreenchange",c,!1),r.element.addEventListener("click",_.bind(void 0,r),!1);var l=C.bind(void 0,r);document.addEventListener("pointerlockchange",l,!1),document.addEventListener("mozpointerlockchange",l,!1),document.addEventListener("webkitpointerlockchange",l,!1),document.addEventListener("pointerlocklost",l,!1),document.addEventListener("webkitpointerlocklost",l,!1),document.addEventListener("mozpointerlocklost",l,!1),r.fullscreen=t,r.pointerLock=n,r.bind("mouse-left","mouse-1"),r.bind("mouse-right","mouse-3"),r.bind("mouse-middle","mouse-2"),r._lastTick=d(),r.startTime=d(),r.paused=!1,r.emit("init")}))}),0),r}},function(e,t,n){(function(e){var r=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++)n[t[r]]=Object.getOwnPropertyDescriptor(e,t[r]);return n},i=/%[sdj%]/g;t.format=function(e){if(!g(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(a(arguments[n]));return t.join(" ")}n=1;for(var r=arguments,o=r.length,s=String(e).replace(i,(function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}})),u=r[n];n<o;u=r[++n])m(u)||!w(u)?s+=" "+u:s+=" "+a(u);return s},t.deprecate=function(n,r){if(void 0!==e&&!0===e.noDeprecation)return n;if(void 0===e)return function(){return t.deprecate(n,r).apply(this,arguments)};var i=!1;return function(){if(!i){if(e.throwDeprecation)throw new Error(r);e.traceDeprecation?console.trace(r):console.error(r),i=!0}return n.apply(this,arguments)}};var o,s={};function a(e,n){var r={seen:[],stylize:c};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),p(n)?r.showHidden=n:n&&t._extend(r,n),y(r.showHidden)&&(r.showHidden=!1),y(r.depth)&&(r.depth=2),y(r.colors)&&(r.colors=!1),y(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=u),l(r,e,r.depth)}function u(e,t){var n=a.styles[t];return n?"["+a.colors[n][0]+"m"+e+"["+a.colors[n][1]+"m":e}function c(e,t){return e}function l(e,n,r){if(e.customInspect&&n&&x(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,e);return g(i)||(i=l(e,i,r)),i}var o=function(e,t){if(y(t))return e.stylize("undefined","undefined");if(g(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}if(v(t))return e.stylize(""+t,"number");if(p(t))return e.stylize(""+t,"boolean");if(m(t))return e.stylize("null","null")}(e,n);if(o)return o;var s=Object.keys(n),a=function(e){var t={};return e.forEach((function(e,n){t[e]=!0})),t}(s);if(e.showHidden&&(s=Object.getOwnPropertyNames(n)),k(n)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return h(n);if(0===s.length){if(x(n)){var u=n.name?": "+n.name:"";return e.stylize("[Function"+u+"]","special")}if(b(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(_(n))return e.stylize(Date.prototype.toString.call(n),"date");if(k(n))return h(n)}var c,w="",M=!1,C=["{","}"];(d(n)&&(M=!0,C=["[","]"]),x(n))&&(w=" [Function"+(n.name?": "+n.name:"")+"]");return b(n)&&(w=" "+RegExp.prototype.toString.call(n)),_(n)&&(w=" "+Date.prototype.toUTCString.call(n)),k(n)&&(w=" "+h(n)),0!==s.length||M&&0!=n.length?r<0?b(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special"):(e.seen.push(n),c=M?function(e,t,n,r,i){for(var o=[],s=0,a=t.length;s<a;++s)D(t,String(s))?o.push(f(e,t,n,r,String(s),!0)):o.push("");return i.forEach((function(i){i.match(/^\d+$/)||o.push(f(e,t,n,r,i,!0))})),o}(e,n,r,a,s):s.map((function(t){return f(e,n,r,a,t,M)})),e.seen.pop(),function(e,t,n){if(e.reduce((function(e,t){return t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1];return n[0]+t+" "+e.join(", ")+" "+n[1]}(c,w,C)):C[0]+w+C[1]}function h(e){return"["+Error.prototype.toString.call(e)+"]"}function f(e,t,n,r,i,o){var s,a,u;if((u=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?a=u.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):u.set&&(a=e.stylize("[Setter]","special")),D(r,i)||(s="["+i+"]"),a||(e.seen.indexOf(u.value)<0?(a=m(n)?l(e,u.value,null):l(e,u.value,n-1)).indexOf("\n")>-1&&(a=o?a.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+a.split("\n").map((function(e){return"   "+e})).join("\n")):a=e.stylize("[Circular]","special")),y(s)){if(o&&i.match(/^\d+$/))return a;(s=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+a}function d(e){return Array.isArray(e)}function p(e){return"boolean"==typeof e}function m(e){return null===e}function v(e){return"number"==typeof e}function g(e){return"string"==typeof e}function y(e){return void 0===e}function b(e){return w(e)&&"[object RegExp]"===M(e)}function w(e){return"object"==typeof e&&null!==e}function _(e){return w(e)&&"[object Date]"===M(e)}function k(e){return w(e)&&("[object Error]"===M(e)||e instanceof Error)}function x(e){return"function"==typeof e}function M(e){return Object.prototype.toString.call(e)}function C(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(n){if(y(o)&&(o=e.env.NODE_DEBUG||""),n=n.toUpperCase(),!s[n])if(new RegExp("\\b"+n+"\\b","i").test(o)){var r=e.pid;s[n]=function(){var e=t.format.apply(t,arguments);console.error("%s %d: %s",n,r,e)}}else s[n]=function(){};return s[n]},t.inspect=a,a.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},a.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=d,t.isBoolean=p,t.isNull=m,t.isNullOrUndefined=function(e){return null==e},t.isNumber=v,t.isString=g,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=y,t.isRegExp=b,t.isObject=w,t.isDate=_,t.isError=k,t.isFunction=x,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=n(295);var P=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function E(){var e=new Date,t=[C(e.getHours()),C(e.getMinutes()),C(e.getSeconds())].join(":");return[e.getDate(),P[e.getMonth()],t].join(" ")}function D(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",E(),t.format.apply(t,arguments))},t.inherits=n(296),t._extend=function(e,t){if(!t||!w(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e};var I="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function A(e,t){if(!e){var n=new Error("Promise was rejected with a falsy value");n.reason=e,e=n}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(I&&e[I]){var t;if("function"!=typeof(t=e[I]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,I,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,n,r=new Promise((function(e,r){t=e,n=r})),i=[],o=0;o<arguments.length;o++)i.push(arguments[o]);i.push((function(e,r){e?n(e):t(r)}));try{e.apply(this,i)}catch(e){n(e)}return r}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),I&&Object.defineProperty(t,I,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,r(e))},t.promisify.custom=I,t.callbackify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');function n(){for(var n=[],r=0;r<arguments.length;r++)n.push(arguments[r]);var i=n.pop();if("function"!=typeof i)throw new TypeError("The last argument must be of type Function");var o=this,s=function(){return i.apply(o,arguments)};t.apply(this,n).then((function(t){e.nextTick(s,null,t)}),(function(t){e.nextTick(A,t,s)}))}return Object.setPrototypeOf(n,Object.getPrototypeOf(t)),Object.defineProperties(n,r(t)),n}}).call(this,n(294))},function(e,t){var n,r,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(e){r=s}}();var u,c=[],l=!1,h=-1;function f(){l&&u&&(l=!1,u.length?c=u.concat(c):h=-1,c.length&&d())}function d(){if(!l){var e=a(f);l=!0;for(var t=c.length;t;){for(u=c,c=[];++h<t;)u&&u[h].run();h=-1,t=c.length}u=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function m(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new p(e,t)),1!==c.length||l||a(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t,n){var r,i,o,s,a;e.exports=(i=[],o=document,s=o.documentElement.doScroll,(a=(s?/^loaded|^c/:/^loaded|^i|^c/).test(o.readyState))||o.addEventListener("DOMContentLoaded",r=function(){for(o.removeEventListener("DOMContentLoaded",r),a=1;r=i.shift();)r()}),function(e){a?setTimeout(e,0):i.push(e)})},function(e,t){var n,r="undefined"!=typeof window?window.navigator.userAgent:"",i=/OS X/.test(r),o=/Opera/.test(r),s=!/like Gecko/.test(r)&&!o,a=e.exports={0:i?"<menu>":"<UNK>",1:"<mouse 1>",2:"<mouse 2>",3:"<break>",4:"<mouse 3>",5:"<mouse 4>",6:"<mouse 5>",8:"<backspace>",9:"<tab>",12:"<clear>",13:"<enter>",16:"<shift>",17:"<control>",18:"<alt>",19:"<pause>",20:"<caps-lock>",21:"<ime-hangul>",23:"<ime-junja>",24:"<ime-final>",25:"<ime-kanji>",27:"<escape>",28:"<ime-convert>",29:"<ime-nonconvert>",30:"<ime-accept>",31:"<ime-mode-change>",27:"<escape>",32:"<space>",33:"<page-up>",34:"<page-down>",35:"<end>",36:"<home>",37:"<left>",38:"<up>",39:"<right>",40:"<down>",41:"<select>",42:"<print>",43:"<execute>",44:"<snapshot>",45:"<insert>",46:"<delete>",47:"<help>",91:"<meta>",92:"<meta>",93:i?"<meta>":"<menu>",95:"<sleep>",106:"<num-*>",107:"<num-+>",108:"<num-enter>",109:"<num--\x3e",110:"<num-.>",111:"<num-/>",144:"<num-lock>",145:"<scroll-lock>",160:"<shift-left>",161:"<shift-right>",162:"<control-left>",163:"<control-right>",164:"<alt-left>",165:"<alt-right>",166:"<browser-back>",167:"<browser-forward>",168:"<browser-refresh>",169:"<browser-stop>",170:"<browser-search>",171:"<browser-favorites>",172:"<browser-home>",173:i&&s?"-":"<volume-mute>",174:"<volume-down>",175:"<volume-up>",176:"<next-track>",177:"<prev-track>",178:"<stop>",179:"<play-pause>",180:"<launch-mail>",181:"<launch-media-select>",182:"<launch-app 1>",183:"<launch-app 2>",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",223:"<meta>",224:"<meta>",226:"<alt-gr>",229:"<ime-process>",231:o?"`":"<unicode>",246:"<attention>",247:"<crsel>",248:"<exsel>",249:"<erase-eof>",250:"<play>",251:"<zoom>",252:"<no-name>",253:"<pa-1>",254:"<clear>"};for(n=58;n<65;++n)a[n]=String.fromCharCode(n);for(n=48;n<58;++n)a[n]=n-48+"";for(n=65;n<91;++n)a[n]=String.fromCharCode(n);for(n=96;n<106;++n)a[n]="<num-"+(n-96)+">";for(n=112;n<136;++n)a[n]="F"+(n-111)},function(e,t,n){"use strict";e.exports=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[e[n]]=n);return t}},function(e,t,n){"use strict";e.exports=function(e,t,n){return 0===e.length?e:t?(n||e.sort(t),function(e,t){for(var n=1,r=e.length,i=e[0],o=e[0],s=1;s<r;++s)if(o=i,t(i=e[s],o)){if(s===n){n++;continue}e[n++]=i}return e.length=n,e}(e,t)):(n||e.sort(),function(e){for(var t=1,n=e.length,r=e[0],i=e[0],o=1;o<n;++o,i=r)if(i=r,(r=e[o])!==i){if(o===t){t++;continue}e[t++]=r}return e.length=t,e}(e))}},function(e,t,n){"use strict";function r(e,t,n,r,i,o){var s=["function ",e,"(a,l,h,",r.join(","),"){",o?"":"var i=",n?"l-1":"h+1",";while(l<=h){var m=(l+h)>>>1,x=a",i?".get(m)":"[m]"];return o?t.indexOf("c")<0?s.push(";if(x===y){return m}else if(x<=y){"):s.push(";var p=c(x,y);if(p===0){return m}else if(p<=0){"):s.push(";if(",t,"){i=m;"),n?s.push("l=m+1}else{h=m-1}"):s.push("h=m-1}else{l=m+1}"),s.push("}"),o?s.push("return -1};"):s.push("return i};"),s.join("")}function i(e,t,n,i){return new Function([r("A","x"+e+"y",t,["y"],!1,i),r("B","x"+e+"y",t,["y"],!0,i),r("P","c(x,y)"+e+"0",t,["y","c"],!1,i),r("Q","c(x,y)"+e+"0",t,["y","c"],!0,i),"function dispatchBsearch",n,"(a,y,c,l,h){if(a.shape){if(typeof(c)==='function'){return Q(a,(l===undefined)?0:l|0,(h===undefined)?a.shape[0]-1:h|0,y,c)}else{return B(a,(c===undefined)?0:c|0,(l===undefined)?a.shape[0]-1:l|0,y)}}else{if(typeof(c)==='function'){return P(a,(l===undefined)?0:l|0,(h===undefined)?a.length-1:h|0,y,c)}else{return A(a,(c===undefined)?0:c|0,(l===undefined)?a.length-1:l|0,y)}}}return dispatchBsearch",n].join(""))()}e.exports={ge:i(">=",!1,"GE"),gt:i(">",!1,"GT"),lt:i("<",!0,"LT"),le:i("<=",!0,"LE"),eq:i("-",!0,"EQ",!0)}},function(e,t){for(var n=0,r=["ms","moz","webkit","o"],i=0;i<r.length&&!window.requestAnimationFrame;++i)window.requestAnimationFrame=window[r[i]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[r[i]+"CancelAnimationFrame"]||window[r[i]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e,t){var r=(new Date).getTime(),i=Math.max(0,16-(r-n)),o=window.setTimeout((function(){e(r+i)}),i);return n=r+i,o}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})},function(e,t){var n,r,i="";function o(e,t,o,s){e[n](i+t,"wheel"==r?o:function(e){!e&&(e=window.event);var t={originalEvent:e,target:e.target||e.srcElement,type:"wheel",deltaMode:"MozMousePixelScroll"==e.type?0:1,deltaX:0,delatZ:0,preventDefault:function(){e.preventDefault?e.preventDefault():e.returnValue=!1}};return"mousewheel"==r?(t.deltaY=-1/40*e.wheelDelta,e.wheelDeltaX&&(t.deltaX=-1/40*e.wheelDeltaX)):t.deltaY=e.detail,o(t)},s||!1)}window.addEventListener?n="addEventListener":(n="attachEvent",i="on"),r="onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",e.exports=function(e,t,n){o(e,r,t,n),"DOMMouseScroll"==r&&o(e,"MozMousePixelScroll",t,n)}},function(e,t){"object"==typeof window.performance?window.performance.now?e.exports=function(){return window.performance.now()}:window.performance.webkitNow&&(e.exports=function(){return window.performance.webkitNow()}):Date.now?e.exports=Date.now:e.exports=function(){return(new Date).getTime()}},function(e,t,n){var r=n(306),i=n(81).EventEmitter,o=n(307);function s(e,t){this.element=e||document,t=t||{},this.preventDefaults=!!t.preventDefaults,this.stopPropagation=!!t.stopPropagation,this.allowContextMenu=!!t.allowContextMenu,this.disabled=!!t.disabled,this.down=new i,this.up=new i,this.state={dx:0,dy:0,scrollx:0,scrolly:0,scrollz:0},this._keybindmap={},this._keyStates={},this._bindPressCounts={},this._ignoreMousemoveOnce=!1,this.initEvents()}function a(e,t,n){g(n.keyCode,r[n.keyCode],t,e,n)}function u(e,t,n){return g(-1-n.button,"<mouse "+(n.button+1)+">",t,e,n),!1}function c(e){if(!e.allowContextMenu)return!1}function l(e,t){if(e._ignoreMousemoveOnce)e._ignoreMousemoveOnce=!1;else{var n=t.movementX||t.mozMovementX||0,r=t.movementY||t.mozMovementY||0;if(t.touches&&0==(n|r)){var i=function(e){for(var t,n=e.changedTouches,r=0;r<n.length;++r)n[r].identifier==d&&(t=n[r]);if(!t)return[0,0];var i=[t.clientX-h,t.clientY-f];return h=t.clientX,f=t.clientY,i}(t);n=i[0],r=i[1]}e.state.dx+=n,e.state.dy+=r}}e.exports=function(e,t){return new s(e,t)},s.prototype.initEvents=function(){window.addEventListener("keydown",a.bind(void 0,this,!0),!1),window.addEventListener("keyup",a.bind(void 0,this,!1),!1),this.element.addEventListener("mousedown",u.bind(void 0,this,!0),!1),this.element.addEventListener("mouseup",u.bind(void 0,this,!1),!1),this.element.oncontextmenu=c.bind(void 0,this),this.element.addEventListener("dragstart",u.bind(void 0,this,!1),!1),this.element.addEventListener("mousemove",l.bind(void 0,this),!1),this.element.addEventListener("touchmove",l.bind(void 0,this),!1),this.element.addEventListener("touchstart",p.bind(void 0,this),!1),o(this.element,m.bind(void 0,this),!1),document.addEventListener("pointerlockchange",v.bind(void 0,this),!1),document.addEventListener("mozpointerlockchange",v.bind(void 0,this),!1)},s.prototype.bind=function(e){for(var t=1;t<arguments.length;++t){var n=arguments[t],r=this._keybindmap[n]||[];-1==r.indexOf(e)&&r.push(e),this._keybindmap[n]=r}this.state[e]=!!this.state[e]},s.prototype.unbind=function(e){for(var t in this._keybindmap){var n=this._keybindmap[t],r=n.indexOf(e);r>-1&&n.splice(r,1)}},s.prototype.tick=function(){this.state.dx=this.state.dy=0,this.state.scrollx=this.state.scrolly=this.state.scrollz=0},s.prototype.getBoundKeys=function(){var e=[];for(var t in this._keybindmap)e.push(t);return e};var h=0,f=0,d=null;function p(e,t){var n=t.changedTouches[0];h=n.clientX,f=n.clientY,d=n.identifier}function m(e,t){var n=1;switch(t.deltaMode){case 0:n=1;break;case 1:n=12;break;case 2:n=e.element.clientHeight||window.innerHeight}return e.state.scrollx+=t.deltaX*n,e.state.scrolly+=t.deltaY*n,e.state.scrollz+=t.deltaZ*n||0,!1}function v(e,t){(document.pointerLockElement||document.mozPointerLockElement||null)&&(e._ignoreMousemoveOnce=!0)}function g(e,t,n,r,i){var o=r._keybindmap[t];if(o){if(r.preventDefaults&&i.preventDefault(),r.stopPropagation&&i.stopPropagation(),b(r._keyStates[e],n))for(var s=0;s<o.length;++s)y(o[s],n,r,i);r._keyStates[e]=n}}function y(e,t,n,r){var i=n._bindPressCounts[e]||0;if((i+=t?1:-1)<0&&(i=0),n._bindPressCounts[e]=i,b(n.state[e],i)){var o=t?n.down:n.up;n.disabled||o.emit(e,r)}n.state[e]=!!i}function b(e,t){return e?!t:t}},function(e,t,n){"use strict";var r,i="undefined"!=typeof window?window.navigator.userAgent:"",o=/OS X/.test(i),s=/Opera/.test(i),a=!/like Gecko/.test(i)&&!s,u=e.exports={0:o?"<menu>":"<UNK>",1:"<mouse 1>",2:"<mouse 2>",3:"<break>",4:"<mouse 3>",5:"<mouse 4>",6:"<mouse 5>",8:"<backspace>",9:"<tab>",12:"<clear>",13:"<enter>",16:"<shift>",17:"<control>",18:"<alt>",19:"<pause>",20:"<caps-lock>",21:"<ime-hangul>",23:"<ime-junja>",24:"<ime-final>",25:"<ime-kanji>",27:"<escape>",28:"<ime-convert>",29:"<ime-nonconvert>",30:"<ime-accept>",31:"<ime-mode-change>",32:"<space>",33:"<page-up>",34:"<page-down>",35:"<end>",36:"<home>",37:"<left>",38:"<up>",39:"<right>",40:"<down>",41:"<select>",42:"<print>",43:"<execute>",44:"<snapshot>",45:"<insert>",46:"<delete>",47:"<help>",91:"<meta>",92:"<meta>",93:o?"<meta>":"<menu>",95:"<sleep>",106:"<num-*>",107:"<num-+>",108:"<num-enter>",109:"<num--\x3e",110:"<num-.>",111:"<num-/>",144:"<num-lock>",145:"<scroll-lock>",160:"<shift-left>",161:"<shift-right>",162:"<control-left>",163:"<control-right>",164:"<alt-left>",165:"<alt-right>",166:"<browser-back>",167:"<browser-forward>",168:"<browser-refresh>",169:"<browser-stop>",170:"<browser-search>",171:"<browser-favorites>",172:"<browser-home>",173:o&&a?"-":"<volume-mute>",174:"<volume-down>",175:"<volume-up>",176:"<next-track>",177:"<prev-track>",178:"<stop>",179:"<play-pause>",180:"<launch-mail>",181:"<launch-media-select>",182:"<launch-app 1>",183:"<launch-app 2>",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",223:"<meta>",224:"<meta>",226:"<alt-gr>",229:"<ime-process>",231:s?"`":"<unicode>",246:"<attention>",247:"<crsel>",248:"<exsel>",249:"<erase-eof>",250:"<play>",251:"<zoom>",252:"<no-name>",253:"<pa-1>",254:"<clear>"};for(r=58;r<65;++r)u[r]=String.fromCharCode(r);for(r=48;r<58;++r)u[r]=r-48+"";for(r=65;r<91;++r)u[r]=String.fromCharCode(r);for(r=96;r<106;++r)u[r]="<num-"+(r-96)+">";for(r=112;r<136;++r)u[r]="F"+(r-111)},function(e,t){var n,r,i="";function o(e,t,o,s){e[n](i+t,"wheel"==r?o:function(e){!e&&(e=window.event);var t={originalEvent:e,target:e.target||e.srcElement,type:"wheel",deltaMode:"MozMousePixelScroll"==e.type?0:1,deltaX:0,delatZ:0,preventDefault:function(){e.preventDefault?e.preventDefault():e.returnValue=!1}};return"mousewheel"==r?(t.deltaY=-1/40*e.wheelDelta,e.wheelDeltaX&&(t.deltaX=-1/40*e.wheelDeltaX)):t.deltaY=e.detail,o(t)},s||!1)}window.addEventListener?n="addEventListener":(n="attachEvent",i="on"),r="onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",e.exports=function(e,t,n){o(e,r,t,n),"DOMMouseScroll"==r&&o(e,"MozMousePixelScroll",t,n)}},function(e,t,n){"use strict";var r=n(122),i=n(41),o=n(216),s=n(309);e.exports=function(e,t,n){return new u(e,t,n)};var a={gravity:[0,-10,0],minBounceImpulse:.5,airDrag:.1,fluidDrag:.4,fluidDensity:2};function u(e,t,n){e=Object.assign({},a,e),this.gravity=e.gravity,this.airDrag=e.airDrag,this.fluidDensity=e.fluidDensity,this.fluidDrag=e.fluidDrag,this.minBounceImpulse=e.minBounceImpulse,this.bodies=[],this.testSolid=t,this.testFluid=n}u.prototype.addBody=function(e,t,n,i,o,a){e=e||new r([0,0,0],[1,1,1]),void 0===t&&(t=1),void 0===n&&(n=1),void 0===i&&(i=0),void 0===o&&(o=1);var u=new s(e,t,n,i,o,a);return this.bodies.push(u),u},u.prototype.removeBody=function(e){var t=this.bodies.indexOf(e);t<0||(this.bodies.splice(t,1),e.aabb=e.onCollide=null)};var c=i.create(),l=i.create(),h=i.create(),f=i.create(),d=i.create();u.prototype.tick=function(e){e/=1e3;var t=M(0,i.squaredLength(this.gravity));this.bodies.forEach(n=>function(e,t,n,r){if(i.copy(d,t.resting),t.mass<=0)return i.set(t.velocity,0,0,0),i.set(t._forces,0,0,0),void i.set(t._impulses,0,0,0);var s=r||0===t.gravityMultiplier;if(function(e,t,n,r){if(t._sleepFrameCount>0)return!1;if(r)return!0;var s=!1,a=.5*n*n*t.gravityMultiplier;return i.scale(x,e.gravity,a),o(e.testSolid,t.aabb,x,(function(){return s=!0,!0}),!0),s}(e,t,n,s))return;t._sleepFrameCount--,function(e,t){var n=t.aabb,r=Math.floor(n.base[0]),o=Math.floor(n.base[2]),s=Math.floor(n.base[1]),a=Math.floor(n.max[1]);if(!e.testFluid(r,s,o))return t.inFluid=!1,void(t.ratioInFluid=0);var u=1,c=s+1;for(;c<=a&&e.testFluid(r,c,o);)u++,c++;var l=(s+u-n.base[1])/n.vec[1];l>1&&(l=1);var h=n.vec[0]*n.vec[1]*n.vec[2]*l,f=p;i.scale(f,e.gravity,-e.fluidDensity*h),t.applyForce(f),t.inFluid=!0,t.ratioInFluid=l}(e,t),P(t._forces),P(t._impulses),P(t.velocity),P(t.resting),i.scale(c,t._forces,1/t.mass),i.scaleAndAdd(c,c,e.gravity,t.gravityMultiplier),i.scale(l,t._impulses,1/t.mass),i.scaleAndAdd(l,l,c,n),i.add(t.velocity,t.velocity,l),t.friction&&(m(0,t,l),m(1,t,l),m(2,t,l));var a=t.airDrag>=0?t.airDrag:e.airDrag;t.inFluid&&(a=t.fluidDrag>=0?t.fluidDrag:e.fluidDrag,a*=1-(1-t.ratioInFluid)**2);var u=Math.max(1-a*n/t.mass,0);i.scale(t.velocity,t.velocity,u),i.scale(h,t.velocity,n),i.set(t._forces,0,0,0),i.set(t._impulses,0,0,0),t.autoStep&&C(y,t.aabb);g(e,t.aabb,h,t.resting),t.autoStep&&function(e,t,n,r){if(t.resting[1]>=0&&!t.inFluid)return;var s=0!==t.resting[0],a=0!==t.resting[2];if(!s&&!a)return;var u=Math.abs(r[0]/r[2]);if(!s&&u>4)return;if(!a&&u<1/4)return;i.add(w,n.base,r);var c=e.testSolid;o(c,n,r,(function(e,t,n,r){if(1!==t)return!0;r[t]=0}));var l=t.aabb.base[1],h=Math.floor(l+1.001)-l;i.set(_,0,h,0);var f=!1;if(o(c,n,_,(function(e,t,n,r){return f=!0,!0})),f)return;if(i.subtract(k,w,n.base),k[1]=0,g(e,n,k,b),s&&!M(n.base[0],w[0]))return;if(a&&!M(n.base[2],w[2]))return;C(t.aabb,n),t.resting[0]=b[0],t.resting[2]=b[2],t.onStep&&t.onStep()}(e,t,y,h);for(var v=0;v<3;++v)f[v]=0,t.resting[v]&&(d[v]||(f[v]=-t.velocity[v]),t.velocity[v]=0);var E=i.length(f);E>.001&&(i.scale(f,f,t.mass),t.onCollide&&t.onCollide(f),t.restitution>0&&E>e.minBounceImpulse&&(i.scale(f,f,t.restitution),t.applyImpulse(f)));i.squaredLength(t.velocity)>1e-5&&t._markActive()}(this,n,e,t))};var p=i.create();function m(e,t,n){var r=t.resting[e],o=n[e];if(0!==r&&!(r*o<=0)){i.copy(v,t.velocity),v[e]=0;var s=i.length(v);if(!M(s,0)){var a=Math.abs(t.friction*o),u=s>a?(s-a)/s:0;t.velocity[(e+1)%3]*=u,t.velocity[(e+2)%3]*=u}}}var v=i.create();function g(e,t,n,r){return i.set(r,0,0,0),o(e.testSolid,t,n,(function(e,t,n,i){r[t]=n,i[t]=0}))}var y=new r([],[]),b=i.create(),w=i.create(),_=i.create(),k=i.create();var x=i.create();function M(e,t){return Math.abs(e-t)<1e-5}function C(e,t){for(var n=0;n<3;n++)e.base[n]=t.base[n],e.max[n]=t.max[n],e.vec[n]=t.vec[n]}var P=function(){}},function(e,t,n){"use strict";var r=n(122),i=n(41);function o(e,t,n,o,s,a,u){this.aabb=new r(e.base,e.vec),this.mass=t,this.friction=n,this.restitution=o,this.gravityMultiplier=s,this.onCollide=a,this.autoStep=!!u,this.airDrag=-1,this.fluidDrag=-1,this.onStep=null,this.velocity=i.create(),this.resting=[0,0,0],this.inFluid=!1,this._ratioInFluid=0,this._forces=i.create(),this._impulses=i.create(),this._sleepFrameCount=10}e.exports=o,o.prototype.setPosition=function(e){s(e),i.subtract(e,e,this.aabb.base),this.aabb.translate(e),this._markActive()},o.prototype.getPosition=function(){return i.clone(this.aabb.base)},o.prototype.applyForce=function(e){s(e),i.add(this._forces,this._forces,e),this._markActive()},o.prototype.applyImpulse=function(e){s(e),i.add(this._impulses,this._impulses,e),this._markActive()},o.prototype._markActive=function(){this._sleepFrameCount=10},o.prototype.atRestX=function(){return this.resting[0]},o.prototype.atRestY=function(){return this.resting[1]},o.prototype.atRestZ=function(){return this.resting[2]};var s=function(){}},function(e,t,n){"use strict";e.exports=
/*!
 * ent-comp: a light, *fast* Entity Component System in JS
 * @url      github.com/andyhall/ent-comp
 * @author   Andy Hall <andy@fenomas.com>
 * @license  MIT
*/
function e(){var t=this;this.components={},this.comps=this.components;var n=this.components,i=1,o={},s=[],a=[],u=[],c=[],l=[];function h(e){Object.keys(o).forEach(t=>{o[t].hash[e]&&f(e,t)})}function f(e,t){var i=n[t],s=o[t];s&&s.hash[e]&&(i.onRemove&&(i.multi?s.hash[e].forEach(t=>{i.onRemove(e,t)}):i.onRemove(e,s.hash[e])),i.multi&&(s.hash[e].length=0),r.remove(s,e))}function d(e,t,r){var i=n[t],s=o[t].hash[e];if(s){var a=s.indexOf(r);a<0||(i.onRemove&&i.onRemove(e,r),s.splice(a,1),0===s.length&&f(e,t))}}function p(){m||(m=!0,setTimeout((function(){m=!1,v()}),1))}this._storage=o,this._systems=s,this._renderSystems=a,this.createEntity=function(e){var n=i++;return e&&e.length&&e.forEach(e=>t.addComponent(n,e)),n},this.deleteEntity=function(e,n){return n?h(e):(u.push(e),p()),t},this.createComponent=function(e){if(!e)throw"Missing component definition";var t=e.name;if(!t)throw"Component definition must have a name property.";if("string"!=typeof t)throw"Component name must be a string.";if(""===t)throw"Component name must be a non-empty string.";if(o[t])throw`Component ${t} already exists.`;var i={};return i.name=t,i.order=isNaN(e.order)?99:e.order,i.state=e.state||{},i.onAdd=e.onAdd||null,i.onRemove=e.onRemove||null,i.system=e.system||null,i.renderSystem=e.renderSystem||null,i.multi=!!e.multi,n[t]=i,o[t]=r.create(),i.system&&(s.push(t),s.sort((e,t)=>n[e].order-n[t].order)),i.renderSystem&&(a.push(t),a.sort((e,t)=>n[e].order-n[t].order)),t},this.deleteComponent=function(e){var r=o[e];if(!r)throw"Unknown component: "+e;r.list.forEach(n=>{var r=n.__id||n[0].__id;t.removeComponent(r,e,!0)});var i=s.indexOf(e),u=a.indexOf(e);return i>-1&&s.splice(i,1),u>-1&&a.splice(u,1),delete n[e],delete o[e],t},this.addComponent=function(e,t,i){var s=n[t],a=o[t];if(!a)throw`Unknown component: ${t}.`;var u=!1;if(c.forEach(n=>{n.id===e&&n.compName===t&&(u=!0)}),u&&g(),a.hash[e]&&!s.multi)throw`Entity ${e} already has component: ${t}.`;var l=Object.assign({},{__id:e},s.state,i);if(l.__id=e,s.multi){var h=a.hash[e];h||(h=[],r.add(a,e,h)),h.push(l)}else r.add(a,e,l);return s.onAdd&&s.onAdd(e,l),this},this.hasComponent=function(e,t){var n=o[t];if(!n)throw`Unknown component: ${t}.`;return void 0!==n.hash[e]},this.removeComponent=function(e,r,i){var s=n[r],a=o[r];if(!a)throw`Unknown component: ${r}.`;if(!a.hash[e]){if(s.multi)return t;throw`Entity ${e} does not have component: ${r} to remove.`}return i?f(e,r):(c.push({id:e,compName:r}),p()),t},this.getState=function(e,t){var n=o[t];if(!n)throw`Unknown component: ${t}.`;return n.hash[e]},e.prototype.getStatesList=function(e){var t=o[e];if(!t)throw`Unknown component: ${e}.`;return t.list},this.getStateAccessor=function(e){if(!o[e])throw`Unknown component: ${e}.`;var t=o[e].hash;return function(e){return t[e]}},this.getComponentAccessor=function(e){if(!o[e])throw`Unknown component: ${e}.`;var t=o[e].hash;return function(e){return void 0!==t[e]}},this.tick=function(e){return v(),s.forEach(t=>{var r=o[t].list;n[t].system(e,r)}),v(),t},this.render=function(e){return v(),a.forEach(t=>{var r=o[t].list;n[t].renderSystem(e,r)}),v(),t},this.removeMultiComponent=function(e,r,i,s){var a=n[r],u=o[r];if(!u)throw`Unknown component: ${r}.`;if(!a.multi)throw"removeMultiComponent called on non-multi component";var c=u.hash[e];if(!c||!c[i])throw`Multicomponent ${r} instance not found at index ${i}`;var h=c[i];return s?d(e,r,h):l.push({id:e,compName:r,state:h}),t};var m=!1;function v(){g(),function(e){for(;l.length;){var t=l.pop();d(t.id,t.compName,t.state),t.state=null}}(),function(){for(;u.length;){h(u.pop())}}()}function g(){for(;c.length;){var e=c.pop();f(e.id,e.compName)}}};var r=n(311)},function(e,t,n){"use strict";e.exports={create:function(){return{list:[],hash:{},_map:{}}},add:function(e,t,n){e.list.push(n),e.hash[t]=n,e._map[t]=e.list.length-1},remove:function(e,t){var n=e._map[t];if(n===e.list.length-1)e.list.pop();else{var r=e.list.pop();e.list[n]=r;var i=r.__id||r[0].__id;e._map[i]=n}delete e.hash[t],delete e._map[t]}}},function(e,t,n){var r={"./collideEntities.js":313,"./collideTerrain.js":324,"./fadeOnZoom.js":325,"./followsEntity.js":326,"./mesh.js":327,"./movement.js":328,"./physics.js":128,"./position.js":127,"./receivesInputs.js":329,"./shadow.js":330,"./smoothCamera.js":331};function i(e){var t=o(e);return n(t)}function o(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}i.keys=function(){return Object.keys(r)},i.resolve=o,e.exports=i,i.id=312},function(e,t,n){"use strict";n.r(t);var r=n(314);t.default=function(e){var t=[];return{name:"collideEntities",order:70,state:{cylinder:!1,collideBits:1,collideMask:1,callback:null},onAdd:null,onRemove:null,system:function(i,o){for(var s=e.ents,a=0;a<o.length;a++){var u=o[a].__id,c=s.getPositionData(u);t[a]=c._extents}t.length=o.length,r(t,(function(r,i){var s=o[r],a=o[i];(function(e,t,r,i){if(e.cylinder)return t.cylinder?function(e,t){var n=(e[3]-e[0])/2,r=(t[3]-t[0])/2,i=e[0]+n-(t[0]+r),o=e[2]+n-(t[2]+r),s=n+r;return i*i+o*o<=s*s}(r,i):n(r,i);if(t.cylinder)return n(i,r);return!0})(s,a,t[r],t[i])&&function(e,t,n){var r=t.__id,i=n.__id;t.collideMask&n.collideBits&&t.callback&&t.callback(i);n.collideMask&t.collideBits&&n.callback&&n.callback(r);e.ents.onPairwiseEntityCollision(r,i)}(e,s,a)}))}};function n(e,t){var n=(e[3]-e[0])/2,r=e[0]+n,o=e[2]+n,s=i(r,t[0],t[3])-r,a=i(o,t[2],t[5])-o;return s*s+a*a<=n*n}function i(e,t,n){return e<t?t:e>n?n:e}}},function(e,t,n){"use strict";e.exports=function(e,t,n){switch(arguments.length){case 1:return h(e);case 2:return"function"==typeof t?c(e,e,t,!0):f(e,t);case 3:return c(e,t,n,!1);default:throw new Error("box-intersect: Invalid arguments")}};var r,i=n(123),o=n(217),s=n(321);function a(e,t){for(var n=0;n<e;++n)if(!(t[n]<=t[n+e]))return!0;return!1}function u(e,t,n,r){for(var i=0,o=0,s=0,u=e.length;s<u;++s){var c=e[s];if(!a(t,c)){for(var l=0;l<2*t;++l)n[i++]=c[l];r[o++]=s}}return o}function c(e,t,n,r){var a=e.length,c=t.length;if(!(a<=0||c<=0)){var l=e[0].length>>>1;if(!(l<=0)){var h,f=i.mallocDouble(2*l*a),d=i.mallocInt32(a);if((a=u(e,l,f,d))>0){if(1===l&&r)o.init(a),h=o.sweepComplete(l,n,0,a,f,d,0,a,f,d);else{var p=i.mallocDouble(2*l*c),m=i.mallocInt32(c);(c=u(t,l,p,m))>0&&(o.init(a+c),h=1===l?o.sweepBipartite(l,n,0,a,f,d,0,c,p,m):s(l,n,r,a,f,d,c,p,m),i.free(p),i.free(m))}i.free(f),i.free(d)}return h}}}function l(e,t){r.push([e,t])}function h(e){return r=[],c(e,e,l,!0),r}function f(e,t){return r=[],c(e,t,l,!1),r}},function(e,t,n){"use strict";e.exports=function(e,t){switch(void 0===t&&(t=0),typeof e){case"number":if(e>0)return function(e,t){var n,r;for(n=new Array(e),r=0;r<e;++r)n[r]=t;return n}(0|e,t);break;case"object":if("number"==typeof e.length)return function e(t,n,r){var i=0|t[r];if(i<=0)return[];var o,s=new Array(i);if(r===t.length-1)for(o=0;o<i;++o)s[o]=n;else for(o=0;o<i;++o)s[o]=e(t,n,r+1);return s}(e,t,0)}return[]}},function(e,t,n){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var r=n(317),i=n(318),o=n(319);function s(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(e,t){if(s()<t)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=u.prototype:(null===e&&(e=new u(t)),e.length=t),e}function u(e,t,n){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return h(this,e)}return c(this,e,t,n)}function c(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r);u.TYPED_ARRAY_SUPPORT?(e=t).__proto__=u.prototype:e=f(e,t);return e}(e,t,n,r):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!u.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|p(t,n),i=(e=a(e,r)).write(t,n);i!==r&&(e=e.slice(0,i));return e}(e,t,n):function(e,t){if(u.isBuffer(t)){var n=0|d(t.length);return 0===(e=a(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(r=t.length)!=r?a(e,0):f(e,t);if("Buffer"===t.type&&o(t.data))return f(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function h(e,t){if(l(t),e=a(e,t<0?0:0|d(t)),!u.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function f(e,t){var n=t.length<0?0:0|d(t.length);e=a(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function d(e){if(e>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|e}function p(e,t){if(u.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return U(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return N(e).length;default:if(r)return U(e).length;t=(""+t).toLowerCase(),r=!0}}function m(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return I(this,t,n);case"utf8":case"utf-8":return P(this,t,n);case"ascii":return E(this,t,n);case"latin1":case"binary":return D(this,t,n);case"base64":return C(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function v(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function g(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=u.from(t,r)),u.isBuffer(t))return 0===t.length?-1:y(e,t,n,r,i);if("number"==typeof t)return t&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):y(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function y(e,t,n,r,i){var o,s=1,a=e.length,u=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;s=2,a/=2,u/=2,n/=2}function c(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){var l=-1;for(o=n;o<a;o++)if(c(e,o)===c(t,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===u)return l*s}else-1!==l&&(o-=o-l),l=-1}else for(n+u>a&&(n=a-u),o=n;o>=0;o--){for(var h=!0,f=0;f<u;f++)if(c(e,o+f)!==c(t,f)){h=!1;break}if(h)return o}return-1}function b(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var s=0;s<r;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[n+s]=a}return s}function w(e,t,n,r){return Y(U(t,e.length-n),e,n,r)}function _(e,t,n,r){return Y(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function k(e,t,n,r){return _(e,t,n,r)}function x(e,t,n,r){return Y(N(t),e,n,r)}function M(e,t,n,r){return Y(function(e,t){for(var n,r,i,o=[],s=0;s<e.length&&!((t-=2)<0);++s)n=e.charCodeAt(s),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(t,e.length-n),e,n,r)}function C(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function P(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o,s,a,u,c=e[i],l=null,h=c>239?4:c>223?3:c>191?2:1;if(i+h<=n)switch(h){case 1:c<128&&(l=c);break;case 2:128==(192&(o=e[i+1]))&&(u=(31&c)<<6|63&o)>127&&(l=u);break;case 3:o=e[i+1],s=e[i+2],128==(192&o)&&128==(192&s)&&(u=(15&c)<<12|(63&o)<<6|63&s)>2047&&(u<55296||u>57343)&&(l=u);break;case 4:o=e[i+1],s=e[i+2],a=e[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(u=(15&c)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&u<1114112&&(l=u)}null===l?(l=65533,h=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=h}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=4096));return n}(r)}t.Buffer=u,t.SlowBuffer=function(e){+e!=e&&(e=0);return u.alloc(+e)},t.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=s(),u.poolSize=8192,u._augment=function(e){return e.__proto__=u.prototype,e},u.from=function(e,t,n){return c(null,e,t,n)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(e,t,n){return function(e,t,n,r){return l(t),t<=0?a(e,t):void 0!==n?"string"==typeof r?a(e,t).fill(n,r):a(e,t).fill(n):a(e,t)}(null,e,t,n)},u.allocUnsafe=function(e){return h(null,e)},u.allocUnsafeSlow=function(e){return h(null,e)},u.isBuffer=function(e){return!(null==e||!e._isBuffer)},u.compare=function(e,t){if(!u.isBuffer(e)||!u.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},u.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(e,t){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return u.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=u.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var s=e[n];if(!u.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,i),i+=s.length}return r},u.byteLength=p,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)v(this,t,t+1);return this},u.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)v(this,t,t+3),v(this,t+1,t+2);return this},u.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)v(this,t,t+7),v(this,t+1,t+6),v(this,t+2,t+5),v(this,t+3,t+4);return this},u.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?P(this,0,e):m.apply(this,arguments)},u.prototype.equals=function(e){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===u.compare(this,e)},u.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},u.prototype.compare=function(e,t,n,r,i){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(r>>>=0),s=(n>>>=0)-(t>>>=0),a=Math.min(o,s),c=this.slice(r,i),l=e.slice(t,n),h=0;h<a;++h)if(c[h]!==l[h]){o=c[h],s=l[h];break}return o<s?-1:s<o?1:0},u.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},u.prototype.indexOf=function(e,t,n){return g(this,e,t,n,!0)},u.prototype.lastIndexOf=function(e,t,n){return g(this,e,t,n,!1)},u.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return b(this,e,t,n);case"utf8":case"utf-8":return w(this,e,t,n);case"ascii":return _(this,e,t,n);case"latin1":case"binary":return k(this,e,t,n);case"base64":return x(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function E(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function D(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function I(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=t;o<n;++o)i+=z(e[o]);return i}function A(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function T(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function B(e,t,n,r,i,o){if(!u.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function S(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-n,2);i<o;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function L(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-n,4);i<o;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function O(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function j(e,t,n,r,o){return o||O(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function R(e,t,n,r,o){return o||O(e,0,n,8),i.write(e,t,n,r,52,8),n+8}u.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),u.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=u.prototype;else{var i=t-e;n=new u(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+e]}return n},u.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||T(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},u.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||T(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},u.prototype.readUInt8=function(e,t){return t||T(e,1,this.length),this[e]},u.prototype.readUInt16LE=function(e,t){return t||T(e,2,this.length),this[e]|this[e+1]<<8},u.prototype.readUInt16BE=function(e,t){return t||T(e,2,this.length),this[e]<<8|this[e+1]},u.prototype.readUInt32LE=function(e,t){return t||T(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},u.prototype.readUInt32BE=function(e,t){return t||T(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},u.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||T(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},u.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||T(e,t,this.length);for(var r=t,i=1,o=this[e+--r];r>0&&(i*=256);)o+=this[e+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},u.prototype.readInt8=function(e,t){return t||T(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},u.prototype.readInt16LE=function(e,t){t||T(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(e,t){t||T(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt32LE=function(e,t){return t||T(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},u.prototype.readInt32BE=function(e,t){return t||T(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},u.prototype.readFloatLE=function(e,t){return t||T(e,4,this.length),i.read(this,e,!0,23,4)},u.prototype.readFloatBE=function(e,t){return t||T(e,4,this.length),i.read(this,e,!1,23,4)},u.prototype.readDoubleLE=function(e,t){return t||T(e,8,this.length),i.read(this,e,!0,52,8)},u.prototype.readDoubleBE=function(e,t){return t||T(e,8,this.length),i.read(this,e,!1,52,8)},u.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||B(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},u.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||B(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},u.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,1,255,0),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},u.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):S(this,e,t,!0),t+2},u.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):S(this,e,t,!1),t+2},u.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):L(this,e,t,!0),t+4},u.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):L(this,e,t,!1),t+4},u.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);B(this,e,t,n,i-1,-i)}var o=0,s=1,a=0;for(this[t]=255&e;++o<n&&(s*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+n},u.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);B(this,e,t,n,i-1,-i)}var o=n-1,s=1,a=0;for(this[t+o]=255&e;--o>=0&&(s*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+n},u.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,1,127,-128),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},u.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):S(this,e,t,!0),t+2},u.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):S(this,e,t,!1),t+2},u.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):L(this,e,t,!0),t+4},u.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):L(this,e,t,!1),t+4},u.prototype.writeFloatLE=function(e,t,n){return j(this,e,t,!0,n)},u.prototype.writeFloatBE=function(e,t,n){return j(this,e,t,!1,n)},u.prototype.writeDoubleLE=function(e,t,n){return R(this,e,t,!0,n)},u.prototype.writeDoubleBE=function(e,t,n){return R(this,e,t,!1,n)},u.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,o=r-n;if(this===e&&n<t&&t<r)for(i=o-1;i>=0;--i)e[i+t]=this[i+n];else if(o<1e3||!u.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+o),t);return o},u.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var o;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(o=t;o<n;++o)this[o]=e;else{var s=u.isBuffer(e)?e:U(new u(e,r).toString()),a=s.length;for(o=0;o<n-t;++o)this[o+t]=s[o%a]}return this};var F=/[^+\/0-9A-Za-z-_]/g;function z(e){return e<16?"0"+e.toString(16):e.toString(16)}function U(e,t){var n;t=t||1/0;for(var r=e.length,i=null,o=[],s=0;s<r;++s){if((n=e.charCodeAt(s))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function N(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(F,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function Y(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}}).call(this,n(161))},function(e,t,n){"use strict";t.byteLength=function(e){var t=c(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,r=c(e),s=r[0],a=r[1],u=new o(function(e,t,n){return 3*(t+n)/4-n}(0,s,a)),l=0,h=a>0?s-4:s;for(n=0;n<h;n+=4)t=i[e.charCodeAt(n)]<<18|i[e.charCodeAt(n+1)]<<12|i[e.charCodeAt(n+2)]<<6|i[e.charCodeAt(n+3)],u[l++]=t>>16&255,u[l++]=t>>8&255,u[l++]=255&t;2===a&&(t=i[e.charCodeAt(n)]<<2|i[e.charCodeAt(n+1)]>>4,u[l++]=255&t);1===a&&(t=i[e.charCodeAt(n)]<<10|i[e.charCodeAt(n+1)]<<4|i[e.charCodeAt(n+2)]>>2,u[l++]=t>>8&255,u[l++]=255&t);return u},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,o=[],s=0,a=n-i;s<a;s+=16383)o.push(l(e,s,s+16383>a?a:s+16383));1===i?(t=e[n-1],o.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],o.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return o.join("")};for(var r=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,u=s.length;a<u;++a)r[a]=s[a],i[s.charCodeAt(a)]=a;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function l(e,t,n){for(var i,o,s=[],a=t;a<n;a+=3)i=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),s.push(r[(o=i)>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return s.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(e,t){
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
t.read=function(e,t,n,r,i){var o,s,a=8*i-r-1,u=(1<<a)-1,c=u>>1,l=-7,h=n?i-1:0,f=n?-1:1,d=e[t+h];for(h+=f,o=d&(1<<-l)-1,d>>=-l,l+=a;l>0;o=256*o+e[t+h],h+=f,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=r;l>0;s=256*s+e[t+h],h+=f,l-=8);if(0===o)o=1-c;else{if(o===u)return s?NaN:1/0*(d?-1:1);s+=Math.pow(2,r),o-=c}return(d?-1:1)*s*Math.pow(2,o-r)},t.write=function(e,t,n,r,i,o){var s,a,u,c=8*o-i-1,l=(1<<c)-1,h=l>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:o-1,p=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=l):(s=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-s))<1&&(s--,u*=2),(t+=s+h>=1?f/u:f*Math.pow(2,1-h))*u>=2&&(s++,u/=2),s+h>=l?(a=0,s=l):s+h>=1?(a=(t*u-1)*Math.pow(2,i),s+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;e[n+d]=255&a,d+=p,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;e[n+d]=255&s,d+=p,s/=256,c-=8);e[n+d-p]|=128*m}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){"use strict";e.exports=function(e,t){t<=128?r(0,t-1,e):function e(t,n,l){var h=(n-t+1)/6|0,f=t+h,d=n-h,p=t+n>>1,m=p-h,v=p+h,g=f,y=m,b=p,w=v,_=d,k=t+1,x=n-1,M=0;u(g,y,l)&&(M=g,g=y,y=M);u(w,_,l)&&(M=w,w=_,_=M);u(g,b,l)&&(M=g,g=b,b=M);u(y,b,l)&&(M=y,y=b,b=M);u(g,w,l)&&(M=g,g=w,w=M);u(b,w,l)&&(M=b,b=w,w=M);u(y,_,l)&&(M=y,y=_,_=M);u(y,b,l)&&(M=y,y=b,b=M);u(w,_,l)&&(M=w,w=_,_=M);for(var C=l[2*y],P=l[2*y+1],E=l[2*w],D=l[2*w+1],I=2*g,A=2*b,T=2*_,B=2*f,S=2*p,L=2*d,O=0;O<2;++O){var j=l[I+O],R=l[A+O],F=l[T+O];l[B+O]=j,l[S+O]=R,l[L+O]=F}o(m,t,l),o(v,n,l);for(var z=k;z<=x;++z)if(c(z,C,P,l))z!==k&&i(z,k,l),++k;else if(!c(z,E,D,l))for(;;){if(c(x,E,D,l)){c(x,C,P,l)?(s(z,k,x,l),++k,--x):(i(z,x,l),--x);break}if(--x<z)break}a(t,k-1,C,P,l),a(n,x+1,E,D,l),k-2-t<=32?r(t,k-2,l):e(t,k-2,l);n-(x+2)<=32?r(x+2,n,l):e(x+2,n,l);x-k<=32?r(k,x,l):e(k,x,l)}(0,t-1,e)};function r(e,t,n){for(var r=2*(e+1),i=e+1;i<=t;++i){for(var o=n[r++],s=n[r++],a=i,u=r-2;a-- >e;){var c=n[u-2],l=n[u-1];if(c<o)break;if(c===o&&l<s)break;n[u]=c,n[u+1]=l,u-=2}n[u]=o,n[u+1]=s}}function i(e,t,n){t*=2;var r=n[e*=2],i=n[e+1];n[e]=n[t],n[e+1]=n[t+1],n[t]=r,n[t+1]=i}function o(e,t,n){t*=2,n[e*=2]=n[t],n[e+1]=n[t+1]}function s(e,t,n,r){t*=2,n*=2;var i=r[e*=2],o=r[e+1];r[e]=r[t],r[e+1]=r[t+1],r[t]=r[n],r[t+1]=r[n+1],r[n]=i,r[n+1]=o}function a(e,t,n,r,i){t*=2,i[e*=2]=i[t],i[t]=n,i[e+1]=i[t+1],i[t+1]=r}function u(e,t,n){t*=2;var r=n[e*=2],i=n[t];return!(r<i)&&(r!==i||n[e+1]>n[t+1])}function c(e,t,n,r){var i=r[e*=2];return i<t||i===t&&r[e+1]<n}},function(e,t,n){"use strict";e.exports=function(e,t,n,o,l,k,x,M,C){!function(e,t){var n=8*i.log2(t+1)*(e+1)|0,o=i.nextPow2(6*n);g.length<o&&(r.free(g),g=r.mallocInt32(o));var s=i.nextPow2(2*n);y.length<s&&(r.free(y),y=r.mallocDouble(s))}(e,o+x);var P,E=0,D=2*e;b(E++,0,0,o,0,x,n?16:0,-1/0,1/0),n||b(E++,0,0,x,0,o,1,-1/0,1/0);for(;E>0;){var I=6*(E-=1),A=g[I],T=g[I+1],B=g[I+2],S=g[I+3],L=g[I+4],O=g[I+5],j=2*E,R=y[j],F=y[j+1],z=1&O,U=!!(16&O),N=l,Y=k,q=M,X=C;if(z&&(N=M,Y=C,q=l,X=k),!(2&O&&(B=d(e,A,T,B,N,Y,F),T>=B)||4&O&&(T=p(e,A,T,B,N,Y,R))>=B)){var G=B-T,V=L-S;if(U){if(e*G*(G+V)<1<<22){if(void 0!==(P=u.scanComplete(e,A,t,T,B,N,Y,S,L,q,X)))return P;continue}}else{if(e*Math.min(G,V)<128){if(void 0!==(P=s(e,A,t,z,T,B,N,Y,S,L,q,X)))return P;continue}if(e*G*V<1<<22){if(void 0!==(P=u.scanBipartite(e,A,t,z,T,B,N,Y,S,L,q,X)))return P;continue}}var H=h(e,A,T,B,N,Y,R,F);if(T<H)if(e*(H-T)<128){if(void 0!==(P=a(e,A+1,t,T,H,N,Y,S,L,q,X)))return P}else if(A===e-2){if(void 0!==(P=z?u.sweepBipartite(e,t,S,L,q,X,T,H,N,Y):u.sweepBipartite(e,t,T,H,N,Y,S,L,q,X)))return P}else b(E++,A+1,T,H,S,L,z,-1/0,1/0),b(E++,A+1,S,L,T,H,1^z,-1/0,1/0);if(H<B){var Z=c(e,A,S,L,q,X),$=q[D*Z+A],K=f(e,A,Z,L,q,X,$);if(K<L&&b(E++,A,H,B,K,L,(4|z)+(U?16:0),$,F),S<Z&&b(E++,A,H,B,S,Z,(2|z)+(U?16:0),R,$),Z+1===K){if(void 0!==(P=U?_(e,A,t,H,B,N,Y,Z,q,X[Z]):w(e,A,t,z,H,B,N,Y,Z,q,X[Z])))return P}else if(Z<K){var W;if(U){if(W=m(e,A,H,B,N,Y,$),H<W){var J=f(e,A,H,W,N,Y,$);if(A===e-2){if(H<J&&void 0!==(P=u.sweepComplete(e,t,H,J,N,Y,Z,K,q,X)))return P;if(J<W&&void 0!==(P=u.sweepBipartite(e,t,J,W,N,Y,Z,K,q,X)))return P}else H<J&&b(E++,A+1,H,J,Z,K,16,-1/0,1/0),J<W&&(b(E++,A+1,J,W,Z,K,0,-1/0,1/0),b(E++,A+1,Z,K,J,W,1,-1/0,1/0))}}else W=z?v(e,A,H,B,N,Y,$):m(e,A,H,B,N,Y,$),H<W&&(A===e-2?P=z?u.sweepBipartite(e,t,Z,K,q,X,H,W,N,Y):u.sweepBipartite(e,t,H,W,N,Y,Z,K,q,X):(b(E++,A+1,H,W,Z,K,z,-1/0,1/0),b(E++,A+1,Z,K,H,W,1^z,-1/0,1/0)))}}}}};var r=n(123),i=n(124),o=n(322),s=o.partial,a=o.full,u=n(217),c=n(323),l=n(218),h=l("!(lo>=p0)&&!(p1>=hi)",["p0","p1"]),f=l("lo===p0",["p0"]),d=l("lo<p0",["p0"]),p=l("hi<=p0",["p0"]),m=l("lo<=p0&&p0<=hi",["p0"]),v=l("lo<p0&&p0<=hi",["p0"]),g=r.mallocInt32(1024),y=r.mallocDouble(1024);function b(e,t,n,r,i,o,s,a,u){var c=6*e;g[c]=t,g[c+1]=n,g[c+2]=r,g[c+3]=i,g[c+4]=o,g[c+5]=s;var l=2*e;y[l]=a,y[l+1]=u}function w(e,t,n,r,i,o,s,a,u,c,l){var h=2*e,f=u*h,d=c[f+t];e:for(var p=i,m=i*h;p<o;++p,m+=h){var v=s[m+t],g=s[m+t+e];if(!(d<v||g<d)&&(!r||d!==v)){for(var y,b=a[p],w=t+1;w<e;++w){v=s[m+w],g=s[m+w+e];var _=c[f+w],k=c[f+w+e];if(g<_||k<v)continue e}if(void 0!==(y=r?n(l,b):n(b,l)))return y}}}function _(e,t,n,r,i,o,s,a,u,c){var l=2*e,h=a*l,f=u[h+t];e:for(var d=r,p=r*l;d<i;++d,p+=l){var m=s[d];if(m!==c){var v=o[p+t],g=o[p+t+e];if(!(f<v||g<f)){for(var y=t+1;y<e;++y){v=o[p+y],g=o[p+y+e];var b=u[h+y],w=u[h+y+e];if(g<b||w<v)continue e}var _=n(m,c);if(void 0!==_)return _}}}}},function(e,t,n){"use strict";var r=["d","ax","vv","rs","re","rb","ri","bs","be","bb","bi"];function i(e){var t="bruteForce"+(e?"Full":"Partial"),n=[],i=r.slice();e||i.splice(3,0,"fp");var o=["function "+t+"("+i.join()+"){"];function s(t,i){var s=function(e,t,n){var i="bruteForce"+(e?"Red":"Blue")+(t?"Flip":"")+(n?"Full":""),o=["function ",i,"(",r.join(),"){","var ","es","=2*","d",";"],s="for(var i=rs,rp=es*rs;i<re;++i,rp+=es){var x0=rb[ax+rp],x1=rb[ax+rp+d],xi=ri[i];",a="for(var j=bs,bp=es*bs;j<be;++j,bp+=es){var y0=bb[ax+bp],"+(n?"y1=bb[ax+bp+d],":"")+"yi=bi[j];";return e?o.push(s,"Q",":",a):o.push(a,"Q",":",s),n?o.push("if(y1<x0||x1<y0)continue;"):t?o.push("if(y0<=x0||x1<y0)continue;"):o.push("if(y0<x0||x1<y0)continue;"),o.push("for(var k=ax+1;k<d;++k){var r0=rb[k+rp],r1=rb[k+d+rp],b0=bb[k+bp],b1=bb[k+d+bp];if(r1<b0||b1<r0)continue Q;}var rv=vv("),t?o.push("yi,xi"):o.push("xi,yi"),o.push(");if(rv!==void 0)return rv;}}}"),{name:i,code:o.join("")}}(t,i,e);n.push(s.code),o.push("return "+s.name+"("+r.join()+");")}o.push("if(re-rs>be-bs){"),e?(s(!0,!1),o.push("}else{"),s(!1,!1)):(o.push("if(fp){"),s(!0,!0),o.push("}else{"),s(!0,!1),o.push("}}else{if(fp){"),s(!1,!0),o.push("}else{"),s(!1,!1),o.push("}")),o.push("}}return "+t);var a=n.join("")+o.join("");return new Function(a)()}t.partial=i(!1),t.full=i(!0)},function(e,t,n){"use strict";e.exports=function(e,t,n,o,s,a){if(o<=n+1)return n;var u=n,c=o,l=o+n>>>1,h=2*e,f=l,d=s[h*l+t];for(;u<c;){if(c-u<8){i(e,t,u,c,s,a),d=s[h*l+t];break}var p=c-u,m=Math.random()*p+u|0,v=s[h*m+t],g=Math.random()*p+u|0,y=s[h*g+t],b=Math.random()*p+u|0,w=s[h*b+t];v<=y?w>=y?(f=g,d=y):v>=w?(f=m,d=v):(f=b,d=w):y>=w?(f=g,d=y):w>=v?(f=m,d=v):(f=b,d=w);for(var _=h*(c-1),k=h*f,x=0;x<h;++x,++_,++k){var M=s[_];s[_]=s[k],s[k]=M}var C=a[c-1];a[c-1]=a[f],a[f]=C,f=r(e,t,u,c-1,s,a,d);for(_=h*(c-1),k=h*f,x=0;x<h;++x,++_,++k){M=s[_];s[_]=s[k],s[k]=M}C=a[c-1];if(a[c-1]=a[f],a[f]=C,l<f){for(c=f-1;u<c&&s[h*(c-1)+t]===d;)c-=1;c+=1}else{if(!(f<l))break;for(u=f+1;u<c&&s[h*u+t]===d;)u+=1}}return r(e,t,n,l,s,a,s[h*l+t])};var r=n(218)("lo<p0",["p0"]);function i(e,t,n,r,i,o){for(var s=2*e,a=s*(n+1)+t,u=n+1;u<r;++u,a+=s)for(var c=i[a],l=u,h=s*(u-1);l>n&&i[h+t]>c;--l,h-=s){for(var f=h,d=h+s,p=0;p<s;++p,++f,++d){var m=i[f];i[f]=i[d],i[d]=m}var v=o[l];o[l]=o[l-1],o[l-1]=v}}},function(e,t,n){"use strict";n.r(t),t.default=function(e){return{name:"collideTerrain",order:0,state:{callback:null},onAdd:function(t,n){var r=e.entities;r.hasPhysics(t)&&(r.getPhysicsBody(t).onCollide=function(n){var r=e.ents.getCollideTerrain(t).callback;r&&r(n,t)})},onRemove:function(t,n){var r=e.entities;r.hasPhysics(t)&&(r.getPhysicsBody(t).onCollide=null)}}}},function(e,t,n){"use strict";n.r(t),t.default=function(e){return{name:"fadeOnZoom",order:99,state:{cutoff:1.5,_showing:!0},onAdd:null,onRemove:null,system:function(t,n){var r=e.camera.currentZoom,i=e.entities;n.forEach(e=>{!function(e,t,n,r){if(!r.hasMesh(t))return;if(e._showing&&n<e.cutoff||!e._showing&&n>e.cutoff){r.getMeshData(t).mesh.visibility=e._showing=n>e.cutoff}}(e,e.__id,r,i)})}}}},function(e,t,n){"use strict";n.r(t);var r=n(41);t.default=function(e){return{name:"followsEntity",order:50,state:{entity:0,offset:null,onTargetMissing:null},onAdd:function(e,i){var o=r.create();i.offset=i.offset?r.copy(o,i.offset):o,t(i),n(i)},onRemove:null,system:function(e,n){n.forEach(e=>t(e))},renderSystem:function(e,t){t.forEach(e=>n(e))}};function t(t){var n=t.__id,i=e.ents.getPositionData(n),o=e.ents.getPositionData(t.entity);o?r.add(i._localPosition,o._localPosition,t.offset):(t.onTargetMissing&&t.onTargetMissing(n),e.ents.removeComponent(n,e.ents.names.followsEntity))}function n(t){var n=t.__id,i=e.ents.getPositionData(n),o=e.ents.getPositionData(t.entity);o&&r.add(i._renderPosition,o._renderPosition,t.offset)}}},function(e,t,n){"use strict";n.r(t);var r=n(41);t.default=function(e){return{name:"mesh",order:100,state:{mesh:null,offset:null},onAdd:function(t,n){var i=e.ents.getPositionData(t);if(!n.mesh)throw new Error("Mesh component added without a mesh - probably a bug!");e.rendering.addMeshToScene(n.mesh,!1,i.position),n.offset||(n.offset=new r.create);var o=i._renderPosition;n.mesh.position.copyFromFloats(o[0]+n.offset[0],o[1]+n.offset[1],o[2]+n.offset[2])},onRemove:function(e,t){t.mesh.dispose()},renderSystem:function(t,n){n.forEach(t=>{var n=t.__id,r=e.ents.getPositionData(n)._renderPosition;t.mesh.position.copyFromFloats(r[0]+t.offset[0],r[1]+t.offset[1],r[2]+t.offset[2])})}}}},function(e,t,n){"use strict";n.r(t);var r=n(41);t.default=function(e){return{name:"movement",order:30,state:{heading:0,running:!1,jumping:!1,maxSpeed:10,moveForce:30,responsiveness:15,runningFriction:0,standingFriction:2,airMoveMult:.5,jumpImpulse:10,jumpForce:12,jumpTime:500,airJumps:1,_jumpCount:0,_isJumping:0,_currjumptime:0},onAdd:null,onRemove:null,system:function(t,n){var a=e.entities;n.forEach(e=>{var n=a.getPhysicsBody(e.__id);!function(e,t,n){var a=n.atRestY()<0,u=a||t._jumpCount<t.airJumps;a&&(t._isJumping=!1,t._jumpCount=0);if(t.jumping)if(t._isJumping){if(t._currjumptime>0){var c=t.jumpForce;t._currjumptime<e&&(c*=t._currjumptime/e),n.applyForce([0,c,0]),t._currjumptime-=e}}else u&&(t._isJumping=!0,a||t._jumpCount++,t._currjumptime=t.jumpTime,n.applyImpulse([0,t.jumpImpulse,0]),!a&&n.velocity[1]<0&&(n.velocity[1]=0));else t._isJumping=!1;var l=i,h=o;if(t.running){var f=t.maxSpeed;r.set(l,0,0,f),r.rotateY(l,l,s,t.heading),r.subtract(h,l,n.velocity),h[1]=0;var d=r.length(h);if(r.normalize(h,h),d>0){var p=t.moveForce;a||(p*=t.airMoveMult);var m=t.responsiveness*d;p>m&&(p=m),r.scale(h,h,p),n.applyForce(h)}n.friction=t.runningFriction}else n.friction=t.standingFriction}(t,e,n)})}}};var i=r.create(),o=r.create(),s=r.create()},function(e,t,n){"use strict";n.r(t),t.default=function(e){return{name:"receivesInputs",order:20,state:{},onAdd:null,onRemove:null,system:function(t,n){var r=e.entities,i=e.inputs.state,o=e.camera.heading;n.forEach(e=>{!function(e,t,n){e.jumping=!!t.jump;var r=t.forward?t.backward?0:1:t.backward?-1:0,i=t.right?t.left?0:1:t.left?-1:0;0==(r|i)?e.running=!1:(e.running=!0,r?(-1==r&&(n+=Math.PI),i&&(n+=Math.PI/4*r*i)):n+=i*Math.PI/2,e.heading=n)}(r.getMovement(e.__id),i,o)})}}}},function(e,t,n){"use strict";n.r(t);var r=n(4),i=n(21),o=n(41);t.default=function(e,t){var n=t,u=e.rendering.getScene(),c=r.a.CreateDisc("shadow",.75,30,u);return c.rotation.x=Math.PI/2,c.material=e.rendering.makeStandardMaterial("shadowMat"),c.material.diffuseColor=i.e.Black(),c.material.ambientColor=i.e.Black(),c.material.alpha=.5,c.setEnabled(!1),u.removeMesh(c),{name:"shadow",order:80,state:{size:.5,_mesh:null},onAdd:function(t,n){var r=c.createInstance("shadow_instance");e.rendering.addMeshToScene(r),r.setEnabled(!1),n._mesh=r},onRemove:function(e,t){t._mesh.dispose()},system:function(t,r){var i=e.camera._localGetPosition(),u=n;r.forEach(t=>{var n=e.ents.getPositionData(t.__id),r=e.ents.getPhysics(t.__id);!function(e,t,n,r,i,u,c){var l;if(n&&n.body.resting[1]<0)l=t._localPosition[1];else{var h=e._localPick(t._localPosition,a,u);if(!h)return void r.setEnabled(!1);l=h.position[1]-e.worldOriginOffset[1]}l=Math.round(l),o.copy(s,t._localPosition),s[1]=l;var f=.01+o.squaredDistance(c,s)/1600*.1;f>.1&&(f=.1);r.position.y=l+f;var d=t._localPosition[1]-l,p=.7*i*(1-d/u);r.scaling.copyFromFloats(p,p,p),r.setEnabled(!0)}(e,n,r,t._mesh,t.size,u,i)})},renderSystem:function(t,n){n.forEach(t=>{var n=e.ents.getPositionData(t.__id)._renderPosition,r=t._mesh.position;r.x=n[0],r.z=n[2]})}}};var s=o.fromValues(0,0,0),a=o.fromValues(0,-1,0)},function(e,t,n){"use strict";n.r(t),t.default=function(e){return{name:"smooth-camera",order:99,state:{time:100.1},onAdd:null,onRemove:null,system:function(t,n){n.forEach(n=>{n.time-=t,n.time<0&&e.ents.removeComponent(n.__id,"smooth-camera")})}}}},function(e){e.exports=JSON.parse('{"_from":"github:andyhall/noa#develop","_id":"noa-engine@0.29.0","_inBundle":false,"_integrity":"","_location":"/noa-engine","_phantomChildren":{},"_requested":{"type":"git","raw":"noa-engine@github:andyhall/noa#develop","name":"noa-engine","escapedName":"noa-engine","rawSpec":"github:andyhall/noa#develop","saveSpec":"github:andyhall/noa#develop","fetchSpec":null,"gitCommittish":"develop"},"_requiredBy":["/"],"_resolved":"github:andyhall/noa#e71d86c4a0568395a2b28b7aa27dba54f57835aa","_spec":"noa-engine@github:andyhall/noa#develop","_where":"/Users/andy/dev/game/noa-examples","author":{"name":"Andy Hall"},"bugs":{"url":"https://github.com/andyhall/noa/issues"},"bundleDependencies":false,"dependencies":{"aabb-3d":"github:andyhall/aabb-3d","box-intersect":"^1.0.2","ent-comp":"^0.9.1","fast-voxel-raycast":"^0.1.1","game-inputs":"^0.4.0","game-shell":"github:andyhall/game-shell","gl-vec3":"^1.1.3","ndarray":"^1.0.16","voxel-aabb-sweep":"^0.5.0","voxel-physics-engine":"^0.10.0"},"deprecated":false,"description":"Experimental voxel game engine","devDependencies":{"eslint":"^6.8.0","js-beautify":"^1.10.2","jsdoc-to-markdown":"^5.0.3","typescript":"^3.9.3"},"files":["/src","/types"],"homepage":"https://github.com/andyhall/noa#readme","keywords":["voxel","game","engine"],"license":"MIT","main":"src/index.js","name":"noa-engine","peerDependencies":{"@babylonjs/core":"^4.0.0"},"repository":{"type":"git","url":"git+https://github.com/andyhall/noa.git"},"scripts":{"doc":"jsdoc2md -f src/* src/**/* -g table -p list --partial doc-templates/* > doc/API.md"},"typings":"types/index.d.ts","version":"0.29.0"}')},function(e,t,n){var r=n(334);function i(e){for(var t,n,i=0,o=e.length,s=0;s<e.length;){for(t=e[s],n=0;s<o&&e[s]===t;)++s,++n;i+=r.log2(n)/7|0,i+=r.log2(t>>>0)/7|0,i+=2}return i}t.size=i,t.encode=function(e,t){t||(t=new Uint8Array(i(e)));for(var n,r,o=0,s=t.length,a=0;a<e.length;){for(n=e[a],r=0;a<e.length&&e[a]===n;)++a,++r;for(;o<s&&r>=128;)t[o++]=128+(127&r),r>>>=7;if(o>=s)throw new Error("RLE buffer overflow");for(t[o++]=r,n>>>=0;o<s&&n>=128;)t[o++]=128+(127&n),n>>>=7;if(o>=s)throw new Error("RLE buffer overflow");t[o++]=n}return t},t.decode=function(e,t){for(var n,r,i,o,s=t.length,a=e.length,u=0,c=0;c<a;){for(n=0,r=0;c<a&&e[c]>=128;)n+=(127&e[c++])<<r,r+=7;if(n+=e[c++]<<r,c>=a)throw new Error("RLE buffer underrun");if(u+n>s)throw new Error("Chunk buffer overflow");for(i=0,r=0;c<a&&e[c]>=128;)i+=(127&e[c++])<<r,r+=7;if(c>=a)throw new Error("RLE buffer underrun");for(i+=e[c++]<<r,o=0;o<n;++o)t[u++]=i}return t}},function(e,t,n){"use strict";function r(e){var t=32;return(e&=-e)&&t--,65535&e&&(t-=16),16711935&e&&(t-=8),252645135&e&&(t-=4),858993459&e&&(t-=2),1431655765&e&&(t-=1),t}t.INT_BITS=32,t.INT_MAX=2147483647,t.INT_MIN=-1<<31,t.sign=function(e){return(e>0)-(e<0)},t.abs=function(e){var t=e>>31;return(e^t)-t},t.min=function(e,t){return t^(e^t)&-(e<t)},t.max=function(e,t){return e^(e^t)&-(e<t)},t.isPow2=function(e){return!(e&e-1||!e)},t.log2=function(e){var t,n;return t=(e>65535)<<4,t|=n=((e>>>=t)>255)<<3,t|=n=((e>>>=n)>15)<<2,(t|=n=((e>>>=n)>3)<<1)|(e>>>=n)>>1},t.log10=function(e){return e>=1e9?9:e>=1e8?8:e>=1e7?7:e>=1e6?6:e>=1e5?5:e>=1e4?4:e>=1e3?3:e>=100?2:e>=10?1:0},t.popCount=function(e){return 16843009*((e=(858993459&(e-=e>>>1&1431655765))+(e>>>2&858993459))+(e>>>4)&252645135)>>>24},t.countTrailingZeros=r,t.nextPow2=function(e){return e+=0===e,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,(e|=e>>>16)+1},t.prevPow2=function(e){return e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,(e|=e>>>16)-(e>>>1)},t.parity=function(e){return e^=e>>>16,e^=e>>>8,e^=e>>>4,27030>>>(e&=15)&1};var i=new Array(256);!function(e){for(var t=0;t<256;++t){var n=t,r=t,i=7;for(n>>>=1;n;n>>>=1)r<<=1,r|=1&n,--i;e[t]=r<<i&255}}(i),t.reverse=function(e){return i[255&e]<<24|i[e>>>8&255]<<16|i[e>>>16&255]<<8|i[e>>>24&255]},t.interleave2=function(e,t){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e&=65535)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t&=65535)|t<<8))|t<<4))|t<<2))|t<<1))<<1},t.deinterleave2=function(e,t){return(e=65535&((e=16711935&((e=252645135&((e=858993459&((e=e>>>t&1431655765)|e>>>1))|e>>>2))|e>>>4))|e>>>16))<<16>>16},t.interleave3=function(e,t,n){return e=1227133513&((e=3272356035&((e=251719695&((e=4278190335&((e&=1023)|e<<16))|e<<8))|e<<4))|e<<2),(e|=(t=1227133513&((t=3272356035&((t=251719695&((t=4278190335&((t&=1023)|t<<16))|t<<8))|t<<4))|t<<2))<<1)|(n=1227133513&((n=3272356035&((n=251719695&((n=4278190335&((n&=1023)|n<<16))|n<<8))|n<<4))|n<<2))<<2},t.deinterleave3=function(e,t){return(e=1023&((e=4278190335&((e=251719695&((e=3272356035&((e=e>>>t&1227133513)|e>>>2))|e>>>4))|e>>>8))|e>>>16))<<22>>22},t.nextCombination=function(e){var t=e|e-1;return t+1|(~t&-~t)-1>>>r(e)+1}},function(e,t,n){"use strict";n.r(t);var r=n(292),i=n(81).EventEmitter;function o(e,t){t=t||{},this._noa=e,this._tickRate=t.tickRate,this.element=t.domElement||function(){var e=document.createElement("div");return e.tabindex=1,e.style.position="fixed",e.style.left="0px",e.style.right="0px",e.style.top="0px",e.style.bottom="0px",e.style.height="100%",e.style.overflow="hidden",document.body.appendChild(e),document.body.style.overflow="hidden",document.body.style.height="100%",e.id="noa-container",e}(),this.canvas=function(e){var t=e.querySelector("canvas");t||((t=document.createElement("canvas")).style.position="absolute",t.style.left="0px",t.style.top="0px",t.style.height="100%",t.style.width="100%",t.id="noa-canvas",e.insertBefore(t,e.firstChild));return t}(this.element),this._shell=function(e,t){(t=Object.assign({pointerLock:!0,preventDefaults:!1},t)).element=e;var n=r(t);return n.preventDefaults=t.preventDefaults,n}(this.canvas,t),this.hasPointerLock=!1,this.supportsPointerLock=!1,this.pointerInGame=!1,this.isFocused=document.hasFocus();var n=this,i=function(e){!function(e,t){var n=document.pointerLockElement||document.mozPointerLockElement||document.webkitPointerLockElement;n?(e.hasPointerLock=!0,e.emit("gainedPointerLock")):(e.hasPointerLock=!1,e.emit("lostPointerLock"));n&&(e.pointerInGame=!0)}(n)};document.addEventListener("pointerlockchange",i,!1),document.addEventListener("mozpointerlockchange",i,!1),document.addEventListener("webkitpointerlockchange",i,!1),function(e){if("pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document){e.supportsPointerLock=!0;var t=function(n){e.supportsPointerLock=!1,document.removeEventListener(n.type,t)};document.addEventListener("touchmove",t)}}(n),n.element.addEventListener("mouseenter",(function(){n.pointerInGame=!0})),n.element.addEventListener("mouseleave",(function(){n.pointerInGame=!1})),window.addEventListener("focus",(function(){n.isFocused=!0})),window.addEventListener("blur",(function(){n.isFocused=!1})),this._shell.on("init",s.bind(null,this))}function s(e){var t=e._noa;e._shell.on("resize",t.rendering.resize.bind(t.rendering)),function(e){var t=e._noa,n=e._tickRate,r=performance.now(),i=0,o=function(){var e=performance.now();i+=e-r;for(var s=2;i>n&&s-- >0;)t.tick(n),i-=n;i>n&&(i=0);var a=performance.now(),u=i+(a-e),c=Math.min(1,u/n);t.render(c),r=e,requestAnimationFrame(o)};requestAnimationFrame(o)}(e),e.emit("DOMready")}function a(e,t){var n=e.indexOf(t);n<0||(n===e.length-1?e.pop():e[n]=e.pop())}function u(e,t,n){for(var r=(n||performance.now())+e,i=0;i<1e3;i++){if(t()||performance.now()>r)return}}o.prototype=Object.create(i.prototype),o.prototype.appendTo=function(e){this.element.appendChild(e)},o.prototype.setPointerLock=function(e){this._shell.pointerLock=!!e};var c=0,l=0;function h(e,t,n,r,i){e?function(e,t,n,r,i,o,s,a,u,c,l){for(var h=0;h<o;h++)for(var f=0;f<s;f++)for(var d=e.index(n+h,r+f,i),p=t.index(u+h,c+f,l),m=0;m<a;m++)t.data[p]=e.data[d],d+=e.stride[2],p+=t.stride[2]}(e,t,n[0],n[1],n[2],r[0],r[1],r[2],i[0],i[1],i[2]):function(e,t,n,r,i,o,s){for(var a=0;a<i;a++)for(var u=0;u<o;u++)for(var c=e.index(t+a,n+u,r),l=0;l<s;l++)e.data[c]=0,c+=e.stride[2]}(t,i[0],i[1],i[2],r[0],r[1],r[2])}function f(){this.arr=[],this.hash={}}f.prototype.includes=function(e){return this.hash[e]},f.prototype.add=function(e){this.hash[e]||(this.arr.push(e),this.hash[e]=!0)},f.prototype.remove=function(e){this.hash[e]&&(this.arr.splice(this.arr.indexOf(e),1),delete this.hash[e])},f.prototype.count=function(){return this.arr.length},f.prototype.forEach=function(e,t){return this.arr.forEach(e,t)},f.prototype.slice=function(e,t){return this.arr.slice(e,t)},f.prototype.isEmpty=function(){return 0===this.arr.length},f.prototype.empty=function(){this.arr.length=0,this.hash={}},f.prototype.pop=function(){var e=this.arr.pop();return delete this.hash[e],e},f.prototype.sort=function(e){var t={};this.arr.forEach(n=>{t[n]=e(n)}),this.arr.sort((e,n)=>t[n]-t[e])},f.prototype.copyFrom=function(e){this.arr=e.arr.slice(),this.hash=Object.assign({},e.hash)};var d=n(26),p=n(142),m=n(57),v=n(76),g=n(17),y=n(145),b=n(92),w=n(21),_=n(4),k=n(200),x=(n(158),n(41)),M={showFPS:!1,antiAlias:!0,clearColor:[.8,.9,1],ambientColor:[1,1,1],lightDiffuse:[1,1,1],lightSpecular:[1,1,1],groundLightColor:[.5,.5,.5],useAO:!0,AOmultipliers:[.93,.8,.5],reverseAOmultiplier:1,preserveDrawingBuffer:!0};function C(e,t,n){this.noa=e,t=Object.assign({},M,t),this.useAO=!!t.useAO,this.aoVals=t.AOmultipliers,this.revAoVal=t.reverseAOmultiplier,this.meshingCutoffTime=6,this._resizeDebounce=250,function(e,t,n){e._engine=new g.a(t,n.antiAlias,{preserveDrawingBuffer:n.preserveDrawingBuffer}),e._scene=new d.a(e._engine);var r=e._scene;r.detachControl(),r._addComponent(new k.c(r)),e._octree=new m.a(e=>{}),e._octree.blocks=[],r._selectionOctree=e._octree,e._cameraHolder=new _.a("camHolder",r),e._camera=new p.a("camera",new w.z(0,0,0),r),e._camera.parent=e._cameraHolder,e._camera.minZ=.01,e._cameraHolder.visibility=!1,e._camScreen=_.a.CreatePlane("camScreen",10,r),e.addMeshToScene(e._camScreen),e._camScreen.position.z=.1,e._camScreen.parent=e._camera,e._camScreenMat=e.makeStandardMaterial("camscreenmat"),e._camScreen.material=e._camScreenMat,e._camScreen.setEnabled(!1),e._camLocBlock=0;var i=new w.z(.1,1,.3);function o(e){return new w.e(e[0],e[1],e[2])}e._light=new y.a("light",i,r),r.clearColor=o(n.clearColor),r.ambientColor=o(n.ambientColor),e._light.diffuse=o(n.lightDiffuse),e._light.specular=o(n.lightSpecular),e._light.groundColor=o(n.groundLightColor),e.flatMaterial=e.makeStandardMaterial("flatmat")}(this,n,t),t.showFPS&&function(){var e=document.createElement("div");e.id="noa_fps";"color:white; background-color:rgba(0,0,0,0.5);","font:14px monospace; text-align:center;","min-width:2em; margin:4px;",e.style="position:absolute; top:0; right:0; z-index:0;color:white; background-color:rgba(0,0,0,0.5);font:14px monospace; text-align:center;min-width:2em; margin:4px;",document.body.appendChild(e);var t=0,n=0,r=performance.now(),i=r;I=function(){t++;var o=performance.now();if(o-i>n&&(n=o-i),i=o,!(o-r<1e3)){var s=Math.round(t/(o-r)*1e3),a=Math.round(1/n*1e3);e.innerHTML=s+"<br>"+a,t=0,n=0,r=o}}}()}C.prototype.getScene=function(){return this._scene},C.prototype.tick=function(e){},C.prototype.render=function(e){D("start"),function(e){var t=e.noa.camera,n=t._localGetTargetPosition();e._cameraHolder.position.copyFromFloats(n[0],n[1],n[2]),e._cameraHolder.rotation.x=t.pitch,e._cameraHolder.rotation.y=t.heading,e._camera.position.z=-t.currentZoom;var r=t._localGetPosition(),i=e.noa.worldOriginOffset,o=Math.floor(r[0]+i[0]),s=Math.floor(r[1]+i[1]),a=Math.floor(r[2]+i[2]),u=e.noa.getBlock(o,s,a);!function(e,t){if(t===e._camLocBlock)return;if(0===t)e._camScreen.setEnabled(!1);else{var n=e.noa.registry.getBlockFaceMaterial(t,0);if(n){var r=e.noa.registry.getMaterialData(n),i=r.color,o=r.alpha;i&&o&&o<1&&(e._camScreenMat.diffuseColor.set(0,0,0),e._camScreenMat.ambientColor.set(i[0],i[1],i[2]),e._camScreenMat.alpha=o,e._camScreen.setEnabled(!0))}}e._camLocBlock=t}(e,u)}(this),D("updateCamera"),this._engine.beginFrame(),D("beginFrame"),this._scene.render(),D("render"),I(),this._engine.endFrame(),D("endFrame"),D("end")},C.prototype.resize=function(e){P||(P=!0,setTimeout(()=>{this._engine.resize(),P=!1},this._resizeDebounce))};var P=!1;C.prototype.highlightBlockFace=function(e,t,n){var r=function(e){var t=e._highlightMesh;if(!t){t=_.a.CreatePlane("highlight",1,e._scene);var n=e.makeStandardMaterial("highlightMat");n.backFaceCulling=!1,n.emissiveColor=new w.e(1,1,1),n.alpha=.2,t.material=n;var r=.5,i=_.a.CreateLines("hightlightLines",[new w.z(r,r,0),new w.z(r,-r,0),new w.z(-r,-r,0),new w.z(-r,r,0),new w.z(r,r,0)],e._scene);i.color=new w.e(1,1,1),i.parent=t,e.addMeshToScene(t),e.addMeshToScene(i),e._highlightMesh=t}return t}(this);if(e){this.noa.globalToLocal(t,null,E);for(var i=.001+.001*x.dist(this.noa.camera._localGetPosition(),E),o=0;o<3;o++)0===n[o]?E[o]+=.5:E[o]+=n[o]>0?1+i:-i;r.position.copyFromFloats(E[0],E[1],E[2]),r.rotation.x=n[1]?Math.PI/2:0,r.rotation.y=n[0]?Math.PI/2:0}r.setEnabled(e)};var E=[];C.prototype.addMeshToScene=function(e,t,n,r){if(!e._noaContainingChunk&&!this._octree.dynamicContent.includes(e)){if(!e.parent){n||(n=[e.position.x,e.position.y,e.position.z]);var i=[];this.noa.globalToLocal(n,null,i),e.position.copyFromFloats(i[0],i[1],i[2])}var o=!1;if(t){var s=r||this.noa.world._getChunkByCoords(n[0],n[1],n[2]);o=!(!s||!s.octreeBlock)}o?(s.octreeBlock.entries.push(e),e._noaContainingChunk=s):this._octree.dynamicContent.push(e),t&&(e.freezeWorldMatrix(),e.freezeNormals());var a=this.removeMeshFromScene.bind(this,e);e.onDisposeObservable.add(a)}},C.prototype.removeMeshFromScene=function(e){e._noaContainingChunk&&e._noaContainingChunk.octreeBlock&&a(e._noaContainingChunk.octreeBlock.entries,e),e._noaContainingChunk=null,a(this._octree.dynamicContent,e)},C.prototype.makeStandardMaterial=function(e){var t=new b.a(e,this._scene);return t.specularColor.copyFromFloats(0,0,0),t.ambientColor.copyFromFloats(1,1,1),t.diffuseColor.copyFromFloats(1,1,1),t},C.prototype.prepareChunkForRendering=function(e){var t=e.size,n=[];this.noa.globalToLocal([e.x,e.y,e.z],null,n);var r=new w.z(n[0],n[1],n[2]),i=new w.z(n[0]+t,n[1]+t,n[2]+t);e.octreeBlock=new v.a(r,i,void 0,void 0,void 0,e=>{}),this._octree.blocks.push(e.octreeBlock)},C.prototype.disposeChunkForRendering=function(e){e.octreeBlock&&(a(this._octree.blocks,e.octreeBlock),e.octreeBlock.entries.length=0,e.octreeBlock=null)},C.prototype._rebaseOrigin=function(e){var t=new w.z(e[0],e[1],e[2]);this._scene.meshes.forEach(e=>{e.parent||(e.position.subtractInPlace(t),e._isWorldMatrixFrozen&&e.markAsDirty())}),this._octree.blocks.forEach(e=>{e.minPoint.subtractInPlace(t),e.maxPoint.subtractInPlace(t),e._boundingVectors.forEach(e=>{e.subtractInPlace(t)})})},C.prototype.debug_SceneCheck=function(){var e=this._scene.meshes,t=this._octree.dynamicContent,n=[],r=0,i=0,o=this._scene.materials,s=[];o.forEach(e=>{e.subMaterials?e.subMaterials.forEach(e=>s.push(e)):s.push(e)}),this._octree.blocks.forEach((function(e){r++,e.entries.forEach(e=>n.push(e))})),e.forEach((function(e){if(e._isDisposed&&c(e,"disposed mesh in scene"),0!==e.getIndices().length)if(l(e,t,n)&&c(e,"non-empty mesh missing from octree"),e.material){i+=e.subMeshes?e.subMeshes.length:1;var r=e.material.subMaterials||[e.material];r.forEach((function(e){l(e,r)&&c(e,"mesh material not in scene")}))}else c(e,"non-empty scene mesh with no material")}));var a=[];s.forEach(t=>{var n=!1;e.forEach(e=>{e.material===t&&(n=!0),e.material&&e.material.subMaterials&&e.material.subMaterials.includes(t)&&(n=!0)}),n||a.push(t.name)}),a.length&&console.warn("Materials unused by any mesh: ",a.join(", ")),t.forEach((function(t){l(t,e)&&c(t,"octree/dynamic mesh not in scene")})),n.forEach((function(t){l(t,e)&&c(t,"octree block mesh not in scene")}));var u=Math.round(10*n.length/r)/10;function c(e,t){console.warn(e.name+" --- "+t)}function l(e,t,n){return!!e&&(!t.includes(e)&&(!n||!n.includes(e)))}return console.log("meshes - octree:",n.length,"  dynamic:",t.length,"   subMeshes:",i,"   avg meshes/octreeBlock:",u),"done."},C.prototype.debug_MeshCount=function(){var e={};for(var t in this._scene.meshes.forEach(t=>{var n=t.name||"";n=(n=(n=(n=n.replace(/-\d+.*/,"#")).replace(/\d+.*/,"#")).replace(/(rotHolder|camHolder|camScreen)/,"rendering use")).replace(/atlas sprite .*/,"atlas sprites"),e[n]=e[n]||0,e[n]++}),e)console.log("   "+(e[t]+"       ").substr(0,7)+t)};var D=()=>{},I=function(){};var A=n(86),T=n.n(A),B=n(39),S=n(5),L=n(58),O=n(12),j=function(e){var t=new Y(e),n=new N(e);this.meshChunk=function(r,i,o,s,a,u,c){q("start");var l=i||e.registry.getBlockFaceMaterial,f=o||e.registry._getMaterialVertexColor,d=void 0===a?e.rendering.useAO:a,p=u||e.rendering.aoVals,m=isNaN(c)?e.rendering.revAoVal:c,v=function(e){var t=e.voxels.shape[0],n=F;if(t+2!==n.shape[0]){var r=t+2;n=new T.a(new Uint16Array(r*r*r),[r,r,r]),F=n}var i=z[0],o=z[1],s=z[2],a=z[3],u=z[4],c=z[5],l=z[6];t!==R&&(R=t,function(e,t,n,r){for(var i=0;i<3;i++)t[i]=[e-1,0,0][i],n[i]=[1,e,1][i],r[i]=[0,1,e+1][i]}(t,u,c,l));for(var f=0;f<3;f++){i[0]=f;for(var d=0;d<3;d++){i[1]=d;for(var p=0;p<3;p++){i[2]=p;for(var m=0;m<3;m++){var v=i[m];o[m]=u[v],s[m]=c[v],a[m]=l[v]}var g=e._neighbors.get(f-1,d-1,p-1);h(g?g.voxels:null,n,o,s,a)}}}return n}(r);q("copy");var g,y=r.isFull||r.isEmpty,b=t.mesh(v,l,f,d,p,m,y);return b.length&&(g=n.build(r,b,s),q("terrain")),q("end"),g||null}};var R,F=new T.a(new Uint16Array(27),[3,3,3]),z=Array.from(Array(10)).map(e=>[0,0,0]);function U(e){this.id=0|e,this.positions=[],this.indices=[],this.normals=[],this.colors=[],this.uvs=[],this.mergeable=!1}function N(e){function t(e,t){for(var r=[],i=[],o=[],s=null,a=0;a<e.length;++a){var u=e[a];if(t||u.mergeable)if(r.push(u.positions.length),i.push(u.indices.length),o.push(u.id),s){var c=s.positions.length/3;n(s.positions,u.positions),n(s.normals,u.normals),n(s.colors,u.colors),n(s.uvs,u.uvs);for(var l=0,h=u.indices.length;l<h;++l)s.indices.push(u.indices[l]+c);e.splice(a,1),u.dispose(),a--}else s=u}return{vertices:r,indices:i,matIDs:o}}function n(e,t){for(var n=0;n<t.length;n++)e.push(t[n])}this.build=function(n,i,o){for(var s=0,a=0;a<i.length;a++){var u=i[a];if(o)u.mergeable=!0;else{var c=e.registry.getMaterialTexture(u.id),l=e.registry.getMaterialData(u.id);u.mergeable=!c&&1===l.alpha&&!l.renderMat}u.mergeable&&s++}s>1&&t(i,!1);var h=t(i,!0);return function(t,n,r,i,o){var s=e.rendering.getScene(),a=new _.a(n,s),u=new S.a;if(u.positions=t.positions,u.indices=t.indices,u.normals=t.normals,u.colors=t.colors,u.uvs=t.uvs,u.applyToMesh(a),t.dispose(),1===r.length)a.material=r[0];else{var c=new L.a("multimat "+n,s);a.subMeshes=[];for(var l=0,h=0,f=0;f<r.length;f++){c.subMaterials[f]=r[f];var d=new B.a(f,l,i[f],h,o[f],a);a.subMeshes[f]=d,l+=i[f],h+=o[f]}a.material=c}return a}(i[0],"chunk_"+n.id,h.matIDs.map(t=>function(t,n){if(n)return e.rendering.flatMaterial;var i="terrain mat "+t;r[i]||(r[i]=function(t){var n=e.registry.getMaterialData(t);if(n.renderMat)return n.renderMat;var r=e.registry.getMaterialTexture(t),i=n.alpha;if(!r&&1===i)return e.rendering.flatMaterial;var o=e.rendering.flatMaterial.clone("terrain"+t);if(r){var s=e.rendering.getScene(),a=new O.a(r,s,!0,!1,O.a.NEAREST_SAMPLINGMODE);n.textureAlpha&&(a.hasAlpha=!0),o.diffuseTexture=a}n.alpha<1&&(o.alpha=n.alpha);return o}(t));return r[i]}(t,o)),h.vertices,h.indices)};var r={}}function Y(e){var t=new Int16Array(16),n=new Uint16Array(16),r=null,i=e.registry._solidityLookup,o=e.registry._opacityLookup;function s(e,i,o,s){for(var u=o.shape[1],c=t,l=n,h=0,f=2*i,d=o.data,p=o.index(e-1,0,0),m=o.stride[0],v=o.stride[1],g=o.stride[2],y=0;y<u;++y){var b=p;p+=g;for(var w=0;w<u;w++,h++,b+=v){var _=d[b],k=d[b+m];if(_!==k){var x=a(_,k,s,f);x&&(c[h]=x>0?s(_,f):-s(k,f+1),r&&(l[h]=x>0?r(o,e,e-1,w,y):r(o,e-1,e,w,y)))}}}}function a(e,t,n,r){var i=o[e],s=o[t];if(i&&s)return 0;if(i)return 1;if(s)return-1;var a=n(e,r),u=n(t,r+1);return a===u?0:0===a?-1:0===u?1:0}function u(e,r,i,o,s,a,u,d,p,m,v){var g=0,y=t,b=n,w=[0,0,0],_=[0,0,0],k=[0,0,0];w[r]=e;for(var x=[0,0,0],M=u?c:l,C=u?f:h,P=0;P<a;++P)for(var E=1,D=1,I=0;I<s;I+=E,g+=E){var A=0|y[g];if(A){var T=0|b[g];for(E=1;E<s-I&&M(g+E,y,A,b,T);++E);e:for(D=1;D<a-P;++D)for(var B=0;B<E;++B){if(!M(g+B+D*s,y,A,b,T))break e}var S=Math.abs(A);d[S]||(d[S]=new U(S));var L=d[S],O=C(L.colors,p(S),T,m,v);w[i]=I,w[o]=P,_[i]=E,k[o]=D;var j=L.positions;j.push(w[0],w[1],w[2],w[0]+_[0],w[1]+_[1],w[2]+_[2],w[0]+_[0]+k[0],w[1]+_[1]+k[1],w[2]+_[2]+k[2],w[0]+k[0],w[1]+k[1],w[2]+k[2]);var R=A>0?1:-1;2===r?L.uvs.push(0,D,-R*E,D,-R*E,0,0,0):L.uvs.push(0,E,0,0,R*D,0,R*D,E);var F=j.length/3-4;A<0?O?L.indices.push(F,F+1,F+2,F,F+2,F+3):L.indices.push(F+1,F+2,F+3,F,F+1,F+3):O?L.indices.push(F,F+2,F+1,F,F+3,F+2):L.indices.push(F+3,F+1,F,F+3,F+2,F+1),x[r]=R,L.normals.push(x[0],x[1],x[2],x[0],x[1],x[2],x[0],x[1],x[2],x[0],x[1],x[2]);for(var z=0;z<D;++z)for(var N=0;N<E;++N)y[g+N+z*s]=0}else E=1}}function c(e,t,n,r,i){return n===t[e]&&i===r[e]}function l(e,t,n,r,i){return n===t[e]}function h(e,t,n,r,i){return e.push(t[0],t[1],t[2],1),e.push(t[0],t[1],t[2],1),e.push(t[0],t[1],t[2],1),e.push(t[0],t[1],t[2],1),!0}function f(e,t,n,r,i){var o=m(n,0,0),s=m(n,1,0),a=m(n,1,1),u=m(n,0,1);v(e,t,o,r,i),v(e,t,s,r,i),v(e,t,a,r,i),v(e,t,u,r,i);return o===a?u!==s||2===u:u!==s&&o+a>u+s}function d(e,t,n,r,o){var s=1,a=1,u=1,c=1;return i[e.get(t,r+1,o)]&&(++u,++c),i[e.get(t,r-1,o)]&&(++s,++a),i[e.get(t,r,o+1)]&&(++a,++c),i[e.get(t,r,o-1)]&&(++s,++u),i[e.get(t,r,o)]?(c=3===c||i[e.get(t,r+1,o+1)]?3:2,a=3===a||i[e.get(t,r-1,o+1)]?3:2,u=3===u||i[e.get(t,r+1,o-1)]?3:2,s=3===s||i[e.get(t,r-1,o-1)]?3:2):(1===c&&i[e.get(t,r+1,o+1)]&&(c=2),1===a&&i[e.get(t,r-1,o+1)]&&(a=2),1===u&&i[e.get(t,r+1,o-1)]&&(u=2),1===s&&i[e.get(t,r-1,o-1)]&&(s=2)),c<<6|u<<4|a<<2|s}function p(e,t,n,r,o){var s=1,a=1,u=1,c=1;return i[e.get(t,r+1,o)]&&(++u,++c),i[e.get(t,r-1,o)]&&(++s,++a),i[e.get(t,r,o+1)]&&(++a,++c),i[e.get(t,r,o-1)]&&(++s,++u),i[e.get(t,r,o)]?(c=3===c||i[e.get(t,r+1,o+1)]?3:2,a=3===a||i[e.get(t,r-1,o+1)]?3:2,u=3===u||i[e.get(t,r+1,o-1)]?3:2,s=3===s||i[e.get(t,r-1,o-1)]?3:2):(1===c&&(i[e.get(t,r+1,o+1)]?c=2:i[e.get(n,r,o+1)]&&i[e.get(n,r+1,o)]&&i[e.get(n,r+1,o+1)]||(c=0)),1===u&&(i[e.get(t,r+1,o-1)]?u=2:i[e.get(n,r,o-1)]&&i[e.get(n,r+1,o)]&&i[e.get(n,r+1,o-1)]||(u=0)),1===a&&(i[e.get(t,r-1,o+1)]?a=2:i[e.get(n,r,o+1)]&&i[e.get(n,r-1,o)]&&i[e.get(n,r-1,o+1)]||(a=0)),1===s&&(i[e.get(t,r-1,o-1)]?s=2:i[e.get(n,r,o-1)]&&i[e.get(n,r-1,o)]&&i[e.get(n,r-1,o-1)]||(s=0))),c<<6|u<<4|a<<2|s}function m(e,t,n){return e>>(t?n?6:4:n?2:0)&3}function v(e,t,n,r,i){var o=0===n?i:r[n-1];e.push(t[0]*o,t[1]*o,t[2]*o,1)}this.mesh=function(a,c,l,h,f,m,v){i=e.registry._solidityLookup,o=e.registry._opacityLookup;var g={},y=m===f[0];r=h?y?d:p:null;for(var b=0;b<3;++b){var w=(b+1)%3,_=(b+2)%3,k=a.shape,x=a.transpose(b,w,_).lo(1,1,1).hi(k[b]-2,k[w]-2,k[_]-2),M=x.shape[0]-1,C=x.shape[1],P=x.shape[2];t.length<C*P&&(t=new Int16Array(C*P),n=new Uint16Array(C*P));for(var E=0;E<=M;++E)s(E,b,x,c),q("masks"),u(E,b,w,_,C,P,h,g,l,f,m),v&&(E+=M-1),q("submeshes")}return Object.keys(g).map(e=>g[e])}}U.prototype.dispose=function(){this.positions=null,this.indices=null,this.normals=null,this.colors=null,this.uvs=null};var q=()=>{},X=n(191),G=new function(){function e(e,t,n,r,i,o){var s=e._objectBlocks,a=new X.a("object_sps_"+e.id,t,{updatable:!1}),u=e.noa.registry._blockHandlerLookup,c=e.noa.registry._blockMeshLookup;for(var l in n){var h,f=c[l],d=n[l],p=d.length,m=u[l];m&&(h=m.onCustomMeshCreate);a.addShape(f,p,{positionFunction:function(e,t,n){var a=d[n],u=s[a];e.position.set(u.x+.5,u.y,u.z+.5),h&&h(e,r+u.x,i+u.y,o+u.z)}}),d.length=0}return a}this.initChunk=function(e){e._objectBlocks={},e._objectSystems=[]},this.disposeChunk=function(e){this.removeObjectMeshes(e),e._objectBlocks=null},this.addObjectBlock=function(e,t,n,r,i){var o=n+"|"+r+"|"+i;e._objectBlocks[o]=new V(t,n,r,i,null)},this.removeObjectBlock=function(e,t,n,r){var i=t+"|"+n+"|"+r;e._objectBlocks[i]&&delete e._objectBlocks[i]},this.removeObjectMeshes=function(e){for(var t=e._objectSystems||[];t.length;){var n=t.pop();n.mesh&&n.mesh.dispose(),n.dispose()}},this.buildObjectMeshes=function(t){J("start");var n=t.noa.rendering.getScene(),r=t.noa.registry._blockMeshLookup,i={};for(var o in t._objectBlocks){var s=t._objectBlocks[o].id,a=r[s].material,u=a?n.materials.indexOf(a):-1;i[u]||(i[u]={}),i[u][s]||(i[u][s]=[]),i[u][s].push(o)}J("preprocess");var c=t.i*t.size,l=t.j*t.size,h=t.k*t.size,f=[];for(var d in i){var p=e(t,n,i[d],c,l,h);J("made SPS");var m=p.buildMesh();J("built mesh"),m.material=d>-1?n.materials[d]:null,f.push(m),t._objectSystems.push(p)}return J("end"),f}};function V(e,t,n,r){this.id=0|e,this.x=0|t,this.y=0|n,this.z=0|r}var H,Z,$,K,W,J=()=>{},Q=n(86),ee=te;function te(e,t,n,r,i,o,s){this.id=t,this.requestID="",this.noa=e,this.isDisposed=!1,this.octreeBlock=null,this.voxels=s,this.i=n,this.j=r,this.k=i,this.size=o,this.x=n*o,this.y=r*o,this.z=i*o,this._terrainDirty=!1,this._objectsDirty=!1,H=e.registry._solidityLookup,Z=e.registry._opacityLookup,$=e.registry._objectLookup,K=e.registry._blockHandlerLookup,this._terrainMesh=null,this._objectBlocks=null,this._objectSystems=null,G.initChunk(this),this.isFull=!1,this.isEmpty=!1;var a=Array.from(Array(27)).map(()=>null);this._neighbors=new Q(a,[3,3,3]).lo(1,1,1),this._neighbors.set(0,0,0,this),this._neighborCount=0,this._maxMeshedNeighbors=0,this._timesMeshed=0,ie(this)}function ne(e,t,n,r,i,o){var s=t[n];s&&s(e.x+r,e.y+i,e.z+o)}function re(e){return 0!==e&&(!!H[e]||!$[e])}function ie(e){for(var t=!0,n=!0,r=!1,i=e.voxels,o=i.data,s=i.shape[0],a=K,u=0;u<s;++u)for(var c=0;c<s;++c)for(var l=i.index(u,c,0),h=0;h<s;++h,++l){var f=o[l];if(0!==f){t=t&&Z[f],n=!1,$[f]&&(oe(e,f,u,c,h),r=!0);var d=a[f];d&&ne(e,d,"onLoad",u,c,h)}else t=!1}e.isFull=t,e.isEmpty=n,e._terrainDirty=!e.isEmpty,e._objectsDirty=r}function oe(e,t,n,r,i){G.addObjectBlock(e,t,n,r,i),e._objectsDirty=!0}function se(e,t){for(var n=e.voxels,r=n.data,i=K,o=n.shape[0],s=0;s<o;++s)for(var a=0;a<o;++a)for(var u=n.index(s,a,0),c=0;c<o;++c,++u){var l=r[u];l>0&&i[l]&&ne(e,i[l],t,s,a,c)}}te._createVoxelArray=function(e){var t=new Uint16Array(e*e*e);return new Q(t,[e,e,e])},te.prototype._updateVoxelArray=function(e){se(this,"onUnload"),G.disposeChunk(this),this.voxels=e,this._terrainDirty=!1,this._objectsDirty=!1,G.initChunk(this),ie(this)},te.prototype.get=function(e,t,n){return this.voxels.get(e,t,n)},te.prototype.getSolidityAt=function(e,t,n){return H[this.voxels.get(e,t,n)]},te.prototype.set=function(e,t,n,r){var i=this.voxels.get(e,t,n),o=i;if(r!==o){this.voxels.set(e,t,n,r),$[i]&&function(e,t,n,r){G.removeObjectBlock(e,t,n,r),e._objectsDirty=!0}(this,e,t,n),$[r]&&oe(this,r,e,t,n),ne(this,o,"onUnset",e,t,n),ne(this,r,"onSet",e,t,n),Z[r]||(this.isFull=!1),0!==r&&(this.isEmpty=!1),(re(r)||re(i))&&(this._terrainDirty=!0),(this._terrainDirty||this._objectsDirty)&&this.noa.world._queueChunkForRemesh(this);var s=!1;if(H[i]!==H[r]&&(s=!0),Z[i]!==Z[r]&&(s=!0),s){var a=this.size-1,u=0===e?-1:e<a?0:1,c=0===t?-1:t<a?0:1,l=0===n?-1:n<a?0:1;if(u|c|l){var h=c?[0,c]:[0],f=l?[0,l]:[0];(u?[0,u]:[0]).forEach(e=>{h.forEach(t=>{f.forEach(n=>{if(0!=(e|t|n)){var r=this._neighbors.get(e,t,n);r&&(r._terrainDirty=!0,this.noa.world._queueChunkForRemesh(r))}})})})}}}},te.prototype.mesh=function(e,t,n,r,i,o){return W||(W=new j(this.noa)),W.meshChunk(this,e,t,n,r,i,o)},te.prototype.updateMeshes=function(){var e=this.noa.rendering;if(this._terrainDirty){this._terrainMesh&&this._terrainMesh.dispose();var t=this.mesh();if(t&&t.getIndices().length>0){var n=[this.x,this.y,this.z];e.addMeshToScene(t,!0,n,this)}this._terrainMesh=t||null,this._terrainDirty=!1,this._timesMeshed++,this._maxMeshedNeighbors=Math.max(this._maxMeshedNeighbors,this._neighborCount)}if(this._objectsDirty){G.removeObjectMeshes(this);var r=G.buildObjectMeshes(this),i=[this.x,this.y,this.z];r.forEach(t=>e.addMeshToScene(t,!0,i,this)),this._objectsDirty=!1}},te.prototype.dispose=function(){se(this,"onUnload"),G.disposeChunk(this),this._terrainMesh&&this._terrainMesh.dispose(),this.voxels.data=null,this.voxels=null,this._neighbors.data=null,this._neighbors=null,this.isDisposed=!0};var ae=n(81).EventEmitter,ue={chunkSize:24,chunkAddDistance:3,chunkRemoveDistance:4,worldGenWhilePaused:!1,manuallyControlChunkLoading:!1};function ce(e,t){var n;this.noa=e,t=Object.assign({},ue,t),this.playerChunkLoaded=!1,this.Chunk=ee,this.chunkSize=t.chunkSize,this.chunkAddDistance=t.chunkAddDistance,this.chunkRemoveDistance=t.chunkRemoveDistance,this.chunkRemoveDistance<this.chunkAddDistance&&(this.chunkRemoveDistance=this.chunkAddDistance),this.manuallyControlChunkLoading=!!t.manuallyControlChunkLoading,this.minNeighborsToMesh=6,this.maxChunksPendingCreation=10,this.maxChunksPendingMeshing=10,this.maxProcessingPerTick=9,this.maxProcessingPerRender=5,this.worldGenWhilePaused=t.worldGenWhilePaused,this._cachedWorldName="",this._lastPlayerChunkID="",this._chunkStorage={},(n=this)._chunkIDsKnown=new f,n._chunkIDsToRequest=new f,n._chunkIDsPending=new f,n._chunkIDsToMesh=new f,n._chunkIDsToMeshFirst=new f,n._chunkIDsToRemove=new f,n._queueChunkForRemesh=e=>{ve(n,e)},function(e){e._getChunk=(t,n,r)=>{var i=t+"|"+n+"|"+r;return e._chunkStorage[i]||null},e._setChunk=(t,n,r,i)=>{var o=he(t,n,r);i?e._chunkStorage[o]=i:delete e._chunkStorage[o]},e._getChunkByCoords=function(t,n,r){var[i,o,s]=e._worldCoordsToChunkCoords(t,n,r);return e._getChunk(i,o,s)}}(this);var r=this.chunkSize;if(0==(r&r-1)){var i=0|Math.log2(r),o=r-1|0;this._worldCoordToChunkCoord=e=>e>>i|0,this._worldCoordToChunkIndex=e=>e&o|0,this._worldCoordsToChunkCoords=(e,t,n)=>[e>>i|0,t>>i|0,n>>i|0],this._worldCoordsToChunkIndexes=(e,t,n)=>[e&o|0,t&o|0,n&o|0]}else this._worldCoordToChunkCoord=e=>0|Math.floor(e/r),this._worldCoordToChunkIndex=e=>(e%r+r)%r|0,this._worldCoordsToChunkCoords=(e,t,n)=>[0|Math.floor(e/r),0|Math.floor(t/r),0|Math.floor(n/r)],this._worldCoordsToChunkIndexes=(e,t,n)=>[(e%r+r)%r|0,(t%r+r)%r|0,(n%r+r)%r|0]}ce.prototype=Object.create(ae.prototype),ce.prototype.getBlockID=function(e,t,n){var r=this._getChunkByCoords(e,t,n);if(!r)return 0;var[i,o,s]=this._worldCoordsToChunkIndexes(e,t,n);return r.get(i,o,s)},ce.prototype.getBlockSolidity=function(e,t,n){var r=this._getChunkByCoords(e,t,n);if(!r)return!1;var[i,o,s]=this._worldCoordsToChunkIndexes(e,t,n);return!!r.getSolidityAt(i,o,s)},ce.prototype.getBlockOpacity=function(e,t,n){var r=this.getBlockID(e,t,n);return this.noa.registry.getBlockOpacity(r)},ce.prototype.getBlockFluidity=function(e,t,n){var r=this.getBlockID(e,t,n);return this.noa.registry.getBlockFluidity(r)},ce.prototype.getBlockProperties=function(e,t,n){var r=this.getBlockID(e,t,n);return this.noa.registry.getBlockProps(r)},ce.prototype.getBlockObjectMesh=function(e,t,n){var r=this._getChunkByCoords(e,t,n);return r?r.getObjectMeshAt(this._worldCoordToChunkIndex(e),this._worldCoordToChunkIndex(t),this._worldCoordToChunkIndex(n)):0},ce.prototype.setBlockID=function(e,t,n,r){var[i,o,s]=this._worldCoordsToChunkCoords(t,n,r),[a,u,c]=this._worldCoordsToChunkIndexes(t,n,r),l=this._getChunk(i,o,s);l&&l.set(a,u,c,e)},ce.prototype.isBoxUnobstructed=function(e){for(var t=e.base,n=e.max,r=Math.floor(t[0]);r<n[0]+1;r++)for(var i=Math.floor(t[1]);i<n[1]+1;i++)for(var o=Math.floor(t[2]);o<n[2]+1;o++)if(this.getBlockSolidity(r,i,o))return!1;return!0},ce.prototype.setChunkData=function(e,t,n){!function(e,t,n,r){var i=t.split("|"),o=parseInt(i.shift()),s=parseInt(i.shift()),a=parseInt(i.shift()),u=i.join("|"),c=he(o,s,a);if(e._chunkIDsPending.remove(c),u!==e.noa.worldName)return;if(!e._chunkIDsKnown.includes(c))return;if(e._chunkIDsToRemove.includes(c))return;var l=e._chunkStorage[c];if(l){l._updateVoxelArray(n),l._neighbors.data.forEach(t=>{t&&t!==l&&t._neighborCount>20&&ve(e,t)})}else{var h=e.chunkSize;l=new ee(e.noa,c,o,s,a,h,n),e._setChunk(o,s,a,l),l.requestID=t,l.userData=r,ye(e,o,s,a,l),e.noa.rendering.prepareChunkForRendering(l),e.emit("chunkAdded",l)}ve(e,l),_e("receive")}(this,e,t,n)},ce.prototype.invalidateVoxelsInAABB=function(e){!function(e,t){var n=t.base.map(t=>Math.floor(e._worldCoordToChunkCoord(t))),r=t.max.map(t=>Math.floor(e._worldCoordToChunkCoord(t)));e._chunkIDsKnown.forEach(t=>{for(var i=fe(t),o=0;o<3;o++)if(i[o]<n[o]||i[o]>r[o])return;e._chunkIDsToRemove.includes(t)||e._chunkIDsToRequest.add(t)})}(this,e)},ce.prototype.manuallyLoadChunk=function(e,t,n){if(!this.manuallyControlChunkLoading)throw le;var[r,i,o]=this._worldCoordsToChunkCoords(e,t,n),s=he(r,i,o);this._chunkIDsKnown.add(s),this._chunkIDsToRequest.add(s)},ce.prototype.manuallyUnloadChunk=function(e,t,n){if(!this.manuallyControlChunkLoading)throw le;var[r,i,o]=this._worldCoordsToChunkCoords(e,t,n),s=he(r,i,o);this._chunkIDsToRemove.add(s),this._chunkIDsToRequest.remove(s),this._chunkIDsToMesh.remove(s),this._chunkIDsToMeshFirst.remove(s)};var le="Set `noa.world.manuallyControlChunkLoading` if you need this API";function he(e,t,n){return e+"|"+t+"|"+n}function fe(e){return e.split("|").map(e=>parseInt(e))}function de(e){var t=e.noa.entities.getPosition(e.noa.playerEntity),[n,r,i]=e._worldCoordsToChunkCoords(t[0],t[1],t[2]);return[n,r,i]}ce.prototype.tick=function(){var e=performance.now();this._cachedWorldName!==this.noa.worldName&&(!function(e){e._chunkIDsToRemove.copyFrom(e._chunkIDsKnown),e._chunkIDsToRequest.empty(),e._chunkIDsToMesh.empty(),e._chunkIDsToMeshFirst.empty();var t=de(e);ge(e._chunkIDsToRemove,t[0],t[1],t[2])}(this),this._cachedWorldName=this.noa.worldName);var t,n,r,i,o,s,a=de(this),h=he(a[0],a[1],a[2]),f=h!=this._lastPlayerChunkID;if(f&&(this.emit("playerEnteredChunk",a[0],a[1],a[2]),this._lastPlayerChunkID=h),we("start"),_e("start"),!this.manuallyControlChunkLoading){f&&(t=this,n=a[0],r=a[1],i=a[2],o=t.chunkRemoveDistance*t.chunkRemoveDistance,s=t._chunkIDsToRemove,t._chunkIDsKnown.forEach(e=>{if(!s.includes(e)){var a=fe(e),u=a[0]-n,c=a[1]-r,l=a[2]-i;u*u+c*c+l*l<o||(t._chunkIDsToRemove.add(e),t._chunkIDsToRequest.remove(e),t._chunkIDsToMesh.remove(e),t._chunkIDsToMeshFirst.remove(e))}}),ge(s,n,r,i),we("remQueue"));var d=function(e){if(e===c)return l;for(var t=Math.ceil(e),n=0,r=e*e,i=-t;i<=t;++i)for(var o=-t;o<=t;++o)for(var s=-t;s<=t;++s){i*i+o*o+s*s<r&&n++}return c=e,l=n,n}(this.chunkAddDistance);(f||this._chunkIDsKnown.count()<d)&&(!function(e,t,n,r){for(var i=Math.ceil(e.chunkAddDistance),o=e.chunkAddDistance*e.chunkAddDistance,s=e._chunkIDsKnown,a=e._chunkIDsToRequest,u=t-i;u<=t+i;++u)for(var c=n-i;c<=n+i;++c)for(var l=r-i;l<=r+i;++l){var h=he(u,c,l);if(!s.includes(h)){var f=u-t,d=c-n,p=l-r;f*f+d*d+p*p>o||(s.add(h),a.add(h))}}ge(a,t,n,r)}(this,a[0],a[1],a[2]),we("addQueue"))}u(this.maxProcessingPerTick,()=>{var e=function(e){var t=e._chunkIDsToRequest;if(t.isEmpty())return!0;var n=e._chunkIDsPending.count(),r=e._chunkIDsToMesh.count();if(n>=e.maxChunksPendingCreation)return!0;if(r>=e.maxChunksPendingMeshing)return!0;var i=t.pop();return function(e,t){var n=fe(t),r=n[0],i=n[1],o=n[2],s=e.chunkSize,a=ee._createVoxelArray(e.chunkSize),u=e.noa.worldName,c=[r,i,o,u].join("|"),l=r*s,h=i*s,f=o*s;e._chunkIDsPending.add(t),e.emit("worldDataNeeded",c,a,l,h,f,u),_e("request")}(e,i),t.isEmpty()}(this);return we("requests"),e=e&&function(e){var t=e._chunkIDsToRemove;return!!t.isEmpty()||(function(e,t){var n=fe(t),r=e._getChunk(n[0],n[1],n[2]);r&&(e.emit("chunkBeingRemoved",r.requestID,r.voxels,r.userData),e.noa.rendering.disposeChunkForRendering(r),r.dispose(),_e("dispose"),ye(e,n[0],n[1],n[2],null));e._setChunk(n[0],n[1],n[2],null),e._chunkIDsKnown.remove(t),e._chunkIDsToMesh.remove(t),e._chunkIDsToMeshFirst.remove(t)}(e,t.pop()),t.isEmpty())}(this),we("removes"),e=e&&me(this,!1),we("meshes"),e},e),performance.now()-e+2<this.maxProcessingPerTick&&(!function(e){for(var t=e._chunkIDsKnown.arr,n=Math.min(50,t.length),r=e._chunkIDsToMesh.count()+e._chunkIDsToMeshFirst.count(),i=0;i<n;i++){pe=(pe+1)%t.length;var o=t[pe],s=e._chunkStorage[o];if(s){var a=s._neighborCount;if(!(a<e.minNeighborsToMesh)&&!(a<=s._maxMeshedNeighbors)&&(ve(e,s),++r>10))return}}}(this),we("looking"),u(this.maxProcessingPerTick,()=>{var e=me(this,!1);return we("meshes"),e},e));var p=this._getChunk(a[0],a[1],a[2]);this.playerChunkLoaded=!!p,_e("end",this),we("end")},ce.prototype.render=function(){u(this.maxProcessingPerRender,()=>me(this,!0))};var pe=-1;function me(e,t){var n=e._chunkIDsToMeshFirst;if(n.isEmpty()&&!t&&(n=e._chunkIDsToMesh),n.isEmpty())return!0;var r=n.pop();if(!e._chunkIDsToRemove.includes(r)){var i=e._chunkStorage[r];i&&function(e,t){e._chunkIDsToMesh.remove(t.id),e._chunkIDsToMeshFirst.remove(t.id),t.updateMeshes(),_e("mesh")}(e,i)}}function ve(e,t){var n=t._neighborCount;n<Math.min(e.minNeighborsToMesh,26)||(t._terrainDirty=!0,(26===n?e._chunkIDsToMeshFirst:e._chunkIDsToMesh).add(t.id))}function ge(e,t,n,r){e.sort(e=>{var i=fe(e),o=i[0]-t,s=i[1]-n,a=i[2]-r;return o*o+a*a+Math.abs(s)})}function ye(e,t,n,r,i){for(var o=-1;o<=1;o++)for(var s=-1;s<=1;s++)for(var a=-1;a<=1;a++)if(0!=(o|s|a)){var u=he(t+o,n+s,r+a),c=e._chunkStorage[u];c&&(i?(i._neighborCount++,i._neighbors.set(o,s,a,c),c._neighborCount++,c._neighbors.set(-o,-s,-a,i),26===c._neighborCount&&ve(e,c)):(c._neighborCount--,c._neighbors.set(-o,-s,-a,null)))}}function be(e,t,n,r){var i=0,o=0,s=0,a=0,u=[];n.forEach(t=>{var n=e._chunkStorage[t];n&&(s++,u.push(n._timesMeshed),n.isFull&&i++,n.isEmpty&&o++,26===n._neighborCount&&a++)});var c=n.length.toString().padEnd(8);if(c+=("exist: "+s).padEnd(12),c+=("full: "+i).padEnd(12),c+=("empty: "+o).padEnd(12),c+=("surr: "+a).padEnd(12),r){var l=u.reduce((e,t)=>e+t,0),h=u.reduce((e,t)=>Math.max(e,t),0),f=u.reduce((e,t)=>Math.min(e,t),0);c+="times meshed: avg "+(l/s).toFixed(2),c+="  max "+h,c+="  min "+f}console.log(t,c)}ce.prototype.report=function(){console.log("World report - playerChunkLoaded: ",this.playerChunkLoaded),be(this,"  known:     ",this._chunkIDsKnown.arr,!0),be(this,"  to request:",this._chunkIDsToRequest.arr),be(this,"  to remove: ",this._chunkIDsToRemove.arr),be(this,"  creating:  ",this._chunkIDsPending.arr),be(this,"  to mesh:   ",this._chunkIDsToMesh.arr.concat(this._chunkIDsToMeshFirst.arr))};var we=()=>{},_e=()=>{};var ke=n(305),xe=function(e,t,n){return function(e,t,n){t=Object.assign({},Me,t);var r=ke(n,t),i=t.bindings;for(var o in i){var s=Array.isArray(i[o])?i[o]:[i[o]];s.unshift(o),r.bind.apply(r,s)}return r}(0,t,n)},Me={bindings:{forward:["W","<up>"],left:["A","<left>"],backward:["S","<down>"],right:["D","<right>"],fire:"<mouse 1>","mid-fire":["<mouse 2>","Q"],"alt-fire":["<mouse 3>","E"],jump:"<space>",sprint:"<shift>",crouch:"<control>"}};var Ce=n(308),Pe=function(e,t){return function(e,t){t=Object.assign({},Ee,t);var n=e.world,r=e.registry._solidityLookup,i=e.registry._fluidityLookup,o=e.worldOriginOffset;return Ce(t,(e,t,i)=>{var s=n.getBlockID(e+o[0],t+o[1],i+o[2]);return r[s]},(e,t,r)=>{var s=n.getBlockID(e+o[0],t+o[1],r+o[2]);return i[s]})}(e,t)},Ee={gravity:[0,-10,0],airDrag:.1};var De=n(41),Ie=n(122),Ae=n(216),Te={inverseX:!1,inverseY:!1,sensitivityX:10,sensitivityY:10,initialZoom:0,zoomSpeed:.2};function Be(e,t){this.noa=e,t=Object.assign({},Te,t),this.sensitivityX=t.sensitivityX,this.sensitivityY=t.sensitivityY,this.inverseX=t.inverseX,this.inverseY=t.inverseY,this.heading=0,this.pitch=0,this.cameraTarget=this.noa.ents.createEntity(["position"]);var n=.9*e.ents.getPositionData(e.playerEntity).height;e.ents.addComponent(this.cameraTarget,"followsEntity",{entity:e.playerEntity,offset:[0,n,0]}),this.zoomDistance=t.initialZoom,this.zoomSpeed=t.zoomSpeed,this.currentZoom=t.initialZoom,this._dirVector=De.fromValues(0,1,0)}Be.prototype._localGetTargetPosition=function(){var e=this.noa.ents.getPositionData(this.cameraTarget);return De.copy(Se,e._renderPosition)},Be.prototype._localGetPosition=function(){var e=this._localGetTargetPosition();return 0===this.currentZoom?e:De.scaleAndAdd(e,e,this._dirVector,-this.currentZoom)};var Se=De.create();Be.prototype.getTargetPosition=function(){var e=this._localGetTargetPosition();return this.noa.localToGlobal(e,Le)};var Le=[];Be.prototype.getPosition=function(){var e=this._localGetPosition();return this.noa.localToGlobal(e,Le)},Be.prototype.getDirection=function(){return this._dirVector},Be.prototype.applyInputsToCamera=function(){var e=this.noa.inputs.state;!function(e){var t=e.dx,n=e.dy,r=document.body.clientWidth/6,i=document.body.clientHeight/6,o=Math.abs(t)>r&&t/Ne<-1,s=Math.abs(n)>i&&n/Ye<-1;o||s?(e.dx=Ne,e.dy=Ye,Ne=t>0?1:-1,Ye=n>0?1:-1):(t&&(Ne=t),n&&(Ye=n))}(e);var t=.0066*Math.PI/180,n=e.dy*this.sensitivityY*t,r=e.dx*this.sensitivityX*t;this.inverseY&&(n=-n),this.inverseX&&(r=-r);var i=2*Math.PI;this.heading+=r<0?r+i:r,this.heading>i&&(this.heading-=i);var o=Math.PI/2-.001;this.pitch=Math.max(-o,Math.min(o,this.pitch+n)),De.set(this._dirVector,0,0,1),De.rotateX(this._dirVector,this._dirVector,Oe,this.pitch),De.rotateY(this._dirVector,this._dirVector,Oe,this.heading)};var Oe=De.create();Be.prototype.updateBeforeEntityRenderSystems=function(){this.currentZoom+=(this.zoomDistance-this.currentZoom)*this.zoomSpeed},Be.prototype.updateAfterEntityRenderSystems=function(){var e=function(e){if(!je){var t=e.noa.worldOriginOffset;je=new Ie([0,0,0],De.clone(Fe)),Re=(n,r,i)=>e.noa.world.getBlockSolidity(n+t[0],r+t[1],i+t[2]),De.scale(Fe,Fe,-.5)}je.setPosition(e._localGetTargetPosition()),je.translate(Fe);var n=Math.max(e.zoomDistance,e.currentZoom)+.1;return De.scale(ze,e.getDirection(),-n),Ae(Re,je,ze,Ue,!0)}(this);this.currentZoom>e&&(this.currentZoom=e)};var je,Re,Fe=De.fromValues(.2,.2,.2),ze=De.create(),Ue=()=>!0;var Ne=0,Ye=0,qe={texturePath:""},Xe={solid:!0,opaque:!0,fluidDensity:1,viscosity:.5};function Ge(e,t){this.noa=e,t=Object.assign({},qe,t);var n=[!1],r=[!1],i=[!1],o=[!1],s=[0,0,0,0,0,0],a=[null],u=[null],c=[null],l={},h=[null],f=t.texturePath;this.registerBlock=function(e,t){t=t||{},Xe.solid=!t.fluid,Xe.opaque=!t.fluid;var h=Object.assign({},Xe,t);if(e<1||e>65535)throw"Block id out of range: "+e;for(;e>n.length;)this.registerBlock(n.length,{});n[e]=!!h.solid,r[e]=!!h.opaque,i[e]=!!h.fluid,o[e]=!!h.blockMesh,u[e]=h.blockMesh||null;var f,d=h.material||null;if(d)if("string"==typeof d)f=[d,d,d,d,d,d];else if(d.length&&2==d.length)f=[d[1],d[1],d[0],d[0],d[1],d[1]];else if(d.length&&3==d.length)f=[d[2],d[2],d[0],d[1],d[2],d[2]];else{if(!d.length||6!=d.length)throw"Invalid material parameter: "+d;f=d}else f=[null,null,null,null,null,null];for(var p=0;p<6;++p)s[6*e+p]=Ve(this,l,f[p],!0);a[e]={},i[e]&&(a[e].fluidDensity=h.fluidDensity,a[e].viscosity=h.viscosity);var m=h.onLoad||h.onUnload||h.onSet||h.onUnset||h.onCustomMeshCreate;return c[e]=m?new He(h):null,e},this.registerMaterial=function(e,t,n,r,i){var o=l[e]||h.length;l[e]=o;var s=1;return t&&4==t.length&&(s=t.pop()),h[o]={color:t||[1,1,1],alpha:s,texture:n?f+n:"",textureAlpha:!!r,renderMat:i||null},o},this.getBlockSolidity=function(e){return n[e]},this.getBlockOpacity=function(e){return r[e]},this.getBlockFluidity=function(e){return i[e]},this.getBlockProps=function(e){return a[e]},this.getBlockFaceMaterial=function(e,t){return s[6*e+t]},this.getMaterialColor=function(e){return h[e].color},this.getMaterialTexture=function(e){return h[e].texture},this.getMaterialData=function(e){return h[e]},this._solidityLookup=n,this._opacityLookup=r,this._fluidityLookup=i,this._objectLookup=o,this._blockMeshLookup=u,this._blockHandlerLookup=c,this._getMaterialVertexColor=function(e){return h[e].texture?d:h[e].color};var d=[1,1,1];this.registerMaterial("dirt",[.4,.3,0],null),this.registerBlock(1,{material:"dirt"})}function Ve(e,t,n,r){if(!n)return 0;var i=t[n];return void 0===i&&r&&(i=e.registerMaterial(n)),i}function He(e){this.onLoad=e.onLoad||null,this.onUnload=e.onUnload||null,this.onSet=e.onSet||null,this.onUnset=e.onUnset||null,this.onCustomMeshCreate=e.onCustomMeshCreate||null}var Ze=n(127),$e=n(128),Ke=n(41),We=n(310),Je={shadowDistance:10};function Qe(e,t){We.call(this),this.noa=e,t=Object.assign({},Je,t),this.names={};var r={shadow:t.shadowDistance},i=n(312);i.keys().forEach(t=>{var n=/\.\/(.*)\.js/.exec(t)[1],o=r[n]||void 0,s=i(t);s.default&&(s=s.default);var a=s(e,o),u=this.createComponent(a);this.names[n]=u}),this.isPlayer=function(t){return t===e.playerEntity},this.hasPhysics=this.getComponentAccessor(this.names.physics),this.cameraSmoothed=this.getComponentAccessor(this.names.smoothCamera),this.hasMesh=this.getComponentAccessor(this.names.mesh),this.hasPosition=this.getComponentAccessor(this.names.position);var o=this.getStateAccessor(this.names.position);function s(t,n){Ke.copy(n._renderPosition,n._localPosition),Ke.add(n.position,n._localPosition,e.worldOriginOffset),Object(Ze.updatePositionExtents)(n);var r=a(t);r&&Object($e.setPhysicsFromPosition)(r,n)}this.getPositionData=o,this._localGetPosition=function(e){return o(e)._localPosition},this.getPosition=function(e){return o(e).position},this._localSetPosition=function(e,t){var n=o(e);Ke.copy(n._localPosition,t),s(e,n)},this.setPosition=(t,n,r,i)=>{"number"==typeof n&&(n=[n,r,i]);var o=e.globalToLocal(n,null,[]);this._localSetPosition(t,o)},this.setEntitySize=function(e,t,n,r){var i=o(e);i.width=(t+r)/2,i.height=n,s(e,i)},this._rebaseOrigin=function(e){this.getStatesList(this.names.position).forEach(t=>{Ke.subtract(t._localPosition,t._localPosition,e),s(t.__id,t)})};var a=this.getStateAccessor(this.names.physics);this.getPhysics=a,this.getPhysicsBody=function(e){return a(e).body},this.getMeshData=this.getStateAccessor(this.names.mesh),this.getMovement=this.getStateAccessor(this.names.movement),this.getCollideTerrain=this.getStateAccessor(this.names.collideTerrain),this.getCollideEntities=this.getStateAccessor(this.names.collideEntities),this.onPairwiseEntityCollision=function(e,t){}}function et(e,t){return!(e[0]>t[3])&&(!(e[1]>t[4])&&(!(e[2]>t[5])&&(!(e[3]<t[0])&&(!(e[4]<t[1])&&!(e[5]<t[2])))))}Qe.prototype=Object.create(We.prototype),Qe.prototype.constructor=Qe,Qe.prototype.addComponentAgain=function(e,t,n){this.hasComponent(e,t)&&this.removeComponent(e,t,!0),this.addComponent(e,t,n)},Qe.prototype.isTerrainBlocked=function(e,t,n){for(var r=this.noa.worldOriginOffset,i=Math.floor(e-r[0]),o=Math.floor(t-r[1]),s=Math.floor(n-r[2]),a=[i+.001,o+.001,s+.001,i+.999,o+.999,s+.999],u=this.getStatesList(this.names.collideTerrain),c=0;c<u.length;c++){var l=u[c].__id;if(et(a,this.getPositionData(l)._extents))return!0}return!1},Qe.prototype.getEntitiesInAABB=function(e,t){var n=this.noa.worldOriginOffset,r=[e.base[0]+n[0],e.base[1]+n[1],e.base[2]+n[2],e.max[0]+n[0],e.max[1]+n[1],e.max[2]+n[2]],i=t?this.getStatesList(t).map(e=>this.getPositionData(e.__id)):this.getStatesList(this.names.position),o=[];return i.forEach(e=>{et(r,e._extents)&&o.push(e.__id)}),o},Qe.prototype.add=function(e,t,n,r,i,o,s){var a=this,u=this.createEntity();if(this.addComponent(u,this.names.position,{position:e||[0,0,0],width:t,height:n}),o){this.addComponent(u,this.names.physics);var c=this.getPhysicsBody(u),l=this.names.smoothCamera;c.onStep=function(){a.addComponentAgain(u,l)}}return r&&(i||(i=Ke.create()),this.addComponent(u,this.names.mesh,{mesh:r,offset:i})),s&&this.addComponent(u,this.names.shadow,{size:t}),u}
/*!
 * noa: an experimental voxel game engine.
 * @url      github.com/andyhall/noa
 * @author   Andy Hall <andy@fenomas.com>
 * @license  MIT
 */;var tt=n(41),nt=n(86),rt=n(291),it=n(81).EventEmitter,ot=at,st={debug:!1,silent:!1,playerHeight:1.8,playerWidth:.6,playerStart:[0,10,0],playerAutoStep:!1,tickRate:33,blockTestDistance:10,stickyPointerLock:!0,dragCameraOutsidePointerLock:!0,skipDefaultHighlighting:!1,originRebaseDistance:25};function at(e){if(!(this instanceof at))return new at(e);this.version=n(332).version,e=Object.assign({},st,e),this._tickRate=e.tickRate,this._lastRenderTime=0,this._paused=!1,this._dragOutsideLock=e.dragCameraOutsidePointerLock;var t=this;if(!e.silent){var r=e.debug?" (debug)":"";console.log(`noa-engine v${this.version}${r}`)}this.worldOriginOffset=[0,0,0],this._originRebaseDistance=e.originRebaseDistance,this.vec3=tt,this.positionInCurrentTick=0,this.worldName="default",this.container=function(e,t){return new o(e,t)}(this,e),this.inputs=xe(0,e,this.container.element),this.registry=function(e,t){return new Ge(e,t)}(this,e),this.world=function(e,t){return new ce(e,t)}(this,e),this.rendering=function(e,t,n){return new C(e,t,n)}(this,e,this.container.canvas),this.physics=Pe(this,e),this.entities=function(e,t){return new Qe(e,t)}(this,e),this.ents=this.entities;var i=this.ents;this.playerEntity=i.add(e.playerStart,e.playerWidth,e.playerHeight,null,null,!0,!0),i.addComponent(this.playerEntity,i.names.collideTerrain),i.addComponent(this.playerEntity,i.names.collideEntities);var s=i.getPhysicsBody(this.playerEntity);s.gravityMultiplier=2,s.autoStep=e.playerAutoStep,i.addComponent(this.playerEntity,i.names.receivesInputs),i.addComponent(this.playerEntity,i.names.fadeOnZoom);var a,u,c;i.addComponent(this.playerEntity,i.names.movement,{airJumps:1}),this.camera=function(e,t){return new Be(e,t)}(this,e),this.blockTestDistance=e.blockTestDistance,this.blockTargetIdCheck=this.registry.getBlockSolidity,this.targetedBlock=null,e.skipDefaultHighlighting||(this.defaultBlockHighlightFunction=function(e){e?t.rendering.highlightBlockFace(!0,e.position,e.normal):t.rendering.highlightBlockFace(!1)},this.on("targetBlockChanged",this.defaultBlockHighlightFunction)),e.debug&&(window.noa=this,window.scene=this.rendering._scene,window.ndarray=nt,window.vec3=tt,i.getMovement(1).airJumps=999,this.setViewDistance=function(e){var t=this.world.chunkSize;this.world.chunkAddDistance=e/t,this.world.chunkRemoveDistance=e/t+1,this.world._lastPlayerChunkID=""}),u="0.27",(c=(e,t,n)=>{var r=()=>{throw`This property changed in ${u} - ${n}`};Object.defineProperty(e,t,{get:r,set:r})})(a=this,"getPlayerEyePosition","to get the camera/player offset see API docs for `noa.camera.cameraTarget`"),c(a,"setPlayerEyePosition","to set the camera/player offset see API docs for `noa.camera.cameraTarget`"),c(a,"getPlayerPosition","use `noa.ents.getPosition(noa.playerEntity)` or similar"),c(a,"getCameraVector","use `noa.camera.getDirection`"),c(a,"getPlayerMesh","use `noa.ents.getMeshData(noa.playerEntity).mesh` or similar"),c(a,"playerBody","use `noa.ents.getPhysicsBody(noa.playerEntity)`"),c(a.rendering,"zoomDistance","use `noa.camera.zoomDistance`"),c(a.rendering,"_currentZoom","use `noa.camera.currentZoom`"),c(a.rendering,"_cameraZoomSpeed","use `noa.camera.zoomSpeed`"),c(a.rendering,"getCameraVector","use `noa.camera.getDirection`"),c(a.rendering,"getCameraPosition","use `noa.camera.getLocalPosition`"),c(a.rendering,"getCameraRotation","use `noa.camera.heading` and `noa.camera.pitch`"),c(a.rendering,"setCameraRotation","to customize camera behavior see API docs for `noa.camera`"),u="0.28",c(a.rendering,"makeMeshInstance","removed, use Babylon's `mesh.createInstance`"),c(a.world,"_maxChunksPendingCreation",'use `maxChunksPendingCreation` (no "_")'),c(a.world,"_maxChunksPendingMeshing",'use `maxChunksPendingMeshing` (no "_")'),c(a.world,"_maxProcessingPerTick",'use `maxProcessingPerTick` (no "_")'),c(a.world,"_maxProcessingPerRender",'use `maxProcessingPerRender` (no "_")'),u="0.29",c(a,"_constants","removed, voxel IDs are no longer packed with bit flags")}at.prototype=Object.create(it.prototype),at.prototype.tick=function(){if(this._paused)this.world.worldGenWhilePaused&&this.world.tick(e);else{ft("start"),function(e){var t=e.ents.getPositionData(e.playerEntity)._localPosition,n=e._originRebaseDistance;if(tt.sqrLen(t)<n*n)return;for(var r=[],i=0;i<3;i++){var o=Math.floor(t[i]);r[i]=o,e.worldOriginOffset[i]+=o}e.rendering._rebaseOrigin(r),e.entities._rebaseOrigin(r)}(this);var e=this._tickRate;if(this.world.tick(e),ft("world"),this.world.playerChunkLoaded){this.physics.tick(e),ft("physics"),this.rendering.tick(e),ft("rendering"),function(e){var t="",n=e.blockTargetIdCheck||e.registry.getBlockSolidity,r=e._localPick(null,null,null,n);if(r){var i=lt;tt.floor(i.adjacent,r.position),tt.copy(i.normal,r.normal),tt.sub(i.position,i.adjacent,i.normal),i.blockID=e.world.getBlockID(i.position[0],i.position[1],i.position[2]),e.targetedBlock=i,t=i.position.join("|")+i.normal.join("|")+"|"+i.blockID}else e.targetedBlock=null;t!=ht&&(e.emit("targetBlockChanged",e.targetedBlock),ht=t)}(this),ft("targets"),this.entities.tick(e),ft("entities"),this.emit("tick",e),ft("tick event"),ft("end");var t=this.inputs.state;t.scrollx=t.scrolly=t.scrollz=0}else this.rendering.tick(e)}},at.prototype.render=function(e){this.positionInCurrentTick=e;var t=performance.now(),n=t-(this._lastRenderTime||t-16);this._lastRenderTime=t,this._paused?this.world.worldGenWhilePaused&&this.world.render():(dt("start"),(this.container.hasPointerLock||!this.container.supportsPointerLock||this._dragOutsideLock&&this.inputs.state.fire)&&this.camera.applyInputsToCamera(),dt("init"),this.world.render(n),dt("meshing"),this.camera.updateBeforeEntityRenderSystems(),this.entities.render(n),this.camera.updateAfterEntityRenderSystems(),dt("entities"),this.emit("beforeRender",n),dt("before render"),this.rendering.render(n),dt("render"),this.emit("afterRender",n),dt("after render"),dt("end"),this.inputs.state.dx=this.inputs.state.dy=0)},at.prototype.globalToLocal=function(e,t,n){var r=this.worldOriginOffset;if(t){for(var i=0;i<3;i++){var o=e[i]-r[i];o+=t[i],n[i]=o}return n}return tt.sub(n,e,r)},at.prototype.localToGlobal=function(e,t,n){var r=this.worldOriginOffset;if(n){for(var i=0;i<3;i++){var o=Math.floor(e[i]);t[i]=o+r[i],n[i]=e[i]-o}return t}return tt.add(t,e,r)},at.prototype.setPaused=function(e){this._paused=!!e,e||(this.inputs.state.dx=this.inputs.state.dy=0)},at.prototype.getBlock=function(e,t,n){return e.length?this.world.getBlockID(e[0],e[1],e[2]):this.world.getBlockID(e,t,n)},at.prototype.setBlock=function(e,t,n,r){return t.length?this.world.setBlockID(e,t[0],t[1],t[2]):this.world.setBlockID(e,t,n,r)},at.prototype.addBlock=function(e,t,n,r){if(t.length){if(this.entities.isTerrainBlocked(t[0],t[1],t[2]))return;return this.world.setBlockID(e,t[0],t[1],t[2]),e}if(!this.entities.isTerrainBlocked(t,n,r))return this.world.setBlockID(e,t,n,r),e},at.prototype.pick=function(e,t,n,r){return 0===n?null:(e&&(this.globalToLocal(e,null,ut),e=ut),this._localPick(e,t,n,r))};var ut=tt.create();at.prototype._localPick=function(e,t,n,r){if(0===n)return null;var i=r||this.registry.getBlockSolidity,o=this.world,s=this.worldOriginOffset;e||(e=this.camera._localGetTargetPosition()),t=t||this.camera.getDirection(),n=n||this.blockTestDistance;var a=ct._localPosition,u=ct.normal;return rt((function(e,t,n){var r=o.getBlockID(e+s[0],t+s[1],n+s[2]);return i(r)}),e,t,n,a,u)?(tt.scaleAndAdd(a,a,u,.01),this.localToGlobal(a,ct.position),ct):null};var ct={_localPosition:tt.create(),position:[0,0,0],normal:[0,0,0]};var lt={blockID:0,position:[],normal:[],adjacent:[]},ht="";var ft=()=>{},dt=()=>{},pt=n(108);var mt,vt,gt,yt=n(333),bt={};n(245);var wt=new ot({debug:!0,showFPS:!0,inverseY:!0,inverseX:!1,chunkSize:32,chunkAddDistance:3.5,chunkRemoveDistance:3,blockTestDistance:50,texturePath:"textures/",playerStart:[.5,5,.5],playerHeight:1.4,playerWidth:.6,playerAutoStep:!0,useAO:!0,AOmultipliers:[.92,.8,.5],reverseAOmultiplier:1,manuallyControlChunkLoading:!1});!function(e,t){e.worldName="world1",e.inputs.bind("swap-world","O"),e.inputs.down.on("swap-world",(function(){e.worldName="world1"===e.worldName?"world2":"world1"})),e.world.on("chunkBeingRemoved",(function(e,t,n){((e,t)=>{bt[e]=yt.encode(t.data)})(e,t)}));var n=[];function r(e,t,n,r){return.8+2*Math.sin(e/n)+(.4+2*Math.sin(t/r+e/30))}function i(e,n,r,i){if(e>0&&r>0){var o=1;return 63!=r&&63!=e||(o=20),n<o?t.grassID:0}return n<i?n<0?t.dirtID:t.grassID:n>=1?0:n%2?t.waterID:t.water2ID}function o(t,n,r,i){for(var o=0;o<t;o++)e.setBlock(i,n+o,1,r+o),e.setBlock(i,2*t+n-o,1,r+o)}e.world.on("worldDataNeeded",(function(e,t,r,i,o,s){n.push({id:e,array:t,x:r,y:i,z:o,worldName:s})})),setInterval((function(){if(0!==n.length){var o,s=n.shift();o=s.id,bt[o]?((e,t)=>{yt.decode(bt[e],t.data)})(s.id,s.array):function(e,n,o,s,a){"world1"===a&&function(e,t,n,o){for(var s=0;s<e.shape[0];++s)for(var a=0;a<e.shape[2];++a)for(var u=r(t+s,o+a,10,30),c=0;c<e.shape[1];++c){var l=i(t+s,n+c,o+a,u);l&&e.set(s,c,a,l)}}(e,n,o,s);"world2"===a&&function(e,n,o,s){for(var a=0;a<e.shape[0];++a)for(var u=0;u<e.shape[2];++u)for(var c=r(n+a,s+u,20,40),l=0;l<e.shape[1];++l){var h=i(n+a,o+l,s+u,c);h===t.grassID&&(h=t.grass2ID),h&&e.set(a,l,u,h)}}(e,n,o,s)}(s.array,s.x,s.y,s.z,s.worldName),e.world.setChunkData(s.id,s.array)}}),10),setTimeout((function(){!function(){e.setBlock(t.testID1,-6,5,6),e.setBlock(t.testID2,-4,5,6),e.setBlock(t.testID3,-2,5,6),e.setBlock(t.windowID,-5,3,6),e.setBlock(t.windowID,-4,3,6),e.setBlock(t.windowID,-3,3,6),e.setBlock(t.testa,-6,4,6),e.setBlock(t.testb,-5,4,6),e.setBlock(t.testc,-4,4,6),e.setBlock(t.waterPole,-18,-1,6),e.setBlock(t.waterPole,-16,-1,6),e.setBlock(t.waterPole,-14,-1,6);var n=5;o(10,5,n,t.shinyDirtID),o(10,5,n+2,t.dirtID),o(10,5,n+5,t.dirtID),o(10,5,n+9,t.dirtID),o(10,5,n+14,t.dirtID),o(10,5,n+=18,t.customID),o(10,5,n+2,t.customID),o(10,5,n+5,t.customID),o(10,5,n+9,t.customID),o(10,5,n+14,t.customID)}()}),1e3)}(wt,function(e){var t=[.45,.36,.22];e.registry.registerMaterial("grass",[.1,.8,.2],null),e.registry.registerMaterial("grass2",[.1,.6,.2],null),e.registry.registerMaterial("dirt",t,null,!1);for(var n=["a","b","c","d","1","2"],r=0;r<6;r++){var i=n[r];e.registry.registerMaterial(i,null,i+".png"),e.registry.registerMaterial("t"+i,null,"t"+i+".png",!0)}e.registry.registerMaterial("water",[.5,.5,.8,.7],null),e.registry.registerMaterial("water2",[.5,.5,.8,.7],null);var o=e.rendering.getScene(),s=e.rendering.makeStandardMaterial("");s.diffuseTexture=new pt.w("textures/window.png",o),s.opacityTexture=s.diffuseTexture,e.registry.registerMaterial("window",null,null,!1,s);var a=e.rendering.makeStandardMaterial("shinyDirtMat");a.specularColor.copyFromFloats(1,1,1),a.specularPower=32,a.bumpTexture=new pt.w("textures/stone.png",o),e.registry.registerMaterial("shinyDirt",t,null,!1,a);var u=_.a.CreateBox("b",1,o),c=w.k.Scaling(.2,1,.2);c.setTranslation(new w.z(0,.5,0)),u.bakeTransformIntoVertices(c),o.removeMesh(u);var l={},h=1;l.dirtID=e.registry.registerBlock(h++,{material:"dirt"}),l.shinyDirtID=e.registry.registerBlock(h++,{material:"shinyDirt"}),l.grassID=e.registry.registerBlock(h++,{material:"grass"}),l.grass2ID=e.registry.registerBlock(h++,{material:"grass2"}),l.testID1=e.registry.registerBlock(h++,{material:["b","d","1","2","c","a"]}),l.windowID=e.registry.registerBlock(h++,{material:"window",opaque:!1}),l.testID2=e.registry.registerBlock(h++,{material:["tb","td","t1","t2","tc","ta"],opaque:!1}),l.testID3=e.registry.registerBlock(h++,{material:["1","2","a"]}),l.waterID=e.registry.registerBlock(h++,{material:"water",fluid:!0}),l.water2ID=e.registry.registerBlock(h++,{material:"water2",fluid:!0}),l.customID=e.registry.registerBlock(h++,{blockMesh:u,opaque:!1,onCustomMeshCreate:function(e,t,n,r){e.rotation.y=(1.234*(t+.234)+6.78*(r+.567))%(2*Math.PI)}}),l.waterPole=e.registry.registerBlock(h++,{blockMesh:u,solid:!0,opaque:!1,material:"water",fluid:!0});var f=t=>{var n=e.rendering.makeStandardMaterial("");n.backFaceCulling=!1,n.diffuseTexture=new pt.w("textures/"+t+".png"),n.diffuseTexture.hasAlpha=!0,window.t=n;var r=_.a.CreatePlane("cross",1,o);r.material=n,r.rotation.x+=Math.PI,r.rotation.y+=Math.PI/4;let i=w.k.Translation(0,-.5,0);r.bakeTransformIntoVertices(i);let s=r.clone();return s.rotation.y+=Math.PI/2,_.a.MergeMeshes([r,s],!0)};return l.testa=e.registry.registerBlock(h++,{blockMesh:f("ta"),opaque:!1}),l.testb=e.registry.registerBlock(h++,{blockMesh:f("tb"),opaque:!1}),l.testc=e.registry.registerBlock(h++,{blockMesh:f("tc"),opaque:!1}),l}(wt)),function(e){var t=e.playerEntity,n=e.entities.getPositionData(t),r=n.width,i=n.height,o=_.a.CreateBox("player",1,e.rendering.getScene());o.scaling.x=o.scaling.z=r,o.scaling.y=i;var s=[0,i/2,0];e.entities.addComponent(t,e.entities.names.mesh,{mesh:o,offset:s})}(wt),function(e){e.inputs.down.on("fire",(function(){e.targetedBlock&&e.setBlock(0,e.targetedBlock.position)}));var t=1;e.inputs.down.on("alt-fire",(function(){e.targetedBlock&&e.addBlock(t,e.targetedBlock.adjacent)})),e.inputs.down.on("mid-fire",(function(){e.targetedBlock&&(t=e.targetedBlock.blockID)})),e.inputs.bind("pause","P"),e.inputs.down.on("pause",(function(){r=!r,e.setPaused(r)}));var r=!1;e.inputs.bind("shoot","1");var i,o,s=()=>function(e){var t=e.entities;mt||(mt=_.a.CreateSphere("ball",6,.4,e.rendering.getScene()));var n=t.getPosition(e.playerEntity),r=[n[0],n[1]+.5,n[2]],i=mt.createInstance("ball_instance"),o=[0,.2,0],s=e.entities.add(r,.4,.4,i,o,!0,!0),a=t.getPhysicsBody(s);a.restitution=.8,a.friction=.7;for(var u=e.camera.getDirection(),c=[],l=0;l<3;l++)c[l]=5*u[l];c[1]+=1,a.applyImpulse(c),vt||(vt=(e,n)=>{for(var r=t.getPosition(e),i=t.getPosition(n),o=[],s=0;s<3;s++)o[s]=2*(r[s]-i[s]);t.getPhysicsBody(e).applyImpulse(o)}),t.addComponent(s,t.names.collideEntities,{cylinder:!0,callback:e=>vt(s,e)}),gt||(gt=t.createComponent({name:"remove",system:(n,r)=>{var i=t.getPosition(e.playerEntity);r.forEach(e=>{for(var n=t.getPosition(e.__id),r=0,o=0;o<3;o++)r+=Math.abs(i[o]-n[o]);r>500&&t.deleteEntity(e.__id)})}})),t.addComponent(s,gt)}(e);e.inputs.down.on("shoot",(function(){s(),o=setTimeout(()=>{i=setInterval(s,50)},400)})),e.inputs.up.on("shoot",(function(){clearTimeout(o),clearInterval(i)})),e.on("tick",(function(t){var n=e.inputs.state.scrolly;0!==n&&(e.camera.zoomDistance+=n>0?1:-1,e.camera.zoomDistance<0&&(e.camera.zoomDistance=0),e.camera.zoomDistance>10&&(e.camera.zoomDistance=10))}));var a=!1,u=e.rendering.getScene();e.inputs.bind("debug","Z"),e.inputs.down.on("debug",()=>{n.e(2).then(n.t.bind(null,381,7)).then(e=>{(a=!a)?u.debugLayer.show():u.debugLayer.hide()})})}(wt)}]);
//# sourceMappingURL=bundle.js.map