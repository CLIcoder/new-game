{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:////Users/andy/dev/game/noa-examples/node_modules/tslib/tslib.es6.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/index.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/events/events.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/ndarray/ndarray.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/aabb-3d/index.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/typedarray-pool/pool.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/components/position.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/components/physics.js","webpack:///(webpack)/buildin/global.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/epsilon.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/create.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/fromValues.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/normalize.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/dot.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/subtract.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/multiply.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/divide.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/distance.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/squaredDistance.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/length.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/squaredLength.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/iota-array/iota.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/voxel-aabb-sweep/index.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/box-intersect/lib/sweep.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/box-intersect/node_modules/bit-twiddle/twiddle.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/box-intersect/lib/partition.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/clone.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/angle.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/copy.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/set.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/equals.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/exactEquals.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/add.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/sub.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/mul.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/div.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/min.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/max.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/floor.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/ceil.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/round.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/scale.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/scaleAndAdd.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/dist.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/sqrDist.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/len.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/sqrLen.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/negate.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/inverse.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/cross.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/lerp.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/random.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/transformMat4.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/transformMat3.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/transformQuat.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/rotateX.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/rotateY.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/rotateZ.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/gl-vec3/forEach.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/is-buffer/index.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/fast-voxel-raycast/index.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/game-shell/shell.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/util/util.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/process/browser.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/util/support/isBufferBrowser.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/util/node_modules/inherits/inherits_browser.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/domready/ready.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/game-shell/node_modules/vkey/index.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/invert-hash/invert.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/uniq/uniq.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/binary-search-bounds/search-bounds.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/game-shell/lib/raf-polyfill.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/game-shell/lib/mousewheel-polyfill.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/game-shell/lib/hrtime-polyfill.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/game-inputs/inputs.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/vkey/index.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/game-inputs/lib/mousewheel-polyfill.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/voxel-physics-engine/src/index.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/voxel-physics-engine/src/rigidBody.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/ent-comp/src/ECS.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/ent-comp/src/dataStore.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/components sync nonrecursive \\.js$","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/components/collideEntities.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/box-intersect/index.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/typedarray-pool/node_modules/bit-twiddle/twiddle.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/dup/dup.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/buffer/index.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/base64-js/index.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/ieee754/index.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/isarray/index.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/box-intersect/lib/sort.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/box-intersect/lib/intersect.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/box-intersect/lib/brute.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/box-intersect/lib/median.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/components/collideTerrain.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/components/fadeOnZoom.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/components/followsEntity.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/components/mesh.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/components/movement.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/components/receivesInputs.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/components/shadow.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/components/smoothCamera.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/voxel-crunch/index.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/bit-twiddle/twiddle.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/lib/container.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/lib/util.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/lib/rendering.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/lib/constants.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/lib/terrainMesher.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/lib/objectMesher.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/lib/chunk.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/lib/world.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/lib/inputs.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/lib/physics.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/lib/camera.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/lib/registry.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/lib/entities.js","webpack:////Users/andy/dev/game/noa-examples/node_modules/noa-engine/src/index.js","webpack:///./worldgen.js","webpack:///./entities.js","webpack:///./index.js","webpack:///./registration.js","webpack:///./actions.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","1","exports","module","l","e","promises","installedChunkData","promise","Promise","resolve","reject","onScriptComplete","script","document","createElement","charset","timeout","nc","setAttribute","src","p","jsonpScriptSrc","error","Error","event","onerror","onload","clearTimeout","chunk","errorType","type","realSrc","target","message","name","request","undefined","setTimeout","head","appendChild","all","m","c","d","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","oe","err","console","jsonpArray","window","oldJsonpFunction","slice","extendStatics","b","setPrototypeOf","__proto__","Array","__extends","__","this","constructor","__assign","assign","arguments","__decorate","decorators","desc","getOwnPropertyDescriptor","Reflect","decorate","__awaiter","thisArg","_arguments","P","generator","step","next","rejected","done","then","__generator","body","f","y","g","_","label","sent","trys","ops","verb","iterator","v","op","TypeError","pop","EPSILON","clone","angle","fromValues","copy","set","equals","exactEquals","add","subtract","sub","multiply","mul","divide","div","min","max","floor","ceil","round","scale","scaleAndAdd","distance","dist","squaredDistance","sqrDist","len","squaredLength","sqrLen","negate","inverse","normalize","dot","cross","lerp","random","transformMat4","transformMat3","transformQuat","rotateX","rotateY","rotateZ","forEach","ReflectOwnKeys","R","ReflectApply","receiver","args","Function","ownKeys","getOwnPropertySymbols","getOwnPropertyNames","concat","NumberIsNaN","Number","isNaN","EventEmitter","init","_events","_eventsCount","_maxListeners","defaultMaxListeners","checkListener","listener","_getMaxListeners","that","_addListener","prepend","events","existing","warning","newListener","emit","unshift","warned","w","String","emitter","count","warn","onceWrapper","fired","removeListener","wrapFn","_onceWrap","state","wrapped","_listeners","unwrap","evlistener","arr","ret","unwrapListeners","arrayClone","listenerCount","arg","RangeError","getPrototypeOf","setMaxListeners","getMaxListeners","doError","er","context","handler","listeners","addListener","on","prependListener","once","prependOnceListener","list","position","originalListener","index","spliceOne","off","removeAllListeners","keys","rawListeners","eventNames","iota","isBuffer","hasTypedArrays","Float64Array","compare1st","a","order","stride","terms","Math","abs","sort","compileConstructor","dtype","dimension","className","join","useGetters","code","procedure","CACHED_CONSTRUCTORS","indices","map","index_str","shapeArg","strideArg","a_vars","c_vars","tShape","tStride","idx","shape","offset","ctor","array","sz","toString","isArray","arrayDType","ctor_list","AABB","vec3","pos","vec","pos2","base","mag","proto","width","height","depth","x0","y0","z0","x1","y1","z1","translate","by","setPosition","expand","aabb","intersects","touches","intersection","union","base_x","base_y","base_z","bits","dup","Buffer","global","__TYPEDARRAY_POOL","UINT8","UINT16","UINT32","BIGUINT64","INT8","INT16","INT32","BIGINT64","FLOAT","DOUBLE","DATA","UINT8C","BUFFER","hasUint8C","Uint8ClampedArray","hasBigUint64","BigUint64Array","hasBigInt64","BigInt64Array","POOL","freeArrayBuffer","buffer","byteLength","log_n","log2","mallocArrayBuffer","nextPow2","ArrayBuffer","mallocUint8","Uint8Array","mallocUint16","Uint16Array","mallocUint32","Uint32Array","mallocInt8","Int8Array","mallocInt16","Int16Array","mallocInt32","Int32Array","mallocFloat","Float32Array","mallocDouble","mallocUint8Clamped","mallocBigUint64","mallocBigInt64","mallocDataView","DataView","mallocBuffer","cache","free","freeUint8","freeUint16","freeUint32","freeBigUint64","freeInt8","freeInt16","freeInt32","freeBigInt64","freeFloat32","freeFloat","freeFloat64","freeDouble","freeUint8Clamped","freeDataView","freeBuffer","malloc","mallocFloat32","mallocFloat64","clearCache","updatePositionExtents","hw","lpos","_localPosition","ext","_extents","_renderPosition","onAdd","eid","noa","globalToLocal","onRemove","system","dt","states","worldOriginOffset","entID","physics","addBody","setPhysicsFromPosition","ents","getPositionData","__id","hasPosition","pdat","setPositionFromPhysics","backtrackRenderPos","removeBody","renderSystem","backtrackAmt","positionInCurrentTick","_tickRate","id","smoothed","cameraSmoothed","local","physState","posState","box","vel","velocity","out","x","z","sqrt","tr_arr","ldi_arr","tri_arr","step_arr","tDelta_arr","tNext_arr","vec_arr","normed_arr","base_arr","max_arr","left_arr","result_arr","getVoxel","dir","callback","noTranslate","epsilon","tr","ldi","tri","tDelta","tNext","normed","cumulative_t","max_t","axis","initSweep","stepForward","checkCollision","handleCollision","lead","leadEdgeToInt","trailEdgeToInt","Infinity","i_axis","stepx","stepy","stepz","left","dv","coord","sweep_impl","rcount","RED_SWEEP_QUEUE","pool","RED_SWEEP_INDEX","BLUE_SWEEP_QUEUE","BLUE_SWEEP_INDEX","COMMON_SWEEP_QUEUE","COMMON_SWEEP_INDEX","eventLength","SWEEP_EVENTS","sweepBipartite","visit","redStart","redEnd","red","redIndex","blueStart","blueEnd","blue","blueIndex","ptr","elemSize","istart","iend","redOffset","blueOffset","isort","redActive","blueActive","sqPop","retval","sqPush","sweepComplete","commonActive","color","scanBipartite","flip","redShift","blueShift","isRed","blueId","bluePtr","b0","b1","red_loop","oidx","redPtr","k","redId","scanComplete","INIT_CAPACITY","queue","item","top","countTrailingZeros","INT_BITS","INT_MAX","INT_MIN","sign","mask","isPow2","log10","popCount","prevPow2","parity","REVERSE_TABLE","tab","reverse","interleave2","deinterleave2","interleave3","deinterleave3","nextCombination","predicate","fargs","split","reads","indexOf","replace","tempA","tempB","cosine","acos","a0","a1","a2","b2","ax","ay","az","bx","bz","PI","zScale","cos","sin","q","qx","qy","qz","qw","ix","iy","iz","iw","py","pz","sc","cc","px","fn","obj","readFloatLE","isSlowBuffer","_isBuffer","origin","direction","max_d","hit_pos","hit_norm","dx","dy","dz","ds","txDelta","tyDelta","tzDelta","txMax","tyMax","tzMax","steppedIndex","traceRay_impl","util","domready","vkey","invert","uniq","bsearch","addMouseWheel","hrtime","filtered_vkey","charAt","substring","parseInt","keyNames","virtualKeyCode","eq","physicalKeyCode","GameShell","_curKeyState","_pressCount","_releaseCount","_tickInterval","_rafHandle","_lastTick","_frameTime","_paused","_width","_height","_wantFullscreen","_wantPointerLock","_fullscreenActive","_pointerLockActive","_rafFunction","tickOrRender","preventDefaults","stopPropagation","element","bindings","frameSkip","tickCount","frameCount","startTime","tickTime","frameTime","stickyFullscreen","stickyPointerLock","scroll","mouseX","mouseY","prevMouseX","prevMouseY","inherits","lookupCount","kc","tryFullscreen","shell","elem","requestFullscreen","requestFullScreen","webkitRequestFullscreen","webkitRequestFullScreen","mozRequestFullscreen","mozRequestFullScreen","requestPointerLock","webkitRequestPointerLock","mozRequestPointerLock","msRequestPointerLock","oRequestPointerLock","virtual_key","physical_key","keybinds","unbind","down","lookupKey","wasDown","press","up","wasUp","release","setInterval","requestAnimationFrame","clearInterval","cancelFullscreen","exitFullscreen","cancelFullScreen","webkitCancelFullscreen","webkitCancelFullScreen","mozCancelFullscreen","mozCancelFullScreen","handleFullscreen","fullscreen","mozFullScreen","webkitIsFullScreen","exitPointerLock","webkitExitPointerLock","mozExitPointerLock","handlePointerLockChange","pointerLockElement","mozPointerLockElement","webkitPointerLockElement","setKeyState","doRender","skip","pCount","rCount","tick","render","handleEvent","ev","preventDefault","handleKeyUp","keyCode","char","which","charCode","handleKeyDown","activeElement","isFocused","metaKey","handleBlur","clientWidth","clientHeight","mouseCodes","handleMouseMove","movementX","mozMovementX","webkitMovementX","movementY","mozMovementY","webkitMovementY","clientX","offsetLeft","clientY","offsetTop","handleMouseDown","button","handleMouseUp","handleMouseEnter","handleMouseLeave","buttons","setMouseButtons","handleMouseWheel","deltaMode","deltaX","deltaY","deltaZ","handleContexMenu","handleResizeElement","h","makeDefaultContainer","container","tabindex","style","right","bottom","overflow","options","useFullscreen","usePointerLock","pointerLock","tickRate","sticky","querySelector","getElementById","getElementByClass","handleResize","MutationObserver","observe","attributes","subtree","addEventListener","oncontextmenu","leave","blur","fullscreenChange","pointerLockChange","paused","getOwnPropertyDescriptors","descriptors","formatRegExp","format","isString","objects","inspect","str","JSON","stringify","isNull","isObject","deprecate","msg","process","noDeprecation","throwDeprecation","traceDeprecation","trace","debugEnviron","debugs","opts","ctx","seen","stylize","stylizeNoColor","colors","isBoolean","showHidden","_extend","isUndefined","customInspect","stylizeWithColor","formatValue","styleType","styles","recurseTimes","isFunction","primitive","simple","isNumber","formatPrimitive","visibleKeys","hash","val","arrayToHash","isError","formatError","isRegExp","RegExp","isDate","Date","output","braces","toUTCString","formatProperty","match","formatArray","reduce","prev","cur","numLinesEst","reduceToSingleString","line","substr","ar","re","objectToString","pad","debuglog","env","NODE_DEBUG","toUpperCase","test","pid","isNullOrUndefined","isSymbol","isPrimitive","months","timestamp","time","getHours","getMinutes","getSeconds","getDate","getMonth","prop","log","kCustomPromisifiedSymbol","callbackifyOnRejected","reason","cb","newReason","promisify","original","writable","configurable","promiseResolve","promiseReject","defineProperties","custom","callbackify","callbackified","maybeCb","self","nextTick","rej","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","runTimeout","fun","currentQueue","draining","queueIndex","cleanUpNextTick","drainQueue","run","marker","runClearTimeout","Item","noop","title","browser","argv","version","versions","binding","cwd","chdir","umask","fill","readUInt8","superCtor","super_","TempCtor","fns","doc","hack","loaded","documentElement","doScroll","readyState","removeEventListener","ua","navigator","userAgent","isOSX","isOpera","maybeFirefox","0","2","3","4","5","6","8","9","12","13","16","17","18","19","20","21","23","24","25","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","91","92","93","95","106","107","108","109","110","111","144","145","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","186","187","188","189","190","191","192","219","220","221","222","223","224","226","229","231","246","247","248","249","250","251","252","253","254","fromCharCode","compare","sorted","unique_pred","unique_eq","compileSearch","funcName","reversed","extraArgs","useNdarray","earlyOut","compileBoundsSearch","suffix","ge","gt","lt","le","lastTime","vendors","cancelAnimationFrame","currTime","getTime","timeToCall","_addEventListener","support","prefix","_addWheelListener","eventName","useCapture","originalEvent","srcElement","delatZ","returnValue","wheelDelta","wheelDeltaX","detail","onmousewheel","performance","now","webkitNow","Inputs","allowContextMenu","disabled","scrollx","scrolly","scrollz","_keybindmap","_keyStates","_bindPressCounts","_ignoreMousemoveOnce","initEvents","onKeyEvent","inputs","handleKeyEvent","onMouseEvent","onContextMenu","onMouseMove","xy","touch","changedTouches","identifier","lastTouchID","res","lastTouchX","lastTouchY","getTouchMovement","domElement","onTouchStart","onMouseWheel","onLockChange","vkeyCode","getBoundKeys","innerHeight","keycode","vcode","XOR","handleBindingEvent","ct","sweep","RigidBody","testSolid","testFluid","Physics","defaults","gravity","minBounceImpulse","airDrag","fluidDrag","fluidDensity","bodies","_aabb","mass","friction","restitution","gravMult","onCollide","impacts","oldResting","noGravity","resting","_forces","_impulses","localNoGrav","gravityMultiplier","_sleepFrameCount","isResting","gmult","sleepVec","bodyAsleep","cx","cz","inFluid","ratioInFluid","submerged","cy","displaced","_fluidVec","applyForce","applyFluidForces","sanityCheck","applyFrictionByAxis","drag","mult","autoStep","cloneAABB","tmpBox","processCollisions","oldBox","xBlocked","zBlocked","ratio","targetPos","getVoxels","ydist","upvec","collided","leftover","tmpResting","onStep","tryAutoStepping","applyImpulse","_markActive","iterateBody","dvel","restDir","vNormal","lateralVel","vCurr","dvMax","scaler","tgt","_ratioInFluid","getPosition","atRestX","atRestY","atRestZ","ECS","components","comps","UID","storage","systems","renderSystems","deferredEntityRemovals","deferredCompRemovals","deferredMultiCompRemovals","deleteEntityNow","compName","removeComponentNow","def","multi","DataStore","remove","removeMultiCompNow","stateObj","statesArr","makeDeferralTimeout","deferralTimeoutPending","runAllDeferredRemovals","_storage","_systems","_renderSystems","createEntity","compList","addComponent","deleteEntity","immediately","createComponent","compDefn","internalDef","deleteComponent","removeComponent","pendingRemoval","doDeferredComponentRemovals","newState","hasComponent","getState","getStatesList","getStateAccessor","getComponentAccessor","removeMultiComponent","stateToRemove","ecs","doDeferredMultiComponentRemovals","doDeferredEntityRemovals","_map","movedItem","movedID","webpackContext","req","webpackContextResolve","boxIntersect","intervals","cylinder","collideBits","collideMask","dat","stateA","stateB","intervalA","intervalB","rada","radb","radsum","cylinderCylinderTest","cylinderBoxTest","cylindricalHitTest","idA","idB","onPairwiseEntityCollision","cyl","cube","rad","clamp","lo","hi","arg0","arg1","arg2","intersectFullArray","intersectBipartiteArray","RESULT","boxIntersectIter","boxEmpty","convertBoxes","boxes","ids","full","redList","redIds","blueList","blueIds","appendItem","dupe_number","dupe_array","base64","ieee754","kMaxLength","TYPED_ARRAY_SUPPORT","createBuffer","encodingOrOffset","allocUnsafe","from","byteOffset","fromArrayLike","fromArrayBuffer","string","encoding","isEncoding","actual","write","fromString","checked","fromObject","assertSize","size","isView","loweredCase","utf8ToBytes","base64ToBytes","toLowerCase","slowToString","start","end","hexSlice","utf8Slice","asciiSlice","latin1Slice","base64Slice","utf16leSlice","swap","bidirectionalIndexOf","arrayIndexOf","lastIndexOf","indexSize","arrLength","valLength","read","buf","readUInt16BE","foundIndex","found","hexWrite","remaining","strLen","parsed","utf8Write","blitBuffer","asciiWrite","byteArray","charCodeAt","asciiToBytes","latin1Write","base64Write","ucs2Write","units","utf16leToBytes","fromByteArray","secondByte","thirdByte","fourthByte","tempCodePoint","firstByte","codePoint","bytesPerSequence","codePoints","decodeCodePointsArray","SlowBuffer","alloc","INSPECT_MAX_BYTES","foo","subarray","typedArraySupport","poolSize","_augment","species","allocUnsafeSlow","swap16","swap32","swap64","thisStart","thisEnd","thisCopy","targetCopy","includes","isFinite","toJSON","_arr","toHex","bytes","checkOffset","checkInt","objectWriteUInt16","littleEndian","objectWriteUInt32","checkIEEE754","writeFloat","noAssert","writeDouble","newBuf","sliceLen","readUIntLE","readUIntBE","readUInt16LE","readUInt32LE","readUInt32BE","readIntLE","pow","readIntBE","readInt8","readInt16LE","readInt16BE","readInt32LE","readInt32BE","readFloatBE","readDoubleLE","readDoubleBE","writeUIntLE","writeUIntBE","writeUInt8","writeUInt16LE","writeUInt16BE","writeUInt32LE","writeUInt32BE","writeIntLE","limit","writeIntBE","writeInt8","writeInt16LE","writeInt16BE","writeInt32LE","writeInt32BE","writeFloatLE","writeFloatBE","writeDoubleLE","writeDoubleBE","targetStart","INVALID_BASE64_RE","leadSurrogate","toByteArray","trim","stringtrim","base64clean","dst","b64","lens","getLens","validLen","placeHoldersLen","tmp","Arr","_byteLength","curByte","revLookup","uint8","extraBytes","parts","len2","encodeChunk","lookup","num","isLE","mLen","nBytes","eLen","eMax","eBias","nBits","NaN","rt","LN2","n0","insertionSort","quickSort","sixth","index1","index5","index3","index2","index4","el1","el2","el3","el4","el5","less","great","pivot1X","pivot1Y","pivot2X","pivot2Y","ptr0","ptr2","ptr4","ptr5","ptr6","ptr7","i1","move","comparePivot","rotate","shufflePivot","jptr","initFull","xSize","xBoxes","xIndex","ySize","yBoxes","yIndex","levels","maxInts","BOX_ISTACK","maxDoubles","BOX_DSTACK","iterInit","iterPush","iptr","dptr","partitionStartLessThan","partitionEndLessThanEqual","redCount","blueCount","bruteForcePartial","red0","partitionInteriorContainsInterval","bruteForceFull","blue0","findMedian","mid","blue1","partitionStartEqual","onePointFull","onePointPartial","red1","partitionContainsPoint","redX","partitionContainsPointProper","bruteForce","partial","genPartition","blueX","r0","r1","ARGS","bruteForcePlanner","invoke","redMajor","redLoop","blueLoop","generateBruteForce","codeStr","proc","pivot","pivot0","value0","pivot1","value1","pivot2","value2","aPtr","bPtr","boxPtr","entities","hasPhysics","getPhysicsBody","impulse","getCollideTerrain","cutoff","_showing","zoom","camera","currentZoom","hasMesh","getMeshData","mesh","visibility","checkZoom","entity","updatePosition","updateRenderPosition","other","names","followsEntity","posDat","rendering","addMeshToScene","rpos","copyFromFloats","dispose","heading","running","jumping","maxSpeed","moveForce","responsiveness","runningFriction","standingFriction","airMoveMult","jumpImpulse","jumpForce","jumpTime","airJumps","_jumpCount","_isJumping","_currjumptime","onGround","canjump","jf","tempvec","tempvec2","speed","zeroVec","pushLen","canPush","pushAmt","applyMovementPhysics","inputState","camHeading","jump","fb","forward","backward","rl","setMovementState","getMovement","shadowDist","scene","getScene","disc","CreateDisc","rotation","material","makeStandardMaterial","diffuseColor","Black","ambientColor","alpha","setEnabled","removeMesh","_mesh","createInstance","cpos","_localGetPosition","getPhysics","physDat","camPos","localY","_localPick","shadowPos","scaling","updateShadowHeight","spos","chunk_len","encode","runs","rptr","nruns","decode","buf_len","cptr","createGameShell","Container","_noa","createContainerDiv","canvas","el","insertBefore","firstChild","getOrCreateCanvas","_shell","createShell","hasPointerLock","supportsPointerLock","pointerInGame","hasFocus","lockChange","detectPointerLock","onShellInit","resize","removeUnorderedListItem","loopForTime","maxTimeInMS","appendTo","htmlElement","setPointerLock","lock","prevRad","prevAnswer","copyNdarrayContents","tgtPos","i0","j0","k0","si","sj","sk","ti","tj","tk","six","tix","doNdarrayCopy","doNdarrayZero","StringList","isEmpty","empty","keyToDistanceFn","mapping","copyFrom","glvec3","showFPS","antiAlias","clearColor","lightDiffuse","lightSpecular","groundLightColor","useAO","AOmultipliers","reverseAOmultiplier","preserveDrawingBuffer","Rendering","aoVals","revAoVal","meshingCutoffTime","_resizeDebounce","_engine","_scene","detachControl","_addComponent","_octree","$","blocks","_selectionOctree","_cameraHolder","_camera","parent","minZ","_camScreen","CreatePlane","_camScreenMat","_camLocBlock","lightVec","arrToColor","_light","diffuse","specular","groundColor","flatMaterial","initScene","longest","last","fps_hook","nt","fps","innerHTML","setUpFPS","profile_hook","cam","tgtLoc","_localGetTargetPosition","pitch","cloc","getBlock","matId","registry","getBlockFaceMaterial","matData","getMaterialData","col","checkCameraEffect","updateCameraForRender","beginFrame","endFrame","pendingResize","highlightBlockFace","show","posArr","normArr","_highlightMesh","hlm","backFaceCulling","emissiveColor","lines","CreateLines","getHighlightMesh","hlpos","slop","isStatic","_containingChunk","_noaContainingChunk","dynamicContent","addToOctree","world","_getChunkByCoords","octreeBlock","entries","freezeWorldMatrix","freezeNormals","remover","removeMeshFromScene","onDisposeObservable","mat","specularColor","prepareChunkForRendering","cs","loc","disposeChunkForRendering","_rebaseOrigin","delta","dvec","meshes","subtractInPlace","_isWorldMatrixFrozen","markAsDirty","minPoint","maxPoint","_boundingVectors","debug_SceneCheck","dyns","octs","numOcts","numSubs","mats","materials","allmats","subMaterials","block","_isDisposed","getIndices","missing","subMeshes","unusedMats","used","avgPerOct","list1","list2","debug_MeshCount","ID_BITS","OBJECT_BIT","constants","SOLID_BIT","OPAQUE_BIT","greedyMesher","GreedyMesher","meshBuilder","MeshBuilder","meshChunk","matGetter","colGetter","ignoreMaterials","cols","_getMaterialVertexColor","ao","vals","rev","voxels","cachedPadded","s2","_vecs","posValues","sizeValues","tgtPosValues","_cachedVecSize","allocateVectors","nab","_neighbors","buildPaddedVoxelArray","edgesOnly","isFull","build","Submesh","positions","normals","uvs","mergeable","mergeSubmeshes","meshDataList","mergeAll","vertices","matIDs","mdat","indexOffset","mergeArrays","numMergeable","url","getMaterialTexture","renderMat","results","submesh","verts","inds","vdat","applyToMesh","multiMat","vertStart","indStart","buildMeshFromSubmesh","matID","ignore","materialCache","tex","NEAREST_SAMPLINGMODE","textureAlpha","hasAlpha","diffuseTexture","makeTerrainMaterial","getTerrainMaterial","ID_MASK","maskCache","aomaskCache","constructMeshMasks","arrT","getMaterial","aoPackFcn","aomask","materialDir","dbase","istride","jstride","kstride","d0","id0","id1","faceDir","getFaceDir","op0","op1","m0","m1","constructMeshDataFromMasks","u","len1","doAO","submeshes","getColor","aoValues","maskCompareFcn","maskCompare","maskCompare_noAO","meshColorFcn","pushMeshColors","pushMeshColors_noAO","maskVal","OUTER","triDir","du","vs","norm0","norm1","norm2","hx","wx","aoVal","ao00","unpackAOMask","ao10","ao11","ao01","pushAOColor","packAOMaskNoReverse","ipos","ineg","a00","a01","a10","a11","solidBit","facingSolid","packAOMask","jpos","kpos","baseCol","skipReverseAO","transpose","len0","buildSPSforMaterialIndex","meshHash","blockHash","_objectBlocks","sps","updatable","blockHandlerLookup","_blockHandlerLookup","objectMeshLookup","_blockMeshLookup","blockID","handlerFn","blockArr","handlers","onCustomMeshCreate","addShape","positionFunction","particle","partIndex","shapeIndex","initChunk","_objectSystems","disposeChunk","removeObjectMeshes","addObjectBlock","ObjMeshDat","removeObjectBlock","buildObjectMeshes","matIndexes","matIndex","merged","buildMesh","solidLookup","opaqueLookup","Chunk","dataArray","requestID","isDisposed","_terrainDirty","_objectsDirty","_solidityLookup","_opacityLookup","setBlockLookups","_terrainMesh","objectMesher","narr","_neighborCount","_maxMeshedNeighbors","_timesMeshed","packVoxelData","callBlockHandler","hobj","affectsTerrain","packID","newID","fullyOpaque","fullyAir","hasObj","packed","callAllBlockHandlers","_createVoxelArray","_updateVoxelArray","getSolidityAt","oldID","oldIDnum","_queueChunkForRemesh","edge","iedge","jedge","kedge","js","ks","terrainMesher","updateMeshes","defaultOptions","chunkSize","chunkAddDistance","chunkRemoveDistance","worldGenWhilePaused","World","playerChunkLoaded","minNeighborsToMesh","maxChunksPendingCreation","maxChunksPendingMeshing","maxProcessingPerTick","maxProcessingPerRender","_cachedWorldName","_lastPlayerChunkID","_chunkStorage","_chunkIDsKnown","_chunkIDsToRequest","_chunkIDsPending","_chunkIDsToMesh","_chunkIDsToMeshFirst","_chunkIDsToRemove","queueChunkForRemesh","_getChunk","getChunkID","_setChunk","_worldCoordToChunkCoord","initChunkStorage","_worldCoordToChunkIndex","parseChunkID","getPlayerChunkCoords","playerEntity","getBlockID","getBlockSolidity","getBlockOpacity","getBlockFluidity","getBlockProperties","getBlockProps","getBlockObjectMesh","getObjectMeshAt","setBlockID","isBoxUnobstructed","setChunkData","userData","reqID","worldName","updateNeighborsOfChunk","profile_queues_hook","invalidateVoxelsInAABB","invalidateChunksInBox","tickStartTime","sortIDListByDistanceFrom","markAllChunksForRemoval","ci","cj","ck","remDistSq","toRemove","chunkID","changedChunks","di","dj","dk","numChunks","rsq","numberOfVoxelsInSphere","addDistSq","known","toRequest","findNewChunksInRange","pending","toMesh","dataArr","requestNewChunk","processRequestQueue","removeChunk","processRemoveQueue","processMeshingQueue","numQueued","lookIndex","lookForChunksToMesh","pChunk","firstOnly","doChunkRemesh","nid","neighbor","_report","exist","surrounded","remeshes","padEnd","sum","acc","toFixed","report","createInputs","defaultBindings","makeInputs","createPhysics","makePhysics","inverseX","inverseY","sensitivityX","sensitivityY","initialZoom","zoomSpeed","Camera","cameraTarget","eyeOffset","zoomDistance","_dirVector","_camPos","getTargetPosition","localToGlobal","globalCamPos","getDirection","applyInputsToCamera","wval","hval","badx","lastx","bady","lasty","bugFix","conv","twopi","maxPitch","updateBeforeEntityRenderSystems","updateAfterEntityRenderSystems","maxZoom","_camBox","_camBoxVec","_getVoxel","_sweepVec","_hitFn","cameraObstructionDistance","texturePath","blockDefaults","solid","opaque","viscosity","MAX_BLOCK_ID","Registry","blockSolidity","blockOpacity","blockIsFluid","blockMats","blockProps","blockMeshes","blockHandlers","registerBlock","_options","fluid","blockMesh","getMaterialId","hasHandler","onLoad","onUnload","onSet","onUnset","BlockCallbackHolder","registerMaterial","textureURL","texHasAlpha","renderMaterial","texture","blockId","getMaterialColor","white","reg","lazyInit","EntComp","shadowDistance","Entities","componentArgs","reqContext","bareName","exec","compFn","default","compDef","comp","isPlayer","smoothCamera","getPos","updateDerivedPositionData","getPhys","_localSetPosition","_yarg","_zarg","setEntitySize","xs","ys","zs","movement","collideTerrain","getCollideEntities","collideEntities","id2","extentsOverlap","extA","extB","addComponentAgain","isTerrainBlocked","xlocal","ylocal","zlocal","blockExt","getEntitiesInAABB","withComponent","testExtents","entStates","hits","meshOffset","doPhysics","shadow","smoothName","raycast","debug","silent","playerHeight","playerWidth","playerStart","playerAutoStep","blockTestDistance","dragCameraOutsidePointerLock","skipDefaultHighlighting","originRebaseDistance","Engine","_lastRenderTime","_dragOutsideLock","debugstr","_originRebaseDistance","receivesInputs","fadeOnZoom","ver","dep","blockTargetIdCheck","targetedBlock","defaultBlockHighlightFunction","normal","_constants","ndarray","setViewDistance","throwFn","checkWorldOffset","newhash","blockIdFn","_targetedBlockDat","adjacent","_prevTargetHash","updateBlockTargets","st","framePart","profile_hook_render","fire","globalPrecise","floored","setPaused","setBlock","addBlock","pick","blockIdTestFunction","_pickPos","testFn","_hitResult","rnorm","ballMesh","collideHandler","removeComp","cruncher","blockIDs","storeChunk","requestQueue","getHeightMap","xsize","zsize","decideBlock","grassID","dirtID","waterID","makeRows","retrieveChunk","generateChunk1","grass2ID","generateChunk2","generateChunk","testID1","testID2","testID3","waterPole","shinyDirtID","customID","addWorldFeatures","initWorldGen","brownish","strs","shinyMat","specularPower","bumpTexture","CreateBox","Scaling","setTranslation","bakeTransformIntoVertices","_id","initRegistration","playerMesh","setupPlayerEntity","pickedID","interval","shoot","CreateSphere","playPos","imp","p1","p2","shootBouncyBall","debugLayer","hide","setupInteractions"],"mappings":"aACE,SAASA,EAAqBC,GAQ7B,IAPA,IAMIC,EAAUC,EANVC,EAAWH,EAAK,GAChBI,EAAcJ,EAAK,GACnBK,EAAiBL,EAAK,GAIHM,EAAI,EAAGC,EAAW,GACpCD,EAAIH,EAASK,OAAQF,IACzBJ,EAAUC,EAASG,GAChBG,OAAOC,UAAUC,eAAeC,KAAKC,EAAiBX,IAAYW,EAAgBX,IACpFK,EAASO,KAAKD,EAAgBX,GAAS,IAExCW,EAAgBX,GAAW,EAE5B,IAAID,KAAYG,EACZK,OAAOC,UAAUC,eAAeC,KAAKR,EAAaH,KACpDc,EAAQd,GAAYG,EAAYH,IAKlC,IAFGe,GAAqBA,EAAoBhB,GAEtCO,EAASC,QACdD,EAASU,OAATV,GAOD,OAHAW,EAAgBJ,KAAKK,MAAMD,EAAiBb,GAAkB,IAGvDe,IAER,SAASA,IAER,IADA,IAAIC,EACIf,EAAI,EAAGA,EAAIY,EAAgBV,OAAQF,IAAK,CAG/C,IAFA,IAAIgB,EAAiBJ,EAAgBZ,GACjCiB,GAAY,EACRC,EAAI,EAAGA,EAAIF,EAAed,OAAQgB,IAAK,CAC9C,IAAIC,EAAQH,EAAeE,GACG,IAA3BX,EAAgBY,KAAcF,GAAY,GAE3CA,IACFL,EAAgBQ,OAAOpB,IAAK,GAC5Be,EAASM,EAAoBA,EAAoBC,EAAIN,EAAe,KAItE,OAAOD,EAIR,IAAIQ,EAAmB,GAKnBhB,EAAkB,CACrBiB,EAAG,GAGAZ,EAAkB,GAQtB,SAASS,EAAoB1B,GAG5B,GAAG4B,EAAiB5B,GACnB,OAAO4B,EAAiB5B,GAAU8B,QAGnC,IAAIC,EAASH,EAAiB5B,GAAY,CACzCK,EAAGL,EACHgC,GAAG,EACHF,QAAS,IAUV,OANAhB,EAAQd,GAAUW,KAAKoB,EAAOD,QAASC,EAAQA,EAAOD,QAASJ,GAG/DK,EAAOC,GAAI,EAGJD,EAAOD,QAKfJ,EAAoBO,EAAI,SAAuBhC,GAC9C,IAAIiC,EAAW,GAKXC,EAAqBvB,EAAgBX,GACzC,GAA0B,IAAvBkC,EAGF,GAAGA,EACFD,EAASrB,KAAKsB,EAAmB,QAC3B,CAEN,IAAIC,EAAU,IAAIC,SAAQ,SAASC,EAASC,GAC3CJ,EAAqBvB,EAAgBX,GAAW,CAACqC,EAASC,MAE3DL,EAASrB,KAAKsB,EAAmB,GAAKC,GAGtC,IACII,EADAC,EAASC,SAASC,cAAc,UAGpCF,EAAOG,QAAU,QACjBH,EAAOI,QAAU,IACbnB,EAAoBoB,IACvBL,EAAOM,aAAa,QAASrB,EAAoBoB,IAElDL,EAAOO,IA1DV,SAAwB/C,GACvB,OAAOyB,EAAoBuB,EAAI,GAAKhD,EAAU,aAyD/BiD,CAAejD,GAG5B,IAAIkD,EAAQ,IAAIC,MAChBZ,EAAmB,SAAUa,GAE5BZ,EAAOa,QAAUb,EAAOc,OAAS,KACjCC,aAAaX,GACb,IAAIY,EAAQ7C,EAAgBX,GAC5B,GAAa,IAAVwD,EAAa,CACf,GAAGA,EAAO,CACT,IAAIC,EAAYL,IAAyB,SAAfA,EAAMM,KAAkB,UAAYN,EAAMM,MAChEC,EAAUP,GAASA,EAAMQ,QAAUR,EAAMQ,OAAOb,IACpDG,EAAMW,QAAU,iBAAmB7D,EAAU,cAAgByD,EAAY,KAAOE,EAAU,IAC1FT,EAAMY,KAAO,iBACbZ,EAAMQ,KAAOD,EACbP,EAAMa,QAAUJ,EAChBH,EAAM,GAAGN,GAEVvC,EAAgBX,QAAWgE,IAG7B,IAAIpB,EAAUqB,YAAW,WACxB1B,EAAiB,CAAEmB,KAAM,UAAWE,OAAQpB,MAC1C,MACHA,EAAOa,QAAUb,EAAOc,OAASf,EACjCE,SAASyB,KAAKC,YAAY3B,GAG5B,OAAOJ,QAAQgC,IAAInC,IAIpBR,EAAoB4C,EAAIxD,EAGxBY,EAAoB6C,EAAI3C,EAGxBF,EAAoB8C,EAAI,SAAS1C,EAASiC,EAAMU,GAC3C/C,EAAoBgD,EAAE5C,EAASiC,IAClCvD,OAAOmE,eAAe7C,EAASiC,EAAM,CAAEa,YAAY,EAAMC,IAAKJ,KAKhE/C,EAAoBoD,EAAI,SAAShD,GACX,oBAAXiD,QAA0BA,OAAOC,aAC1CxE,OAAOmE,eAAe7C,EAASiD,OAAOC,YAAa,CAAEC,MAAO,WAE7DzE,OAAOmE,eAAe7C,EAAS,aAAc,CAAEmD,OAAO,KAQvDvD,EAAoBwD,EAAI,SAASD,EAAOE,GAEvC,GADU,EAAPA,IAAUF,EAAQvD,EAAoBuD,IAC/B,EAAPE,EAAU,OAAOF,EACpB,GAAW,EAAPE,GAA8B,iBAAVF,GAAsBA,GAASA,EAAMG,WAAY,OAAOH,EAChF,IAAII,EAAK7E,OAAO8E,OAAO,MAGvB,GAFA5D,EAAoBoD,EAAEO,GACtB7E,OAAOmE,eAAeU,EAAI,UAAW,CAAET,YAAY,EAAMK,MAAOA,IACtD,EAAPE,GAA4B,iBAATF,EAAmB,IAAI,IAAIM,KAAON,EAAOvD,EAAoB8C,EAAEa,EAAIE,EAAK,SAASA,GAAO,OAAON,EAAMM,IAAQC,KAAK,KAAMD,IAC9I,OAAOF,GAIR3D,EAAoB+D,EAAI,SAAS1D,GAChC,IAAI0C,EAAS1C,GAAUA,EAAOqD,WAC7B,WAAwB,OAAOrD,EAAgB,SAC/C,WAA8B,OAAOA,GAEtC,OADAL,EAAoB8C,EAAEC,EAAQ,IAAKA,GAC5BA,GAIR/C,EAAoBgD,EAAI,SAASgB,EAAQC,GAAY,OAAOnF,OAAOC,UAAUC,eAAeC,KAAK+E,EAAQC,IAGzGjE,EAAoBuB,EAAI,GAGxBvB,EAAoBkE,GAAK,SAASC,GAA2B,MAApBC,QAAQ3C,MAAM0C,GAAYA,GAEnE,IAAIE,EAAaC,OAAqB,aAAIA,OAAqB,cAAK,GAChEC,EAAmBF,EAAWlF,KAAK2E,KAAKO,GAC5CA,EAAWlF,KAAOf,EAClBiG,EAAaA,EAAWG,QACxB,IAAI,IAAI7F,EAAI,EAAGA,EAAI0F,EAAWxF,OAAQF,IAAKP,EAAqBiG,EAAW1F,IAC3E,IAAIU,EAAsBkF,EAI1BhF,EAAgBJ,KAAK,CAAC,IAAI,IAEnBM,I,kCC5NT;;;;;;;;;;;;;;;AAgBA,IAAIgF,EAAgB,SAAS3B,EAAG4B,GAI5B,OAHAD,EAAgB3F,OAAO6F,gBAClB,CAAEC,UAAW,cAAgBC,OAAS,SAAU/B,EAAG4B,GAAK5B,EAAE8B,UAAYF,IACvE,SAAU5B,EAAG4B,GAAK,IAAK,IAAInD,KAAKmD,EAAOA,EAAE1F,eAAeuC,KAAIuB,EAAEvB,GAAKmD,EAAEnD,MACpDuB,EAAG4B,IAGrB,SAASI,EAAUhC,EAAG4B,GAEzB,SAASK,IAAOC,KAAKC,YAAcnC,EADnC2B,EAAc3B,EAAG4B,GAEjB5B,EAAE/D,UAAkB,OAAN2F,EAAa5F,OAAO8E,OAAOc,IAAMK,EAAGhG,UAAY2F,EAAE3F,UAAW,IAAIgG,GAG5E,IAAIG,EAAW,WAQlB,OAPAA,EAAWpG,OAAOqG,QAAU,SAAkB3B,GAC1C,IAAK,IAAIvD,EAAGtB,EAAI,EAAGoF,EAAIqB,UAAUvG,OAAQF,EAAIoF,EAAGpF,IAE5C,IAAK,IAAI4C,KADTtB,EAAImF,UAAUzG,GACOG,OAAOC,UAAUC,eAAeC,KAAKgB,EAAGsB,KAAIiC,EAAEjC,GAAKtB,EAAEsB,IAE9E,OAAOiC,IAEKhE,MAAMwF,KAAMI,YAezB,SAASC,EAAWC,EAAYnD,EAAQ0B,EAAK0B,GAChD,IAA2HzC,EAAvHD,EAAIuC,UAAUvG,OAAQuE,EAAIP,EAAI,EAAIV,EAAkB,OAAToD,EAAgBA,EAAOzG,OAAO0G,yBAAyBrD,EAAQ0B,GAAO0B,EACrH,GAAuB,iBAAZE,SAAoD,mBAArBA,QAAQC,SAAyBtC,EAAIqC,QAAQC,SAASJ,EAAYnD,EAAQ0B,EAAK0B,QACpH,IAAK,IAAI5G,EAAI2G,EAAWzG,OAAS,EAAGF,GAAK,EAAGA,KAASmE,EAAIwC,EAAW3G,MAAIyE,GAAKP,EAAI,EAAIC,EAAEM,GAAKP,EAAI,EAAIC,EAAEX,EAAQ0B,EAAKT,GAAKN,EAAEX,EAAQ0B,KAAST,GAChJ,OAAOP,EAAI,GAAKO,GAAKtE,OAAOmE,eAAed,EAAQ0B,EAAKT,GAAIA,EAWzD,SAASuC,EAAUC,EAASC,EAAYC,EAAGC,GAC9C,OAAO,IAAKD,IAAMA,EAAInF,WAAU,SAAUC,EAASC,GAC/C,SAASjB,EAAU2D,GAAS,IAAMyC,EAAKD,EAAUE,KAAK1C,IAAW,MAAOhD,GAAKM,EAAON,IACpF,SAAS2F,EAAS3C,GAAS,IAAMyC,EAAKD,EAAiB,MAAExC,IAAW,MAAOhD,GAAKM,EAAON,IACvF,SAASyF,EAAKtG,GAAUA,EAAOyG,KAAOvF,EAAQlB,EAAO6D,OAAS,IAAIuC,GAAE,SAAUlF,GAAWA,EAAQlB,EAAO6D,UAAW6C,KAAKxG,EAAWsG,GACnIF,GAAMD,EAAYA,EAAUvG,MAAMoG,EAASC,GAAc,KAAKI,WAI/D,SAASI,EAAYT,EAASU,GACjC,IAAsGC,EAAGC,EAAGhD,EAAGiD,EAA3GC,EAAI,CAAEC,MAAO,EAAGC,KAAM,WAAa,GAAW,EAAPpD,EAAE,GAAQ,MAAMA,EAAE,GAAI,OAAOA,EAAE,IAAOqD,KAAM,GAAIC,IAAK,IAChG,OAAOL,EAAI,CAAER,KAAMc,EAAK,GAAI,MAASA,EAAK,GAAI,OAAUA,EAAK,IAAwB,mBAAX1D,SAA0BoD,EAAEpD,OAAO2D,UAAY,WAAa,OAAOhC,OAAUyB,EACvJ,SAASM,EAAKhD,GAAK,OAAO,SAAUkD,GAAK,OACzC,SAAcC,GACV,GAAIX,EAAG,MAAM,IAAIY,UAAU,mCAC3B,KAAOT,GAAG,IACN,GAAIH,EAAI,EAAGC,IAAMhD,EAAY,EAAR0D,EAAG,GAASV,EAAU,OAAIU,EAAG,GAAKV,EAAS,SAAOhD,EAAIgD,EAAU,SAAMhD,EAAEvE,KAAKuH,GAAI,GAAKA,EAAEP,SAAWzC,EAAIA,EAAEvE,KAAKuH,EAAGU,EAAG,KAAKf,KAAM,OAAO3C,EAE3J,OADIgD,EAAI,EAAGhD,IAAG0D,EAAK,CAAS,EAARA,EAAG,GAAQ1D,EAAED,QACzB2D,EAAG,IACP,KAAK,EAAG,KAAK,EAAG1D,EAAI0D,EAAI,MACxB,KAAK,EAAc,OAAXR,EAAEC,QAAgB,CAAEpD,MAAO2D,EAAG,GAAIf,MAAM,GAChD,KAAK,EAAGO,EAAEC,QAASH,EAAIU,EAAG,GAAIA,EAAK,CAAC,GAAI,SACxC,KAAK,EAAGA,EAAKR,EAAEI,IAAIM,MAAOV,EAAEG,KAAKO,MAAO,SACxC,QACI,KAAM5D,EAAIkD,EAAEG,MAAMrD,EAAIA,EAAE3E,OAAS,GAAK2E,EAAEA,EAAE3E,OAAS,KAAkB,IAAVqI,EAAG,IAAsB,IAAVA,EAAG,IAAW,CAAER,EAAI,EAAG,SACjG,GAAc,IAAVQ,EAAG,MAAc1D,GAAM0D,EAAG,GAAK1D,EAAE,IAAM0D,EAAG,GAAK1D,EAAE,IAAM,CAAEkD,EAAEC,MAAQO,EAAG,GAAI,MAC9E,GAAc,IAAVA,EAAG,IAAYR,EAAEC,MAAQnD,EAAE,GAAI,CAAEkD,EAAEC,MAAQnD,EAAE,GAAIA,EAAI0D,EAAI,MAC7D,GAAI1D,GAAKkD,EAAEC,MAAQnD,EAAE,GAAI,CAAEkD,EAAEC,MAAQnD,EAAE,GAAIkD,EAAEI,IAAI3H,KAAK+H,GAAK,MACvD1D,EAAE,IAAIkD,EAAEI,IAAIM,MAChBV,EAAEG,KAAKO,MAAO,SAEtBF,EAAKZ,EAAKrH,KAAK2G,EAASc,GAC1B,MAAOnG,GAAK2G,EAAK,CAAC,EAAG3G,GAAIiG,EAAI,EAAK,QAAUD,EAAI/C,EAAI,EACtD,GAAY,EAAR0D,EAAG,GAAQ,MAAMA,EAAG,GAAI,MAAO,CAAE3D,MAAO2D,EAAG,GAAKA,EAAG,QAAK,EAAQf,MAAM,GArB9BH,CAAK,CAACjC,EAAGkD,Q,8CC/E7D5G,EAAOD,QAAU,CACfiH,QAAS,EAAQ,KACfzD,OAAQ,EAAQ,KAChB0D,MAAO,EAAQ,KACfC,MAAO,EAAQ,KACfC,WAAY,EAAQ,KACpBC,KAAM,EAAQ,KACdC,IAAK,EAAQ,KACbC,OAAQ,EAAQ,KAChBC,YAAa,EAAQ,KACrBC,IAAK,EAAQ,KACbC,SAAU,EAAQ,KAClBC,IAAK,EAAQ,KACbC,SAAU,EAAQ,KAClBC,IAAK,EAAQ,KACbC,OAAQ,EAAQ,KAChBC,IAAK,EAAQ,KACbC,IAAK,EAAQ,KACbC,IAAK,EAAQ,KACbC,MAAO,EAAQ,KACfC,KAAM,EAAQ,KACdC,MAAO,EAAQ,KACfC,MAAO,EAAQ,KACfC,YAAa,EAAQ,KACrBC,SAAU,EAAQ,KAClBC,KAAM,EAAQ,KACdC,gBAAiB,EAAQ,KACzBC,QAAS,EAAQ,KACjBjK,OAAQ,EAAQ,KAChBkK,IAAK,EAAQ,KACbC,cAAe,EAAQ,KACvBC,OAAQ,EAAQ,KAChBC,OAAQ,EAAQ,KAChBC,QAAS,EAAQ,KACjBC,UAAW,EAAQ,KACnBC,IAAK,EAAQ,KACbC,MAAO,EAAQ,KACfC,KAAM,EAAQ,KACdC,OAAQ,EAAQ,KAChBC,cAAe,EAAQ,KACvBC,cAAe,EAAQ,KACvBC,cAAe,EAAQ,KACvBC,QAAS,EAAQ,KACjBC,QAAS,EAAQ,KACjBC,QAAS,EAAQ,KACjBC,QAAS,EAAQ,O,0DCtBrB,IAOIC,EAPAC,EAAuB,iBAAZxE,QAAuBA,QAAU,KAC5CyE,EAAeD,GAAwB,mBAAZA,EAAEzK,MAC7ByK,EAAEzK,MACF,SAAsB2C,EAAQgI,EAAUC,GACxC,OAAOC,SAAStL,UAAUS,MAAMP,KAAKkD,EAAQgI,EAAUC,IAKzDJ,EADEC,GAA0B,mBAAdA,EAAEK,QACCL,EAAEK,QACVxL,OAAOyL,sBACC,SAAwBpI,GACvC,OAAOrD,OAAO0L,oBAAoBrI,GAC/BsI,OAAO3L,OAAOyL,sBAAsBpI,KAGxB,SAAwBA,GACvC,OAAOrD,OAAO0L,oBAAoBrI,IAQtC,IAAIuI,EAAcC,OAAOC,OAAS,SAAqBrH,GACrD,OAAOA,GAAUA,GAGnB,SAASsH,IACPA,EAAaC,KAAK7L,KAAK+F,MAEzB3E,EAAOD,QAAUyK,EAGjBA,EAAaA,aAAeA,EAE5BA,EAAa9L,UAAUgM,aAAUxI,EACjCsI,EAAa9L,UAAUiM,aAAe,EACtCH,EAAa9L,UAAUkM,mBAAgB1I,EAIvC,IAAI2I,EAAsB,GAE1B,SAASC,EAAcC,GACrB,GAAwB,mBAAbA,EACT,MAAM,IAAIjE,UAAU,0EAA4EiE,GAsCpG,SAASC,EAAiBC,GACxB,YAA2B/I,IAAvB+I,EAAKL,cACAJ,EAAaK,oBACfI,EAAKL,cAmDd,SAASM,EAAapJ,EAAQF,EAAMmJ,EAAUI,GAC5C,IAAI5I,EACA6I,EACAC,EAzHsBC,EA+I1B,GApBAR,EAAcC,QAGC7I,KADfkJ,EAAStJ,EAAO4I,UAEdU,EAAStJ,EAAO4I,QAAUjM,OAAO8E,OAAO,MACxCzB,EAAO6I,aAAe,SAIKzI,IAAvBkJ,EAAOG,cACTzJ,EAAO0J,KAAK,cAAe5J,EACfmJ,EAASA,SAAWA,EAASA,SAAWA,GAIpDK,EAAStJ,EAAO4I,SAElBW,EAAWD,EAAOxJ,SAGHM,IAAbmJ,EAEFA,EAAWD,EAAOxJ,GAAQmJ,IACxBjJ,EAAO6I,kBAeT,GAbwB,mBAAbU,EAETA,EAAWD,EAAOxJ,GAChBuJ,EAAU,CAACJ,EAAUM,GAAY,CAACA,EAAUN,GAErCI,EACTE,EAASI,QAAQV,GAEjBM,EAASvM,KAAKiM,IAIhBxI,EAAIyI,EAAiBlJ,IACb,GAAKuJ,EAAS7M,OAAS+D,IAAM8I,EAASK,OAAQ,CACpDL,EAASK,QAAS,EAGlB,IAAIC,EAAI,IAAItK,MAAM,+CACEgK,EAAS7M,OAAS,IAAMoN,OAAOhK,GADjC,qEAIlB+J,EAAE3J,KAAO,8BACT2J,EAAEE,QAAU/J,EACZ6J,EAAE/J,KAAOA,EACT+J,EAAEG,MAAQT,EAAS7M,OA5KG8M,EA6KHK,EA5KnB5H,SAAWA,QAAQgI,MAAMhI,QAAQgI,KAAKT,GAgL1C,OAAOxJ,EAcT,SAASkK,IACP,IAAKrH,KAAKsH,MAGR,OAFAtH,KAAK7C,OAAOoK,eAAevH,KAAK/C,KAAM+C,KAAKwH,QAC3CxH,KAAKsH,OAAQ,EACY,IAArBlH,UAAUvG,OACLmG,KAAKoG,SAASnM,KAAK+F,KAAK7C,QAC1B6C,KAAKoG,SAAS5L,MAAMwF,KAAK7C,OAAQiD,WAI5C,SAASqH,EAAUtK,EAAQF,EAAMmJ,GAC/B,IAAIsB,EAAQ,CAAEJ,OAAO,EAAOE,YAAQjK,EAAWJ,OAAQA,EAAQF,KAAMA,EAAMmJ,SAAUA,GACjFuB,EAAUN,EAAYvI,KAAK4I,GAG/B,OAFAC,EAAQvB,SAAWA,EACnBsB,EAAMF,OAASG,EACRA,EA0HT,SAASC,EAAWzK,EAAQF,EAAM4K,GAChC,IAAIpB,EAAStJ,EAAO4I,QAEpB,QAAexI,IAAXkJ,EACF,MAAO,GAET,IAAIqB,EAAarB,EAAOxJ,GACxB,YAAmBM,IAAfuK,EACK,GAEiB,mBAAfA,EACFD,EAAS,CAACC,EAAW1B,UAAY0B,GAAc,CAACA,GAElDD,EAsDT,SAAyBE,GAEvB,IADA,IAAIC,EAAM,IAAInI,MAAMkI,EAAIlO,QACfF,EAAI,EAAGA,EAAIqO,EAAInO,SAAUF,EAChCqO,EAAIrO,GAAKoO,EAAIpO,GAAGyM,UAAY2B,EAAIpO,GAElC,OAAOqO,EA1DLC,CAAgBH,GAAcI,EAAWJ,EAAYA,EAAWjO,QAoBpE,SAASsO,EAAclL,GACrB,IAAIwJ,EAASzG,KAAK+F,QAElB,QAAexI,IAAXkJ,EAAsB,CACxB,IAAIqB,EAAarB,EAAOxJ,GAExB,GAA0B,mBAAf6K,EACT,OAAO,EACF,QAAmBvK,IAAfuK,EACT,OAAOA,EAAWjO,OAItB,OAAO,EAOT,SAASqO,EAAWH,EAAKhJ,GAEvB,IADA,IAAI0D,EAAO,IAAI5C,MAAMd,GACZpF,EAAI,EAAGA,EAAIoF,IAAKpF,EACvB8I,EAAK9I,GAAKoO,EAAIpO,GAChB,OAAO8I,EApWT3I,OAAOmE,eAAe4H,EAAc,sBAAuB,CACzD3H,YAAY,EACZC,IAAK,WACH,OAAO+H,GAETxD,IAAK,SAAS0F,GACZ,GAAmB,iBAARA,GAAoBA,EAAM,GAAK1C,EAAY0C,GACpD,MAAM,IAAIC,WAAW,kGAAoGD,EAAM,KAEjIlC,EAAsBkC,KAI1BvC,EAAaC,KAAO,gBAEGvI,IAAjByC,KAAK+F,SACL/F,KAAK+F,UAAYjM,OAAOwO,eAAetI,MAAM+F,UAC/C/F,KAAK+F,QAAUjM,OAAO8E,OAAO,MAC7BoB,KAAKgG,aAAe,GAGtBhG,KAAKiG,cAAgBjG,KAAKiG,oBAAiB1I,GAK7CsI,EAAa9L,UAAUwO,gBAAkB,SAAyBxJ,GAChE,GAAiB,iBAANA,GAAkBA,EAAI,GAAK2G,EAAY3G,GAChD,MAAM,IAAIsJ,WAAW,gFAAkFtJ,EAAI,KAG7G,OADAiB,KAAKiG,cAAgBlH,EACdiB,MAST6F,EAAa9L,UAAUyO,gBAAkB,WACvC,OAAOnC,EAAiBrG,OAG1B6F,EAAa9L,UAAU8M,KAAO,SAAc5J,GAE1C,IADA,IAAImI,EAAO,GACFzL,EAAI,EAAGA,EAAIyG,UAAUvG,OAAQF,IAAKyL,EAAKjL,KAAKiG,UAAUzG,IAC/D,IAAI8O,EAAoB,UAATxL,EAEXwJ,EAASzG,KAAK+F,QAClB,QAAexI,IAAXkJ,EACFgC,EAAWA,QAA4BlL,IAAjBkJ,EAAOhK,WAC1B,IAAKgM,EACR,OAAO,EAGT,GAAIA,EAAS,CACX,IAAIC,EAGJ,GAFItD,EAAKvL,OAAS,IAChB6O,EAAKtD,EAAK,IACRsD,aAAchM,MAGhB,MAAMgM,EAGR,IAAIvJ,EAAM,IAAIzC,MAAM,oBAAsBgM,EAAK,KAAOA,EAAGtL,QAAU,IAAM,KAEzE,MADA+B,EAAIwJ,QAAUD,EACRvJ,EAGR,IAAIyJ,EAAUnC,EAAOxJ,GAErB,QAAgBM,IAAZqL,EACF,OAAO,EAET,GAAuB,mBAAZA,EACT1D,EAAa0D,EAAS5I,KAAMoF,OAE5B,KAAIrB,EAAM6E,EAAQ/O,OACdgP,EAAYX,EAAWU,EAAS7E,GACpC,IAASpK,EAAI,EAAGA,EAAIoK,IAAOpK,EACzBuL,EAAa2D,EAAUlP,GAAIqG,KAAMoF,GAGrC,OAAO,GAiETS,EAAa9L,UAAU+O,YAAc,SAAqB7L,EAAMmJ,GAC9D,OAAOG,EAAavG,KAAM/C,EAAMmJ,GAAU,IAG5CP,EAAa9L,UAAUgP,GAAKlD,EAAa9L,UAAU+O,YAEnDjD,EAAa9L,UAAUiP,gBACnB,SAAyB/L,EAAMmJ,GAC7B,OAAOG,EAAavG,KAAM/C,EAAMmJ,GAAU,IAqBhDP,EAAa9L,UAAUkP,KAAO,SAAchM,EAAMmJ,GAGhD,OAFAD,EAAcC,GACdpG,KAAK+I,GAAG9L,EAAMwK,EAAUzH,KAAM/C,EAAMmJ,IAC7BpG,MAGT6F,EAAa9L,UAAUmP,oBACnB,SAA6BjM,EAAMmJ,GAGjC,OAFAD,EAAcC,GACdpG,KAAKgJ,gBAAgB/L,EAAMwK,EAAUzH,KAAM/C,EAAMmJ,IAC1CpG,MAIb6F,EAAa9L,UAAUwN,eACnB,SAAwBtK,EAAMmJ,GAC5B,IAAI+C,EAAM1C,EAAQ2C,EAAUzP,EAAG0P,EAK/B,GAHAlD,EAAcC,QAGC7I,KADfkJ,EAASzG,KAAK+F,SAEZ,OAAO/F,KAGT,QAAazC,KADb4L,EAAO1C,EAAOxJ,IAEZ,OAAO+C,KAET,GAAImJ,IAAS/C,GAAY+C,EAAK/C,WAAaA,EACb,KAAtBpG,KAAKgG,aACThG,KAAK+F,QAAUjM,OAAO8E,OAAO,cAEtB6H,EAAOxJ,GACVwJ,EAAOc,gBACTvH,KAAK6G,KAAK,iBAAkB5J,EAAMkM,EAAK/C,UAAYA,SAElD,GAAoB,mBAAT+C,EAAqB,CAGrC,IAFAC,GAAY,EAEPzP,EAAIwP,EAAKtP,OAAS,EAAGF,GAAK,EAAGA,IAChC,GAAIwP,EAAKxP,KAAOyM,GAAY+C,EAAKxP,GAAGyM,WAAaA,EAAU,CACzDiD,EAAmBF,EAAKxP,GAAGyM,SAC3BgD,EAAWzP,EACX,MAIJ,GAAIyP,EAAW,EACb,OAAOpJ,KAEQ,IAAboJ,EACFD,EAAK7O,QAiIf,SAAmB6O,EAAMG,GACvB,KAAOA,EAAQ,EAAIH,EAAKtP,OAAQyP,IAC9BH,EAAKG,GAASH,EAAKG,EAAQ,GAC7BH,EAAK/G,MAlIGmH,CAAUJ,EAAMC,GAGE,IAAhBD,EAAKtP,SACP4M,EAAOxJ,GAAQkM,EAAK,SAEQ5L,IAA1BkJ,EAAOc,gBACTvH,KAAK6G,KAAK,iBAAkB5J,EAAMoM,GAAoBjD,GAG1D,OAAOpG,MAGb6F,EAAa9L,UAAUyP,IAAM3D,EAAa9L,UAAUwN,eAEpD1B,EAAa9L,UAAU0P,mBACnB,SAA4BxM,GAC1B,IAAI4L,EAAWpC,EAAQ9M,EAGvB,QAAe4D,KADfkJ,EAASzG,KAAK+F,SAEZ,OAAO/F,KAGT,QAA8BzC,IAA1BkJ,EAAOc,eAUT,OATyB,IAArBnH,UAAUvG,QACZmG,KAAK+F,QAAUjM,OAAO8E,OAAO,MAC7BoB,KAAKgG,aAAe,QACMzI,IAAjBkJ,EAAOxJ,KACY,KAAtB+C,KAAKgG,aACThG,KAAK+F,QAAUjM,OAAO8E,OAAO,aAEtB6H,EAAOxJ,IAEX+C,KAIT,GAAyB,IAArBI,UAAUvG,OAAc,CAC1B,IACIgF,EADA6K,EAAO5P,OAAO4P,KAAKjD,GAEvB,IAAK9M,EAAI,EAAGA,EAAI+P,EAAK7P,SAAUF,EAEjB,oBADZkF,EAAM6K,EAAK/P,KAEXqG,KAAKyJ,mBAAmB5K,GAK1B,OAHAmB,KAAKyJ,mBAAmB,kBACxBzJ,KAAK+F,QAAUjM,OAAO8E,OAAO,MAC7BoB,KAAKgG,aAAe,EACbhG,KAKT,GAAyB,mBAFzB6I,EAAYpC,EAAOxJ,IAGjB+C,KAAKuH,eAAetK,EAAM4L,QACrB,QAAkBtL,IAAdsL,EAET,IAAKlP,EAAIkP,EAAUhP,OAAS,EAAGF,GAAK,EAAGA,IACrCqG,KAAKuH,eAAetK,EAAM4L,EAAUlP,IAIxC,OAAOqG,MAoBb6F,EAAa9L,UAAU8O,UAAY,SAAmB5L,GACpD,OAAO2K,EAAW5H,KAAM/C,GAAM,IAGhC4I,EAAa9L,UAAU4P,aAAe,SAAsB1M,GAC1D,OAAO2K,EAAW5H,KAAM/C,GAAM,IAGhC4I,EAAasC,cAAgB,SAASjB,EAASjK,GAC7C,MAAqC,mBAA1BiK,EAAQiB,cACVjB,EAAQiB,cAAclL,GAEtBkL,EAAclO,KAAKiN,EAASjK,IAIvC4I,EAAa9L,UAAUoO,cAAgBA,EAiBvCtC,EAAa9L,UAAU6P,WAAa,WAClC,OAAO5J,KAAKgG,aAAe,EAAIhB,EAAehF,KAAK+F,SAAW,K,oBCvahE,IAAI8D,EAAO,EAAQ,KACfC,EAAW,EAAQ,KAEnBC,EAA6C,oBAAlBC,aAE/B,SAASC,EAAWC,EAAGxK,GACrB,OAAOwK,EAAE,GAAKxK,EAAE,GAGlB,SAASyK,IACP,IAEIxQ,EAFAyQ,EAASpK,KAAKoK,OACdC,EAAQ,IAAIxK,MAAMuK,EAAOvQ,QAE7B,IAAIF,EAAE,EAAGA,EAAE0Q,EAAMxQ,SAAUF,EACzB0Q,EAAM1Q,GAAK,CAAC2Q,KAAKC,IAAIH,EAAOzQ,IAAKA,GAEnC0Q,EAAMG,KAAKP,GACX,IAAIvP,EAAS,IAAImF,MAAMwK,EAAMxQ,QAC7B,IAAIF,EAAE,EAAGA,EAAEe,EAAOb,SAAUF,EAC1Be,EAAOf,GAAK0Q,EAAM1Q,GAAG,GAEvB,OAAOe,EAGT,SAAS+P,EAAmBC,EAAOC,GACjC,IAAIC,EAAY,CAAC,OAAQD,EAAW,IAAKD,GAAOG,KAAK,IAClDF,EAAY,IACbC,EAAY,WAAaF,GAE3B,IAAII,EAAwB,YAAVJ,EAElB,IAAkB,IAAfC,EAAkB,CAEnB,IAAII,EACF,YAAYH,EAAU,+BAChBA,EAAU,2BACPF,EAAM,kLAMGE,EAAU,+GAGNA,EAAU,kBAAkBA,EAAU,QAE9D,OADgB,IAAIvF,SAAS0F,EACtBC,GACF,GAAiB,IAAdL,EAAiB,CAErBI,EACF,YAAYH,EAAU,mDAIhBA,EAAU,2BACPF,EAAM,6KAUCE,EAAU,uBACnBA,EAAU,gDAEDA,EAAU,6EAGGA,EAAU,kBACnCE,EAAa,6BAA+B,0BACtD,wBACqBF,EAAU,mBACrBE,EAAa,+BAAiC,4BAA4B,+BAExDF,EAAU,wBAAwBA,EAAU,SAEpE,OADgB,IAAIvF,SAAS,eAAgB0F,EACtCC,CAAUC,EAAoBP,GAAO,IAG1CK,EAAO,CAAC,gBAAZ,IAGIG,EAAUrB,EAAKc,GACfvF,EAAO8F,EAAQC,KAAI,SAASxR,GAAK,MAAO,IAAIA,KAC5CyR,EAAY,eAAiBF,EAAQC,KAAI,SAASxR,GAChD,MAAO,eAAiBA,EAAI,MAAQA,KACnCkR,KAAK,KACRQ,EAAWH,EAAQC,KAAI,SAASxR,GAChC,MAAO,IAAIA,KACVkR,KAAK,KACNS,EAAYJ,EAAQC,KAAI,SAASxR,GACjC,MAAO,IAAIA,KACVkR,KAAK,KACVE,EAAK5Q,KACH,YAAYyQ,EAAU,MAAQS,EAAW,IAAMC,EAAY,kBACzD,eAAiBD,EAAW,IAC5B,gBAAkBC,EAAY,IAC9B,mBACF,aAAaV,EAAU,aACvB,gBAAgBF,EAAM,IACtB,mBAAmBC,GAGrBI,EAAK5Q,KAAK,oDAAoDyQ,EAAU,kBACjEM,EAAQC,KAAI,SAASxR,GAAK,MAAO,cAAcA,EAAE,OAAOkR,KAAK,KACtE,OAGmB,IAAdF,EACDI,EAAK5Q,KAAK,oBAEV4Q,EAAK5Q,KAAK,6CACPwQ,EAAY,GACbI,EAAK5Q,KAAK,YAAYyQ,EAAU,aACf,IAAdD,EACDI,EAAK5Q,KAAK,6EACY,IAAdwQ,GACRI,EAAK5Q,KACb,4QAkBM4Q,EAAK5Q,KAAK,YAKd4Q,EAAK5Q,KACP,sBAAsByQ,EAAU,QAAQxF,EAAKyF,KAAK,KAAK,QAClDC,EACDC,EAAK5Q,KAAK,wBAAwBiR,EAAU,QAE5CL,EAAK5Q,KAAK,oBAAoBiR,EAAU,QAI1CL,EAAK5Q,KAAK,sBAAsByQ,EAAU,QAAQxF,EAAKyF,KAAK,KAAK,MAC9DC,EACDC,EAAK5Q,KAAK,wBAAwBiR,EAAU,MAE5CL,EAAK5Q,KAAK,oBAAoBiR,EAAU,MAI1CL,EAAK5Q,KACH,wBAAwByQ,EAAU,UAAWxF,EAAKyF,OAAQ,YAAYO,EAAU,KAGlFL,EAAK5Q,KAAK,qBAAqByQ,EAAU,OAAOxF,EAAKyF,KAAK,KAAK,gBAAgBD,EAAU,cACvFM,EAAQC,KAAI,SAASxR,GACnB,MAAO,CAAC,YAAYA,EAAE,iBAAiBA,EAAE,kBAAmBA,EAAG,MAAOA,EAAE,MAAMkR,KAAK,OAClFA,KAAK,KAAK,IACbK,EAAQC,KAAI,SAASxR,GACnB,MAAO,eAAeA,EAAI,OACzBkR,KAAK,KAAK,kBAGf,IAAIU,EAASL,EAAQC,KAAI,SAASxR,GAAK,MAAO,IAAIA,EAAE,eAAeA,EAAE,OACjE6R,EAASN,EAAQC,KAAI,SAASxR,GAAK,MAAO,IAAIA,EAAE,gBAAgBA,EAAE,OACtEoR,EAAK5Q,KAAK,qBAAqByQ,EAAU,OAAOxF,EAAKyF,KAAK,KAAK,2BAA2BU,EAAOV,KAAK,KAAK,IAAIW,EAAOX,KAAK,MAC3H,IAAI,IAAIlR,EAAE,EAAGA,EAAEgR,IAAahR,EAC1BoR,EAAK5Q,KACT,cAAcR,EAAE,iBAAiBA,EAAE,WAC9BA,EAAE,UACDA,EAAE,OACLA,EAAE,QAEHoR,EAAK5Q,KAAK,cAAcyQ,EAAU,cAChCM,EAAQC,KAAI,SAASxR,GACnB,MAAO,IAAIA,KACVkR,KAAK,KAAK,IACbK,EAAQC,KAAI,SAASxR,GACnB,MAAO,IAAIA,KACVkR,KAAK,KAAK,QAGfE,EAAK5Q,KAAK,uBAAuByQ,EAAU,SAASxF,EAAKyF,KAAK,KAAK,SACjEK,EAAQC,KAAI,SAASxR,GACnB,MAAO,IAAIA,EAAE,eAAeA,EAAE,OAC7BkR,KAAK,KAAK,IACbK,EAAQC,KAAI,SAASxR,GACnB,MAAO,IAAIA,EAAE,gBAAgBA,EAAE,OAC9BkR,KAAK,KAAK,qCACf,IAAQlR,EAAE,EAAGA,EAAEgR,IAAahR,EAC1BoR,EAAK5Q,KACT,cAAcR,EAAE,mBACXA,EAAE,kBAEDA,EAAE,MAAMA,EAAE,QACbA,EAAE,WAAWA,EAAE,aAEfA,EAAE,UAAUA,EAAE,QAEdA,EAAE,QAGHoR,EAAK5Q,KAAK,cAAcyQ,EAAU,cAChCM,EAAQC,KAAI,SAASxR,GACnB,MAAO,IAAMA,KACZkR,KAAK,KAAK,IACbK,EAAQC,KAAI,SAASxR,GACnB,MAAO,IAAMA,KACZkR,KAAK,KAAK,QAGf,IAAIY,EAAS,IAAI5L,MAAM8K,GACnBe,EAAU,IAAI7L,MAAM8K,GACxB,IAAQhR,EAAE,EAAGA,EAAEgR,IAAahR,EAC1B8R,EAAO9R,GAAK,MAAMA,EAAE,IACpB+R,EAAQ/R,GAAK,MAAMA,EAAE,IAEvBoR,EAAK5Q,KAAK,4BAA4ByQ,EAAU,cAAcxF,EAAK,KACjEA,EAAK+F,KAAI,SAASpM,EAAE4M,GAAO,OAAO5M,EAAI,KAAOA,EAAI,gBAAkB4M,EAAM,IAAM5M,EAAI,SAAQ8L,KAAK,KAChG,6CAA6CD,EAAU,cAAca,EAAOZ,KAAK,KAAK,IAAIa,EAAQb,KAAK,KAAK,kBAG9GE,EAAK5Q,KAAK,uBAAuByQ,EAAU,SAASxF,EAAK,iCACzD,IAAQzL,EAAE,EAAGA,EAAEgR,IAAahR,EAC1BoR,EAAK5Q,KAAK,cAAcR,EAAE,iBAAiBA,EAAE,yBAAyBA,EAAE,MAAMA,EAAE,8BAA8BA,EAAE,yBAAyBA,EAAE,OAe7I,OAbAoR,EAAK5Q,KAAK,gEAGV4Q,EAAK5Q,KAAK,6BAA6ByQ,EAAU,yCAAyCA,EAAU,SAClGM,EAAQC,KAAI,SAASxR,GACnB,MAAO,SAASA,EAAE,OACjBkR,KAAK,KAAK,IACbK,EAAQC,KAAI,SAASxR,GACnB,MAAO,UAAUA,EAAE,OAClBkR,KAAK,KAAK,aAGC,IAAIxF,SAAS,YAAa,QAAS0F,EAAKF,KAAK,MACtDG,CAAUC,EAAoBP,GAAQP,GAuC/C,IAAIc,EAAsB,CACxB,QAAU,GACV,QAAU,GACV,KAAO,GACP,MAAQ,GACR,MAAQ,GACR,MAAQ,GACR,OAAS,GACT,OAAS,GACT,MAAQ,GACR,cAAgB,GAChB,SAAY,GACZ,UAAa,GACb,OAAS,GACT,QAAU,IA4CZ5P,EAAOD,QAnCP,SAA4B/B,EAAMuS,EAAOxB,EAAQyB,GAC/C,QAAYtO,IAATlE,EAED,OADIyS,EAAOb,EAAoBc,MAAM,IACzB,IACY,iBAAT1S,IACfA,EAAO,CAACA,SAEGkE,IAAVqO,IACDA,EAAQ,CAAEvS,EAAKQ,SAEjB,IAAIiE,EAAI8N,EAAM/R,OACd,QAAc0D,IAAX6M,EAAsB,CACvBA,EAAS,IAAIvK,MAAM/B,GACnB,IAAI,IAAInE,EAAEmE,EAAE,EAAGkO,EAAG,EAAGrS,GAAG,IAAKA,EAC3ByQ,EAAOzQ,GAAKqS,EACZA,GAAMJ,EAAMjS,GAGhB,QAAc4D,IAAXsO,EAAsB,CACvBA,EAAS,EACT,IAAQlS,EAAE,EAAGA,EAAEmE,IAAKnE,EACfyQ,EAAOzQ,GAAK,IACbkS,IAAWD,EAAMjS,GAAG,GAAGyQ,EAAOzQ,IAMpC,IAFA,IAAI+Q,EArFN,SAAoBrR,GAClB,GAAGyQ,EAASzQ,GACV,MAAO,SAET,GAAG0Q,EACD,OAAOjQ,OAAOC,UAAUkS,SAAShS,KAAKZ,IACpC,IAAK,wBACH,MAAO,UACT,IAAK,wBACH,MAAO,UACT,IAAK,qBACH,MAAO,OACT,IAAK,sBACH,MAAO,QACT,IAAK,sBACH,MAAO,QACT,IAAK,sBACH,MAAO,QACT,IAAK,uBACH,MAAO,SACT,IAAK,uBACH,MAAO,SACT,IAAK,6BACH,MAAO,gBACT,IAAK,yBACH,MAAO,WACT,IAAK,0BACH,MAAO,YAGb,OAAGwG,MAAMqM,QAAQ7S,GACR,QAEF,UAoDK8S,CAAW9S,GACnB+S,EAAYnB,EAAoBP,GAC9B0B,EAAUvS,QAAUiE,EAAE,GAC1BsO,EAAUjS,KAAKsQ,EAAmBC,EAAO0B,EAAUvS,OAAO,IAG5D,OADIiS,EAAOM,EAAUtO,EAAE,IACXzE,EAAMuS,EAAOxB,EAAQyB,K,oCCzVnCxQ,EAAOD,QAAUiR,EAEjB,IAAIC,EAAO,EAAQ,IAEnB,SAASD,EAAKE,EAAKC,GAEjB,KAAKxM,gBAAgBqM,GACnB,OAAO,IAAIA,EAAKE,EAAKC,GAGvB,IAAIC,EAAOH,EAAK1N,SAChB0N,EAAKzJ,IAAI4J,EAAMF,EAAKC,GAEpBxM,KAAK0M,KAAOJ,EAAKlJ,IAAIkJ,EAAK1N,SAAU2N,EAAKE,GACzCzM,KAAKwM,IAAMF,EAAKhK,MAAMkK,GACtBxM,KAAKqD,IAAMiJ,EAAKjJ,IAAIiJ,EAAK1N,SAAU2N,EAAKE,GAExCzM,KAAK2M,IAAML,EAAKzS,OAAOmG,KAAKwM,KAI9B,IACII,EADOP,EACMtS,UAEjB6S,EAAMC,MAAQ,WACZ,OAAO7M,KAAKwM,IAAI,IAGlBI,EAAME,OAAS,WACb,OAAO9M,KAAKwM,IAAI,IAGlBI,EAAMG,MAAQ,WACZ,OAAO/M,KAAKwM,IAAI,IAGlBI,EAAMI,GAAK,WACT,OAAOhN,KAAK0M,KAAK,IAGnBE,EAAMK,GAAK,WACT,OAAOjN,KAAK0M,KAAK,IAGnBE,EAAMM,GAAK,WACT,OAAOlN,KAAK0M,KAAK,IAGnBE,EAAMO,GAAK,WACT,OAAOnN,KAAKqD,IAAI,IAGlBuJ,EAAMQ,GAAK,WACT,OAAOpN,KAAKqD,IAAI,IAGlBuJ,EAAMS,GAAK,WACT,OAAOrN,KAAKqD,IAAI,IAGlBuJ,EAAMU,UAAY,SAASC,GAGzB,OAFAjB,EAAKzJ,IAAI7C,KAAKqD,IAAKrD,KAAKqD,IAAKkK,GAC7BjB,EAAKzJ,IAAI7C,KAAK0M,KAAM1M,KAAK0M,KAAMa,GACxBvN,MAGT4M,EAAMY,YAAc,SAASjB,GAG3B,OAFAD,EAAKzJ,IAAI7C,KAAKqD,IAAKkJ,EAAKvM,KAAKwM,KAC7BF,EAAK7J,KAAKzC,KAAK0M,KAAMH,GACdvM,MAGT4M,EAAMa,OAAS,SAASC,GACtB,IAAIrK,EAAMiJ,EAAK1N,SACXwE,EAAMkJ,EAAK1N,SAMf,OAJA0N,EAAKjJ,IAAIA,EAAKqK,EAAKrK,IAAKrD,KAAKqD,KAC7BiJ,EAAKlJ,IAAIA,EAAKsK,EAAKhB,KAAM1M,KAAK0M,MAC9BJ,EAAKxJ,SAASO,EAAKA,EAAKD,GAEjB,IAAIiJ,EAAKjJ,EAAKC,IAGvBuJ,EAAMe,WAAa,SAASD,GAC1B,QAAGA,EAAKhB,KAAK,GAAK1M,KAAKqD,IAAI,QACxBqK,EAAKhB,KAAK,GAAK1M,KAAKqD,IAAI,QACxBqK,EAAKhB,KAAK,GAAK1M,KAAKqD,IAAI,QACxBqK,EAAKrK,IAAI,GAAKrD,KAAK0M,KAAK,QACxBgB,EAAKrK,IAAI,GAAKrD,KAAK0M,KAAK,OACxBgB,EAAKrK,IAAI,GAAKrD,KAAK0M,KAAK,SAK7BE,EAAMgB,QAAU,SAASF,GAEvB,IAAIG,EAAe7N,KAAK8N,MAAMJ,GAE9B,OAAyB,OAAjBG,IACyB,GAAxBA,EAAahB,SACW,GAAzBgB,EAAaf,UACW,GAAxBe,EAAad,UAIvBH,EAAMkB,MAAQ,SAASJ,GACrB,IAAI1N,KAAK2N,WAAWD,GAAO,OAAO,KAElC,IAAIK,EAASzD,KAAKjH,IAAIqK,EAAKhB,KAAK,GAAI1M,KAAK0M,KAAK,IAC1CsB,EAAS1D,KAAKjH,IAAIqK,EAAKhB,KAAK,GAAI1M,KAAK0M,KAAK,IAC1CuB,EAAS3D,KAAKjH,IAAIqK,EAAKhB,KAAK,GAAI1M,KAAK0M,KAAK,IAK9C,OAAO,IAAIL,EAAK,CAAC0B,EAAQC,EAAQC,GAAS,CAJ9B3D,KAAKlH,IAAIsK,EAAKrK,IAAI,GAAIrD,KAAKqD,IAAI,IAIQ0K,EAHvCzD,KAAKlH,IAAIsK,EAAKrK,IAAI,GAAIrD,KAAKqD,IAAI,IAGwB2K,EAFvD1D,KAAKlH,IAAIsK,EAAKrK,IAAI,GAAIrD,KAAKqD,IAAI,IAEwC4K,M,8BCnHrF,YAEA,IAAIC,EAAO,EAAQ,KACfC,EAAM,EAAQ,KACdC,EAAS,EAAQ,KAAUA,OAG3BC,EAAOC,oBACTD,EAAOC,kBAAoB,CACvBC,MAAYJ,EAAI,CAAC,GAAI,IACrBK,OAAYL,EAAI,CAAC,GAAI,IACrBM,OAAYN,EAAI,CAAC,GAAI,IACrBO,UAAYP,EAAI,CAAC,GAAI,IACrBQ,KAAYR,EAAI,CAAC,GAAI,IACrBS,MAAYT,EAAI,CAAC,GAAI,IACrBU,MAAYV,EAAI,CAAC,GAAI,IACrBW,SAAYX,EAAI,CAAC,GAAI,IACrBY,MAAYZ,EAAI,CAAC,GAAI,IACrBa,OAAYb,EAAI,CAAC,GAAI,IACrBc,KAAYd,EAAI,CAAC,GAAI,IACrBe,OAAYf,EAAI,CAAC,GAAI,IACrBgB,OAAYhB,EAAI,CAAC,GAAI,MAI3B,IAAIiB,EAA2C,oBAAvBC,kBACpBC,EAA2C,oBAApBC,eACvBC,EAAyC,oBAAnBC,cACtBC,EAAOrB,EAAOC,kBAGdoB,EAAKR,SACPQ,EAAKR,OAASf,EAAI,CAAC,GAAI,KAErBuB,EAAKhB,YACPgB,EAAKhB,UAAYP,EAAI,CAAC,GAAI,KAExBuB,EAAKZ,WACPY,EAAKZ,SAAWX,EAAI,CAAC,GAAI,KAEvBuB,EAAKP,SACPO,EAAKP,OAAShB,EAAI,CAAC,GAAI,KAIzB,IAAIc,EAAUS,EAAKT,KACfE,EAAUO,EAAKP,OAkBnB,SAASQ,EAAgBC,GACvB,GAAIA,EAAJ,CAGA,IAAI7Q,EAAI6Q,EAAO/V,QAAU+V,EAAOC,WAC5BC,EAAQ5B,EAAK6B,KAAKhR,GACtBkQ,EAAKa,GAAO3V,KAAKyV,IAsEnB,SAASI,EAAkBjR,GACrBA,EAAImP,EAAK+B,SAASlR,GAAtB,IACI+Q,EAAQ5B,EAAK6B,KAAKhR,GAClBjB,EAAImR,EAAKa,GACb,OAAGhS,EAAEjE,OAAS,EACLiE,EAAEsE,MAEJ,IAAI8N,YAAYnR,GAIzB,SAASoR,EAAYpR,GACnB,OAAO,IAAIqR,WAAWJ,EAAkBjR,GAAI,EAAGA,GAIjD,SAASsR,EAAatR,GACpB,OAAO,IAAIuR,YAAYN,EAAkB,EAAEjR,GAAI,EAAGA,GAIpD,SAASwR,EAAaxR,GACpB,OAAO,IAAIyR,YAAYR,EAAkB,EAAEjR,GAAI,EAAGA,GAIpD,SAAS0R,EAAW1R,GAClB,OAAO,IAAI2R,UAAUV,EAAkBjR,GAAI,EAAGA,GAIhD,SAAS4R,EAAY5R,GACnB,OAAO,IAAI6R,WAAWZ,EAAkB,EAAEjR,GAAI,EAAGA,GAInD,SAAS8R,EAAY9R,GACnB,OAAO,IAAI+R,WAAWd,EAAkB,EAAEjR,GAAI,EAAGA,GAInD,SAASgS,EAAYhS,GACnB,OAAO,IAAIiS,aAAahB,EAAkB,EAAEjR,GAAI,EAAGA,GAIrD,SAASkS,EAAalS,GACpB,OAAO,IAAIiL,aAAagG,EAAkB,EAAEjR,GAAI,EAAGA,GAIrD,SAASmS,EAAmBnS,GAC1B,OAAGqQ,EACM,IAAIC,kBAAkBW,EAAkBjR,GAAI,EAAGA,GAE/CoR,EAAYpR,GAKvB,SAASoS,EAAgBpS,GACvB,OAAGuQ,EACM,IAAIC,eAAeS,EAAkB,EAAEjR,GAAI,EAAGA,GAE9C,KAKX,SAASqS,EAAerS,GACtB,OAAIyQ,EACK,IAAIC,cAAcO,EAAkB,EAAEjR,GAAI,EAAGA,GAE7C,KAKX,SAASsS,EAAetS,GACtB,OAAO,IAAIuS,SAAStB,EAAkBjR,GAAI,EAAGA,GAI/C,SAASwS,EAAaxS,GACpBA,EAAImP,EAAK+B,SAASlR,GAClB,IAAI+Q,EAAQ5B,EAAK6B,KAAKhR,GAClByS,EAAQrC,EAAOW,GACnB,OAAG0B,EAAM3X,OAAS,EACT2X,EAAMpP,MAER,IAAIgM,EAAOrP,GAtLpB3D,EAAQqW,KAAO,SAAc1F,GAC3B,GAAGqC,EAAOtE,SAASiC,GACjBoD,EAAOjB,EAAK6B,KAAKhE,EAAMlS,SAASM,KAAK4R,OAChC,CAIL,GAH6C,yBAA1CjS,OAAOC,UAAUkS,SAAShS,KAAK8R,KAChCA,EAAQA,EAAM6D,SAEZ7D,EACF,OAEF,IAAIhN,EAAIgN,EAAMlS,QAAUkS,EAAM8D,WAC1BC,EAAqB,EAAb5B,EAAK6B,KAAKhR,GACtBkQ,EAAKa,GAAO3V,KAAK4R,KAiBrB3Q,EAAQsW,UACRtW,EAAQuW,WACRvW,EAAQwW,WACRxW,EAAQyW,cACRzW,EAAQ0W,SACR1W,EAAQ2W,UACR3W,EAAQ4W,UACR5W,EAAQ6W,aACR7W,EAAQ8W,YACR9W,EAAQ+W,UACR/W,EAAQgX,YACRhX,EAAQiX,WACRjX,EAAQkX,iBACRlX,EAAQmX,aAjBR,SAAwBxG,GACtB4D,EAAgB5D,EAAM6D,SAkBxBxU,EAAQuU,gBAAkBA,EAE1BvU,EAAQoX,WAAa,SAAoBzG,GACvCoD,EAAOjB,EAAK6B,KAAKhE,EAAMlS,SAASM,KAAK4R,IAGvC3Q,EAAQqX,OAAS,SAAgB1T,EAAG2L,GAClC,QAAanN,IAAVmN,GAAiC,gBAAVA,EACxB,OAAOsF,EAAkBjR,GAEzB,OAAO2L,GACL,IAAK,QACH,OAAOyF,EAAYpR,GACrB,IAAK,SACH,OAAOsR,EAAatR,GACtB,IAAK,SACH,OAAOwR,EAAaxR,GACtB,IAAK,OACH,OAAO0R,EAAW1R,GACpB,IAAK,QACH,OAAO4R,EAAY5R,GACrB,IAAK,QACH,OAAO8R,EAAY9R,GACrB,IAAK,QACL,IAAK,UACH,OAAOgS,EAAYhS,GACrB,IAAK,SACL,IAAK,UACH,OAAOkS,EAAalS,GACtB,IAAK,gBACH,OAAOmS,EAAmBnS,GAC5B,IAAK,WACH,OAAOqS,EAAerS,GACxB,IAAK,YACH,OAAOoS,EAAgBpS,GACzB,IAAK,SACH,OAAOwS,EAAaxS,GACtB,IAAK,OACL,IAAK,WACH,OAAOsS,EAAetS,GAExB,QACE,OAAO,KAGb,OAAO,MAYT3D,EAAQ4U,kBAAoBA,EAK5B5U,EAAQ+U,YAAcA,EAKtB/U,EAAQiV,aAAeA,EAKvBjV,EAAQmV,aAAeA,EAKvBnV,EAAQqV,WAAaA,EAKrBrV,EAAQuV,YAAcA,EAKtBvV,EAAQyV,YAAcA,EAKtBzV,EAAQsX,cAAgBtX,EAAQ2V,YAAcA,EAK9C3V,EAAQuX,cAAgBvX,EAAQ6V,aAAeA,EAS/C7V,EAAQ8V,mBAAqBA,EAS7B9V,EAAQ+V,gBAAkBA,EAS1B/V,EAAQgW,eAAiBA,EAKzBhW,EAAQiW,eAAiBA,EAWzBjW,EAAQmW,aAAeA,EAEvBnW,EAAQwX,WAAa,WACnB,IAAI,IAAIjZ,EAAE,EAAGA,EAAE,KAAMA,EACnB+V,EAAKnB,MAAM5U,GAAGE,OAAS,EACvB6V,EAAKlB,OAAO7U,GAAGE,OAAS,EACxB6V,EAAKjB,OAAO9U,GAAGE,OAAS,EACxB6V,EAAKf,KAAKhV,GAAGE,OAAS,EACtB6V,EAAKd,MAAMjV,GAAGE,OAAS,EACvB6V,EAAKb,MAAMlV,GAAGE,OAAS,EACvB6V,EAAKX,MAAMpV,GAAGE,OAAS,EACvB6V,EAAKV,OAAOrV,GAAGE,OAAS,EACxB6V,EAAKhB,UAAU/U,GAAGE,OAAS,EAC3B6V,EAAKZ,SAASnV,GAAGE,OAAS,EAC1B6V,EAAKR,OAAOvV,GAAGE,OAAS,EACxBoV,EAAKtV,GAAGE,OAAS,EACjBsV,EAAOxV,GAAGE,OAAS,K,kDCxPvB,iEAAIyS,EAAO,EAAQ,IA0EZ,SAASuG,EAAsBnL,GAClC,IAAIoL,EAAKpL,EAAMmF,MAAQ,EACnBkG,EAAOrL,EAAMsL,eACbC,EAAMvL,EAAMwL,SAChBD,EAAI,GAAKF,EAAK,GAAKD,EACnBG,EAAI,GAAKF,EAAK,GACdE,EAAI,GAAKF,EAAK,GAAKD,EACnBG,EAAI,GAAKF,EAAK,GAAKD,EACnBG,EAAI,GAAKF,EAAK,GAAKrL,EAAMoF,OACzBmG,EAAI,GAAKF,EAAK,GAAKD,EAjFR,sBAqBX,MAAO,CAEHzV,KAAM,WAEN8M,MAAO,GAEPzC,MAAO,CACH0B,SAAU,KACVyD,MAAO,EACPC,OAAQ,EACRkG,eAAgB,KAChBG,gBAAiB,KACjBD,SAAU,MAIdE,MAAO,SAAUC,EAAK3L,GAElB,IAAI6E,EAAM,CAAC,EAAG,EAAG,GACb7E,EAAM0B,UAAUkD,EAAK7J,KAAK8J,EAAK7E,EAAM0B,UACzC1B,EAAM0B,SAAWmD,EAEjB7E,EAAMsL,eAAiB1G,EAAK1N,SAC5B8I,EAAMyL,gBAAkB7G,EAAK1N,SAC7B8I,EAAMwL,SAAW,IAAIlC,aAAa,GAGlCsC,EAAIC,cAAc7L,EAAM0B,SAAU,KAAM1B,EAAMsL,gBAC9C1G,EAAK7J,KAAKiF,EAAMyL,gBAAiBzL,EAAMsL,gBACvCH,EAAsBnL,IAG1B8L,SAAU,KAIVC,OAAQ,SAAUC,EAAIC,GAClB,IAAInK,EAAM8J,EAAIM,kBACdD,EAAO5O,QAAQ2C,IACX4E,EAAKzJ,IAAI6E,EAAM0B,SAAU1B,EAAMsL,eAAgBxJ,GAC/CqJ,EAAsBnL,S,6BC/DtC,kEAAI4E,EAAO,EAAQ,IAGJ,sBAGX,MAAO,CAEHjP,KAAM,UAEN8M,MAAO,GAEPzC,MAAO,CACHpG,KAAM,MAIV8R,MAAO,SAAUS,EAAOnM,GACpBA,EAAMpG,KAAOgS,EAAIQ,QAAQC,UAGzBC,EAAuBtM,EADV4L,EAAIW,KAAKC,gBAAgBxM,EAAMyM,QAKhDX,SAAU,SAAUK,EAAOnM,GAIvB,GAAI4L,EAAIW,KAAKG,YAAY1M,EAAMyM,MAAO,CAClC,IAAIE,EAAOf,EAAIW,KAAKC,gBAAgBxM,EAAMyM,MAC1CG,EAAuB5M,EAAO2M,GAC9BE,EAAmB7M,EAAO2M,EAAM,GAAG,GAEvCf,EAAIQ,QAAQU,WAAW9M,EAAMpG,OAIjCmS,OAAQ,SAAUC,EAAIC,GAClBA,EAAO5O,QAAQ2C,IAEX4M,EAAuB5M,EADZ4L,EAAIW,KAAKC,gBAAgBxM,EAAMyM,UAOlDM,aAAc,SAAUf,EAAIC,GAExB,IAUIe,GAVUpB,EAAIqB,sBACKrB,EAAIsB,UASEtB,EAAIsB,WAAa,IAC9CjB,EAAO5O,QAAQ2C,IACX,IAAImN,EAAKnN,EAAMyM,KACXE,EAAOf,EAAIW,KAAKC,gBAAgBW,GAChCC,EAAWxB,EAAIW,KAAKc,eAAeF,GACvCN,EAAmB7M,EAAO2M,EAAMK,EAAcI,QAW9D,IAAIE,EAAQ1I,EAAK1N,SAEV,SAASoV,EAAuBiB,EAAWC,GAC9C,IAAIC,EAAMF,EAAU3T,KAAKoM,KACrBuF,EAAMiC,EAAShC,SACnB5G,EAAK7J,KAAK0S,EAAIzI,KAAMuG,GACpB3G,EAAK5J,IAAIyS,EAAI3I,IAAK0I,EAASrI,MAAOqI,EAASpI,OAAQoI,EAASrI,OAC5DP,EAAKzJ,IAAIsS,EAAI9R,IAAK8R,EAAIzI,KAAMyI,EAAI3I,KAIpC,SAAS8H,EAAuBW,EAAWC,GACvC,IAAIxI,EAAOuI,EAAU3T,KAAKoM,KAAKhB,KAC3BoG,EAAKoC,EAASrI,MAAQ,EAC1BP,EAAK5J,IAAIwS,EAASlC,eAAgBtG,EAAK,GAAKoG,EAAIpG,EAAK,GAAIA,EAAK,GAAKoG,GAIvE,SAASyB,EAAmBU,EAAWC,EAAUR,EAAcI,GAE3D,IAAIM,EAAMH,EAAU3T,KAAK+T,SACzB/I,EAAK5I,YAAYsR,EAAOE,EAASlC,eAAgBoC,EAAKV,GAIlDI,GAAUxI,EAAK/H,KAAKyQ,EAAOE,EAAS/B,gBAAiB6B,EAAO,IAGhE1I,EAAK7J,KAAKyS,EAAS/B,gBAAiB6B,K,6CCvGxC,IAAIvT,EAGJA,EAAI,WACH,OAAOzB,KADJ,GAIJ,IAECyB,EAAIA,GAAK,IAAI4D,SAAS,cAAb,GACR,MAAO9J,GAEc,iBAAX+D,SAAqBmC,EAAInC,QAOrCjE,EAAOD,QAAUqG,G,0CCnBjBpG,EAAOD,QAAU,M,cCAjBC,EAAOD,QAOP,WACI,IAAIka,EAAM,IAAItE,aAAa,GAI3B,OAHAsE,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACFA,I,cCZXja,EAAOD,QAUP,SAAoBma,EAAG/T,EAAGgU,GACtB,IAAIF,EAAM,IAAItE,aAAa,GAI3B,OAHAsE,EAAI,GAAKC,EACTD,EAAI,GAAK9T,EACT8T,EAAI,GAAKE,EACFF,I,cCfXja,EAAOD,QASP,SAAmBka,EAAKpL,GACpB,IAAIqL,EAAIrL,EAAE,GACN1I,EAAI0I,EAAE,GACNsL,EAAItL,EAAE,GACNnG,EAAMwR,EAAEA,EAAI/T,EAAEA,EAAIgU,EAAEA,EACpBzR,EAAM,IAENA,EAAM,EAAIuG,KAAKmL,KAAK1R,GACpBuR,EAAI,GAAKpL,EAAE,GAAKnG,EAChBuR,EAAI,GAAKpL,EAAE,GAAKnG,EAChBuR,EAAI,GAAKpL,EAAE,GAAKnG,GAEpB,OAAOuR,I,cCrBXja,EAAOD,QASP,SAAa8O,EAAGxK,GACZ,OAAOwK,EAAE,GAAKxK,EAAE,GAAKwK,EAAE,GAAKxK,EAAE,GAAKwK,EAAE,GAAKxK,EAAE,K,cCVhDrE,EAAOD,QAUP,SAAkBka,EAAKpL,EAAGxK,GAItB,OAHA4V,EAAI,GAAKpL,EAAE,GAAKxK,EAAE,GAClB4V,EAAI,GAAKpL,EAAE,GAAKxK,EAAE,GAClB4V,EAAI,GAAKpL,EAAE,GAAKxK,EAAE,GACX4V,I,cCdXja,EAAOD,QAUP,SAAkBka,EAAKpL,EAAGxK,GAItB,OAHA4V,EAAI,GAAKpL,EAAE,GAAKxK,EAAE,GAClB4V,EAAI,GAAKpL,EAAE,GAAKxK,EAAE,GAClB4V,EAAI,GAAKpL,EAAE,GAAKxK,EAAE,GACX4V,I,cCdXja,EAAOD,QAUP,SAAgBka,EAAKpL,EAAGxK,GAIpB,OAHA4V,EAAI,GAAKpL,EAAE,GAAKxK,EAAE,GAClB4V,EAAI,GAAKpL,EAAE,GAAKxK,EAAE,GAClB4V,EAAI,GAAKpL,EAAE,GAAKxK,EAAE,GACX4V,I,cCdXja,EAAOD,QASP,SAAkB8O,EAAGxK,GACjB,IAAI6V,EAAI7V,EAAE,GAAKwK,EAAE,GACb1I,EAAI9B,EAAE,GAAKwK,EAAE,GACbsL,EAAI9V,EAAE,GAAKwK,EAAE,GACjB,OAAOI,KAAKmL,KAAKF,EAAEA,EAAI/T,EAAEA,EAAIgU,EAAEA,K,cCbnCna,EAAOD,QASP,SAAyB8O,EAAGxK,GACxB,IAAI6V,EAAI7V,EAAE,GAAKwK,EAAE,GACb1I,EAAI9B,EAAE,GAAKwK,EAAE,GACbsL,EAAI9V,EAAE,GAAKwK,EAAE,GACjB,OAAOqL,EAAEA,EAAI/T,EAAEA,EAAIgU,EAAEA,I,cCbzBna,EAAOD,QAQP,SAAgB8O,GACZ,IAAIqL,EAAIrL,EAAE,GACN1I,EAAI0I,EAAE,GACNsL,EAAItL,EAAE,GACV,OAAOI,KAAKmL,KAAKF,EAAEA,EAAI/T,EAAEA,EAAIgU,EAAEA,K,cCZnCna,EAAOD,QAQP,SAAuB8O,GACnB,IAAIqL,EAAIrL,EAAE,GACN1I,EAAI0I,EAAE,GACNsL,EAAItL,EAAE,GACV,OAAOqL,EAAEA,EAAI/T,EAAEA,EAAIgU,EAAEA,I,6BCFzBna,EAAOD,QARP,SAAc2D,GAEZ,IADA,IAAIrE,EAAS,IAAImF,MAAMd,GACfpF,EAAE,EAAGA,EAAEoF,IAAKpF,EAClBe,EAAOf,GAAKA,EAEd,OAAOe,I,6BCFT,IAAIgb,EAAS,GACTC,EAAU,GACVC,EAAU,GACVC,EAAW,GACXC,EAAa,GACbC,EAAY,GACZC,EAAU,GACVC,EAAa,GACbC,EAAW,GACXC,EAAU,GACVC,EAAW,GACXC,EAAa,GA4OjBhb,EAAOD,QA/BP,SAAekb,EAAUnB,EAAKoB,EAAKC,EAAUC,EAAaC,GAQtD,IANA,IAAIlK,EAAMwJ,EACNtJ,EAAOwJ,EACP7S,EAAM8S,EACNzb,EAAS2b,EAGJ1c,EAAI,EAAGA,EAAI,EAAGA,IACnB6S,EAAI7S,IAAM4c,EAAI5c,GACd0J,EAAI1J,IAAMwb,EAAI9R,IAAI1J,GAClB+S,EAAK/S,IAAMwb,EAAIzI,KAAK/S,GAGnB+c,IAASA,EAAU,OAGxB,IAAI9S,EAxNR,SAAoB0S,EAAUE,EAAUhK,EAAKE,EAAMrJ,EAAKqT,GASpD,IAAIC,EAAKjB,EACLkB,EAAMjB,EACNkB,EAAMjB,EACN5U,EAAO6U,EACPiB,EAAShB,EACTiB,EAAQhB,EACRiB,EAASf,EAET3S,EAAQgH,KAAKhH,MACb2T,EAAe,EACfzY,EAAI,EACJ0Y,EAAQ,EACRC,EAAO,EACPxd,EAAI,EAKR,GADAyd,IACc,IAAVF,EAAa,OAAO,EAKxB,IAHAC,EAAOE,IAGA7Y,GAAK0Y,GAAO,CAGf,GAAII,EAAeH,GAGf,GADWI,IACD,OAAON,EAGrBE,EAAOE,IAKX,IADAJ,GAAgBC,EACXvd,EAAI,EAAGA,EAAI,EAAGA,IACf+S,EAAK/S,IAAM6S,EAAI7S,GACf0J,EAAI1J,IAAM6S,EAAI7S,GAElB,OAAOsd,EAOP,SAASG,IAKL,GAFA5Y,EAAI,EAEU,KADd0Y,EAAQ5M,KAAKmL,KAAKjJ,EAAI,GAAKA,EAAI,GAAKA,EAAI,GAAKA,EAAI,GAAKA,EAAI,GAAKA,EAAI,KAEnE,IAAK,IAAI7S,EAAI,EAAGA,EAAI,EAAGA,IAAK,CACxB,IAAI4c,EAAO/J,EAAI7S,IAAM,EACrBqH,EAAKrH,GAAK4c,EAAM,GAAK,EAErB,IAAIiB,EAAOjB,EAAMlT,EAAI1J,GAAK+S,EAAK/S,GAC/Bgd,EAAGhd,GAAK4c,EAAM7J,EAAK/S,GAAK0J,EAAI1J,GAE5Bid,EAAIjd,GAAK8d,EAAcD,EAAMxW,EAAKrH,IAClCkd,EAAIld,GAAK+d,EAAef,EAAGhd,GAAIqH,EAAKrH,IAEpCqd,EAAOrd,GAAK6S,EAAI7S,GAAKud,EAErBJ,EAAOnd,GAAK2Q,KAAKC,IAAI,EAAIyM,EAAOrd,IAEhC,IAAIiK,EAAO2S,EAAOK,EAAIjd,GAAK,EAAI6d,EAASA,EAAOZ,EAAIjd,GACnDod,EAAMpd,GAAMmd,EAAOnd,GAAKge,IAAYb,EAAOnd,GAAKiK,EAAO+T,KAQ/D,SAASL,EAAeM,GA0BpB,IAzBA,IAAIC,EAAQ7W,EAAK,GACbgM,EAAiB,IAAX4K,EAAgBhB,EAAI,GAAKC,EAAI,GACnC1J,EAAKyJ,EAAI,GAAKiB,EAEdC,EAAQ9W,EAAK,GACbiM,EAAiB,IAAX2K,EAAgBhB,EAAI,GAAKC,EAAI,GACnCzJ,EAAKwJ,EAAI,GAAKkB,EAEdC,EAAQ/W,EAAK,GACbkM,EAAiB,IAAX0K,EAAgBhB,EAAI,GAAKC,EAAI,GACnCxJ,EAAKuJ,EAAI,GAAKmB,EAeTxC,EAAIvI,EAAIuI,GAAKpI,EAAIoI,GAAKsC,EAC3B,IAAK,IAAIrW,EAAIyL,EAAIzL,GAAK4L,EAAI5L,GAAKsW,EAC3B,IAAK,IAAItC,EAAItI,EAAIsI,GAAKnI,EAAImI,GAAKuC,EAC3B,GAAIzB,EAASf,EAAG/T,EAAGgU,GAAI,OAAO,EAI1C,OAAO,EAMX,SAAS+B,IAGLN,GAAgBzY,EAChB,IAAI+X,EAAMvV,EAAKmW,GAGXhW,EAAO3C,EAAI0Y,EACXc,EAAO5B,EACX,IAAKzc,EAAI,EAAGA,EAAI,EAAGA,IAAK,CACpB,IAAIse,EAAKzL,EAAI7S,GAAKwH,EAClBuL,EAAK/S,IAAMse,EACX5U,EAAI1J,IAAMse,EACVD,EAAKre,GAAK6S,EAAI7S,GAAKse,EAevB,GAVI1B,EAAM,EACNlT,EAAI8T,GAAQ7M,KAAK9G,MAAMH,EAAI8T,IAE3BzK,EAAKyK,GAAQ7M,KAAK9G,MAAMkJ,EAAKyK,IAIvBX,EAASS,EAAcE,EAAMZ,EAAKyB,GAGnC,OAAO,EAGhB,IAAKre,EAAI,EAAGA,EAAI,EAAGA,IAAK6S,EAAI7S,GAAKqe,EAAKre,GAEtC,OADAyd,IACc,IAAVF,EAQR,SAASG,IACL,IAAIF,EAAQJ,EAAM,GAAKA,EAAM,GACvBA,EAAM,GAAKA,EAAM,GAAM,EAAI,EAC3BA,EAAM,GAAKA,EAAM,GAAM,EAAI,EAC7BrD,EAAKqD,EAAMI,GAAQ3Y,EAIvB,IAHAA,EAAIuY,EAAMI,GACVP,EAAIO,IAASnW,EAAKmW,GAClBJ,EAAMI,IAASL,EAAOK,GACjBxd,EAAI,EAAGA,EAAI,EAAGA,IACfgd,EAAGhd,IAAM+Z,EAAKsD,EAAOrd,GACrBkd,EAAIld,GAAK+d,EAAef,EAAGhd,GAAIqH,EAAKrH,IAGxC,OAAOwd,EAKX,SAASM,EAAcS,EAAOlX,GAC1B,OAAOsC,EAAM4U,EAAQlX,EAAO0V,GAEhC,SAASgB,EAAeQ,EAAOlX,GAC3B,OAAOsC,EAAM4U,EAAQlX,EAAO0V,IA4BrByB,CAAW7B,EAAUE,EAAUhK,EAAKE,EAAMrJ,EAAKqT,GAG1D,IAAKD,EAAa,CACd,IAAK9c,EAAI,EAAGA,EAAI,EAAGA,IACfe,EAAOf,GAAM4c,EAAI5c,GAAK,EAAK0J,EAAI1J,GAAKwb,EAAI9R,IAAI1J,GAAK+S,EAAK/S,GAAKwb,EAAIzI,KAAK/S,GAExEwb,EAAI7H,UAAU5S,GAIlB,OAAOkJ,I,6BCvPXvI,EAAOD,QAAU,CACf0K,KAyBF,SAAgBqB,GACd,IAAIiR,EAASlK,EAAK+B,SAAS9I,GACxBkR,EAAgBxe,OAASue,IAC1BE,EAAK7G,KAAK4G,GACVA,EAAkBC,EAAKzH,YAAYuH,IAElCG,EAAgB1e,OAASue,IAC1BE,EAAK7G,KAAK8G,GACVA,EAAkBD,EAAKzH,YAAYuH,IAElCI,EAAiB3e,OAASue,IAC3BE,EAAK7G,KAAK+G,GACVA,EAAmBF,EAAKzH,YAAYuH,IAEnCK,EAAiB5e,OAASue,IAC3BE,EAAK7G,KAAKgH,GACVA,EAAmBH,EAAKzH,YAAYuH,IAEnCM,EAAmB7e,OAASue,IAC7BE,EAAK7G,KAAKiH,GACVA,EAAqBJ,EAAKzH,YAAYuH,IAErCO,EAAmB9e,OAASue,IAC7BE,EAAK7G,KAAKkH,GACVA,EAAqBL,EAAKzH,YAAYuH,IAExC,IAAIQ,EAAc,EAAIR,EACnBS,EAAahf,OAAS+e,IACvBN,EAAK7G,KAAKoH,GACVA,EAAeP,EAAKrH,aAAa2H,KArDnCE,eAwEF,SACIhb,EAAGib,EACHC,EAAWC,EAAQC,EAAKC,EACxBC,EAAWC,EAASC,EAAMC,GAc5B,IALA,IAAIC,EAAW,EACXC,EAAW,EAAE3b,EACb4b,EAAW5b,EAAE,EACb6b,EAAWF,EAAS,EAEhB9f,EAAEqf,EAAUrf,EAAEsf,IAAUtf,EAAG,CACjC,IAAIgS,EAAMwN,EAASxf,GACfigB,EAAYH,EAAS9f,EACzBkf,EAAaW,KAASN,EAAIU,EAAUF,GACpCb,EAAaW,OAAW7N,EAAI,GAC5BkN,EAAaW,KAASN,EAAIU,EAAUD,GACpCd,EAAaW,KAAS7N,EAGxB,IAAQhS,EAAEyf,EAAWzf,EAAE0f,IAAW1f,EAAG,CAC/BgS,EAAM4N,EAAU5f,IAxFP,GAAG,IAwFhB,IACIkgB,EAAaJ,EAAS9f,EAC1Bkf,EAAaW,KAASF,EAAKO,EAAWH,GACtCb,EAAaW,MAAU7N,EACvBkN,EAAaW,KAASF,EAAKO,EAAWF,GACtCd,EAAaW,KAAS7N,EAIxB,IAAI5M,EAAIya,IAAQ,EAChBM,EAAMjB,EAAc9Z,GAEpB,IAAIgb,EAAa,EACbC,EAAa,EACjB,IAAQrgB,EAAE,EAAGA,EAAEoF,IAAKpF,EAAG,CACrB,IAAI4B,EAAwB,EAApBsd,EAAa,EAAElf,EAAE,GACzB,GAAG4B,GAxGU,GAAG,GA2Gd0e,EAAMzB,EAAkBC,EAAkBuB,IAD1Cze,EAAKA,GA1GM,GAAG,IA0GI,QAEb,GAAGA,GAAK,EAEb0e,EAAM5B,EAAiBE,EAAiBwB,IAAaxe,QAChD,GAAGA,KA/GG,GAAG,IA+GW,CAEzBA,GAAMA,GAjHK,GAAG,IAiHK,EACnB,IAAI,IAAIV,EAAE,EAAGA,EAAEkf,IAAalf,EAAG,CAE7B,QAAc,KADVqf,EAASnB,EAAMV,EAAgBxd,GAAIU,IAErC,OAAO2e,EAGXC,EAAO3B,EAAkBC,EAAkBuB,IAAcze,OACpD,CAELA,GAAMA,EAAE,EAAG,EACX,IAAQV,EAAE,EAAGA,EAAEmf,IAAcnf,EAAG,CAC9B,IAAIqf,EACJ,QAAc,KADVA,EAASnB,EAAMxd,EAAGid,EAAiB3d,KAErC,OAAOqf,EAGXC,EAAO9B,EAAiBE,EAAiBwB,IAAaxe,MA5I1D6e,cAkJF,SAAuBtc,EAAGib,EACxBC,EAAUC,EAAQC,EAAKC,EACvBC,EAAWC,EAASC,EAAMC,GAO1B,IALA,IAAIC,EAAW,EACXC,EAAW,EAAE3b,EACb4b,EAAW5b,EAAE,EACb6b,EAAWF,EAAS,EAEhB9f,EAAEqf,EAAUrf,EAAEsf,IAAUtf,EAAG,CACjC,IAAIgS,EAAOwN,EAASxf,GAAG,GAAI,EACvBigB,EAAYH,EAAS9f,EACzBkf,EAAaW,KAASN,EAAIU,EAAUF,GACpCb,EAAaW,MAAU7N,EACvBkN,EAAaW,KAASN,EAAIU,EAAUD,GACpCd,EAAaW,KAAS7N,EAGxB,IAAQhS,EAAEyf,EAAWzf,EAAE0f,IAAW1f,EAAG,CAC/BgS,EAAO4N,EAAU5f,GAAG,GAAI,EAA5B,IACIkgB,EAAaJ,EAAS9f,EAC1Bkf,EAAaW,KAASF,EAAKO,EAAWH,GACtCb,EAAaW,KAAgB,GAAL7N,EACxBkN,EAAaW,KAASF,EAAKO,EAAWF,GACtCd,EAAaW,KAAa,EAAJ7N,EAIxB,IAAI5M,EAAIya,IAAQ,EAChBM,EAAMjB,EAAc9Z,GAEpB,IAAIgb,EAAe,EACfC,EAAe,EACfK,EAAe,EACnB,IAAQ1gB,EAAE,EAAGA,EAAEoF,IAAKpF,EAAG,CACrB,IAAI4B,EAA4B,EAApBsd,EAAa,EAAElf,EAAE,GACzB2gB,EAAU,EAAF/e,EAMZ,GALG5B,EAAIoF,EAAE,GAAMxD,GAAG,GAAQsd,EAAa,EAAElf,EAAE,IAAI,IAC7C2gB,EAAQ,EACR3gB,GAAK,GAGJ4B,EAAI,EAAG,CAKR,IAHA,IAAIsZ,IAAOtZ,GAAG,GAAK,EAGXV,EAAE,EAAGA,EAAEwf,IAAgBxf,EAAG,CAEhC,QAAc,KADVqf,EAASnB,EAAML,EAAmB7d,GAAIga,IAExC,OAAOqF,EAIX,GAAa,IAAVI,EAED,IAAQzf,EAAE,EAAGA,EAAEkf,IAAalf,EAAG,CAE7B,QAAc,KADVqf,EAASnB,EAAMV,EAAgBxd,GAAIga,IAErC,OAAOqF,EAKb,GAAa,IAAVI,EAED,IAAQzf,EAAE,EAAGA,EAAEmf,IAAcnf,EAAG,CAC9B,IAAIqf,EACJ,QAAc,KADVA,EAASnB,EAAMP,EAAiB3d,GAAIga,IAEtC,OAAOqF,EAKA,IAAVI,EAEDH,EAAO9B,EAAiBE,EAAiBwB,IAAalF,GACpC,IAAVyF,EAERH,EAAO3B,EAAkBC,EAAkBuB,IAAcnF,GACvC,IAAVyF,GAERH,EAAOzB,EAAoBC,EAAoB0B,IAAgBxF,OAE5D,CAEDA,GAAMtZ,GAAG,GAAK,EACL,IAAV+e,EAEDL,EAAM5B,EAAiBE,EAAiBwB,IAAalF,GACnC,IAAVyF,EAERL,EAAMzB,EAAkBC,EAAkBuB,IAAcnF,GACtC,IAAVyF,GAERL,EAAMvB,EAAoBC,EAAoB0B,IAAgBxF,MAhPpE0F,cAyPF,SACEzc,EAAGqZ,EAAM4B,EAAOyB,EAChBxB,EAAWC,EAAQC,EAAKC,EACxBC,EAAWC,EAASC,EAAMC,GAE1B,IAAIC,EAAW,EACXC,EAAW,EAAE3b,EACb4b,EAAWvC,EACXwC,EAAWxC,EAAKrZ,EAEhB2c,EAAY,EACZC,EAAY,EACbF,EACDE,EA7Pa,GAAG,GA+PhBD,EA/Pa,GAAG,GAkQlB,IAAI,IAAI9gB,EAAEqf,EAAUrf,EAAEsf,IAAUtf,EAAG,CACjC,IAAIgS,EAAMhS,EAAI8gB,EACVb,EAAYH,EAAS9f,EACzBkf,EAAaW,KAASN,EAAIU,EAAUF,GACpCb,EAAaW,MAAU7N,EACvBkN,EAAaW,KAASN,EAAIU,EAAUD,GACpCd,EAAaW,KAAS7N,EAExB,IAAQhS,EAAEyf,EAAWzf,EAAE0f,IAAW1f,EAAG,CAC/BgS,EAAMhS,EAAI+gB,EAAd,IACIb,EAAaJ,EAAS9f,EAC1Bkf,EAAaW,KAASF,EAAKO,EAAWH,GACtCb,EAAaW,MAAU7N,EAIzB,IAAI5M,EAAIya,IAAQ,EAChBM,EAAMjB,EAAc9Z,GAEpB,IAAIgb,EAAe,EACnB,IAAQpgB,EAAE,EAAGA,EAAEoF,IAAKpF,EAAG,CACrB,IAAI4B,EAAwB,EAApBsd,EAAa,EAAElf,EAAE,GACzB,GAAG4B,EAAI,EAAG,CACR,IACIof,GAAQ,EAQZ,IATIhP,GAASpQ,IAzRF,GAAG,IA4RZof,GAASH,EACT7O,GA7RS,GAAG,KA+RZgP,IAAUH,EACV7O,GAAO,GAENgP,EACDR,EAAO9B,EAAiBE,EAAiBwB,IAAapO,OACjD,CACL,IAAIiP,EAAUrB,EAAU5N,GACpBkP,EAAUpB,EAAW9N,EAErBmP,EAAKxB,EAAKuB,EAAQ1D,EAAK,GACvB4D,EAAKzB,EAAKuB,EAAQ1D,EAAK,EAAErZ,GAErCkd,EACQ,IAAI,IAAIngB,EAAE,EAAGA,EAAEkf,IAAalf,EAAG,CAC7B,IAAIogB,EAAS5C,EAAgBxd,GACzBqgB,EAASzB,EAAWwB,EAExB,KAAGF,EAAK7B,EAAIgC,EAAO/D,EAAK,IACrB+B,EAAIgC,EAAO/D,EAAK,EAAErZ,GAAKgd,GAD1B,CAKA,IAAI,IAAIK,EAAEhE,EAAK,EAAGgE,EAAErd,IAAKqd,EACvB,GAAG7B,EAAKuB,EAAUM,EAAIrd,GAAKob,EAAIgC,EAASC,IACrCjC,EAAIgC,EAASC,EAAIrd,GAAKwb,EAAKuB,EAAUM,GACtC,SAASH,EAIb,IACId,EADAkB,EAASjC,EAAS8B,GAOtB,QAAc,KAJZf,EADCM,EACQzB,EAAM6B,EAAQQ,GAEdrC,EAAMqC,EAAOR,IAGtB,OAAOV,UAKbD,EAAM5B,EAAiBE,EAAiBwB,IAAaxe,EAAIkf,KAjV7DY,aAsVF,SACEvd,EAAGqZ,EAAM4B,EACTC,EAAWC,EAAQC,EAAKC,EACxBC,EAAWC,EAASC,EAAMC,GAO1B,IALA,IAAIC,EAAW,EACXC,EAAW,EAAE3b,EACb4b,EAAWvC,EACXwC,EAAWxC,EAAKrZ,EAEZnE,EAAEqf,EAAUrf,EAAEsf,IAAUtf,EAAG,CACjC,IAAIgS,EAAMhS,GAzVG,GAAG,IA0VZigB,EAAYH,EAAS9f,EACzBkf,EAAaW,KAASN,EAAIU,EAAUF,GACpCb,EAAaW,MAAU7N,EACvBkN,EAAaW,KAASN,EAAIU,EAAUD,GACpCd,EAAaW,KAAS7N,EAExB,IAAQhS,EAAEyf,EAAWzf,EAAE0f,IAAW1f,EAAG,CAC/BgS,EAAMhS,EAAI,EAAd,IACIkgB,EAAaJ,EAAS9f,EAC1Bkf,EAAaW,KAASF,EAAKO,EAAWH,GACtCb,EAAaW,MAAU7N,EAIzB,IAAI5M,EAAIya,IAAQ,EAChBM,EAAMjB,EAAc9Z,GAEpB,IAAIgb,EAAe,EACnB,IAAQpgB,EAAE,EAAGA,EAAEoF,IAAKpF,EAAG,CACrB,IAAI4B,EAAwB,EAApBsd,EAAa,EAAElf,EAAE,GACzB,GAAG4B,EAAI,EAAG,CAER,IADIoQ,GAASpQ,IA/WF,GAAG,GAiXZ8c,EAAgB0B,KAAepO,GAjXtB,GAAG,QAkXP,CAEL,IAAIiP,EAAUrB,EADd5N,GAAO,GAEHkP,EAAUpB,EAAW9N,EAErBmP,EAAKxB,EAAKuB,EAAQ1D,EAAK,GACvB4D,EAAKzB,EAAKuB,EAAQ1D,EAAK,EAAErZ,GAErCkd,EACQ,IAAI,IAAIngB,EAAE,EAAGA,EAAEkf,IAAalf,EAAG,CAC7B,IAAIogB,EAAS5C,EAAgBxd,GACzBugB,EAASjC,EAAS8B,GAEtB,GAAGG,IAAUR,EACX,MAGF,IAAIM,EAASzB,EAAWwB,EACxB,KAAGF,EAAK7B,EAAIgC,EAAO/D,EAAK,IACtB+B,EAAIgC,EAAO/D,EAAK,EAAErZ,GAAKgd,GADzB,CAIA,IAAI,IAAIK,EAAEhE,EAAK,EAAGgE,EAAErd,IAAKqd,EACvB,GAAG7B,EAAKuB,EAAUM,EAAIrd,GAAKob,EAAIgC,EAASC,IACrCjC,EAAIgC,EAASC,EAAIrd,GAAOwb,EAAKuB,EAAUM,GACxC,SAASH,EAIb,IAAId,EAASnB,EAAMqC,EAAOR,GAC1B,QAAc,IAAXV,EACD,OAAOA,SAIR,CAEL,IADIvO,EAAMpQ,GAtZC,GAAG,IAuZNV,EAAEkf,EAAU,EAAGlf,GAAG,IAAKA,EAC7B,GAAGwd,EAAgBxd,KAAO8Q,EAAK,CAC7B,IAAQwP,EAAEtgB,EAAE,EAAGsgB,EAAEpB,IAAaoB,EAC5B9C,EAAgB8C,EAAE,GAAK9C,EAAgB8C,GAEzC,QAGFpB,MApaR,IAAIzB,EAAQ,EAAQ,IAChBpK,EAAQ,EAAQ,KAChB4L,EAAQ,EAAQ,KAOhBzB,EAAqBC,EAAKzH,YADL,MAErB0H,EAAqBD,EAAKzH,YAFL,MAGrB2H,EAAqBF,EAAKzH,YAHL,MAIrB4H,EAAqBH,EAAKzH,YAJL,MAKrB6H,EAAqBJ,EAAKzH,YALL,MAMrB8H,EAAqBL,EAAKzH,YANL,MAOrBgI,EAAqBP,EAAKrH,aAAaqK,MAqC3C,SAASrB,EAAMsB,EAAOjS,EAAOnC,EAAOqU,GAClC,IAAI7P,EAAMrC,EAAMkS,GACZC,EAAMF,EAAMpU,EAAM,GACtBoU,EAAM5P,GAAO8P,EACbnS,EAAMmS,GAAO9P,EAIf,SAASwO,EAAOoB,EAAOjS,EAAOnC,EAAOqU,GACnCD,EAAMpU,GAASqU,EACflS,EAAMkS,GAASrU,I,6BCFjB,SAASuU,EAAmBzZ,GAC1B,IAAIpE,EAAI,GAQR,OAPAoE,IAAMA,IACCpE,IACC,MAAJoE,IAAgBpE,GAAK,IACjB,SAAJoE,IAAgBpE,GAAK,GACjB,UAAJoE,IAAgBpE,GAAK,GACjB,UAAJoE,IAAgBpE,GAAK,GACjB,WAAJoE,IAAgBpE,GAAK,GAClBA,EAhETzC,EAAQugB,SAHO,GAIfvgB,EAAQwgB,QAAa,WACrBxgB,EAAQygB,SAAa,GAAG,GAGxBzgB,EAAQ0gB,KAAO,SAAS7Z,GACtB,OAAQA,EAAI,IAAMA,EAAI,IAIxB7G,EAAQmP,IAAM,SAAStI,GACrB,IAAI8Z,EAAO9Z,GAAK,GAChB,OAAQA,EAAI8Z,GAAQA,GAItB3gB,EAAQgI,IAAM,SAASmS,EAAG/T,GACxB,OAAOA,GAAM+T,EAAI/T,KAAO+T,EAAI/T,IAI9BpG,EAAQiI,IAAM,SAASkS,EAAG/T,GACxB,OAAO+T,GAAMA,EAAI/T,KAAO+T,EAAI/T,IAI9BpG,EAAQ4gB,OAAS,SAAS/Z,GACxB,QAASA,EAAKA,EAAE,IAAUA,IAI5B7G,EAAQ2U,KAAO,SAAS9N,GACtB,IAAI7D,EAAG9D,EAKP,OAJA8D,GAAS6D,EAAI,QAAW,EACiB7D,GAAzC9D,IAD2B2H,KAAO7D,GACrB,MAAW,EACiBA,GAAzC9D,IAD2B2H,KAAO3H,GACrB,KAAW,GACiB8D,GAAzC9D,IAD2B2H,KAAO3H,GACrB,IAAW,IAAG2H,KAAO3H,IACjB,GAInBc,EAAQ6gB,MAAQ,SAASha,GACvB,OAASA,GAAK,IAAc,EAAKA,GAAK,IAAa,EAAKA,GAAK,IAAY,EAChEA,GAAK,IAAW,EAAKA,GAAK,IAAU,EAAKA,GAAK,IAAS,EACvDA,GAAK,IAAQ,EAAKA,GAAK,IAAO,EAAKA,GAAK,GAAM,EAAI,GAI7D7G,EAAQ8gB,SAAW,SAASja,GAG1B,OAAsC,WADtCA,GAAS,WADTA,GAAUA,IAAM,EAAK,cACIA,IAAM,EAAK,aACtBA,IAAM,GAAK,aAA4B,IAevD7G,EAAQsgB,mBAAqBA,EAG7BtgB,EAAQ6U,SAAW,SAAShO,GAQ1B,OAPAA,GAAW,IAANA,IACHA,EACFA,GAAKA,IAAM,EACXA,GAAKA,IAAM,EACXA,GAAKA,IAAM,EACXA,GAAKA,IAAM,GACXA,GAAKA,IAAM,IACA,GAIb7G,EAAQ+gB,SAAW,SAASla,GAM1B,OALAA,GAAKA,IAAM,EACXA,GAAKA,IAAM,EACXA,GAAKA,IAAM,EACXA,GAAKA,IAAM,GACXA,GAAKA,IAAM,KACCA,IAAI,IAIlB7G,EAAQghB,OAAS,SAASna,GAKxB,OAJAA,GAAKA,IAAM,GACXA,GAAKA,IAAM,EACXA,GAAKA,IAAM,EAEH,SADRA,GAAK,IACmB,GAG1B,IAAIoa,EAAgB,IAAIxc,MAAM,MAE9B,SAAUyc,GACR,IAAI,IAAI3iB,EAAE,EAAGA,EAAE,MAAOA,EAAG,CACvB,IAAIsI,EAAItI,EAAGyE,EAAIzE,EAAGsB,EAAI,EACtB,IAAKgH,KAAO,EAAGA,EAAGA,KAAO,EACvB7D,IAAM,EACNA,GAAS,EAAJ6D,IACHhH,EAEJqhB,EAAI3iB,GAAMyE,GAAKnD,EAAK,KARxB,CAUGohB,GAGHjhB,EAAQmhB,QAAU,SAASta,GACzB,OAASoa,EAA2B,IAAZpa,IAAqB,GACpCoa,EAAepa,IAAM,EAAM,MAAS,GACpCoa,EAAepa,IAAM,GAAM,MAAS,EACpCoa,EAAepa,IAAM,GAAM,MAItC7G,EAAQohB,YAAc,SAASjH,EAAG/T,GAahC,OARA+T,EAAqB,aADrBA,EAAqB,YADrBA,EAAqB,YADrBA,EAAqB,WADrBA,GAAK,OACKA,GAAK,IACLA,GAAK,IACLA,GAAK,IACLA,GAAK,KAMf/T,EAAqB,aADrBA,EAAqB,YADrBA,EAAqB,YADrBA,EAAqB,WADrBA,GAAK,OACKA,GAAK,IACLA,GAAK,IACLA,GAAK,IACLA,GAAK,KAEE,GAInBpG,EAAQqhB,cAAgB,SAASxa,EAAGlD,GAMlC,OADAkD,EAAuB,QADvBA,EAAuB,WADvBA,EAAuB,YADvBA,EAAuB,YADvBA,EAAKA,IAAMlD,EAAK,YACNkD,IAAM,IACNA,IAAM,IACNA,IAAM,IACNA,IAAM,MACH,IAAO,IAKtB7G,EAAQshB,YAAc,SAASnH,EAAG/T,EAAGgU,GAoBnC,OAfAD,EAAqB,aADrBA,EAAqB,aADrBA,EAAqB,YADrBA,EAAqB,aADrBA,GAAK,MACMA,GAAG,KACHA,GAAG,IACHA,GAAG,IACHA,GAAG,IAOdA,IADA/T,EAAqB,aADrBA,EAAqB,aADrBA,EAAqB,YADrBA,EAAqB,aADrBA,GAAK,MACMA,GAAG,KACHA,GAAG,IACHA,GAAG,IACHA,GAAG,KACH,IAMXgU,EAAqB,aADrBA,EAAqB,aADrBA,EAAqB,YADrBA,EAAqB,aADrBA,GAAK,MACMA,GAAG,KACHA,GAAG,IACHA,GAAG,IACHA,GAAG,KAEG,GAInBpa,EAAQuhB,cAAgB,SAAS1a,EAAGlD,GAMlC,OADAkD,EAAsB,OADtBA,EAAsB,aADtBA,EAAsB,YADtBA,EAAsB,aADtBA,EAAKA,IAAMlD,EAAW,YACZkD,IAAI,IACJA,IAAI,IACJA,IAAI,IACJA,IAAI,MACH,IAAK,IAIlB7G,EAAQwhB,gBAAkB,SAAS3a,GACjC,IAAIzD,EAAIyD,EAAKA,EAAI,EACjB,OAAQzD,EAAI,IAASA,IAAMA,GAAK,IAAQkd,EAAmBzZ,GAAK,I,6BCvMlE5G,EAAOD,QAIP,SAAsByhB,EAAWzX,GAC/B,IAAI0X,EAAO,SAASC,MAAM,IAAItX,OAAOL,GACjC4X,EAAQ,GACTH,EAAUI,QAAQ,OAAS,GAC5BD,EAAM7iB,KAAK,aAEV0iB,EAAUI,QAAQ,OAAS,GAC5BD,EAAM7iB,KAAK,aAKb,OAHA2iB,EAAM3iB,KAXG,4LAYF+iB,QAAQ,IAAKF,EAAMnS,QACnBqS,QAAQ,IAAKL,IACbxX,SAAS7K,WAAM,EAAQsiB,K,yCClBhCzhB,EAAOD,QAQP,SAAe8O,GACX,IAAIoL,EAAM,IAAItE,aAAa,GAI3B,OAHAsE,EAAI,GAAKpL,EAAE,GACXoL,EAAI,GAAKpL,EAAE,GACXoL,EAAI,GAAKpL,EAAE,GACJoL,I,gBCbXja,EAAOD,QAYP,SAAe8O,EAAGxK,GACd,IAAIyd,EAAQ3a,EAAW0H,EAAE,GAAIA,EAAE,GAAIA,EAAE,IACjCkT,EAAQ5a,EAAW9C,EAAE,GAAIA,EAAE,GAAIA,EAAE,IAErC0E,EAAU+Y,EAAOA,GACjB/Y,EAAUgZ,EAAOA,GAEjB,IAAIC,EAAShZ,EAAI8Y,EAAOC,GAExB,OAAGC,EAAS,EACD,EAEA/S,KAAKgT,KAAKD,IAtBzB,IAAI7a,EAAa,EAAQ,KACrB4B,EAAY,EAAQ,KACpBC,EAAM,EAAQ,M,cCJlBhJ,EAAOD,QASP,SAAcka,EAAKpL,GAIf,OAHAoL,EAAI,GAAKpL,EAAE,GACXoL,EAAI,GAAKpL,EAAE,GACXoL,EAAI,GAAKpL,EAAE,GACJoL,I,cCbXja,EAAOD,QAWP,SAAaka,EAAKC,EAAG/T,EAAGgU,GAIpB,OAHAF,EAAI,GAAKC,EACTD,EAAI,GAAK9T,EACT8T,EAAI,GAAKE,EACFF,I,gBCfXja,EAAOD,QAWP,SAAgB8O,EAAGxK,GACjB,IAAI6d,EAAKrT,EAAE,GACPsT,EAAKtT,EAAE,GACPuT,EAAKvT,EAAE,GACP4Q,EAAKpb,EAAE,GACPqb,EAAKrb,EAAE,GACPge,EAAKhe,EAAE,GACX,OAAQ4K,KAAKC,IAAIgT,EAAKzC,IAAOzY,EAAUiI,KAAKjH,IAAI,EAAKiH,KAAKC,IAAIgT,GAAKjT,KAAKC,IAAIuQ,KACpExQ,KAAKC,IAAIiT,EAAKzC,IAAO1Y,EAAUiI,KAAKjH,IAAI,EAAKiH,KAAKC,IAAIiT,GAAKlT,KAAKC,IAAIwQ,KACpEzQ,KAAKC,IAAIkT,EAAKC,IAAOrb,EAAUiI,KAAKjH,IAAI,EAAKiH,KAAKC,IAAIkT,GAAKnT,KAAKC,IAAImT,KAlB9E,IAAIrb,EAAU,EAAQ,M,cCFtBhH,EAAOD,QASP,SAAqB8O,EAAGxK,GACtB,OAAOwK,EAAE,KAAOxK,EAAE,IAAMwK,EAAE,KAAOxK,EAAE,IAAMwK,EAAE,KAAOxK,EAAE,K,cCVtDrE,EAAOD,QAUP,SAAaka,EAAKpL,EAAGxK,GAIjB,OAHA4V,EAAI,GAAKpL,EAAE,GAAKxK,EAAE,GAClB4V,EAAI,GAAKpL,EAAE,GAAKxK,EAAE,GAClB4V,EAAI,GAAKpL,EAAE,GAAKxK,EAAE,GACX4V,I,gBCdXja,EAAOD,QAAU,EAAQ,M,gBCAzBC,EAAOD,QAAU,EAAQ,M,gBCAzBC,EAAOD,QAAU,EAAQ,M,cCAzBC,EAAOD,QAUP,SAAaka,EAAKpL,EAAGxK,GAIjB,OAHA4V,EAAI,GAAKhL,KAAKlH,IAAI8G,EAAE,GAAIxK,EAAE,IAC1B4V,EAAI,GAAKhL,KAAKlH,IAAI8G,EAAE,GAAIxK,EAAE,IAC1B4V,EAAI,GAAKhL,KAAKlH,IAAI8G,EAAE,GAAIxK,EAAE,IACnB4V,I,cCdXja,EAAOD,QAUP,SAAaka,EAAKpL,EAAGxK,GAIjB,OAHA4V,EAAI,GAAKhL,KAAKjH,IAAI6G,EAAE,GAAIxK,EAAE,IAC1B4V,EAAI,GAAKhL,KAAKjH,IAAI6G,EAAE,GAAIxK,EAAE,IAC1B4V,EAAI,GAAKhL,KAAKjH,IAAI6G,EAAE,GAAIxK,EAAE,IACnB4V,I,cCdXja,EAAOD,QASP,SAAeka,EAAKpL,GAIlB,OAHAoL,EAAI,GAAKhL,KAAKhH,MAAM4G,EAAE,IACtBoL,EAAI,GAAKhL,KAAKhH,MAAM4G,EAAE,IACtBoL,EAAI,GAAKhL,KAAKhH,MAAM4G,EAAE,IACfoL,I,cCbTja,EAAOD,QASP,SAAcka,EAAKpL,GAIjB,OAHAoL,EAAI,GAAKhL,KAAK/G,KAAK2G,EAAE,IACrBoL,EAAI,GAAKhL,KAAK/G,KAAK2G,EAAE,IACrBoL,EAAI,GAAKhL,KAAK/G,KAAK2G,EAAE,IACdoL,I,cCbTja,EAAOD,QASP,SAAeka,EAAKpL,GAIlB,OAHAoL,EAAI,GAAKhL,KAAK9G,MAAM0G,EAAE,IACtBoL,EAAI,GAAKhL,KAAK9G,MAAM0G,EAAE,IACtBoL,EAAI,GAAKhL,KAAK9G,MAAM0G,EAAE,IACfoL,I,cCbTja,EAAOD,QAUP,SAAeka,EAAKpL,EAAGxK,GAInB,OAHA4V,EAAI,GAAKpL,EAAE,GAAKxK,EAChB4V,EAAI,GAAKpL,EAAE,GAAKxK,EAChB4V,EAAI,GAAKpL,EAAE,GAAKxK,EACT4V,I,cCdXja,EAAOD,QAWP,SAAqBka,EAAKpL,EAAGxK,EAAG+D,GAI5B,OAHA6R,EAAI,GAAKpL,EAAE,GAAMxK,EAAE,GAAK+D,EACxB6R,EAAI,GAAKpL,EAAE,GAAMxK,EAAE,GAAK+D,EACxB6R,EAAI,GAAKpL,EAAE,GAAMxK,EAAE,GAAK+D,EACjB6R,I,gBCfXja,EAAOD,QAAU,EAAQ,M,gBCAzBC,EAAOD,QAAU,EAAQ,M,gBCAzBC,EAAOD,QAAU,EAAQ,M,gBCAzBC,EAAOD,QAAU,EAAQ,M,cCAzBC,EAAOD,QASP,SAAgBka,EAAKpL,GAIjB,OAHAoL,EAAI,IAAMpL,EAAE,GACZoL,EAAI,IAAMpL,EAAE,GACZoL,EAAI,IAAMpL,EAAE,GACLoL,I,cCbXja,EAAOD,QASP,SAAiBka,EAAKpL,GAIpB,OAHAoL,EAAI,GAAK,EAAMpL,EAAE,GACjBoL,EAAI,GAAK,EAAMpL,EAAE,GACjBoL,EAAI,GAAK,EAAMpL,EAAE,GACVoL,I,cCbTja,EAAOD,QAUP,SAAeka,EAAKpL,EAAGxK,GACnB,IAAIie,EAAKzT,EAAE,GAAI0T,EAAK1T,EAAE,GAAI2T,EAAK3T,EAAE,GAC7B4T,EAAKpe,EAAE,GAAI6N,EAAK7N,EAAE,GAAIqe,EAAKre,EAAE,GAKjC,OAHA4V,EAAI,GAAKsI,EAAKG,EAAKF,EAAKtQ,EACxB+H,EAAI,GAAKuI,EAAKC,EAAKH,EAAKI,EACxBzI,EAAI,GAAKqI,EAAKpQ,EAAKqQ,EAAKE,EACjBxI,I,cCjBXja,EAAOD,QAWP,SAAcka,EAAKpL,EAAGxK,EAAGlB,GACrB,IAAImf,EAAKzT,EAAE,GACP0T,EAAK1T,EAAE,GACP2T,EAAK3T,EAAE,GAIX,OAHAoL,EAAI,GAAKqI,EAAKnf,GAAKkB,EAAE,GAAKie,GAC1BrI,EAAI,GAAKsI,EAAKpf,GAAKkB,EAAE,GAAKke,GAC1BtI,EAAI,GAAKuI,EAAKrf,GAAKkB,EAAE,GAAKme,GACnBvI,I,cClBXja,EAAOD,QASP,SAAgBka,EAAK7R,GACjBA,EAAQA,GAAS,EAEjB,IAAIrF,EAAoB,EAAhBkM,KAAK9F,SAAiB8F,KAAK0T,GAC/BxI,EAAqB,EAAhBlL,KAAK9F,SAAkB,EAC5ByZ,EAAS3T,KAAKmL,KAAK,EAAID,EAAEA,GAAK/R,EAKlC,OAHA6R,EAAI,GAAKhL,KAAK4T,IAAI9f,GAAK6f,EACvB3I,EAAI,GAAKhL,KAAK6T,IAAI/f,GAAK6f,EACvB3I,EAAI,GAAKE,EAAI/R,EACN6R,I,cCnBXja,EAAOD,QAWP,SAAuBka,EAAKpL,EAAGtM,GAC3B,IAAI2X,EAAIrL,EAAE,GAAI1I,EAAI0I,EAAE,GAAIsL,EAAItL,EAAE,GAC1BlD,EAAIpJ,EAAE,GAAK2X,EAAI3X,EAAE,GAAK4D,EAAI5D,EAAE,IAAM4X,EAAI5X,EAAE,IAK5C,OAJAoJ,EAAIA,GAAK,EACTsO,EAAI,IAAM1X,EAAE,GAAK2X,EAAI3X,EAAE,GAAK4D,EAAI5D,EAAE,GAAK4X,EAAI5X,EAAE,KAAOoJ,EACpDsO,EAAI,IAAM1X,EAAE,GAAK2X,EAAI3X,EAAE,GAAK4D,EAAI5D,EAAE,GAAK4X,EAAI5X,EAAE,KAAOoJ,EACpDsO,EAAI,IAAM1X,EAAE,GAAK2X,EAAI3X,EAAE,GAAK4D,EAAI5D,EAAE,IAAM4X,EAAI5X,EAAE,KAAOoJ,EAC9CsO,I,cClBXja,EAAOD,QAUP,SAAuBka,EAAKpL,EAAGtM,GAC3B,IAAI2X,EAAIrL,EAAE,GAAI1I,EAAI0I,EAAE,GAAIsL,EAAItL,EAAE,GAI9B,OAHAoL,EAAI,GAAKC,EAAI3X,EAAE,GAAK4D,EAAI5D,EAAE,GAAK4X,EAAI5X,EAAE,GACrC0X,EAAI,GAAKC,EAAI3X,EAAE,GAAK4D,EAAI5D,EAAE,GAAK4X,EAAI5X,EAAE,GACrC0X,EAAI,GAAKC,EAAI3X,EAAE,GAAK4D,EAAI5D,EAAE,GAAK4X,EAAI5X,EAAE,GAC9B0X,I,cCfXja,EAAOD,QAUP,SAAuBka,EAAKpL,EAAGkU,GAG3B,IAAI7I,EAAIrL,EAAE,GAAI1I,EAAI0I,EAAE,GAAIsL,EAAItL,EAAE,GAC1BmU,EAAKD,EAAE,GAAIE,EAAKF,EAAE,GAAIG,EAAKH,EAAE,GAAII,EAAKJ,EAAE,GAGxCK,EAAKD,EAAKjJ,EAAI+I,EAAK9I,EAAI+I,EAAK/c,EAC5Bkd,EAAKF,EAAKhd,EAAI+c,EAAKhJ,EAAI8I,EAAK7I,EAC5BmJ,EAAKH,EAAKhJ,EAAI6I,EAAK7c,EAAI8c,EAAK/I,EAC5BqJ,GAAMP,EAAK9I,EAAI+I,EAAK9c,EAAI+c,EAAK/I,EAMjC,OAHAF,EAAI,GAAKmJ,EAAKD,EAAKI,GAAMP,EAAKK,GAAMH,EAAKI,GAAML,EAC/ChJ,EAAI,GAAKoJ,EAAKF,EAAKI,GAAMN,EAAKK,GAAMN,EAAKI,GAAMF,EAC/CjJ,EAAI,GAAKqJ,EAAKH,EAAKI,GAAML,EAAKE,GAAMH,EAAKI,GAAML,EACxC/I,I,cC1BXja,EAAOD,QAUP,SAAiBka,EAAKpL,EAAGxK,EAAG7B,GACxB,IAAI0P,EAAK7N,EAAE,GACPqe,EAAKre,EAAE,GAGPmf,EAAK3U,EAAE,GAAKqD,EACZuR,EAAK5U,EAAE,GAAK6T,EAEZgB,EAAKzU,KAAK6T,IAAItgB,GACdmhB,EAAK1U,KAAK4T,IAAIrgB,GAOlB,OAJAyX,EAAI,GAAKpL,EAAE,GACXoL,EAAI,GAAK/H,EAAKsR,EAAKG,EAAKF,EAAKC,EAC7BzJ,EAAI,GAAKyI,EAAKc,EAAKE,EAAKD,EAAKE,EAEtB1J,I,cC1BXja,EAAOD,QAUP,SAAiBka,EAAKpL,EAAGxK,EAAG7B,GACxB,IAAIigB,EAAKpe,EAAE,GACPqe,EAAKre,EAAE,GAGPuf,EAAK/U,EAAE,GAAK4T,EACZgB,EAAK5U,EAAE,GAAK6T,EAEZgB,EAAKzU,KAAK6T,IAAItgB,GACdmhB,EAAK1U,KAAK4T,IAAIrgB,GAOlB,OAJAyX,EAAI,GAAKwI,EAAKgB,EAAKC,EAAKE,EAAKD,EAC7B1J,EAAI,GAAKpL,EAAE,GACXoL,EAAI,GAAKyI,EAAKe,EAAKE,EAAKC,EAAKF,EAEtBzJ,I,cC1BXja,EAAOD,QAUP,SAAiBka,EAAKpL,EAAGxK,EAAG7B,GACxB,IAAIigB,EAAKpe,EAAE,GACP6N,EAAK7N,EAAE,GAGPuf,EAAK/U,EAAE,GAAK4T,EACZe,EAAK3U,EAAE,GAAKqD,EAEZwR,EAAKzU,KAAK6T,IAAItgB,GACdmhB,EAAK1U,KAAK4T,IAAIrgB,GAOlB,OAJAyX,EAAI,GAAKwI,EAAKmB,EAAKD,EAAKH,EAAKE,EAC7BzJ,EAAI,GAAK/H,EAAK0R,EAAKF,EAAKF,EAAKG,EAC7B1J,EAAI,GAAKpL,EAAE,GAEJoL,I,gBC1BXja,EAAOD,QAgBP,SAAiB8O,EAAGE,EAAQyB,EAAQ1E,EAAO+X,EAAI9W,GACvC,IAAIzO,EAAG2B,EACH8O,IACAA,EAAS,GAGTyB,IACAA,EAAS,GAITvQ,EADD6L,EACKmD,KAAKlH,IAAK+D,EAAQiD,EAAUyB,EAAQ3B,EAAErQ,QAEtCqQ,EAAErQ,OAGV,IAAIF,EAAIkS,EAAQlS,EAAI2B,EAAG3B,GAAKyQ,EACxBoC,EAAI,GAAKtC,EAAEvQ,GACX6S,EAAI,GAAKtC,EAAEvQ,EAAE,GACb6S,EAAI,GAAKtC,EAAEvQ,EAAE,GACbulB,EAAG1S,EAAKA,EAAKpE,GACb8B,EAAEvQ,GAAK6S,EAAI,GACXtC,EAAEvQ,EAAE,GAAK6S,EAAI,GACbtC,EAAEvQ,EAAE,GAAK6S,EAAI,GAGjB,OAAOtC,GAxCf,IAAIsC,EAAM,EAAQ,IAAR,I,cCWV,SAAS1C,EAAUqV,GACjB,QAASA,EAAIlf,aAAmD,mBAA7Bkf,EAAIlf,YAAY6J,UAA2BqV,EAAIlf,YAAY6J,SAASqV;;;;;;;AALzG9jB,EAAOD,QAAU,SAAU+jB,GACzB,OAAc,MAAPA,IAAgBrV,EAASqV,IAQlC,SAAuBA,GACrB,MAAkC,mBAApBA,EAAIC,aAAmD,mBAAdD,EAAI3f,OAAwBsK,EAASqV,EAAI3f,MAAM,EAAG,IATjE6f,CAAaF,MAAUA,EAAIG,a,6BCuHrEjkB,EAAOD,QAxBP,SAAkBkb,EAAUiJ,EAAQC,EAAWC,EAAOC,EAASC,GAC9D,IAAIV,GAAMM,EAAO,GACdV,GAAMU,EAAO,GACbT,GAAMS,EAAO,GACbK,GAAMJ,EAAU,GAChBK,GAAML,EAAU,GAChBM,GAAMN,EAAU,GAChBO,EAAKzV,KAAKmL,KAAKmK,EAAKA,EAAKC,EAAKA,EAAKC,EAAKA,GAE3C,GAAW,IAAPC,EACH,MAAM,IAAIrjB,MAAM,qCAWjB,OA5HD,SAAwB4Z,EACvB2I,EAAIJ,EAAIC,EACRc,EAAIC,EAAIC,EACRL,EAAOC,EAASC,GAmChB,IA3BA,IAAInhB,EAAI,EACL8E,EAAQgH,KAAKhH,MACbmb,EAAiB,EAAZnb,EAAM2b,GACXP,EAAiB,EAAZpb,EAAMub,GACXF,EAAiB,EAAZrb,EAAMwb,GAEXjH,EAAS+H,EAAK,EAAK,GAAK,EACxB9H,EAAS+H,EAAK,EAAK,GAAK,EACxB9H,EAAS+H,EAAK,EAAK,GAAK,EAGxBE,EAAU1V,KAAKC,IAAI,EAAIqV,GACvBK,EAAU3V,KAAKC,IAAI,EAAIsV,GACvBK,EAAU5V,KAAKC,IAAI,EAAIuV,GAOvBK,EAASH,EAAUrI,IAAYqI,GALtBnI,EAAQ,EAAM4G,EAAK,EAAIQ,EAAOA,EAAKR,GAKK9G,IACjDyI,EAASH,EAAUtI,IAAYsI,GALtBnI,EAAQ,EAAM4G,EAAK,EAAIG,EAAOA,EAAKH,GAKK/G,IACjD0I,EAASH,EAAUvI,IAAYuI,GALtBnI,EAAQ,EAAM4G,EAAK,EAAIG,EAAOA,EAAKH,GAKKhH,IAEjD2I,GAAgB,EAGZ9hB,GAAKihB,GAAO,CAGlB,IAAI/f,EAAI4W,EAASmI,EAAIC,EAAIC,GACzB,GAAIjf,EAYH,OAXIggB,IACHA,EAAQ,GAAKT,EAAKzgB,EAAIohB,EACtBF,EAAQ,GAAKb,EAAKrgB,EAAIqhB,EACtBH,EAAQ,GAAKZ,EAAKtgB,EAAIshB,GAEnBH,IACHA,EAAS,GAAKA,EAAS,GAAKA,EAAS,GAAK,EACrB,IAAjBW,IAAoBX,EAAS,IAAM9H,GAClB,IAAjByI,IAAoBX,EAAS,IAAM7H,GAClB,IAAjBwI,IAAoBX,EAAS,IAAM5H,IAEjCrY,EAIJygB,EAAQC,EACPD,EAAQE,GACX5B,GAAM5G,EACNrZ,EAAI2hB,EACJA,GAASH,EACTM,EAAe,IAEf3B,GAAM5G,EACNvZ,EAAI6hB,EACJA,GAASH,EACTI,EAAe,GAGZF,EAAQC,GACX3B,GAAM5G,EACNtZ,EAAI4hB,EACJA,GAASH,EACTK,EAAe,IAEf3B,GAAM5G,EACNvZ,EAAI6hB,EACJA,GAASH,EACTI,EAAe,GAgBlB,OATIZ,IACHA,EAAQ,GAAKT,EAAKzgB,EAAIohB,EACtBF,EAAQ,GAAKb,EAAKrgB,EAAIqhB,EACtBH,EAAQ,GAAKZ,EAAKtgB,EAAIshB,GAEnBH,IACHA,EAAS,GAAKA,EAAS,GAAKA,EAAS,GAAK,GAGpC,EA4BAY,CAAcjK,EAAU2I,EAAIJ,EAAIC,EARvCc,GAAMG,EACNF,GAAME,EACND,GAAMC,EAELN,OADsB,IAAZ,EACF,IAECA,EAEoDC,EAASC,K,6BC5HxE,IAAI9Z,EAAe,EAAQ,IAAUA,aACjC2a,EAAe,EAAQ,KACvBC,EAAe,EAAQ,KACvBC,EAAe,EAAQ,KACvBC,EAAe,EAAQ,KACvBC,EAAe,EAAQ,KACvBC,EAAe,EAAQ,KACvBhX,EAAe,EAAQ,KACvBzG,EAAekH,KAAKlH,IAGxB,EAAQ,KACR,IAAI0d,EAAgB,EAAQ,KACxBC,EAAS,EAAQ,KAGjBC,EAAgB,WAClB,IACIrnB,EAAMwhB,EADNzgB,EAAS,IAAImF,MAAM,KAEvB,IAAIlG,EAAE,EAAGA,EAAE,MAAOA,EAChBe,EAAOf,GAAK,MAEd,IAAIA,KAAK+mB,EAEY,OADnBvF,EAAIuF,EAAK/mB,IACJsnB,OAAO,IAAuC,MAAzB9F,EAAE8F,OAAO9F,EAAEthB,OAAO,KAC1CshB,EAAIA,EAAE+F,UAAU,EAAG/F,EAAEthB,OAAO,IAE9BshB,EAAIA,EAAE+B,QAAQ,MAAO,KACrBxiB,EAAOymB,SAASxnB,IAAMwhB,EAExB,OAAOzgB,EAdW,GAkBhB0mB,EAAWR,EAAK9mB,OAAO4P,KAAKiX,EAAOK,KAGvC,SAASK,EAAexiB,GACtB,OAAOgiB,EAAQS,GAAGF,EAAUviB,GAI9B,SAAS0iB,EAAgB1iB,GACvB,OAAOwiB,EAAeL,EAAcniB,IAItC,SAAS2iB,IACP3b,EAAa5L,KAAK+F,MAClBA,KAAKyhB,aAAgB,IAAI5hB,MAAMuhB,EAASvnB,QACxCmG,KAAK0hB,YAAgB,IAAI7hB,MAAMuhB,EAASvnB,QACxCmG,KAAK2hB,cAAgB,IAAI9hB,MAAMuhB,EAASvnB,QAExCmG,KAAK4hB,cAAgB,KACrB5hB,KAAK6hB,WAAa,KAClB7hB,KAAK4U,UAAY,EACjB5U,KAAK8hB,UAAYf,IACjB/gB,KAAK+hB,WAAa,EAClB/hB,KAAKgiB,SAAU,EACfhiB,KAAKiiB,OAAS,EACdjiB,KAAKkiB,QAAU,EAEfliB,KAAKmiB,iBAAkB,EACvBniB,KAAKoiB,kBAAmB,EACxBpiB,KAAKqiB,mBAAoB,EACzBriB,KAAKsiB,oBAAqB,EAE1BtiB,KAAKuiB,aAAeC,EAAa1jB,UAAKvB,EAAWyC,MAAM,GAEvDA,KAAKyiB,iBAAkB,EACvBziB,KAAK0iB,iBAAkB,EAEvB,IAAI,IAAI/oB,EAAE,EAAGA,EAAEynB,EAASvnB,SAAUF,EAChCqG,KAAKyhB,aAAa9nB,IAAK,EACvBqG,KAAK0hB,YAAY/nB,GAAKqG,KAAK2hB,cAAchoB,GAAK,EAIhDqG,KAAK2iB,QAAU,KACf3iB,KAAK4iB,SAAW,GAChB5iB,KAAK6iB,UAAY,IACjB7iB,KAAK8iB,UAAY,EACjB9iB,KAAK+iB,WAAa,EAClB/iB,KAAKgjB,UAAYjC,IACjB/gB,KAAKijB,SAAWjjB,KAAK4U,UACrB5U,KAAKkjB,UAAY,GACjBljB,KAAKmjB,kBAAmB,EACxBnjB,KAAKojB,mBAAoB,EAGzBpjB,KAAKqjB,OAAS,CAAC,EAAE,EAAE,GAGnBrjB,KAAKsjB,OAAS,EACdtjB,KAAKujB,OAAS,EACdvjB,KAAKwjB,WAAa,EAClBxjB,KAAKyjB,WAAa,EAGpBjD,EAAKkD,SAASlC,EAAW3b,GAEzB,IAAI+G,EAAQ4U,EAAUznB,UA8DtB,SAAS4pB,EAAYjc,EAAOkb,EAAU/jB,GACpC,GAAGA,KAAO+jB,EAAU,CAElB,IADA,IAAI7a,EAAM6a,EAAS/jB,GAAMT,EAAI,EACrBzE,EAAE,EAAGoF,EAAEgJ,EAAIlO,OAAQF,EAAEoF,IAAKpF,EAChCyE,GAAKsJ,EAAM2Z,EAAetZ,EAAIpO,KAEhC,OAAOyE,EAET,IAAIwlB,EAAKvC,EAAexiB,GACxB,OAAG+kB,GAAM,EACAlc,EAAMkc,GAER,EA0DT,SAASC,EAAcC,GAErB,IAAIC,EAAOD,EAAMnB,QAEdmB,EAAM3B,kBAAoB2B,EAAMzB,oBACxB0B,EAAKC,mBACLD,EAAKE,mBACLF,EAAKG,yBACLH,EAAKI,yBACLJ,EAAKK,sBACLL,EAAKM,sBACL,cACNpqB,KAAK8pB,GAEPD,EAAM1B,mBAAqB0B,EAAMxB,qBACxByB,EAAKO,oBACLP,EAAKQ,0BACLR,EAAKS,uBACLT,EAAKU,sBACLV,EAAKW,qBACL,cACPzqB,KAAK8pB,GAtJZnX,EAAMwU,SAAWA,EAGjBxU,EAAM9N,KAAO,SAAS6lB,GAEpB,IAAI5c,EAOA6c,EALF7c,EADC4c,KAAe3kB,KAAK4iB,SACf5iB,KAAK4iB,SAAS+B,GAEd,GAIR,IAAI,IAAIhrB,EAAE,EAAGoF,EAAEqB,UAAUvG,OAAQF,EAAEoF,IAAKpF,EAEtC,GAAG0nB,EADHuD,EAAexkB,UAAUzG,KACU,EACjCoO,EAAI5N,KAAKyqB,QACJ,GAAGA,KAAgB5kB,KAAK4iB,SAE7B,IADA,IAAIiC,EAAW7kB,KAAK4iB,SAASgC,GACrB/pB,EAAE,EAAGA,EAAEgqB,EAAShrB,SAAUgB,EAChCkN,EAAI5N,KAAK0qB,EAAShqB,KAKxBkN,EAAM6Y,EAAK7Y,IACJlO,OAAS,IACdmG,KAAK4iB,SAAS+B,GAAe5c,GAE/B/H,KAAK6G,KAAK,OAAQ8d,EAAa5c,IAIjC6E,EAAMkY,OAAS,SAASH,GACnBA,KAAe3kB,KAAK4iB,iBACd5iB,KAAK4iB,SAAS+B,GAEvB3kB,KAAK6G,KAAK,SAAU8d,IAsCtB/X,EAAMmY,KAAO,SAASlmB,GACpB,OAnCF,SAAmB6I,EAAOkb,EAAU/jB,GAClC,GAAGA,KAAO+jB,EAAU,CAElB,IADA,IAAI7a,EAAM6a,EAAS/jB,GACXlF,EAAE,EAAGoF,EAAEgJ,EAAIlO,OAAQF,EAAEoF,IAAKpF,EAChC,GAAG+N,EAAM2Z,EAAetZ,EAAIpO,KAC1B,OAAO,EAGX,OAAO,EAET,IAAIiqB,EAAKvC,EAAexiB,GACxB,OAAG+kB,GAAM,GACAlc,EAAMkc,GAuBRoB,CAAUhlB,KAAKyhB,aAAczhB,KAAK4iB,SAAU/jB,IAIrD+N,EAAMqY,QAAU,SAASpmB,GACvB,OAAOmB,KAAK+kB,KAAKlmB,MAAUmB,KAAKklB,MAAMrmB,IAIxC+N,EAAMuY,GAAK,SAAStmB,GAClB,OAAQmB,KAAK+kB,KAAKlmB,IAIpB+N,EAAMwY,MAAQ,SAASvmB,GACrB,OAAOmB,KAAKmlB,GAAGtmB,MAAUmB,KAAKqlB,QAAQxmB,IAIxC+N,EAAMsY,MAAQ,SAASrmB,GACrB,OAAO8kB,EAAY3jB,KAAK0hB,YAAa1hB,KAAK4iB,SAAU/jB,IAItD+N,EAAMyY,QAAU,SAASxmB,GACvB,OAAO8kB,EAAY3jB,KAAK2hB,cAAe3hB,KAAK4iB,SAAU/jB,IAIxD/E,OAAOmE,eAAe2O,EAAO,SAAU,CACrCzO,IAAK,WACH,OAAO6B,KAAKgiB,SAEdtf,IAAK,SAASgF,KACDA,IACD1H,KAAKgiB,UACThiB,KAAKgiB,SAMPhiB,KAAKgiB,SAAU,EACfhiB,KAAK8hB,UAAYf,IAAWzW,KAAKhH,MAAMtD,KAAK+hB,WAAa/hB,KAAK4U,WAC9D5U,KAAK4hB,cAAgB0D,YAAY9C,EAAcxiB,KAAK4U,UAAW5U,MAAM,GACrEA,KAAK6hB,WAAa0D,sBAAsBvlB,KAAKuiB,gBAR7CviB,KAAKgiB,SAAU,EACfhiB,KAAK+hB,WAAa3e,EAAI,GAAM2d,IAAW/gB,KAAK8hB,WAAa9hB,KAAK4U,WAC9D4Q,cAAcxlB,KAAK4hB,oBAuC3B,IAAI6D,EAAmBzpB,SAAS0pB,gBACT1pB,SAASypB,kBACTzpB,SAAS2pB,kBACT3pB,SAAS4pB,wBACT5pB,SAAS6pB,wBACT7pB,SAAS8pB,qBACT9pB,SAAS+pB,qBACT,aAuBvB,SAASC,EAAiBlC,GACxBA,EAAMzB,kBAAoBrmB,SAASiqB,YACTjqB,SAASkqB,eACTlqB,SAASmqB,qBACT,GACtBrC,EAAMX,kBAAoBW,EAAMzB,oBAClCyB,EAAM3B,iBAAkB,GA3B5BroB,OAAOmE,eAAe2O,EAAO,aAAc,CACzCzO,IAAK,WACH,OAAO6B,KAAKqiB,mBAEd3f,IAAK,SAASgF,IACDA,GAET1H,KAAKmiB,iBAAkB,GACXnmB,SAASiqB,YACTjqB,SAASkqB,eACTlqB,SAASmqB,qBACT,IACDV,EAAiBxrB,KAAK+B,YAEjCgE,KAAKmiB,iBAAkB,EACvB0B,EAAc7jB,OAEhB,OAAOA,KAAKqiB,qBAehB,IAAI+D,EAAkBpqB,SAASoqB,iBACTpqB,SAASqqB,uBACTrqB,SAASsqB,oBACT,aAmBtB,SAASC,EAAwBzC,EAAOnnB,GACtCmnB,EAAMxB,mBAAqBwB,EAAMnB,WAC7B3mB,SAASwqB,oBACTxqB,SAASyqB,uBACTzqB,SAAS0qB,0BACT,OACA5C,EAAMV,mBAAqBU,EAAMxB,qBACnCwB,EAAM1B,kBAAmB,GAiB7B,SAASuE,EAAY7C,EAAOjlB,EAAK6I,GACtBoc,EAAMrC,aAAa5iB,KAClB6I,IACLA,EACDoc,EAAMpC,YAAY7iB,KAElBilB,EAAMnC,cAAc9iB,KAEtBilB,EAAMrC,aAAa5iB,GAAO6I,GAI9B,SAAS8a,EAAasB,EAAO8C,IAQ7B,SAAc9C,GACZ,IAGInqB,EAAGsB,EAAGuD,EAHNqoB,EAAO9F,IAAW+C,EAAMjB,UACxBiE,EAAShD,EAAMpC,YACfqF,EAASjD,EAAMnC,cAEfhL,EAAKmN,EAAMlP,UACX7V,EAAIqiB,EAASvnB,OACjB,MAAOiqB,EAAM9B,SACPjB,KAAY+C,EAAMhC,UAAYnL,GAAI,CAGtC,GAAGoK,IAAW8F,EAEZ,YADA/C,EAAMhC,UAAYf,IAAWpK,GAe/B,IAVA1b,EAAI8lB,IACJ+C,EAAMjd,KAAK,QACXrI,EAAIuiB,IACJ+C,EAAMb,SAAWzkB,EAAIvD,IAGnB6oB,EAAMhB,UACRgB,EAAMhC,WAAanL,EAGfhd,EAAE,EAAGA,EAAEoF,IAAKpF,EACdmtB,EAAOntB,GAAKotB,EAAOptB,GAAK,EAEvBmqB,EAAMxB,oBACPwB,EAAMN,WAAaM,EAAMR,OAASQ,EAAMjX,OAAO,EAC/CiX,EAAML,WAAaK,EAAMP,OAASO,EAAMhX,QAAQ,IAEhDgX,EAAMN,WAAaM,EAAMR,OACzBQ,EAAML,WAAaK,EAAMP,QAE3BO,EAAMT,OAAO,GAAKS,EAAMT,OAAO,GAAKS,EAAMT,OAAO,GAAK,GA5CxD2D,CAAKlD,GACD8C,GAgDN,SAAgB9C,GAMd,IAAIpQ,EAHJoQ,EAAMjC,WAAa0D,sBAAsBzB,EAAMvB,cAK7C7O,EADCoQ,EAAM9B,QACF8B,EAAM/B,WAEN3e,EAAI,GAAM2d,IAAW+C,EAAMhC,WAAagC,EAAMlP,aAInDkP,EAAMf,WACR,IAAI9nB,EAAI8lB,IACR+C,EAAMjd,KAAK,SAAU6M,GACrB,IAAIlV,EAAIuiB,IACR+C,EAAMZ,UAAY1kB,EAAIvD,EAjEpBgsB,CAAOnD,GA0EX,SAASoD,EAAYpD,EAAOqD,GACvBrD,EAAMrB,iBACP0E,EAAGC,iBAEFtD,EAAMpB,iBACPyE,EAAGzE,kBAKP,SAAS2E,EAAYvD,EAAOqD,GAC1BD,EAAYpD,EAAOqD,GACnB,IAAIvD,EAAKrC,EAAgB4F,EAAGG,SAAWH,EAAGI,MAAQJ,EAAGK,OAASL,EAAGM,UAC9D7D,GAAM,GACP+C,EAAY7C,EAAOF,GAAI,GAK3B,SAAS8D,EAAc5D,EAAOqD,GAC5B,GAzBF,SAAmBrD,GACjB,OAAQ9nB,SAAS2rB,gBAAkB3rB,SAASsF,MACpCtF,SAAS2rB,gBAAkB7D,EAAMnB,QAuBrCiF,CAAU9D,GAId,GADAoD,EAAYpD,EAAOqD,GAChBA,EAAGU,QAEJC,EAAWhE,EAAOqD,OACb,CACL,IAAIvD,EAAKrC,EAAgB4F,EAAGG,SAAWH,EAAGI,MAAQJ,EAAGK,OAASL,EAAGM,UAC9D7D,GAAM,GACP+C,EAAY7C,EAAOF,GAAI,IAhK7B9pB,OAAOmE,eAAe2O,EAAO,cAAe,CAC1CzO,IAAK,WACH,OAAO6B,KAAKsiB,oBAEd5f,IAAK,SAASgF,GASZ,QARWA,GAKT1H,KAAKoiB,kBAAmB,EACxByB,EAAc7jB,QAJdA,KAAKoiB,kBAAmB,EACxBgE,EAAgBnsB,KAAK+B,WAKhBgE,KAAKsiB,sBAgBhBxoB,OAAOmE,eAAe2O,EAAO,QAAS,CACpCzO,IAAK,WACH,OAAO6B,KAAK2iB,QAAQoF,eAGxBjuB,OAAOmE,eAAe2O,EAAO,SAAU,CACrCzO,IAAK,WACH,OAAO6B,KAAK2iB,QAAQqF,gBAkIxB,IAAIC,EAAape,EAAK,IAAIsB,KAAI,SAASpM,GACrC,OAAOsiB,EAAe,UAAYtiB,EAAE,OAStC,SAASmpB,EAAgBpE,EAAOqD,GAE9B,GADAD,EAAYpD,EAAOqD,GAChBrD,EAAMxB,mBAAoB,CAC3B,IAAI6F,EAAYhB,EAAGgB,WACHhB,EAAGiB,cACHjB,EAAGkB,iBACH,EACZC,EAAYnB,EAAGmB,WACHnB,EAAGoB,cACHpB,EAAGqB,iBACH,EAChB1E,EAAMR,QAAU6E,EAChBrE,EAAMP,QAAU+E,OAEhBxE,EAAMR,OAAS6D,EAAGsB,QAAU3E,EAAMnB,QAAQ+F,WAC1C5E,EAAMP,OAAS4D,EAAGwB,QAAU7E,EAAMnB,QAAQiG,UAE5C,OAAO,EAGT,SAASC,EAAgB/E,EAAOqD,GAG9B,OAFAD,EAAYpD,EAAOqD,GACnBR,EAAY7C,EAAOmE,EAAWd,EAAG2B,SAAS,IACnC,EAGT,SAASC,EAAcjF,EAAOqD,GAG5B,OAFAD,EAAYpD,EAAOqD,GACnBR,EAAY7C,EAAOmE,EAAWd,EAAG2B,SAAS,IACnC,EAGT,SAASE,EAAiBlF,EAAOqD,GAS/B,OARAD,EAAYpD,EAAOqD,GAChBrD,EAAMxB,oBACPwB,EAAMN,WAAaM,EAAMR,OAASQ,EAAMjX,OAAO,EAC/CiX,EAAML,WAAaK,EAAMP,OAASO,EAAMhX,QAAQ,IAEhDgX,EAAMN,WAAaM,EAAMR,OAAS6D,EAAGsB,QAAU3E,EAAMnB,QAAQ+F,WAC7D5E,EAAML,WAAaK,EAAMP,OAAS4D,EAAGwB,QAAU7E,EAAMnB,QAAQiG,YAExD,EAGT,SAASK,EAAiBnF,EAAOqD,GAG/B,OAFAD,EAAYpD,EAAOqD,GAnDrB,SAAyBrD,EAAOoF,GAC9B,IAAI,IAAIvvB,EAAE,EAAGA,EAAE,KAAMA,EACnBgtB,EAAY7C,EAAOmE,EAAWtuB,MAAOuvB,EAAW,GAAGvvB,IAkDrDwvB,CAAgBrF,EAAO,IAChB,EAIT,SAASsF,EAAiBtF,EAAOqD,GAC/BD,EAAYpD,EAAOqD,GACnB,IAAI1jB,EAAQ,EACZ,OAAO0jB,EAAGkC,WACR,KAAK,EACH5lB,EAAQ,EACV,MACA,KAAK,EACHA,EAAQ,GACV,MACA,KAAK,EACFA,EAAQqgB,EAAMhX,OAOnB,OAHAgX,EAAMT,OAAO,IAAO8D,EAAGmC,OAAS7lB,EAChCqgB,EAAMT,OAAO,IAAO8D,EAAGoC,OAAS9lB,EAChCqgB,EAAMT,OAAO,IAAO8D,EAAGqC,OAAS/lB,GAAQ,GACjC,EAGT,SAASgmB,EAAiB3F,EAAOqD,GAE/B,OADAD,EAAYpD,EAAOqD,IACZ,EAGT,SAASW,EAAWhE,EAAOqD,GACzB,IAGIxtB,EAHAoF,EAAIqiB,EAASvnB,OACbgE,EAAIimB,EAAMrC,aACVrjB,EAAI0lB,EAAMnC,cAEd,IAAIhoB,EAAE,EAAGA,EAAEoF,IAAKpF,EACXkE,EAAElE,MACDyE,EAAEzE,GAENkE,EAAElE,IAAK,EAET,OAAO,EAGT,SAAS+vB,EAAoB5F,EAAOqD,GAClC,IAAIngB,EAA8B,EAA1B8c,EAAMnB,QAAQoF,YAClB4B,EAA+B,EAA3B7F,EAAMnB,QAAQqF,aAClBhhB,IAAM8c,EAAM7B,QAAY0H,IAAM7F,EAAM5B,UACtC4B,EAAM7B,OAASjb,EACf8c,EAAM5B,QAAUyH,EAChB7F,EAAMjd,KAAK,SAAUG,EAAG2iB,IAI5B,SAASC,IACP,IAAIC,EAAY7tB,SAASC,cAAc,OAYvC,OAXA4tB,EAAUC,SAAW,EACrBD,EAAUE,MAAM3gB,SAAW,WAC3BygB,EAAUE,MAAM/R,KAAO,MACvB6R,EAAUE,MAAMC,MAAQ,MACxBH,EAAUE,MAAMtO,IAAM,MACtBoO,EAAUE,MAAME,OAAS,MACzBJ,EAAUE,MAAMjd,OAAS,OACzB+c,EAAUE,MAAMG,SAAW,SAC3BluB,SAASsF,KAAK5D,YAAYmsB,GAC1B7tB,SAASsF,KAAKyoB,MAAMG,SAAW,SAC/BluB,SAASsF,KAAKyoB,MAAMjd,OAAS,OACtB+c,EAoJTxuB,EAAOD,QAjJP,SAAqB+uB,GAInB,IAAIC,KAHJD,EAAUA,GAAW,IAGSlE,WAC1BoE,EAAiBD,OACa7sB,WAAxB4sB,EAAQG,cAChBD,IAAmBF,EAAQG,aAI7B,IAAIxG,EAAQ,IAAItC,EAmIhB,OAlIAsC,EAAMlP,UAAYuV,EAAQI,UAAY,GACtCzG,EAAMjB,UAAYsH,EAAQtH,WAAmC,GAArBiB,EAAMlP,UAAU,GACxDkP,EAAMX,mBAAqBgH,EAAQhH,oBAAsBgH,EAAQK,OACjE1G,EAAMV,oBAAsB+G,EAAQ/G,qBAAuB+G,EAAQK,OAGhEL,EAAQvH,WACTkB,EAAMlB,SAAWuH,EAAQvH,UAI3BplB,YAAW,WAAaijB,GAAS,WAG/B,IAAIkC,EAAUwH,EAAQxH,QACtB,GAAsB,iBAAZA,EAAsB,CAC9B,IAAIpnB,EAAIS,SAASyuB,cAAc9H,GAC3BpnB,IACFA,EAAIS,SAAS0uB,eAAe/H,IAE1BpnB,IACFA,EAAIS,SAAS2uB,kBAAkBhI,GAAS,IAEtCpnB,IACFA,EAAIquB,KAEN9F,EAAMnB,QAAUpnB,OAEhBuoB,EAAMnB,QADqB,iBAAZA,GAA0BA,EACzBA,EACW,mBAAZA,EACCA,IAEAiH,IAIf9F,EAAMnB,QAAQoH,QACfjG,EAAMnB,QAAQoH,MAAM,yBAA2B,OAC/CjG,EAAMnB,QAAQoH,MAAM,uBAAyB,OAC7CjG,EAAMnB,QAAQoH,MAAM,sBAAwB,OAC5CjG,EAAMnB,QAAQoH,MAAM,oBAAsB,OAC1CjG,EAAMnB,QAAQoH,MAAM,mBAAqB,OACzCjG,EAAMnB,QAAQoH,MAAM,eAAiB,QAIvCjG,EAAM7B,OAAS6B,EAAMnB,QAAQoF,YAC7BjE,EAAM5B,QAAU4B,EAAMnB,QAAQqF,aAC9B,IAAI4C,EAAelB,EAAoB5qB,UAAKvB,EAAWumB,GACxB,oBAArB+G,iBACO,IAAIA,iBAAiBD,GAC3BE,QAAQhH,EAAMnB,QAAS,CAC9BoI,YAAY,EACZC,SAAS,IAGXlH,EAAMnB,QAAQsI,iBAAiB,qBAAsBL,GAAc,GAErEtrB,OAAO2rB,iBAAiB,SAAUL,GAAc,GAGhDtrB,OAAO2rB,iBAAiB,UAAWvD,EAAc5oB,UAAKvB,EAAWumB,IAAQ,GACzExkB,OAAO2rB,iBAAiB,QAAS5D,EAAYvoB,UAAKvB,EAAWumB,IAAQ,GAGrEA,EAAMnB,QAAQuI,cAAgBzB,EAAiB3qB,UAAKvB,EAAWumB,GAG/DA,EAAMnB,QAAQsI,iBAAiB,YAAapC,EAAgB/pB,UAAKvB,EAAWumB,IAAQ,GACpFA,EAAMnB,QAAQsI,iBAAiB,UAAWlC,EAAcjqB,UAAKvB,EAAWumB,IAAQ,GAChFA,EAAMnB,QAAQsI,iBAAiB,YAAa/C,EAAgBppB,UAAKvB,EAAWumB,IAAQ,GACpFA,EAAMnB,QAAQsI,iBAAiB,aAAcjC,EAAiBlqB,UAAKvB,EAAWumB,IAAQ,GAGtF,IAAIqH,EAAQlC,EAAiBnqB,UAAKvB,EAAWumB,GAC7CA,EAAMnB,QAAQsI,iBAAiB,aAAcE,GAAO,GACpDrH,EAAMnB,QAAQsI,iBAAiB,WAAYE,GAAO,GAClD7rB,OAAO2rB,iBAAiB,aAAcE,GAAO,GAC7C7rB,OAAO2rB,iBAAiB,WAAYE,GAAO,GAG3C,IAAIC,EAAOtD,EAAWhpB,UAAKvB,EAAWumB,GACtCA,EAAMnB,QAAQsI,iBAAiB,OAAQG,GAAM,GAC7CtH,EAAMnB,QAAQsI,iBAAiB,WAAYG,GAAM,GACjDtH,EAAMnB,QAAQsI,iBAAiB,QAASG,GAAM,GAC9C9rB,OAAO2rB,iBAAiB,OAAQG,GAAM,GACtC9rB,OAAO2rB,iBAAiB,WAAYG,GAAM,GAC1C9rB,OAAO2rB,iBAAiB,QAASG,GAAM,GAGvCtK,EAAcgD,EAAMnB,QAASyG,EAAiBtqB,UAAKvB,EAAWumB,IAAQ,GAGtE,IAAIuH,EAAmBrF,EAAiBlnB,UAAKvB,EAAWumB,GACxD9nB,SAASivB,iBAAiB,mBAAoBI,GAAkB,GAChErvB,SAASivB,iBAAiB,sBAAuBI,GAAkB,GACnErvB,SAASivB,iBAAiB,yBAA0BI,GAAkB,GAGtEvH,EAAMnB,QAAQsI,iBAAiB,QAASpH,EAAc/kB,UAAKvB,EAAWumB,IAAQ,GAG9E,IAAIwH,EAAoB/E,EAAwBznB,UAAKvB,EAAWumB,GAChE9nB,SAASivB,iBAAiB,oBAAqBK,GAAmB,GAClEtvB,SAASivB,iBAAiB,uBAAwBK,GAAmB,GACrEtvB,SAASivB,iBAAiB,0BAA2BK,GAAmB,GACxEtvB,SAASivB,iBAAiB,kBAAmBK,GAAmB,GAChEtvB,SAASivB,iBAAiB,wBAAyBK,GAAmB,GACtEtvB,SAASivB,iBAAiB,qBAAsBK,GAAmB,GAGnExH,EAAMmC,WAAamE,EACnBtG,EAAMwG,YAAcD,EAGpBvG,EAAMhlB,KAAK,aAAgB,WAC3BglB,EAAMhlB,KAAK,cAAgB,WAC3BglB,EAAMhlB,KAAK,eAAgB,WAG3BglB,EAAMhC,UAAYf,IAClB+C,EAAMd,UAAYjC,IAGlB+C,EAAMyH,QAAS,EAGfzH,EAAMjd,KAAK,aACR,GAEEid,I,iBCruBT,YAqBA,IAAI0H,EAA4B1xB,OAAO0xB,2BACrC,SAAmCrM,GAGjC,IAFA,IAAIzV,EAAO5P,OAAO4P,KAAKyV,GACnBsM,EAAc,GACT9xB,EAAI,EAAGA,EAAI+P,EAAK7P,OAAQF,IAC/B8xB,EAAY/hB,EAAK/P,IAAMG,OAAO0G,yBAAyB2e,EAAKzV,EAAK/P,IAEnE,OAAO8xB,GAGPC,EAAe,WACnBtwB,EAAQuwB,OAAS,SAASpqB,GACxB,IAAKqqB,EAASrqB,GAAI,CAEhB,IADA,IAAIsqB,EAAU,GACLlyB,EAAI,EAAGA,EAAIyG,UAAUvG,OAAQF,IACpCkyB,EAAQ1xB,KAAK2xB,EAAQ1rB,UAAUzG,KAEjC,OAAOkyB,EAAQhhB,KAAK,KAGlBlR,EAAI,EAmBR,IAnBA,IACIyL,EAAOhF,UACP2D,EAAMqB,EAAKvL,OACXkyB,EAAM9kB,OAAO1F,GAAG2b,QAAQwO,GAAc,SAASnW,GACjD,GAAU,OAANA,EAAY,MAAO,IACvB,GAAI5b,GAAKoK,EAAK,OAAOwR,EACrB,OAAQA,GACN,IAAK,KAAM,OAAOtO,OAAO7B,EAAKzL,MAC9B,IAAK,KAAM,OAAOgM,OAAOP,EAAKzL,MAC9B,IAAK,KACH,IACE,OAAOqyB,KAAKC,UAAU7mB,EAAKzL,MAC3B,MAAO+H,GACP,MAAO,aAEX,QACE,OAAO6T,MAGJA,EAAInQ,EAAKzL,GAAIA,EAAIoK,EAAKwR,EAAInQ,IAAOzL,GACpCuyB,EAAO3W,KAAO4W,EAAS5W,GACzBwW,GAAO,IAAMxW,EAEbwW,GAAO,IAAMD,EAAQvW,GAGzB,OAAOwW,GAOT3wB,EAAQgxB,UAAY,SAASlN,EAAImN,GAC/B,QAAuB,IAAZC,IAAqD,IAA1BA,EAAQC,cAC5C,OAAOrN,EAIT,QAAuB,IAAZoN,EACT,OAAO,WACL,OAAOlxB,EAAQgxB,UAAUlN,EAAImN,GAAK7xB,MAAMwF,KAAMI,YAIlD,IAAI2G,GAAS,EAeb,OAdA,WACE,IAAKA,EAAQ,CACX,GAAIulB,EAAQE,iBACV,MAAM,IAAI9vB,MAAM2vB,GACPC,EAAQG,iBACjBrtB,QAAQstB,MAAML,GAEdjtB,QAAQ3C,MAAM4vB,GAEhBtlB,GAAS,EAEX,OAAOmY,EAAG1kB,MAAMwF,KAAMI,aAO1B,IACIusB,EADAC,EAAS,GA6Bb,SAASd,EAAQ3M,EAAK0N,GAEpB,IAAIC,EAAM,CACRC,KAAM,GACNC,QAASC,GAkBX,OAfI7sB,UAAUvG,QAAU,IAAGizB,EAAI/f,MAAQ3M,UAAU,IAC7CA,UAAUvG,QAAU,IAAGizB,EAAII,OAAS9sB,UAAU,IAC9C+sB,EAAUN,GAEZC,EAAIM,WAAaP,EACRA,GAETzxB,EAAQiyB,QAAQP,EAAKD,GAGnBS,EAAYR,EAAIM,cAAaN,EAAIM,YAAa,GAC9CE,EAAYR,EAAI/f,SAAQ+f,EAAI/f,MAAQ,GACpCugB,EAAYR,EAAII,UAASJ,EAAII,QAAS,GACtCI,EAAYR,EAAIS,iBAAgBT,EAAIS,eAAgB,GACpDT,EAAII,SAAQJ,EAAIE,QAAUQ,GACvBC,EAAYX,EAAK3N,EAAK2N,EAAI/f,OAoCnC,SAASygB,EAAiBzB,EAAK2B,GAC7B,IAAI3D,EAAQ+B,EAAQ6B,OAAOD,GAE3B,OAAI3D,EACK,KAAY+B,EAAQoB,OAAOnD,GAAO,GAAK,IAAMgC,EAC7C,KAAYD,EAAQoB,OAAOnD,GAAO,GAAK,IAEvCgC,EAKX,SAASkB,EAAelB,EAAK2B,GAC3B,OAAO3B,EAeT,SAAS0B,EAAYX,EAAKvuB,EAAOqvB,GAG/B,GAAId,EAAIS,eACJhvB,GACAsvB,EAAWtvB,EAAMutB,UAEjBvtB,EAAMutB,UAAY1wB,EAAQ0wB,WAExBvtB,EAAM0B,aAAe1B,EAAM0B,YAAYlG,YAAcwE,GAAQ,CACjE,IAAIyJ,EAAMzJ,EAAMutB,QAAQ8B,EAAcd,GAItC,OAHKlB,EAAS5jB,KACZA,EAAMylB,EAAYX,EAAK9kB,EAAK4lB,IAEvB5lB,EAIT,IAAI8lB,EA+FN,SAAyBhB,EAAKvuB,GAC5B,GAAI+uB,EAAY/uB,GACd,OAAOuuB,EAAIE,QAAQ,YAAa,aAClC,GAAIpB,EAASrtB,GAAQ,CACnB,IAAIwvB,EAAS,IAAO/B,KAAKC,UAAU1tB,GAAO2e,QAAQ,SAAU,IAClBA,QAAQ,KAAM,OACdA,QAAQ,OAAQ,KAAO,IACjE,OAAO4P,EAAIE,QAAQe,EAAQ,UAE7B,GAAIC,EAASzvB,GACX,OAAOuuB,EAAIE,QAAQ,GAAKzuB,EAAO,UACjC,GAAI4uB,EAAU5uB,GACZ,OAAOuuB,EAAIE,QAAQ,GAAKzuB,EAAO,WAEjC,GAAI2tB,EAAO3tB,GACT,OAAOuuB,EAAIE,QAAQ,OAAQ,QA9GbiB,CAAgBnB,EAAKvuB,GACrC,GAAIuvB,EACF,OAAOA,EAIT,IAAIpkB,EAAO5P,OAAO4P,KAAKnL,GACnB2vB,EApCN,SAAqBniB,GACnB,IAAIoiB,EAAO,GAMX,OAJApiB,EAAMhH,SAAQ,SAASqpB,EAAKziB,GAC1BwiB,EAAKC,IAAO,KAGPD,EA6BWE,CAAY3kB,GAQ9B,GANIojB,EAAIM,aACN1jB,EAAO5P,OAAO0L,oBAAoBjH,IAKhC+vB,EAAQ/vB,KACJmL,EAAKuT,QAAQ,YAAc,GAAKvT,EAAKuT,QAAQ,gBAAkB,GACrE,OAAOsR,EAAYhwB,GAIrB,GAAoB,IAAhBmL,EAAK7P,OAAc,CACrB,GAAIg0B,EAAWtvB,GAAQ,CACrB,IAAIlB,EAAOkB,EAAMlB,KAAO,KAAOkB,EAAMlB,KAAO,GAC5C,OAAOyvB,EAAIE,QAAQ,YAAc3vB,EAAO,IAAK,WAE/C,GAAImxB,EAASjwB,GACX,OAAOuuB,EAAIE,QAAQyB,OAAO10B,UAAUkS,SAAShS,KAAKsE,GAAQ,UAE5D,GAAImwB,EAAOnwB,GACT,OAAOuuB,EAAIE,QAAQ2B,KAAK50B,UAAUkS,SAAShS,KAAKsE,GAAQ,QAE1D,GAAI+vB,EAAQ/vB,GACV,OAAOgwB,EAAYhwB,GAIvB,IA2CIqwB,EA3CAliB,EAAO,GAAIX,GAAQ,EAAO8iB,EAAS,CAAC,IAAK,MAGzC3iB,EAAQ3N,KACVwN,GAAQ,EACR8iB,EAAS,CAAC,IAAK,MAIbhB,EAAWtvB,MAEbmO,EAAO,cADCnO,EAAMlB,KAAO,KAAOkB,EAAMlB,KAAO,IACf,KAkB5B,OAdImxB,EAASjwB,KACXmO,EAAO,IAAM+hB,OAAO10B,UAAUkS,SAAShS,KAAKsE,IAI1CmwB,EAAOnwB,KACTmO,EAAO,IAAMiiB,KAAK50B,UAAU+0B,YAAY70B,KAAKsE,IAI3C+vB,EAAQ/vB,KACVmO,EAAO,IAAM6hB,EAAYhwB,IAGP,IAAhBmL,EAAK7P,QAAkBkS,GAAyB,GAAhBxN,EAAM1E,OAItC+zB,EAAe,EACbY,EAASjwB,GACJuuB,EAAIE,QAAQyB,OAAO10B,UAAUkS,SAAShS,KAAKsE,GAAQ,UAEnDuuB,EAAIE,QAAQ,WAAY,YAInCF,EAAIC,KAAK5yB,KAAKoE,GAIZqwB,EADE7iB,EAsCN,SAAqB+gB,EAAKvuB,EAAOqvB,EAAcM,EAAaxkB,GAE1D,IADA,IAAIklB,EAAS,GACJj1B,EAAI,EAAG2B,EAAIiD,EAAM1E,OAAQF,EAAI2B,IAAK3B,EACrCK,EAAeuE,EAAO0I,OAAOtN,IAC/Bi1B,EAAOz0B,KAAK40B,EAAejC,EAAKvuB,EAAOqvB,EAAcM,EACjDjnB,OAAOtN,IAAI,IAEfi1B,EAAOz0B,KAAK,IAShB,OANAuP,EAAK3E,SAAQ,SAASlG,GACfA,EAAImwB,MAAM,UACbJ,EAAOz0B,KAAK40B,EAAejC,EAAKvuB,EAAOqvB,EAAcM,EACjDrvB,GAAK,OAGN+vB,EArDIK,CAAYnC,EAAKvuB,EAAOqvB,EAAcM,EAAaxkB,GAEnDA,EAAKyB,KAAI,SAAStM,GACzB,OAAOkwB,EAAejC,EAAKvuB,EAAOqvB,EAAcM,EAAarvB,EAAKkN,MAItE+gB,EAAIC,KAAK3qB,MA6GX,SAA8BwsB,EAAQliB,EAAMmiB,GAQ1C,GANaD,EAAOM,QAAO,SAASC,EAAMC,GAGxC,OADIA,EAAInS,QAAQ,OAAS,GAAGoS,EACrBF,EAAOC,EAAIlS,QAAQ,kBAAmB,IAAIrjB,OAAS,IACzD,GAEU,GACX,OAAOg1B,EAAO,IACG,KAATniB,EAAc,GAAKA,EAAO,OAC3B,IACAkiB,EAAO/jB,KAAK,SACZ,IACAgkB,EAAO,GAGhB,OAAOA,EAAO,GAAKniB,EAAO,IAAMkiB,EAAO/jB,KAAK,MAAQ,IAAMgkB,EAAO,GA5H1DS,CAAqBV,EAAQliB,EAAMmiB,IAxBjCA,EAAO,GAAKniB,EAAOmiB,EAAO,GA+CrC,SAASN,EAAYhwB,GACnB,MAAO,IAAM7B,MAAM3C,UAAUkS,SAAShS,KAAKsE,GAAS,IAwBtD,SAASwwB,EAAejC,EAAKvuB,EAAOqvB,EAAcM,EAAarvB,EAAKkN,GAClE,IAAI1O,EAAM0uB,EAAKxrB,EAsCf,IArCAA,EAAOzG,OAAO0G,yBAAyBjC,EAAOM,IAAQ,CAAEN,MAAOA,EAAMM,KAC5DV,IAEL4tB,EADExrB,EAAKmC,IACDoqB,EAAIE,QAAQ,kBAAmB,WAE/BF,EAAIE,QAAQ,WAAY,WAG5BzsB,EAAKmC,MACPqpB,EAAMe,EAAIE,QAAQ,WAAY,YAG7BhzB,EAAek0B,EAAarvB,KAC/BxB,EAAO,IAAMwB,EAAM,KAEhBktB,IACCe,EAAIC,KAAK9P,QAAQ1c,EAAKhC,OAAS,GAE/BwtB,EADEG,EAAO0B,GACHH,EAAYX,EAAKvsB,EAAKhC,MAAO,MAE7BkvB,EAAYX,EAAKvsB,EAAKhC,MAAOqvB,EAAe,IAE5C3Q,QAAQ,OAAS,IAErB8O,EADEhgB,EACIggB,EAAIhP,MAAM,MAAM5R,KAAI,SAASokB,GACjC,MAAO,KAAOA,KACb1kB,KAAK,MAAM2kB,OAAO,GAEf,KAAOzD,EAAIhP,MAAM,MAAM5R,KAAI,SAASokB,GACxC,MAAO,MAAQA,KACd1kB,KAAK,OAIZkhB,EAAMe,EAAIE,QAAQ,aAAc,YAGhCM,EAAYjwB,GAAO,CACrB,GAAI0O,GAASlN,EAAImwB,MAAM,SACrB,OAAOjD,GAET1uB,EAAO2uB,KAAKC,UAAU,GAAKptB,IAClBmwB,MAAM,iCACb3xB,EAAOA,EAAKmyB,OAAO,EAAGnyB,EAAKxD,OAAS,GACpCwD,EAAOyvB,EAAIE,QAAQ3vB,EAAM,UAEzBA,EAAOA,EAAK6f,QAAQ,KAAM,OACdA,QAAQ,OAAQ,KAChBA,QAAQ,WAAY,KAChC7f,EAAOyvB,EAAIE,QAAQ3vB,EAAM,WAI7B,OAAOA,EAAO,KAAO0uB,EA2BvB,SAAS7f,EAAQujB,GACf,OAAO5vB,MAAMqM,QAAQujB,GAIvB,SAAStC,EAAU/kB,GACjB,MAAsB,kBAARA,EAIhB,SAAS8jB,EAAO9jB,GACd,OAAe,OAARA,EAST,SAAS4lB,EAAS5lB,GAChB,MAAsB,iBAARA,EAIhB,SAASwjB,EAASxjB,GAChB,MAAsB,iBAARA,EAShB,SAASklB,EAAYllB,GACnB,YAAe,IAARA,EAIT,SAASomB,EAASkB,GAChB,OAAOvD,EAASuD,IAA8B,oBAAvBC,EAAeD,GAIxC,SAASvD,EAAS/jB,GAChB,MAAsB,iBAARA,GAA4B,OAARA,EAIpC,SAASsmB,EAAO5wB,GACd,OAAOquB,EAASruB,IAA4B,kBAAtB6xB,EAAe7xB,GAIvC,SAASwwB,EAAQ/yB,GACf,OAAO4wB,EAAS5wB,KACW,mBAAtBo0B,EAAep0B,IAA2BA,aAAamB,OAI9D,SAASmxB,EAAWzlB,GAClB,MAAsB,mBAARA,EAgBhB,SAASunB,EAAe3xB,GACtB,OAAOlE,OAAOC,UAAUkS,SAAShS,KAAK+D,GAIxC,SAAS4xB,EAAI7wB,GACX,OAAOA,EAAI,GAAK,IAAMA,EAAEkN,SAAS,IAAMlN,EAAEkN,SAAS,IApbpD7Q,EAAQy0B,SAAW,SAASntB,GAI1B,GAHI4qB,EAAYX,KACdA,EAAeL,EAAQwD,IAAIC,YAAc,IAC3CrtB,EAAMA,EAAIstB,eACLpD,EAAOlqB,GACV,GAAI,IAAI+rB,OAAO,MAAQ/rB,EAAM,MAAO,KAAKutB,KAAKtD,GAAe,CAC3D,IAAIuD,EAAM5D,EAAQ4D,IAClBtD,EAAOlqB,GAAO,WACZ,IAAI2pB,EAAMjxB,EAAQuwB,OAAOnxB,MAAMY,EAASgF,WACxChB,QAAQ3C,MAAM,YAAaiG,EAAKwtB,EAAK7D,SAGvCO,EAAOlqB,GAAO,aAGlB,OAAOkqB,EAAOlqB,IAoChBtH,EAAQ0wB,QAAUA,EAIlBA,EAAQoB,OAAS,CACf,KAAS,CAAC,EAAG,IACb,OAAW,CAAC,EAAG,IACf,UAAc,CAAC,EAAG,IAClB,QAAY,CAAC,EAAG,IAChB,MAAU,CAAC,GAAI,IACf,KAAS,CAAC,GAAI,IACd,MAAU,CAAC,GAAI,IACf,KAAS,CAAC,GAAI,IACd,KAAS,CAAC,GAAI,IACd,MAAU,CAAC,GAAI,IACf,QAAY,CAAC,GAAI,IACjB,IAAQ,CAAC,GAAI,IACb,OAAW,CAAC,GAAI,KAIlBpB,EAAQ6B,OAAS,CACf,QAAW,OACX,OAAU,SACV,QAAW,SACX,UAAa,OACb,KAAQ,OACR,OAAU,QACV,KAAQ,UAER,OAAU,OAkRZvyB,EAAQ8Q,QAAUA,EAKlB9Q,EAAQ+xB,UAAYA,EAKpB/xB,EAAQ8wB,OAASA,EAKjB9wB,EAAQ+0B,kBAHR,SAA2B/nB,GACzB,OAAc,MAAPA,GAOThN,EAAQ4yB,SAAWA,EAKnB5yB,EAAQwwB,SAAWA,EAKnBxwB,EAAQg1B,SAHR,SAAkBhoB,GAChB,MAAsB,iBAARA,GAOhBhN,EAAQkyB,YAAcA,EAKtBlyB,EAAQozB,SAAWA,EAKnBpzB,EAAQ+wB,SAAWA,EAKnB/wB,EAAQszB,OAASA,EAMjBtzB,EAAQkzB,QAAUA,EAKlBlzB,EAAQyyB,WAAaA,EAUrBzyB,EAAQi1B,YARR,SAAqBjoB,GACnB,OAAe,OAARA,GACe,kBAARA,GACQ,iBAARA,GACQ,iBAARA,GACQ,iBAARA,QACQ,IAARA,GAIhBhN,EAAQ0O,SAAW,EAAQ,KAY3B,IAAIwmB,EAAS,CAAC,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MACxD,MAAO,MAAO,OAG5B,SAASC,IACP,IAAIzyB,EAAI,IAAI6wB,KACR6B,EAAO,CAACZ,EAAI9xB,EAAE2yB,YACNb,EAAI9xB,EAAE4yB,cACNd,EAAI9xB,EAAE6yB,eAAe9lB,KAAK,KACtC,MAAO,CAAC/M,EAAE8yB,UAAWN,EAAOxyB,EAAE+yB,YAAaL,GAAM3lB,KAAK,KAqCxD,SAAS7Q,EAAemlB,EAAK2R,GAC3B,OAAOh3B,OAAOC,UAAUC,eAAeC,KAAKklB,EAAK2R,GAjCnD11B,EAAQ21B,IAAM,WACZ3xB,QAAQ2xB,IAAI,UAAWR,IAAan1B,EAAQuwB,OAAOnxB,MAAMY,EAASgF,aAiBpEhF,EAAQsoB,SAAW,EAAQ,KAE3BtoB,EAAQiyB,QAAU,SAAS9N,EAAQ1c,GAEjC,IAAKA,IAAQspB,EAAStpB,GAAM,OAAO0c,EAInC,IAFA,IAAI7V,EAAO5P,OAAO4P,KAAK7G,GACnBlJ,EAAI+P,EAAK7P,OACNF,KACL4lB,EAAO7V,EAAK/P,IAAMkJ,EAAI6G,EAAK/P,IAE7B,OAAO4lB,GAOT,IAAIyR,EAA6C,oBAAX3yB,OAAyBA,OAAO,8BAA2Bd,EA0DjG,SAAS0zB,EAAsBC,EAAQC,GAKrC,IAAKD,EAAQ,CACX,IAAIE,EAAY,IAAI10B,MAAM,2CAC1B00B,EAAUF,OAASA,EACnBA,EAASE,EAEX,OAAOD,EAAGD,GAlEZ91B,EAAQi2B,UAAY,SAAmBC,GACrC,GAAwB,mBAAbA,EACT,MAAM,IAAInvB,UAAU,oDAEtB,GAAI6uB,GAA4BM,EAASN,GAA2B,CAClE,IAAI9R,EACJ,GAAkB,mBADdA,EAAKoS,EAASN,IAEhB,MAAM,IAAI7uB,UAAU,iEAKtB,OAHArI,OAAOmE,eAAeihB,EAAI8R,EAA0B,CAClDzyB,MAAO2gB,EAAIhhB,YAAY,EAAOqzB,UAAU,EAAOC,cAAc,IAExDtS,EAGT,SAASA,IAQP,IAPA,IAAIuS,EAAgBC,EAChBh2B,EAAU,IAAIC,SAAQ,SAAUC,EAASC,GAC3C41B,EAAiB71B,EACjB81B,EAAgB71B,KAGduJ,EAAO,GACFzL,EAAI,EAAGA,EAAIyG,UAAUvG,OAAQF,IACpCyL,EAAKjL,KAAKiG,UAAUzG,IAEtByL,EAAKjL,MAAK,SAAUgF,EAAKZ,GACnBY,EACFuyB,EAAcvyB,GAEdsyB,EAAelzB,MAInB,IACE+yB,EAAS92B,MAAMwF,KAAMoF,GACrB,MAAOjG,GACPuyB,EAAcvyB,GAGhB,OAAOzD,EAQT,OALA5B,OAAO6F,eAAeuf,EAAIplB,OAAOwO,eAAegpB,IAE5CN,GAA0Bl3B,OAAOmE,eAAeihB,EAAI8R,EAA0B,CAChFzyB,MAAO2gB,EAAIhhB,YAAY,EAAOqzB,UAAU,EAAOC,cAAc,IAExD13B,OAAO63B,iBACZzS,EACAsM,EAA0B8F,KAI9Bl2B,EAAQi2B,UAAUO,OAASZ,EAiD3B51B,EAAQy2B,YAlCR,SAAqBP,GACnB,GAAwB,mBAAbA,EACT,MAAM,IAAInvB,UAAU,oDAMtB,SAAS2vB,IAEP,IADA,IAAI1sB,EAAO,GACFzL,EAAI,EAAGA,EAAIyG,UAAUvG,OAAQF,IACpCyL,EAAKjL,KAAKiG,UAAUzG,IAGtB,IAAIo4B,EAAU3sB,EAAKhD,MACnB,GAAuB,mBAAZ2vB,EACT,MAAM,IAAI5vB,UAAU,8CAEtB,IAAI6vB,EAAOhyB,KACPmxB,EAAK,WACP,OAAOY,EAAQv3B,MAAMw3B,EAAM5xB,YAI7BkxB,EAAS92B,MAAMwF,KAAMoF,GAClBhE,MAAK,SAAS4G,GAAOskB,EAAQ2F,SAASd,EAAI,KAAMnpB,MAC3C,SAASkqB,GAAO5F,EAAQ2F,SAAShB,EAAuBiB,EAAKf,MAMvE,OAHAr3B,OAAO6F,eAAemyB,EAAeh4B,OAAOwO,eAAegpB,IAC3Dx3B,OAAO63B,iBAAiBG,EACAtG,EAA0B8F,IAC3CQ,K,iCC3rBT,IAOIK,EACAC,EARA9F,EAAUjxB,EAAOD,QAAU,GAU/B,SAASi3B,IACL,MAAM,IAAI31B,MAAM,mCAEpB,SAAS41B,IACL,MAAM,IAAI51B,MAAM,qCAsBpB,SAAS61B,EAAWC,GAChB,GAAIL,IAAqB30B,WAErB,OAAOA,WAAWg1B,EAAK,GAG3B,IAAKL,IAAqBE,IAAqBF,IAAqB30B,WAEhE,OADA20B,EAAmB30B,WACZA,WAAWg1B,EAAK,GAE3B,IAEI,OAAOL,EAAiBK,EAAK,GAC/B,MAAMj3B,GACJ,IAEI,OAAO42B,EAAiBl4B,KAAK,KAAMu4B,EAAK,GAC1C,MAAMj3B,GAEJ,OAAO42B,EAAiBl4B,KAAK+F,KAAMwyB,EAAK,MAvCnD,WACG,IAEQL,EADsB,mBAAf30B,WACYA,WAEA60B,EAEzB,MAAO92B,GACL42B,EAAmBE,EAEvB,IAEQD,EADwB,mBAAjBt1B,aACcA,aAEAw1B,EAE3B,MAAO/2B,GACL62B,EAAqBE,GAjB7B,GAwEA,IAEIG,EAFAlX,EAAQ,GACRmX,GAAW,EAEXC,GAAc,EAElB,SAASC,IACAF,GAAaD,IAGlBC,GAAW,EACPD,EAAa54B,OACb0hB,EAAQkX,EAAahtB,OAAO8V,GAE5BoX,GAAc,EAEdpX,EAAM1hB,QACNg5B,KAIR,SAASA,IACL,IAAIH,EAAJ,CAGA,IAAIv2B,EAAUo2B,EAAWK,GACzBF,GAAW,EAGX,IADA,IAAI3uB,EAAMwX,EAAM1hB,OACVkK,GAAK,CAGP,IAFA0uB,EAAelX,EACfA,EAAQ,KACCoX,EAAa5uB,GACd0uB,GACAA,EAAaE,GAAYG,MAGjCH,GAAc,EACd5uB,EAAMwX,EAAM1hB,OAEhB44B,EAAe,KACfC,GAAW,EAnEf,SAAyBK,GACrB,GAAIX,IAAuBt1B,aAEvB,OAAOA,aAAai2B,GAGxB,IAAKX,IAAuBE,IAAwBF,IAAuBt1B,aAEvE,OADAs1B,EAAqBt1B,aACdA,aAAai2B,GAExB,IAEWX,EAAmBW,GAC5B,MAAOx3B,GACL,IAEI,OAAO62B,EAAmBn4B,KAAK,KAAM84B,GACvC,MAAOx3B,GAGL,OAAO62B,EAAmBn4B,KAAK+F,KAAM+yB,KAgD7CC,CAAgB72B,IAiBpB,SAAS82B,EAAKT,EAAKzmB,GACf/L,KAAKwyB,IAAMA,EACXxyB,KAAK+L,MAAQA,EAYjB,SAASmnB,KA5BT5G,EAAQ2F,SAAW,SAAUO,GACzB,IAAIptB,EAAO,IAAIvF,MAAMO,UAAUvG,OAAS,GACxC,GAAIuG,UAAUvG,OAAS,EACnB,IAAK,IAAIF,EAAI,EAAGA,EAAIyG,UAAUvG,OAAQF,IAClCyL,EAAKzL,EAAI,GAAKyG,UAAUzG,GAGhC4hB,EAAMphB,KAAK,IAAI84B,EAAKT,EAAKptB,IACJ,IAAjBmW,EAAM1hB,QAAiB64B,GACvBH,EAAWM,IASnBI,EAAKl5B,UAAU+4B,IAAM,WACjB9yB,KAAKwyB,IAAIh4B,MAAM,KAAMwF,KAAK+L,QAE9BugB,EAAQ6G,MAAQ,UAChB7G,EAAQ8G,SAAU,EAClB9G,EAAQwD,IAAM,GACdxD,EAAQ+G,KAAO,GACf/G,EAAQgH,QAAU,GAClBhH,EAAQiH,SAAW,GAInBjH,EAAQvjB,GAAKmqB,EACb5G,EAAQxjB,YAAcoqB,EACtB5G,EAAQrjB,KAAOiqB,EACf5G,EAAQ9iB,IAAM0pB,EACd5G,EAAQ/kB,eAAiB2rB,EACzB5G,EAAQ7iB,mBAAqBypB,EAC7B5G,EAAQzlB,KAAOqsB,EACf5G,EAAQtjB,gBAAkBkqB,EAC1B5G,EAAQpjB,oBAAsBgqB,EAE9B5G,EAAQzjB,UAAY,SAAUxL,GAAQ,MAAO,IAE7CivB,EAAQkH,QAAU,SAAUn2B,GACxB,MAAM,IAAIX,MAAM,qCAGpB4vB,EAAQmH,IAAM,WAAc,MAAO,KACnCnH,EAAQoH,MAAQ,SAAUnd,GACtB,MAAM,IAAI7Z,MAAM,mCAEpB4vB,EAAQqH,MAAQ,WAAa,OAAO,I,cCvLpCt4B,EAAOD,QAAU,SAAkBgN,GACjC,OAAOA,GAAsB,iBAARA,GACI,mBAAbA,EAAI3F,MACS,mBAAb2F,EAAIwrB,MACc,mBAAlBxrB,EAAIyrB,Y,cCJW,mBAAlB/5B,OAAO8E,OAEhBvD,EAAOD,QAAU,SAAkB0Q,EAAMgoB,GACvChoB,EAAKioB,OAASD,EACdhoB,EAAK/R,UAAYD,OAAO8E,OAAOk1B,EAAU/5B,UAAW,CAClDkG,YAAa,CACX1B,MAAOuN,EACP5N,YAAY,EACZqzB,UAAU,EACVC,cAAc,MAMpBn2B,EAAOD,QAAU,SAAkB0Q,EAAMgoB,GACvChoB,EAAKioB,OAASD,EACd,IAAIE,EAAW,aACfA,EAASj6B,UAAY+5B,EAAU/5B,UAC/B+R,EAAK/R,UAAY,IAAIi6B,EACrBloB,EAAK/R,UAAUkG,YAAc6L,I,gBCXnB,IAEE1F,EAAV6tB,EACAC,EACAC,EAEAC,EAV8B/4B,EAAOD,SAMrC64B,EAAM,GACNC,EAAMl4B,SACNm4B,EAAOD,EAAIG,gBAAgBC,UAE3BF,GAAUD,EAAO,aAAe,iBAAiBlE,KAAKiE,EAAIK,cAI9DL,EAAIjJ,iBALmB,mBAKgB7kB,EAAW,WAGhD,IAFA8tB,EAAIM,oBANiB,mBAMqBpuB,GAC1CguB,EAAS,EACFhuB,EAAW6tB,EAAI35B,SAAS8L,MAG1B,SAAU8Y,GACfkV,EAAS52B,WAAW0hB,EAAI,GAAK+U,EAAI95B,KAAK+kB,M,cC1B1C,IAKIvlB,EALA86B,EAAuB,oBAAXn1B,OAAyBA,OAAOo1B,UAAUC,UAAY,GAClEC,EAAQ,OAAO3E,KAAKwE,GACpBI,EAAU,QAAQ5E,KAAKwE,GACvBK,GAAgB,aAAa7E,KAAKwE,KAAQI,EAEvCjG,EAASvzB,EAAOD,QAAU,CAC/B25B,EAAIH,EAAQ,SAAW,QACvBz5B,EAAI,YACJ65B,EAAI,YACJC,EAAI,UACJC,EAAI,YACJC,EAAI,YACJC,EAAI,YACJC,EAAI,cACJC,EAAI,QACJC,GAAI,UACJC,GAAI,UACJC,GAAI,UACJC,GAAI,YACJC,GAAI,QACJC,GAAI,UACJC,GAAI,cACJC,GAAI,eACJC,GAAI,cACJC,GAAI,cACJC,GAAI,cACJC,GAAI,WACJC,GAAI,gBACJC,GAAI,mBACJC,GAAI,eACJC,GAAI,oBACJJ,GAAI,WACJK,GAAI,UACJC,GAAI,YACJC,GAAI,cACJC,GAAI,QACJC,GAAI,SACJC,GAAI,SACJC,GAAI,OACJC,GAAI,UACJC,GAAI,SACJC,GAAI,WACJC,GAAI,UACJC,GAAI,YACJC,GAAI,aACJC,GAAI,WACJC,GAAI,WACJC,GAAI,SACJC,GAAI,SACJC,GAAI,SACJC,GAAI7C,EAAQ,SAAW,SACvB8C,GAAI,UACJC,IAAK,UACLC,IAAK,UACLC,IAAK,cACLC,IAAK,aACLC,IAAK,UACLC,IAAK,UACLC,IAAK,aACLC,IAAK,gBACLC,IAAK,eACLC,IAAK,gBACLC,IAAK,iBACLC,IAAK,kBACLC,IAAK,aACLC,IAAK,cACLC,IAAK,iBACLC,IAAK,oBACLC,IAAK,oBACLC,IAAK,iBACLC,IAAK,mBACLC,IAAK,sBACLC,IAAK,iBAGLC,IAAKpE,GAASE,EAAe,IAAM,gBACnCmE,IAAK,gBACLC,IAAK,cACLC,IAAK,eACLC,IAAK,eACLC,IAAK,SACLC,IAAK,eACLC,IAAK,gBACLC,IAAK,wBACLC,IAAK,iBACLC,IAAK,iBACLC,IAAK,IACLC,IAAK,IACLC,IAAK,IACLC,IAAK,IACLC,IAAK,IACLC,IAAK,IACLC,IAAK,IACLC,IAAK,IACLC,IAAK,KACLC,IAAK,IACLC,IAAK,IACLC,IAAK,SACLC,IAAK,SACLC,IAAK,WACLC,IAAK,gBACLC,IAAK7F,EAAU,IAAM,YACrB8F,IAAK,cACLC,IAAK,UACLC,IAAK,UACLC,IAAK,cACLC,IAAK,SACLC,IAAK,SACLC,IAAK,YACLC,IAAK,SACLC,IAAK,WAGP,IAAIxhC,EAAI,GAAIA,EAAI,KAAMA,EACpBi1B,EAAOj1B,GAAKsN,OAAOm0B,aAAazhC,GAIlC,IAAIA,EAAI,GAAIA,EAAI,KAAMA,EACpBi1B,EAAOj1B,GAAMA,EAAI,GAAI,GAIvB,IAAIA,EAAI,GAAIA,EAAI,KAAMA,EACpBi1B,EAAOj1B,GAAKsN,OAAOm0B,aAAazhC,GAIlC,IAAIA,EAAI,GAAIA,EAAI,MAAOA,EACrBi1B,EAAOj1B,GAAK,SAASA,EAAI,IAAI,IAI/B,IAAIA,EAAI,IAAKA,EAAI,MAAOA,EACtBi1B,EAAOj1B,GAAK,KAAKA,EAAE,M,6BC1HrB0B,EAAOD,QAVP,SAAgB+yB,GACd,IAAIzzB,EAAS,GACb,IAAI,IAAIf,KAAKw0B,EACRA,EAAKn0B,eAAeL,KACrBe,EAAOyzB,EAAKx0B,IAAMA,GAGtB,OAAOe,I,6BC+CTW,EAAOD,QAhBP,SAAgB+N,EAAMkyB,EAASC,GAC7B,OAAmB,IAAhBnyB,EAAKtP,OACCsP,EAENkyB,GACGC,GACFnyB,EAAKqB,KAAK6wB,GA5ChB,SAAqBlyB,EAAMkyB,GAIzB,IAHA,IAAI7hB,EAAM,EACNzV,EAAMoF,EAAKtP,OACXqQ,EAAEf,EAAK,GAAIzJ,EAAEyJ,EAAK,GACdxP,EAAE,EAAGA,EAAEoK,IAAOpK,EAGpB,GAFA+F,EAAIwK,EAEDmxB,EADHnxB,EAAIf,EAAKxP,GACK+F,GAAI,CAChB,GAAG/F,IAAM6f,EAAK,CACZA,IACA,SAEFrQ,EAAKqQ,KAAStP,EAIlB,OADAf,EAAKtP,OAAS2f,EACPrQ,EA8BEoyB,CAAYpyB,EAAMkyB,KAEvBC,GACFnyB,EAAKqB,OA9BT,SAAmBrB,GAIjB,IAHA,IAAIqQ,EAAM,EACNzV,EAAMoF,EAAKtP,OACXqQ,EAAEf,EAAK,GAAIzJ,EAAIyJ,EAAK,GAChBxP,EAAE,EAAGA,EAAEoK,IAAOpK,EAAG+F,EAAEwK,EAGzB,GAFAxK,EAAIwK,GACJA,EAAIf,EAAKxP,MACA+F,EAAG,CACV,GAAG/F,IAAM6f,EAAK,CACZA,IACA,SAEFrQ,EAAKqQ,KAAStP,EAIlB,OADAf,EAAKtP,OAAS2f,EACPrQ,EAgBAqyB,CAAUryB,M,6BCnDnB,SAASsyB,EAAcC,EAAU7e,EAAW8e,EAAUC,EAAWC,EAAYC,GAC3E,IAAI/wB,EAAO,CACT,YAAa2wB,EAAU,UAAWE,EAAU/wB,KAAK,KAAO,KAC5DixB,EAAW,GAAK,SAAWH,EAAW,MAAQ,MAC9C,mCACsBE,EAAa,UAAY,OAqB7C,OApBGC,EACEjf,EAAUI,QAAQ,KAAO,EAC1BlS,EAAK5Q,KAAK,sCAEV4Q,EAAK5Q,KAAK,mDAGZ4Q,EAAK5Q,KAAK,OAAQ0iB,EAAW,UAE5B8e,EACD5wB,EAAK5Q,KAAK,qBAEV4Q,EAAK5Q,KAAK,qBAEZ4Q,EAAK5Q,KAAK,KACP2hC,EACD/wB,EAAK5Q,KAAK,eAEV4Q,EAAK5Q,KAAK,cAEL4Q,EAAKF,KAAK,IAGnB,SAASkxB,EAAoBlf,EAAW8e,EAAUK,EAAQF,GAmBxD,OAlBa,IAAIz2B,SAAS,CAC1Bo2B,EAAc,IAAK,IAAM5e,EAAY,IAAK8e,EAAU,CAAC,MAAM,EAAOG,GAClEL,EAAc,IAAK,IAAM5e,EAAY,IAAK8e,EAAU,CAAC,MAAM,EAAMG,GACjEL,EAAc,IAAK,SAAW5e,EAAY,IAAK8e,EAAU,CAAC,IAAK,MAAM,EAAOG,GAC5EL,EAAc,IAAK,SAAW5e,EAAY,IAAK8e,EAAU,CAAC,IAAK,MAAM,EAAMG,GAC7E,2BAA4BE,EAAQ,6YAYXA,GAAQnxB,KAAK,IAC7BnQ,GAGTW,EAAOD,QAAU,CACf6gC,GAAIF,EAAoB,MAAM,EAAO,MACrCG,GAAIH,EAAoB,KAAK,EAAO,MACpCI,GAAIJ,EAAoB,KAAK,EAAM,MACnCK,GAAIL,EAAoB,MAAM,EAAM,MACpCza,GAAIya,EAAoB,KAAK,EAAM,MAAM,K,cClD3C,IAFA,IAAIM,EAAW,EACXC,EAAU,CAAC,KAAM,MAAO,SAAU,KAC9B/mB,EAAI,EAAGA,EAAI+mB,EAAQziC,SAAWyF,OAAOimB,wBAAyBhQ,EAClEjW,OAAOimB,sBAAwBjmB,OAAOg9B,EAAQ/mB,GAAG,yBACjDjW,OAAOi9B,qBAAuBj9B,OAAOg9B,EAAQ/mB,GAAG,yBAClBjW,OAAOg9B,EAAQ/mB,GAAG,+BAG/CjW,OAAOimB,wBACRjmB,OAAOimB,sBAAwB,SAAS/O,EAAUmM,GAC9C,IAAI6Z,GAAW,IAAI7N,MAAO8N,UACtBC,EAAapyB,KAAKjH,IAAI,EAAG,IAAMm5B,EAAWH,IAC1CxnB,EAAKvV,OAAO9B,YAAW,WAAagZ,EAASgmB,EAAWE,KAC1DA,GAEF,OADAL,EAAWG,EAAWE,EACf7nB,IAGVvV,OAAOi9B,uBACRj9B,OAAOi9B,qBAAuB,SAAS1nB,GACnC/X,aAAa+X,M,cCxBrB,IAAiB8nB,EAA4BC,EAAzCC,EAAS,GAeb,SAASC,EAAmB/Y,EAAMgZ,EAAWvmB,EAAUwmB,GACrDjZ,EAAM4Y,GAAqBE,EAASE,EAAsB,SAAXH,EAAqBpmB,EAAW,SAAUymB,IACtFA,IAAmBA,EAAgB39B,OAAO3C,OAG3C,IAAIA,EAAQ,CAEVsgC,cAAeA,EACf9/B,OAAQ8/B,EAAc9/B,QAAU8/B,EAAcC,WAC9CjgC,KAAM,QACNosB,UAAiC,uBAAtB4T,EAAchgC,KAAgC,EAAI,EAC7DqsB,OAAQ,EACR6T,OAAQ,EACR/V,eAAgB,WACd6V,EAAc7V,eACZ6V,EAAc7V,iBACd6V,EAAcG,aAAc,IAclC,MATgB,cAAXR,GACHjgC,EAAM4sB,QAAW,EAAE,GAAK0T,EAAcI,WAEtCJ,EAAcK,cAAiB3gC,EAAM2sB,QAAW,EAAE,GAAK2T,EAAcK,cAErE3gC,EAAM4sB,OAAS0T,EAAcM,OAIxB/mB,EAAU7Z,IAChBqgC,IAAc,GA3Cd19B,OAAO2rB,iBACV0R,EAAoB,oBAEpBA,EAAoB,cACpBE,EAAS,MAIXD,EAAU,YAAa5gC,SAASC,cAAc,OAAS,aACnBsB,IAA1BvB,SAASwhC,aAA6B,aACtC,iBAoCVniC,EAAOD,QAAU,SAAU2oB,EAAMvN,EAAUwmB,GACzCF,EAAmB/Y,EAAM6Y,EAASpmB,EAAUwmB,GAG7B,kBAAXJ,GACFE,EAAmB/Y,EAAM,sBAAuBvN,EAAUwmB,K,cCxD7B,iBAAvB19B,OAAOm+B,YACZn+B,OAAOm+B,YAAYC,IACpBriC,EAAOD,QAAU,WAAa,OAAOkE,OAAOm+B,YAAYC,OAChDp+B,OAAOm+B,YAAYE,YAC3BtiC,EAAOD,QAAU,WAAa,OAAOkE,OAAOm+B,YAAYE,cAElDhP,KAAK+O,IACbriC,EAAOD,QAAUuzB,KAAK+O,IAEtBriC,EAAOD,QAAU,WAAa,OAAO,IAAKuzB,MAAQ8N,Y,gBCRpD,IAAI/b,EAAO,EAAQ,KACf7a,EAAe,EAAQ,IAAUA,aAEjCib,EAAgB,EAAQ,KAyB5B,SAAS8c,EAAOjb,EAASkK,GAGrB7sB,KAAK2iB,QAAUA,GAAW3mB,SAC1B6wB,EAAOA,GAAQ,GACf7sB,KAAKyiB,kBAAoBoK,EAAKpK,gBAC9BziB,KAAK0iB,kBAAoBmK,EAAKnK,gBAC9B1iB,KAAK69B,mBAAqBhR,EAAKgR,iBAC/B79B,KAAK89B,WAAajR,EAAKiR,SAGvB99B,KAAK+kB,KAAO,IAAIlf,EAChB7F,KAAKmlB,GAAK,IAAItf,EAGd7F,KAAK0H,MAAQ,CACTkY,GAAI,EAAGC,GAAI,EACXke,QAAS,EAAGC,QAAS,EAAGC,QAAS,GAIrCj+B,KAAKk+B,YAAc,GACnBl+B,KAAKm+B,WAAa,GAClBn+B,KAAKo+B,iBAAmB,GAIxBp+B,KAAKq+B,sBAAuB,EAG5Br+B,KAAKs+B,aAiFT,SAASC,EAAWC,EAAQvZ,EAASkC,GACjCsX,EAAetX,EAAGG,QAAS5G,EAAKyG,EAAGG,SAAUrC,EAASuZ,EAAQrX,GAGlE,SAASuX,EAAaF,EAAQvZ,EAASkC,GAKnC,OADAsX,GAFe,EAAItX,EAAG2B,OACP,WAAa3B,EAAG2B,OAAS,GAAK,IACX7D,EAASuZ,EAAQrX,IAC5C,EAGX,SAASwX,EAAcH,GACnB,IAAKA,EAAOX,iBAAkB,OAAO,EAGzC,SAASe,EAAYJ,EAAQrX,GAEzB,GAAIqX,EAAOH,qBACPG,EAAOH,sBAAuB,MADlC,CAKA,IAAIze,EAAKuH,EAAGgB,WAAahB,EAAGiB,cAAgB,EACxCvI,EAAKsH,EAAGmB,WAAanB,EAAGoB,cAAgB,EAE5C,GAAIpB,EAAGvZ,SAAyB,IAAbgS,EAAKC,GAAW,CAC/B,IAAIgf,EAoBZ,SAA0B1X,GAGtB,IAFA,IAAI2X,EACAlxB,EAAUuZ,EAAG4X,eACRplC,EAAI,EAAGA,EAAIiU,EAAQ/T,SAAUF,EAC9BiU,EAAQjU,GAAGqlC,YAAcC,IAAaH,EAAQlxB,EAAQjU,IAE9D,IAAKmlC,EAAO,MAAO,CAAC,EAAG,GACvB,IAAII,EAAM,CAACJ,EAAMrW,QAAU0W,EAAYL,EAAMnW,QAAUyW,GAGvD,OAFAD,EAAaL,EAAMrW,QACnB2W,EAAaN,EAAMnW,QACZuW,EA9BMG,CAAiBlY,GAC1BvH,EAAKif,EAAG,GACRhf,EAAKgf,EAAG,GAEZL,EAAO92B,MAAMkY,IAAMA,EACnB4e,EAAO92B,MAAMmY,IAAMA,GAtKvBxkB,EAAOD,QAAU,SAAUkkC,EAAYnV,GACnC,OAAO,IAAIyT,EAAO0B,EAAYnV,IA8DlCyT,EAAO7jC,UAAUukC,WAAa,WAE1Bh/B,OAAO2rB,iBAAiB,UAAWsT,EAAWz/B,UAAKvB,EAAWyC,MAAM,IAAO,GAC3EV,OAAO2rB,iBAAiB,QAASsT,EAAWz/B,UAAKvB,EAAWyC,MAAM,IAAQ,GAE1EA,KAAK2iB,QAAQsI,iBAAiB,YAAayT,EAAa5/B,UAAKvB,EAAWyC,MAAM,IAAO,GACrFA,KAAK2iB,QAAQsI,iBAAiB,UAAWyT,EAAa5/B,UAAKvB,EAAWyC,MAAM,IAAQ,GACpFA,KAAK2iB,QAAQuI,cAAgByT,EAAc7/B,UAAKvB,EAAWyC,MAE3DA,KAAK2iB,QAAQsI,iBAAiB,YAAayT,EAAa5/B,UAAKvB,EAAWyC,MAAM,IAAQ,GAEtFA,KAAK2iB,QAAQsI,iBAAiB,YAAa2T,EAAY9/B,UAAKvB,EAAWyC,OAAO,GAC9EA,KAAK2iB,QAAQsI,iBAAiB,YAAa2T,EAAY9/B,UAAKvB,EAAWyC,OAAO,GAC9EA,KAAK2iB,QAAQsI,iBAAiB,aAAcsU,EAAazgC,UAAKvB,EAAWyC,OAAO,GAEhF8gB,EAAc9gB,KAAK2iB,QAAS6c,EAAa1gC,UAAKvB,EAAWyC,OAAO,GAEhEhE,SAASivB,iBAAiB,oBAAqBwU,EAAa3gC,UAAKvB,EAAWyC,OAAO,GACnFhE,SAASivB,iBAAiB,uBAAwBwU,EAAa3gC,UAAKvB,EAAWyC,OAAO,IAO1F49B,EAAO7jC,UAAU+E,KAAO,SAAU00B,GAC9B,IAAK,IAAI75B,EAAI,EAAGA,EAAIyG,UAAUvG,SAAUF,EAAG,CACvC,IAAI+lC,EAAWt/B,UAAUzG,GACrBoO,EAAM/H,KAAKk+B,YAAYwB,IAAa,IACX,GAAzB33B,EAAIkV,QAAQuW,IACZzrB,EAAI5N,KAAKq5B,GAEbxzB,KAAKk+B,YAAYwB,GAAY33B,EAEjC/H,KAAK0H,MAAM8rB,KAAaxzB,KAAK0H,MAAM8rB,IAIvCoK,EAAO7jC,UAAU+qB,OAAS,SAAU0O,GAChC,IAAK,IAAI9zB,KAAKM,KAAKk+B,YAAa,CAC5B,IAAIn2B,EAAM/H,KAAKk+B,YAAYx+B,GACvB/F,EAAIoO,EAAIkV,QAAQuW,GAChB75B,GAAK,GAAKoO,EAAIhN,OAAOpB,EAAG,KAKpCikC,EAAO7jC,UAAUitB,KAAO,WACpBhnB,KAAK0H,MAAMkY,GAAK5f,KAAK0H,MAAMmY,GAAK,EAChC7f,KAAK0H,MAAMq2B,QAAU/9B,KAAK0H,MAAMs2B,QAAUh+B,KAAK0H,MAAMu2B,QAAU,GAKnEL,EAAO7jC,UAAU4lC,aAAe,WAC5B,IAAI53B,EAAM,GACV,IAAK,IAAIrI,KAAKM,KAAKk+B,YAAen2B,EAAI5N,KAAKuF,GAC3C,OAAOqI,GAkDX,IAAIo3B,EAAa,EACbC,EAAa,EACbH,EAAc,KAElB,SAASM,EAAaf,EAAQrX,GAC1B,IAAI2X,EAAQ3X,EAAG4X,eAAe,GAC9BI,EAAaL,EAAMrW,QACnB2W,EAAaN,EAAMnW,QACnBsW,EAAcH,EAAME,WAgBxB,SAASQ,EAAahB,EAAQrX,GAE1B,IAAI1jB,EAAQ,EACZ,OAAQ0jB,EAAGkC,WACP,KAAK,EAAG5lB,EAAQ,EAAG,MACnB,KAAK,EAAGA,EAAQ,GAAI,MACpB,KAAK,EAEDA,EAAQ+6B,EAAO7b,QAAQqF,cAAgB1oB,OAAOsgC,YAOtD,OAHApB,EAAO92B,MAAMq2B,SAAW5W,EAAGmC,OAAS7lB,EACpC+6B,EAAO92B,MAAMs2B,SAAW7W,EAAGoC,OAAS9lB,EACpC+6B,EAAO92B,MAAMu2B,SAAY9W,EAAGqC,OAAS/lB,GAAU,GACxC,EAGX,SAASg8B,EAAajB,EAAQrX,IACbnrB,SAASwqB,oBACfxqB,SAASyqB,uBACT,QACK+X,EAAOH,sBAAuB,GAe9C,SAASI,EAAeoB,EAASC,EAAO7a,EAASuZ,EAAQrX,GACrD,IAAIpf,EAAMy2B,EAAON,YAAY4B,GAE7B,GAAK/3B,EAAL,CAMA,GALIy2B,EAAO/b,iBAAiB0E,EAAGC,iBAC3BoX,EAAO9b,iBAAiByE,EAAGzE,kBAI3Bqd,EADYvB,EAAOL,WAAW0B,GACf5a,GAEf,IAAK,IAAItrB,EAAI,EAAGA,EAAIoO,EAAIlO,SAAUF,EAC9BqmC,EAAmBj4B,EAAIpO,GAAIsrB,EAASuZ,EAAQrX,GAGpDqX,EAAOL,WAAW0B,GAAW5a,GAIjC,SAAS+a,EAAmBxM,EAASvO,EAASuZ,EAAQrX,GAGlD,IAAI8Y,EAAKzB,EAAOJ,iBAAiB5K,IAAY,EAO7C,IANAyM,GAAMhb,EAAU,GAAK,GACZ,IAAKgb,EAAK,GACnBzB,EAAOJ,iBAAiB5K,GAAWyM,EAI/BF,EADYvB,EAAO92B,MAAM8rB,GACVyM,GAAK,CACpB,IAAI/4B,EAAU+d,EAAUuZ,EAAOzZ,KAAOyZ,EAAOrZ,GACxCqZ,EAAOV,UAAU52B,EAAQL,KAAK2sB,EAASrM,GAEhDqX,EAAO92B,MAAM8rB,KAAayM,EAgB9B,SAASF,EAAI71B,EAAGxK,GACZ,OAAOwK,GAAKxK,EAAIA,I,6BC7RpB,IAKI/F,EALA86B,EAAuB,oBAAXn1B,OAAyBA,OAAOo1B,UAAUC,UAAY,GAClEC,EAAQ,OAAO3E,KAAKwE,GACpBI,EAAU,QAAQ5E,KAAKwE,GACvBK,GAAgB,aAAa7E,KAAKwE,KAAQI,EAEvCjG,EAASvzB,EAAOD,QAAU,CAC/B25B,EAAIH,EAAQ,SAAW,QACvBz5B,EAAI,YACJ65B,EAAI,YACJC,EAAI,UACJC,EAAI,YACJC,EAAI,YACJC,EAAI,YACJC,EAAI,cACJC,EAAI,QACJC,GAAI,UACJC,GAAI,UACJC,GAAI,UACJC,GAAI,YACJC,GAAI,QACJC,GAAI,UACJC,GAAI,cACJC,GAAI,eACJC,GAAI,cACJC,GAAI,cACJC,GAAI,cACJC,GAAI,WACJC,GAAI,gBACJC,GAAI,mBACJC,GAAI,eACJC,GAAI,oBACJC,GAAI,UACJC,GAAI,YACJC,GAAI,cACJC,GAAI,QACJC,GAAI,SACJC,GAAI,SACJC,GAAI,OACJC,GAAI,UACJC,GAAI,SACJC,GAAI,WACJC,GAAI,UACJC,GAAI,YACJC,GAAI,aACJC,GAAI,WACJC,GAAI,WACJC,GAAI,SACJC,GAAI,SACJC,GAAI,SACJC,GAAI7C,EAAQ,SAAW,SACvB8C,GAAI,UACJC,IAAK,UACLC,IAAK,UACLC,IAAK,cACLC,IAAK,aACLC,IAAK,UACLC,IAAK,UACLC,IAAK,aACLC,IAAK,gBACLC,IAAK,eACLC,IAAK,gBACLC,IAAK,iBACLC,IAAK,kBACLC,IAAK,aACLC,IAAK,cACLC,IAAK,iBACLC,IAAK,oBACLC,IAAK,oBACLC,IAAK,iBACLC,IAAK,mBACLC,IAAK,sBACLC,IAAK,iBAGLC,IAAKpE,GAASE,EAAe,IAAM,gBACnCmE,IAAK,gBACLC,IAAK,cACLC,IAAK,eACLC,IAAK,eACLC,IAAK,SACLC,IAAK,eACLC,IAAK,gBACLC,IAAK,wBACLC,IAAK,iBACLC,IAAK,iBACLC,IAAK,IACLC,IAAK,IACLC,IAAK,IACLC,IAAK,IACLC,IAAK,IACLC,IAAK,IACLC,IAAK,IACLC,IAAK,IACLC,IAAK,KACLC,IAAK,IACLC,IAAK,IACLC,IAAK,SACLC,IAAK,SACLC,IAAK,WACLC,IAAK,gBACLC,IAAK7F,EAAU,IAAM,YACrB8F,IAAK,cACLC,IAAK,UACLC,IAAK,UACLC,IAAK,cACLC,IAAK,SACLC,IAAK,SACLC,IAAK,YACLC,IAAK,SACLC,IAAK,WAGP,IAAIxhC,EAAI,GAAIA,EAAI,KAAMA,EACpBi1B,EAAOj1B,GAAKsN,OAAOm0B,aAAazhC,GAIlC,IAAIA,EAAI,GAAIA,EAAI,KAAMA,EACpBi1B,EAAOj1B,GAAMA,EAAI,GAAI,GAIvB,IAAIA,EAAI,GAAIA,EAAI,KAAMA,EACpBi1B,EAAOj1B,GAAKsN,OAAOm0B,aAAazhC,GAIlC,IAAIA,EAAI,GAAIA,EAAI,MAAOA,EACrBi1B,EAAOj1B,GAAK,SAASA,EAAI,IAAI,IAI/B,IAAIA,EAAI,IAAKA,EAAI,MAAOA,EACtBi1B,EAAOj1B,GAAK,KAAKA,EAAE,M,cCrIrB,IAAiBgjC,EAA4BC,EAAzCC,EAAS,GAeb,SAASC,EAAmB/Y,EAAMgZ,EAAWvmB,EAAUwmB,GACrDjZ,EAAM4Y,GAAqBE,EAASE,EAAsB,SAAXH,EAAqBpmB,EAAW,SAAUymB,IACtFA,IAAmBA,EAAgB39B,OAAO3C,OAG3C,IAAIA,EAAQ,CAEVsgC,cAAeA,EACf9/B,OAAQ8/B,EAAc9/B,QAAU8/B,EAAcC,WAC9CjgC,KAAM,QACNosB,UAAiC,uBAAtB4T,EAAchgC,KAAgC,EAAI,EAC7DqsB,OAAQ,EACR6T,OAAQ,EACR/V,eAAgB,WACd6V,EAAc7V,eACZ6V,EAAc7V,iBACd6V,EAAcG,aAAc,IAclC,MATgB,cAAXR,GACHjgC,EAAM4sB,QAAW,EAAE,GAAK0T,EAAcI,WAEtCJ,EAAcK,cAAiB3gC,EAAM2sB,QAAW,EAAE,GAAK2T,EAAcK,cAErE3gC,EAAM4sB,OAAS0T,EAAcM,OAIxB/mB,EAAU7Z,IAChBqgC,IAAc,GA3Cd19B,OAAO2rB,iBACV0R,EAAoB,oBAEpBA,EAAoB,cACpBE,EAAS,MAIXD,EAAU,YAAa5gC,SAASC,cAAc,OAAS,aACnBsB,IAA1BvB,SAASwhC,aAA6B,aACtC,iBAoCVniC,EAAOD,QAAU,SAAU2oB,EAAMvN,EAAUwmB,GACzCF,EAAmB/Y,EAAM6Y,EAASpmB,EAAUwmB,GAG7B,kBAAXJ,GACFE,EAAmB/Y,EAAM,sBAAuBvN,EAAUwmB,K,6BCtD9D,IAAItvB,EAAO,EAAQ,IACfpB,EAAO,EAAQ,IACf4zB,EAAQ,EAAQ,KAChBC,EAAY,EAAQ,KAMxB9kC,EAAOD,QAAU,SAAUyxB,EAAMuT,EAAWC,GACxC,OAAO,IAAIC,EAAQzT,EAAMuT,EAAWC,IAGxC,IAAIE,EAAW,CACXC,QAAS,CAAC,GAAI,GAAI,GAClBC,iBAAkB,GAClBC,QAAS,GACTC,UAAW,GACXC,aAAc,GAUlB,SAASN,EAAQzT,EAAMuT,EAAWC,GAC9BxT,EAAO/yB,OAAOqG,OAAO,GAAIogC,EAAU1T,GAEnC7sB,KAAKwgC,QAAU3T,EAAK2T,QACpBxgC,KAAK0gC,QAAU7T,EAAK6T,QACpB1gC,KAAK4gC,aAAe/T,EAAK+T,aACzB5gC,KAAK2gC,UAAY9T,EAAK8T,UACtB3gC,KAAKygC,iBAAmB5T,EAAK4T,iBAC7BzgC,KAAK6gC,OAAS,GAGd7gC,KAAKogC,UAAYA,EACjBpgC,KAAKqgC,UAAYA,EAQrBC,EAAQvmC,UAAUga,QAAU,SAAU+sB,EAAOC,EAAMC,EAC/CC,EAAaC,EAAUC,GACvBL,EAAQA,GAAS,IAAIpzB,EAAK,CAAC,EAAG,EAAG,GAAI,CAAC,EAAG,EAAG,SACzB,IAARqzB,IAAqBA,EAAO,QAChB,IAAZC,IAAyBA,EAAW,QACrB,IAAfC,IAA4BA,EAAc,QAC9B,IAAZC,IAAyBA,EAAW,GAC/C,IAAIxhC,EAAI,IAAIygC,EAAUW,EAAOC,EAAMC,EAAUC,EAAaC,EAAUC,GAEpE,OADAnhC,KAAK6gC,OAAO1mC,KAAKuF,GACVA,GAGX4gC,EAAQvmC,UAAUya,WAAa,SAAU9U,GACrC,IAAI/F,EAAIqG,KAAK6gC,OAAO5jB,QAAQvd,GACxB/F,EAAI,IACRqG,KAAK6gC,OAAO9lC,OAAOpB,EAAG,GACtB+F,EAAEgO,KAAOhO,EAAEyhC,UAAY,OAU3B,IAAIj3B,EAAIoC,EAAK1N,SACTqZ,EAAK3L,EAAK1N,SACVghB,EAAKtT,EAAK1N,SACVwiC,EAAU90B,EAAK1N,SACfyiC,EAAa/0B,EAAK1N,SAMtB0hC,EAAQvmC,UAAUitB,KAAO,SAAUtT,GAE/BA,GAAU,IACV,IAAI4tB,EAAY3+B,EAAO,EAAG2J,EAAKtI,cAAchE,KAAKwgC,UAElDxgC,KAAK6gC,OAAO97B,QAAQrF,GASxB,SAAqBsyB,EAAMtyB,EAAGgU,EAAI4tB,GAI9B,GAHAh1B,EAAK7J,KAAK4+B,EAAY3hC,EAAE6hC,SAGpB7hC,EAAEqhC,MAAQ,EAIV,OAHAz0B,EAAK5J,IAAIhD,EAAE2V,SAAU,EAAG,EAAG,GAC3B/I,EAAK5J,IAAIhD,EAAE8hC,QAAS,EAAG,EAAG,QAC1Bl1B,EAAK5J,IAAIhD,EAAE+hC,UAAW,EAAG,EAAG,GAKhC,IAAIC,EAAcJ,GAAsC,IAAxB5hC,EAAEiiC,kBAClC,GAgRJ,SAAoB3P,EAAM1wB,EAAMoS,EAAI4tB,GAChC,GAAIhgC,EAAKsgC,iBAAmB,EAAG,OAAO,EAEtC,GAAIN,EAAW,OAAO,EAItB,IAAIO,GAAY,EACZC,EAAQ,GAAMpuB,EAAKA,EAAKpS,EAAKqgC,kBAMjC,OALAr1B,EAAK7I,MAAMs+B,EAAU/P,EAAKwO,QAASsB,GACnC5B,EAAMlO,EAAKoO,UAAW9+B,EAAKoM,KAAMq0B,GAAU,WAEvC,OADAF,GAAY,GACL,KACR,GACIA,EA9RHG,CAAWhQ,EAAMtyB,EAAGgU,EAAIguB,GAAc,OAC1ChiC,EAAEkiC,mBAqGN,SAA0B5P,EAAM1wB,GAG5B,IAAI6T,EAAM7T,EAAKoM,KACXu0B,EAAK33B,KAAKhH,MAAM6R,EAAIzI,KAAK,IACzBw1B,EAAK53B,KAAKhH,MAAM6R,EAAIzI,KAAK,IACzBO,EAAK3C,KAAKhH,MAAM6R,EAAIzI,KAAK,IACzBU,EAAK9C,KAAKhH,MAAM6R,EAAI9R,IAAI,IAE5B,IAAK2uB,EAAKqO,UAAU4B,EAAIh1B,EAAIi1B,GAGxB,OAFA5gC,EAAK6gC,SAAU,OACf7gC,EAAK8gC,aAAe,GAKxB,IAAIC,EAAY,EACZC,EAAKr1B,EAAK,EACd,KAAOq1B,GAAMl1B,GAAM4kB,EAAKqO,UAAU4B,EAAIK,EAAIJ,IACtCG,IACAC,IAEJ,IAEIF,GAFan1B,EAAKo1B,EACWltB,EAAIzI,KAAK,IACPyI,EAAI3I,IAAI,GACvC41B,EAAe,IAAGA,EAAe,GACrC,IACIG,EADMptB,EAAI3I,IAAI,GAAK2I,EAAI3I,IAAI,GAAK2I,EAAI3I,IAAI,GACtB41B,EAElB7gC,EAAIihC,EACRl2B,EAAK7I,MAAMlC,EAAGywB,EAAKwO,SAAUxO,EAAK4O,aAAe2B,GACjDjhC,EAAKmhC,WAAWlhC,GAEhBD,EAAK6gC,SAAU,EACf7gC,EAAK8gC,aAAeA,EApIpBM,CAAiB1Q,EAAMtyB,GAGvBijC,EAAYjjC,EAAE8hC,SACdmB,EAAYjjC,EAAE+hC,WACdkB,EAAYjjC,EAAE2V,UACdstB,EAAYjjC,EAAE6hC,SAKdj1B,EAAK7I,MAAMyG,EAAGxK,EAAE8hC,QAAS,EAAI9hC,EAAEqhC,MAC/Bz0B,EAAK5I,YAAYwG,EAAGA,EAAG8nB,EAAKwO,QAAS9gC,EAAEiiC,mBAIvCr1B,EAAK7I,MAAMwU,EAAIvY,EAAE+hC,UAAW,EAAI/hC,EAAEqhC,MAClCz0B,EAAK5I,YAAYuU,EAAIA,EAAI/N,EAAGwJ,GAC5BpH,EAAKzJ,IAAInD,EAAE2V,SAAU3V,EAAE2V,SAAU4C,GAG7BvY,EAAEshC,WACF4B,EAAoB,EAAGljC,EAAGuY,GAC1B2qB,EAAoB,EAAGljC,EAAGuY,GAC1B2qB,EAAoB,EAAGljC,EAAGuY,IAK9B,IAAI4qB,EAAQnjC,EAAEghC,SAAW,EAAKhhC,EAAEghC,QAAU1O,EAAK0O,QAC3ChhC,EAAEyiC,UACFU,EAAQnjC,EAAEihC,WAAa,EAAKjhC,EAAEihC,UAAY3O,EAAK2O,UAC/CkC,GAAQ,GAAK,EAAInjC,EAAE0iC,eAAiB,GAExC,IAAIU,EAAOx4B,KAAKjH,IAAI,EAAIw/B,EAAOnvB,EAAKhU,EAAEqhC,KAAM,GAC5Cz0B,EAAK7I,MAAM/D,EAAE2V,SAAU3V,EAAE2V,SAAUytB,GAGnCx2B,EAAK7I,MAAMmc,EAAIlgB,EAAE2V,SAAU3B,GAG3BpH,EAAK5J,IAAIhD,EAAE8hC,QAAS,EAAG,EAAG,GAC1Bl1B,EAAK5J,IAAIhD,EAAE+hC,UAAW,EAAG,EAAG,GAGxB/hC,EAAEqjC,UACFC,EAAUC,EAAQvjC,EAAEgO,MAIxBw1B,EAAkBlR,EAAMtyB,EAAEgO,KAAMkS,EAAIlgB,EAAE6hC,SAGlC7hC,EAAEqjC,UA4JV,SAAyB/Q,EAAMtyB,EAAGyjC,EAAQvjB,GACtC,GAAIlgB,EAAE6hC,QAAQ,IAAM,IAAM7hC,EAAEyiC,QAAS,OAGrC,IAAIiB,EAA6B,IAAjB1jC,EAAE6hC,QAAQ,GACtB8B,EAA6B,IAAjB3jC,EAAE6hC,QAAQ,GAC1B,IAAM6B,IAAYC,EAAW,OAG7B,IAAIC,EAAQh5B,KAAKC,IAAIqV,EAAG,GAAKA,EAAG,IAEhC,IAAKwjB,GAAYE,EADJ,EACoB,OACjC,IAAKD,GAAYC,EAAQ,EAFZ,EAEwB,OAGrCh3B,EAAKzJ,IAAI0gC,EAAWJ,EAAOz2B,KAAMkT,GAGjC,IAAI4jB,EAAYxR,EAAKoO,UACrBF,EAAMsD,EAAWL,EAAQvjB,GAAI,SAAUhc,EAAMuT,EAAMZ,EAAK/J,GACpD,GAAa,IAAT2K,EACC,OAAO,EADI3K,EAAI2K,GAAQ,KAIhC,IAAI3V,EAAI9B,EAAEgO,KAAKhB,KAAK,GAChB+2B,EAAQn5B,KAAKhH,MAAM9B,EAAI,OAASA,EACpC8K,EAAK5J,IAAIghC,EAAO,EAAGD,EAAO,GAC1B,IAAIE,GAAW,EAMf,GAJAzD,EAAMsD,EAAWL,EAAQO,GAAO,SAAU9/B,EAAMuT,EAAMZ,EAAK/J,GAEvD,OADAm3B,GAAW,GACJ,KAEPA,EAAU,OAQd,GALAr3B,EAAKxJ,SAAS8gC,EAAUL,EAAWJ,EAAOz2B,MAC1Ck3B,EAAS,GAAK,EACdV,EAAkBlR,EAAMmR,EAAQS,EAAUC,GAGtCT,IAAazgC,EAAOwgC,EAAOz2B,KAAK,GAAI62B,EAAU,IAAK,OACvD,GAAIF,IAAa1gC,EAAOwgC,EAAOz2B,KAAK,GAAI62B,EAAU,IAAK,OAGvDP,EAAUtjC,EAAEgO,KAAMy1B,GAClBzjC,EAAE6hC,QAAQ,GAAKsC,EAAW,GAC1BnkC,EAAE6hC,QAAQ,GAAKsC,EAAW,GACtBnkC,EAAEokC,QAAQpkC,EAAEokC,SA3MZC,CAAgB/R,EAAMtyB,EAAGujC,EAAQrjB,GAIrC,IAAK,IAAIjmB,EAAI,EAAGA,EAAI,IAAKA,EACrBynC,EAAQznC,GAAK,EACT+F,EAAE6hC,QAAQ5nC,KAEL0nC,EAAW1nC,KAAIynC,EAAQznC,IAAM+F,EAAE2V,SAAS1b,IAC7C+F,EAAE2V,SAAS1b,GAAK,GAGxB,IAAIgT,EAAML,EAAKzS,OAAOunC,GAClBz0B,EAAM,OAINL,EAAK7I,MAAM29B,EAASA,EAAS1hC,EAAEqhC,MAC3BrhC,EAAEyhC,WAAWzhC,EAAEyhC,UAAUC,GAGzB1hC,EAAEuhC,YAAc,GAAKt0B,EAAMqlB,EAAKyO,mBAChCn0B,EAAK7I,MAAM29B,EAASA,EAAS1hC,EAAEuhC,aAC/BvhC,EAAEskC,aAAa5C,KAMb90B,EAAKtI,cAActE,EAAE2V,UACrB,MAAM3V,EAAEukC,cA9GOC,CAAYlkC,KAAMN,EAAGgU,EAAI4tB,KAiKtD,IAAIkB,EAAYl2B,EAAK1N,SAWrB,SAASgkC,EAAoBzrB,EAAM7V,EAAM6iC,GAErC,IAAIC,EAAU9iC,EAAKigC,QAAQpqB,GACvBktB,EAAUF,EAAKhtB,GACnB,GAAgB,IAAZitB,KACAA,EAAUC,GAAW,GAAzB,CAGA/3B,EAAK7J,KAAK6hC,EAAYhjC,EAAK+T,UAC3BivB,EAAWntB,GAAQ,EACnB,IAAIotB,EAAQj4B,EAAKzS,OAAOyqC,GACxB,IAAI3hC,EAAO4hC,EAAO,GAAlB,CAWA,IAAIC,EAAQl6B,KAAKC,IAAIjJ,EAAK0/B,SAAWqD,GAGjCI,EAAUF,EAAQC,GAAUD,EAAQC,GAASD,EAAQ,EACzDjjC,EAAK+T,UAAU8B,EAAO,GAAK,IAAMstB,EACjCnjC,EAAK+T,UAAU8B,EAAO,GAAK,IAAMstB,IAErC,IAAIH,EAAah4B,EAAK1N,SAYtB,SAASskC,EAAkBlR,EAAM7c,EAAKE,EAAUksB,GAE5C,OADAj1B,EAAK5J,IAAI6+B,EAAS,EAAG,EAAG,GACjBrB,EAAMlO,EAAKoO,UAAWjrB,EAAKE,GAAU,SAAUzR,EAAMuT,EAAMZ,EAAK/J,GACnE+0B,EAAQpqB,GAAQZ,EAChB/J,EAAI2K,GAAQ,KAYpB,IAAI8rB,EAAS,IAAIv1B,EAAK,GAAI,IACtBm2B,EAAav3B,EAAK1N,SAClB2kC,EAAYj3B,EAAK1N,SACjB8kC,EAAQp3B,EAAK1N,SACbglC,EAAWt3B,EAAK1N,SA6EpB,IAAImjC,EAAWz1B,EAAK1N,SAMpB,SAAS+D,EAAOuH,EAAGxK,GAAK,OAAO4K,KAAKC,IAAIL,EAAIxK,GAAK,KAEjD,SAASsjC,EAAU0B,EAAKpoC,GACpB,IAAK,IAAI3C,EAAI,EAAGA,EAAI,EAAGA,IACnB+qC,EAAIh4B,KAAK/S,GAAK2C,EAAIoQ,KAAK/S,GACvB+qC,EAAIrhC,IAAI1J,GAAK2C,EAAI+G,IAAI1J,GACrB+qC,EAAIl4B,IAAI7S,GAAK2C,EAAIkQ,IAAI7S,GAM7B,IAAIgpC,EAAc,c,6BCjalB,IAAIj1B,EAAO,EAAQ,IACfpB,EAAO,EAAQ,IAenB,SAAS6zB,EAAUW,EAAOC,EAAMC,EAAUC,EAAaC,EAAUC,EAAW4B,GACxE/iC,KAAK0N,KAAO,IAAIA,EAAKozB,EAAMp0B,KAAMo0B,EAAMt0B,KACvCxM,KAAK+gC,KAAOA,EACZ/gC,KAAKghC,SAAWA,EAChBhhC,KAAKihC,YAAcA,EACnBjhC,KAAK2hC,kBAAoBT,EACzBlhC,KAAKmhC,UAAYA,EACjBnhC,KAAK+iC,WAAaA,EAClB/iC,KAAK0gC,SAAW,EAChB1gC,KAAK2gC,WAAa,EAClB3gC,KAAK8jC,OAAS,KAGd9jC,KAAKqV,SAAW/I,EAAK1N,SACrBoB,KAAKuhC,QAAU,CAAC,EAAG,EAAG,GACtBvhC,KAAKmiC,SAAU,EACfniC,KAAK2kC,cAAgB,EACrB3kC,KAAKwhC,QAAUl1B,EAAK1N,SACpBoB,KAAKyhC,UAAYn1B,EAAK1N,SACtBoB,KAAK4hC,iBAAmB,GA5B5BvmC,EAAOD,QAAU+kC,EA+BjBA,EAAUpmC,UAAUyT,YAAc,SAAUjR,GACxComC,EAAYpmC,GACZ+P,EAAKxJ,SAASvG,EAAGA,EAAGyD,KAAK0N,KAAKhB,MAC9B1M,KAAK0N,KAAKJ,UAAU/Q,GACpByD,KAAKikC,eAET9D,EAAUpmC,UAAU6qC,YAAc,WAC9B,OAAOt4B,EAAKhK,MAAMtC,KAAK0N,KAAKhB,OAEhCyzB,EAAUpmC,UAAU0oC,WAAa,SAAUlhC,GACvCohC,EAAYphC,GACZ+K,EAAKzJ,IAAI7C,KAAKwhC,QAASxhC,KAAKwhC,QAASjgC,GACrCvB,KAAKikC,eAET9D,EAAUpmC,UAAUiqC,aAAe,SAAUrqC,GACzCgpC,EAAYhpC,GACZ2S,EAAKzJ,IAAI7C,KAAKyhC,UAAWzhC,KAAKyhC,UAAW9nC,GACzCqG,KAAKikC,eAET9D,EAAUpmC,UAAUkqC,YAAc,WAC9BjkC,KAAK4hC,iBAAmB,IAM5BzB,EAAUpmC,UAAU8qC,QAAU,WAAc,OAAO7kC,KAAKuhC,QAAQ,IAChEpB,EAAUpmC,UAAU+qC,QAAU,WAAc,OAAO9kC,KAAKuhC,QAAQ,IAChEpB,EAAUpmC,UAAUgrC,QAAU,WAAc,OAAO/kC,KAAKuhC,QAAQ,IAMhE,IAAIoB,EAAc,c,6BCxElBtnC,EAAOD;;;;;;;AA2BP,SAAS4pC,IACR,IAAIhT,EAAOhyB,KAYXA,KAAKilC,WAAa,GAClBjlC,KAAKklC,MAAQllC,KAAKilC,WAUlB,IAAIA,EAAajlC,KAAKilC,WAGlBE,EAAM,EAINC,EAAU,GAGVC,EAAU,GACVC,EAAgB,GAGhBC,EAAyB,GACzBC,EAAuB,GACvBC,EAA4B,GAufhC,SAASC,EAAgB7xB,GAGxB/Z,OAAO4P,KAAK07B,GAASrgC,QAAQ4gC,IACjBP,EAAQO,GACVxX,KAAKta,IAAQ+xB,EAAmB/xB,EAAO8xB,KAMlD,SAASC,EAAmB/xB,EAAO8xB,GAClC,IAAIE,EAAMZ,EAAWU,GACjBtsC,EAAO+rC,EAAQO,GACdtsC,GACAA,EAAK80B,KAAKta,KAGXgyB,EAAIryB,WACHqyB,EAAIC,MACPzsC,EAAK80B,KAAKta,GAAO9O,QAAQ2C,IACxBm+B,EAAIryB,SAASK,EAAOnM,KAGrBm+B,EAAIryB,SAASK,EAAOxa,EAAK80B,KAAKta,KAK5BgyB,EAAIC,QAAOzsC,EAAK80B,KAAKta,GAAOha,OAAS,GAGzCksC,EAAUC,OAAO3sC,EAAMwa,IAMxB,SAASoyB,EAAmBpyB,EAAO8xB,EAAUO,GAC5C,IAAIL,EAAMZ,EAAWU,GAEjBQ,EADOf,EAAQO,GACExX,KAAKta,GAC1B,GAAKsyB,EAAL,CAEA,IAAIxsC,EAAIwsC,EAAUlpB,QAAQipB,GACtBvsC,EAAI,IACJksC,EAAIryB,UACPqyB,EAAIryB,SAASK,EAAOqyB,GAErBC,EAAUprC,OAAOpB,EAAG,GAGK,IAArBwsC,EAAUtsC,QACb+rC,EAAmB/xB,EAAO8xB,KAoB5B,SAASS,IACJC,IACJA,GAAyB,EACzB7oC,YAAW,WACV6oC,GAAyB,EACzBC,MACE,IAlkBJtmC,KAAKumC,SAAWnB,EAChBplC,KAAKwmC,SAAWnB,EAChBrlC,KAAKymC,eAAiBnB,EAwBtBtlC,KAAK0mC,aAAe,SAAUC,GAC7B,IAAI9xB,EAAKswB,IAIT,OAHIwB,GAAYA,EAAS9sC,QACxB8sC,EAAS5hC,QAAQ4gC,GAAY3T,EAAK4U,aAAa/xB,EAAI8wB,IAE7C9wB,GAgBR7U,KAAK6mC,aAAe,SAAUhzB,EAAOizB,GAOpC,OANIA,EACHpB,EAAgB7xB,IAEhB0xB,EAAuBprC,KAAK0Z,GAC5BuyB,KAEMpU,GAqCRhyB,KAAK+mC,gBAAkB,SAAUC,GAChC,IAAKA,EAAU,KAAM,+BACrB,IAAI3pC,EAAO2pC,EAAS3pC,KACpB,IAAKA,EAAM,KAAM,kDACjB,GAAoB,iBAATA,EAAmB,KAAM,mCACpC,GAAa,KAATA,EAAa,KAAM,6CACvB,GAAI+nC,EAAQ/nC,GAAO,KAAM,aAAaA,oBAGtC,IAAI4pC,EAAc,GAsBlB,OArBAA,EAAY5pC,KAAOA,EACnB4pC,EAAY98B,MAAQvE,MAAMohC,EAAS78B,OAAS,GAAK68B,EAAS78B,MAC1D88B,EAAYv/B,MAAQs/B,EAASt/B,OAAS,GACtCu/B,EAAY7zB,MAAQ4zB,EAAS5zB,OAAS,KACtC6zB,EAAYzzB,SAAWwzB,EAASxzB,UAAY,KAC5CyzB,EAAYxzB,OAASuzB,EAASvzB,QAAU,KACxCwzB,EAAYxyB,aAAeuyB,EAASvyB,cAAgB,KACpDwyB,EAAYnB,QAAUkB,EAASlB,MAE/Bb,EAAW5nC,GAAQ4pC,EACnB7B,EAAQ/nC,GAAQ0oC,EAAUnnC,SAEtBqoC,EAAYxzB,SACf4xB,EAAQlrC,KAAKkD,GACbgoC,EAAQ76B,KAAK,CAACN,EAAGxK,IAAMulC,EAAW/6B,GAAGC,MAAQ86B,EAAWvlC,GAAGyK,QAExD88B,EAAYxyB,eACf6wB,EAAcnrC,KAAKkD,GACnBioC,EAAc96B,KAAK,CAACN,EAAGxK,IAAMulC,EAAW/6B,GAAGC,MAAQ86B,EAAWvlC,GAAGyK,QAG3D9M,GAmBR2C,KAAKknC,gBAAkB,SAAUvB,GAChC,IAAItsC,EAAO+rC,EAAQO,GACnB,IAAKtsC,EAAM,KAAM,sBAAsBssC,EAEvCtsC,EAAK8P,KAAKpE,QAAQoa,IACjB,IAAItK,EAAKsK,EAAIhL,MAAQgL,EAAI,GAAGhL,KAC5B6d,EAAKmV,gBAAgBtyB,EAAI8wB,GAAU,KAGpC,IAAIhsC,EAAI0rC,EAAQpoB,QAAQ0oB,GACpB9qC,EAAIyqC,EAAcroB,QAAQ0oB,GAO9B,OANIhsC,GAAK,GAAG0rC,EAAQtqC,OAAOpB,EAAG,GAC1BkB,GAAK,GAAGyqC,EAAcvqC,OAAOF,EAAG,UAE7BoqC,EAAWU,UACXP,EAAQO,GAER3T,GAkBRhyB,KAAK4mC,aAAe,SAAU/yB,EAAO8xB,EAAUj+B,GAC9C,IAAIm+B,EAAMZ,EAAWU,GACjBtsC,EAAO+rC,EAAQO,GACnB,IAAKtsC,EAAM,KAAM,sBAAsBssC,KAGvC,IAAIyB,GAAiB,EAMrB,GALA5B,EAAqBzgC,QAAQoa,IACxBA,EAAItK,KAAOhB,GAASsL,EAAIwmB,WAAaA,IAAUyB,GAAiB,KAEjEA,GAAgBC,IAEhBhuC,EAAK80B,KAAKta,KAAWgyB,EAAIC,MAAO,KAAM,UAAUjyB,4BAAgC8xB,KAGpF,IAAI2B,EAAWxtC,OAAOqG,OAAO,GAAI,CAAEgU,KAAMN,GAASgyB,EAAIn+B,MAAOA,GAM7D,GAHA4/B,EAASnzB,KAAON,EAGZgyB,EAAIC,MAAO,CACd,IAAIK,EAAY9sC,EAAK80B,KAAKta,GACrBsyB,IACJA,EAAY,GACZJ,EAAUljC,IAAIxJ,EAAMwa,EAAOsyB,IAE5BA,EAAUhsC,KAAKmtC,QAEfvB,EAAUljC,IAAIxJ,EAAMwa,EAAOyzB,GAM5B,OAFIzB,EAAIzyB,OAAOyyB,EAAIzyB,MAAMS,EAAOyzB,GAEzBtnC,MAcRA,KAAKunC,aAAe,SAAU1zB,EAAO8xB,GACpC,IAAItsC,EAAO+rC,EAAQO,GACnB,IAAKtsC,EAAM,KAAM,sBAAsBssC,KACvC,YAA6BpoC,IAArBlE,EAAK80B,KAAKta,IAiBnB7T,KAAKmnC,gBAAkB,SAAUtzB,EAAO8xB,EAAUmB,GACjD,IAAIjB,EAAMZ,EAAWU,GACjBtsC,EAAO+rC,EAAQO,GACnB,IAAKtsC,EAAM,KAAM,sBAAsBssC,KAGvC,IAAKtsC,EAAK80B,KAAKta,GAAQ,CACtB,GAAIgyB,EAAIC,MAAO,OAAO9T,EACjB,KAAM,UAAUne,8BAAkC8xB,eAcxD,OAVImB,EACHlB,EAAmB/xB,EAAO8xB,IAE1BH,EAAqBrrC,KAAK,CACzB0a,GAAIhB,EACJ8xB,SAAUA,IAEXS,KAGMpU,GAsBRhyB,KAAKwnC,SAAW,SAAU3zB,EAAO8xB,GAChC,IAAItsC,EAAO+rC,EAAQO,GACnB,IAAKtsC,EAAM,KAAM,sBAAsBssC,KACvC,OAAOtsC,EAAK80B,KAAKta,IAmBlBmxB,EAAIjrC,UAAU0tC,cAAgB,SAAU9B,GACvC,IAAItsC,EAAO+rC,EAAQO,GACnB,IAAKtsC,EAAM,KAAM,sBAAsBssC,KACvC,OAAOtsC,EAAK8P,MAsBbnJ,KAAK0nC,iBAAmB,SAAU/B,GACjC,IAAKP,EAAQO,GAAW,KAAM,sBAAsBA,KACpD,IAAIxX,EAAOiX,EAAQO,GAAUxX,KAC7B,OAAO,SAAUta,GAChB,OAAOsa,EAAKta,KAqBd7T,KAAK2nC,qBAAuB,SAAUhC,GACrC,IAAKP,EAAQO,GAAW,KAAM,sBAAsBA,KACpD,IAAIxX,EAAOiX,EAAQO,GAAUxX,KAC7B,OAAO,SAAUta,GAChB,YAAwBtW,IAAhB4wB,EAAKta,KAgCf7T,KAAKgnB,KAAO,SAAUtT,GAQrB,OAPA4yB,IACAjB,EAAQtgC,QAAQ4gC,IACf,IAAIx8B,EAAOi8B,EAAQO,GAAUx8B,KAClB87B,EAAWU,GACjBlyB,OAAOC,EAAIvK,KAEjBm9B,IACOtU,GAwBRhyB,KAAKinB,OAAS,SAAUvT,GAQvB,OAPA4yB,IACAhB,EAAcvgC,QAAQ4gC,IACrB,IAAIx8B,EAAOi8B,EAAQO,GAAUx8B,KAClB87B,EAAWU,GACjBlxB,aAAaf,EAAIvK,KAEvBm9B,IACOtU,GAkBRhyB,KAAK4nC,qBAAuB,SAAU/zB,EAAO8xB,EAAUr8B,EAAOw9B,GAC7D,IAAIjB,EAAMZ,EAAWU,GACjBtsC,EAAO+rC,EAAQO,GACnB,IAAKtsC,EAAM,KAAM,sBAAsBssC,KACvC,IAAKE,EAAIC,MAAO,KAAM,qDAGtB,IAAIK,EAAY9sC,EAAK80B,KAAKta,GAC1B,IAAKsyB,IAAcA,EAAU78B,GAC5B,KAAM,kBAAkBq8B,iCAAwCr8B,IAIjE,IAAIu+B,EAAgB1B,EAAU78B,GAW9B,OAVIw9B,EACHb,EAAmBpyB,EAAO8xB,EAAUkC,GAEpCpC,EAA0BtrC,KAAK,CAC9B0a,GAAIhB,EACJ8xB,SAAUA,EACVj+B,MAAOmgC,IAIF7V,GAqGR,IAAIqU,GAAyB,EAK7B,SAASC,IACRe,IAyBD,SAA0CS,GACzC,KAAOrC,EAA0B5rC,QAAQ,CACxC,IAAIslB,EAAMsmB,EAA0BrjC,MACpC6jC,EAAmB9mB,EAAItK,GAAIsK,EAAIwmB,SAAUxmB,EAAIzX,OAC7CyX,EAAIzX,MAAQ,MA5BbqgC,GAMD,WACC,KAAOxC,EAAuB1rC,QAAQ,CAErC6rC,EADYH,EAAuBnjC,QAPpC4lC,GAcD,SAASX,IACR,KAAO7B,EAAqB3rC,QAAQ,CACnC,IAAIslB,EAAMqmB,EAAqBpjC,MAC/BwjC,EAAmBzmB,EAAItK,GAAIsK,EAAIwmB,aAnqBlC,IAAII,EAAY,EAAQ,M,6BCaxB1qC,EAAOD,QAAU,CAEbwD,OAAQ,WACJ,MAAO,CACHuK,KAAM,GACNglB,KAAM,GACN8Z,KAAM,KAKdplC,IAAK,SAAUxJ,EAAMwb,EAAI7V,GACrB3F,EAAK8P,KAAKhP,KAAK6E,GACf3F,EAAK80B,KAAKtZ,GAAM7V,EAChB3F,EAAK4uC,KAAKpzB,GAAMxb,EAAK8P,KAAKtP,OAAS,GAIvCmsC,OAAQ,SAAU3sC,EAAMwb,GAEpB,IAAIvL,EAAQjQ,EAAK4uC,KAAKpzB,GACtB,GAAIvL,IAAUjQ,EAAK8P,KAAKtP,OAAS,EAC7BR,EAAK8P,KAAK/G,UACP,CAEH,IAAI8lC,EAAY7uC,EAAK8P,KAAK/G,MAC1B/I,EAAK8P,KAAKG,GAAS4+B,EAGnB,IAAIC,EAAUD,EAAU/zB,MAAQ+zB,EAAU,GAAG/zB,KAC7C9a,EAAK4uC,KAAKE,GAAW7+B,SAGlBjQ,EAAK80B,KAAKtZ,UACVxb,EAAK4uC,KAAKpzB,M,gBClDzB,IAAI1J,EAAM,CACT,uBAAwB,IACxB,sBAAuB,IACvB,kBAAmB,IACnB,qBAAsB,IACtB,YAAa,IACb,gBAAiB,IACjB,eAAgB,GAChB,gBAAiB,GACjB,sBAAuB,IACvB,cAAe,IACf,oBAAqB,KAItB,SAASi9B,EAAeC,GACvB,IAAIxzB,EAAKyzB,EAAsBD,GAC/B,OAAOrtC,EAAoB6Z,GAE5B,SAASyzB,EAAsBD,GAC9B,IAAIrtC,EAAoBgD,EAAEmN,EAAKk9B,GAAM,CACpC,IAAI9sC,EAAI,IAAImB,MAAM,uBAAyB2rC,EAAM,KAEjD,MADA9sC,EAAEwP,KAAO,mBACHxP,EAEP,OAAO4P,EAAIk9B,GAEZD,EAAe1+B,KAAO,WACrB,OAAO5P,OAAO4P,KAAKyB,IAEpBi9B,EAAexsC,QAAU0sC,EACzBjtC,EAAOD,QAAUgtC,EACjBA,EAAevzB,GAAK,K,oCC/BpB,IAAI0zB,EAAe,EAAQ,KAsBZ,sBAEX,IAAIC,EAAY,GAEhB,MAAO,CAEHnrC,KAAM,kBAEN8M,MAAO,GAEPzC,MAAO,CACH+gC,UAAU,EACVC,YAAa,EACbC,YAAa,EACbnyB,SAAU,MAGdpD,MAAO,KAEPI,SAAU,KAGVC,OAAQ,SAAwBC,EAAIC,GAKhC,IAJA,IAAIM,EAAOX,EAAIW,KAINta,EAAI,EAAGA,EAAIga,EAAO9Z,OAAQF,IAAK,CACpC,IAAIkb,EAAKlB,EAAOha,GAAGwa,KACfy0B,EAAM30B,EAAKC,gBAAgBW,GAC/B2zB,EAAU7uC,GAAKivC,EAAI11B,SAEvBs1B,EAAU3uC,OAAS8Z,EAAO9Z,OAG1B0uC,EAAaC,GAAW,SAAUt+B,EAAGxK,GACjC,IAAImpC,EAASl1B,EAAOzJ,GAChB4+B,EAASn1B,EAAOjU,IAyChC,SAA4BmpC,EAAQC,EAAQC,EAAWC,GACnD,GAAIH,EAAOJ,SACP,OAAIK,EAAOL,SAiBnB,SAA8Bv+B,EAAGxK,GAE7B,IAAIupC,GAAQ/+B,EAAE,GAAKA,EAAE,IAAM,EACvBg/B,GAAQxpC,EAAE,GAAKA,EAAE,IAAM,EACvBkgB,EAAK1V,EAAE,GAAK++B,GAAQvpC,EAAE,GAAKwpC,GAC3BppB,EAAK5V,EAAE,GAAK++B,GAAQvpC,EAAE,GAAKwpC,GAG3BC,EAASF,EAAOC,EACpB,OAFatpB,EAAKA,EAAKE,EAAKA,GAEVqpB,EAASA,EAzBZC,CAAqBL,EAAWC,GAEhCK,EAAgBN,EAAWC,GAEnC,GAAIF,EAAOL,SACd,OAAOY,EAAgBL,EAAWD,GAEtC,OAAO,GAhDKO,CAAmBT,EAAQC,EAFfN,EAAUt+B,GACVs+B,EAAU9oC,KAkBtC,SAAyB4T,EAAKu1B,EAAQC,GAClC,IAAIS,EAAMV,EAAO10B,KACbq1B,EAAMV,EAAO30B,KAGb00B,EAAOF,YAAcG,EAAOJ,aACxBG,EAAOryB,UAAUqyB,EAAOryB,SAASgzB,GAErCV,EAAOH,YAAcE,EAAOH,aACxBI,EAAOtyB,UAAUsyB,EAAOtyB,SAAS+yB,GAIzCj2B,EAAIW,KAAKw1B,0BAA0BF,EAAKC,GA7B5BjyB,CAAgBjE,EAAKu1B,EAAQC,QA0E7C,SAASO,EAAgBK,EAAKC,GAE1B,IAAIC,GAAOF,EAAI,GAAKA,EAAI,IAAM,EAC1BzH,EAAKyH,EAAI,GAAKE,EACd1H,EAAKwH,EAAI,GAAKE,EAKdhqB,EAHKiqB,EAAM5H,EAAI0H,EAAK,GAAIA,EAAK,IAGnB1H,EACVniB,EAHK+pB,EAAM3H,EAAIyH,EAAK,GAAIA,EAAK,IAGnBzH,EAEd,OADatiB,EAAKA,EAAKE,EAAKA,GACV8pB,EAAMA,EAG5B,SAASC,EAAMzb,EAAK0b,EAAIC,GACpB,OAAQ3b,EAAM0b,EAAMA,EAAM1b,EAAM2b,EAAMA,EAAK3b,K,6BCxJnD/yB,EAAOD,QAuHP,SAA6B4uC,EAAMC,EAAMC,GAEvC,OAAO9pC,UAAUvG,QACf,KAAK,EACH,OAAOswC,EAAmBH,GAC5B,KAAK,EACH,MAAmB,mBAATC,EACD1B,EAAayB,EAAMA,EAAMC,GAAM,GAE/BG,EAAwBJ,EAAMC,GAEzC,KAAK,EACH,OAAO1B,EAAayB,EAAMC,EAAMC,GAAM,GACxC,QACE,MAAM,IAAIxtC,MAAM,sCAnItB,IAkGI2tC,EAlGA/xB,EAAO,EAAQ,IACf4nB,EAAQ,EAAQ,KAChBoK,EAAmB,EAAQ,KAE/B,SAASC,EAASzsC,EAAGqX,GACnB,IAAI,IAAIta,EAAE,EAAGA,EAAEiD,IAAKjD,EAClB,KAAKsa,EAAIta,IAAMsa,EAAIta,EAAEiD,IACnB,OAAO,EAGX,OAAO,EAIT,SAAS0sC,EAAaC,EAAO3sC,EAAGzE,EAAMqxC,GAGpC,IAFA,IAAIlxB,EAAM,EACNrS,EAAQ,EACJxN,EAAE,EAAGoF,EAAE0rC,EAAM5wC,OAAQF,EAAEoF,IAAKpF,EAAG,CACrC,IAAI+F,EAAI+qC,EAAM9wC,GACd,IAAG4wC,EAASzsC,EAAG4B,GAAf,CAGA,IAAI,IAAI7E,EAAE,EAAGA,EAAE,EAAEiD,IAAKjD,EACpBxB,EAAKmgB,KAAS9Z,EAAE7E,GAElB6vC,EAAIvjC,KAAWxN,GAEjB,OAAOwN,EAIT,SAASohC,EAAarvB,EAAKI,EAAMP,EAAO4xB,GACtC,IAAI5rC,EAAIma,EAAIrf,OACR+D,EAAI0b,EAAKzf,OAGb,KAAGkF,GAAK,GAAKnB,GAAK,GAAlB,CAKA,IAAIE,EAAKob,EAAI,GAAS,SAAI,EAC1B,KAAGpb,GAAK,GAAR,CAIA,IAAIoc,EAGA0wB,EAAWtyB,EAAKrH,aAAa,EAAEnT,EAAEiB,GACjC8rC,EAAWvyB,EAAKzH,YAAY9R,GAGhC,IAFAA,EAAIyrC,EAAatxB,EAAKpb,EAAG8sC,EAASC,IAE3B,EAAG,CACR,GAAS,IAAN/sC,GAAW6sC,EAEZzK,EAAMp6B,KAAK/G,GACXmb,EAASgmB,EAAM9lB,cACbtc,EAAGib,EACH,EAAGha,EAAG6rC,EAASC,EACf,EAAG9rC,EAAG6rC,EAASC,OACZ,CAGL,IAAIC,EAAWxyB,EAAKrH,aAAa,EAAEnT,EAAEF,GACjCmtC,EAAWzyB,EAAKzH,YAAYjT,IAChCA,EAAI4sC,EAAalxB,EAAMxb,EAAGgtC,EAAUC,IAE7B,IACL7K,EAAMp6B,KAAK/G,EAAEnB,GAIXsc,EAFO,IAANpc,EAEQoiC,EAAMpnB,eACbhb,EAAGib,EACH,EAAGha,EAAG6rC,EAAUC,EAChB,EAAGjtC,EAAGktC,EAAUC,GAGTT,EACPxsC,EAAGib,EAAU4xB,EACb5rC,EAAG6rC,EAAUC,EACbjtC,EAAGktC,EAAUC,GAGjBzyB,EAAK7G,KAAKq5B,GACVxyB,EAAK7G,KAAKs5B,IAIdzyB,EAAK7G,KAAKm5B,GACVtyB,EAAK7G,KAAKo5B,GAGZ,OAAO3wB,IAMT,SAAS8wB,EAAWrxC,EAAEkB,GACpBwvC,EAAOlwC,KAAK,CAACR,EAAEkB,IAGjB,SAASsvC,EAAmB50B,GAG1B,OAFA80B,EAAS,GACT9B,EAAahzB,EAAGA,EAAGy1B,GAAY,GACxBX,EAGT,SAASD,EAAwB70B,EAAG/T,GAGlC,OAFA6oC,EAAS,GACT9B,EAAahzB,EAAG/T,EAAGwpC,GAAY,GACxBX,I,6BC/CT,SAAS3uB,EAAmBzZ,GAC1B,IAAIpE,EAAI,GAQR,OAPAoE,IAAMA,IACCpE,IACC,MAAJoE,IAAgBpE,GAAK,IACjB,SAAJoE,IAAgBpE,GAAK,GACjB,UAAJoE,IAAgBpE,GAAK,GACjB,UAAJoE,IAAgBpE,GAAK,GACjB,WAAJoE,IAAgBpE,GAAK,GAClBA,EAhETzC,EAAQugB,SAHO,GAIfvgB,EAAQwgB,QAAa,WACrBxgB,EAAQygB,SAAa,GAAG,GAGxBzgB,EAAQ0gB,KAAO,SAAS7Z,GACtB,OAAQA,EAAI,IAAMA,EAAI,IAIxB7G,EAAQmP,IAAM,SAAStI,GACrB,IAAI8Z,EAAO9Z,GAAK,GAChB,OAAQA,EAAI8Z,GAAQA,GAItB3gB,EAAQgI,IAAM,SAASmS,EAAG/T,GACxB,OAAOA,GAAM+T,EAAI/T,KAAO+T,EAAI/T,IAI9BpG,EAAQiI,IAAM,SAASkS,EAAG/T,GACxB,OAAO+T,GAAMA,EAAI/T,KAAO+T,EAAI/T,IAI9BpG,EAAQ4gB,OAAS,SAAS/Z,GACxB,QAASA,EAAKA,EAAE,IAAUA,IAI5B7G,EAAQ2U,KAAO,SAAS9N,GACtB,IAAI7D,EAAG9D,EAKP,OAJA8D,GAAS6D,EAAI,QAAW,EACiB7D,GAAzC9D,IAD2B2H,KAAO7D,GACrB,MAAW,EACiBA,GAAzC9D,IAD2B2H,KAAO3H,GACrB,KAAW,GACiB8D,GAAzC9D,IAD2B2H,KAAO3H,GACrB,IAAW,IAAG2H,KAAO3H,IACjB,GAInBc,EAAQ6gB,MAAQ,SAASha,GACvB,OAASA,GAAK,IAAc,EAAKA,GAAK,IAAa,EAAKA,GAAK,IAAY,EAChEA,GAAK,IAAW,EAAKA,GAAK,IAAU,EAAKA,GAAK,IAAS,EACvDA,GAAK,IAAQ,EAAKA,GAAK,IAAO,EAAKA,GAAK,GAAM,EAAI,GAI7D7G,EAAQ8gB,SAAW,SAASja,GAG1B,OAAsC,WADtCA,GAAS,WADTA,GAAUA,IAAM,EAAK,cACIA,IAAM,EAAK,aACtBA,IAAM,GAAK,aAA4B,IAevD7G,EAAQsgB,mBAAqBA,EAG7BtgB,EAAQ6U,SAAW,SAAShO,GAQ1B,OAPAA,GAAW,IAANA,IACHA,EACFA,GAAKA,IAAM,EACXA,GAAKA,IAAM,EACXA,GAAKA,IAAM,EACXA,GAAKA,IAAM,GACXA,GAAKA,IAAM,IACA,GAIb7G,EAAQ+gB,SAAW,SAASla,GAM1B,OALAA,GAAKA,IAAM,EACXA,GAAKA,IAAM,EACXA,GAAKA,IAAM,EACXA,GAAKA,IAAM,GACXA,GAAKA,IAAM,KACCA,IAAI,IAIlB7G,EAAQghB,OAAS,SAASna,GAKxB,OAJAA,GAAKA,IAAM,GACXA,GAAKA,IAAM,EACXA,GAAKA,IAAM,EAEH,SADRA,GAAK,IACmB,GAG1B,IAAIoa,EAAgB,IAAIxc,MAAM,MAE9B,SAAUyc,GACR,IAAI,IAAI3iB,EAAE,EAAGA,EAAE,MAAOA,EAAG,CACvB,IAAIsI,EAAItI,EAAGyE,EAAIzE,EAAGsB,EAAI,EACtB,IAAKgH,KAAO,EAAGA,EAAGA,KAAO,EACvB7D,IAAM,EACNA,GAAS,EAAJ6D,IACHhH,EAEJqhB,EAAI3iB,GAAMyE,GAAKnD,EAAK,KARxB,CAUGohB,GAGHjhB,EAAQmhB,QAAU,SAASta,GACzB,OAASoa,EAA2B,IAAZpa,IAAqB,GACpCoa,EAAepa,IAAM,EAAM,MAAS,GACpCoa,EAAepa,IAAM,GAAM,MAAS,EACpCoa,EAAepa,IAAM,GAAM,MAItC7G,EAAQohB,YAAc,SAASjH,EAAG/T,GAahC,OARA+T,EAAqB,aADrBA,EAAqB,YADrBA,EAAqB,YADrBA,EAAqB,WADrBA,GAAK,OACKA,GAAK,IACLA,GAAK,IACLA,GAAK,IACLA,GAAK,KAMf/T,EAAqB,aADrBA,EAAqB,YADrBA,EAAqB,YADrBA,EAAqB,WADrBA,GAAK,OACKA,GAAK,IACLA,GAAK,IACLA,GAAK,IACLA,GAAK,KAEE,GAInBpG,EAAQqhB,cAAgB,SAASxa,EAAGlD,GAMlC,OADAkD,EAAuB,QADvBA,EAAuB,WADvBA,EAAuB,YADvBA,EAAuB,YADvBA,EAAKA,IAAMlD,EAAK,YACNkD,IAAM,IACNA,IAAM,IACNA,IAAM,IACNA,IAAM,MACH,IAAO,IAKtB7G,EAAQshB,YAAc,SAASnH,EAAG/T,EAAGgU,GAoBnC,OAfAD,EAAqB,aADrBA,EAAqB,aADrBA,EAAqB,YADrBA,EAAqB,aADrBA,GAAK,MACMA,GAAG,KACHA,GAAG,IACHA,GAAG,IACHA,GAAG,IAOdA,IADA/T,EAAqB,aADrBA,EAAqB,aADrBA,EAAqB,YADrBA,EAAqB,aADrBA,GAAK,MACMA,GAAG,KACHA,GAAG,IACHA,GAAG,IACHA,GAAG,KACH,IAMXgU,EAAqB,aADrBA,EAAqB,aADrBA,EAAqB,YADrBA,EAAqB,aADrBA,GAAK,MACMA,GAAG,KACHA,GAAG,IACHA,GAAG,IACHA,GAAG,KAEG,GAInBpa,EAAQuhB,cAAgB,SAAS1a,EAAGlD,GAMlC,OADAkD,EAAsB,OADtBA,EAAsB,aADtBA,EAAsB,YADtBA,EAAsB,aADtBA,EAAKA,IAAMlD,EAAW,YACZkD,IAAI,IACJA,IAAI,IACJA,IAAI,IACJA,IAAI,MACH,IAAK,IAIlB7G,EAAQwhB,gBAAkB,SAAS3a,GACjC,IAAIzD,EAAIyD,EAAKA,EAAI,EACjB,OAAQzD,EAAI,IAASA,IAAMA,GAAK,IAAQkd,EAAmBzZ,GAAK,I,6BCzJlE5G,EAAOD,QAnBP,SAAc+L,EAAO5I,GAInB,YAHoB,IAAVA,IACRA,EAAQ,UAEI4I,GACZ,IAAK,SACH,GAAGA,EAAQ,EACT,OAhBR,SAAqBA,EAAO5I,GAC1B,IAAI7D,EAAQf,EAEZ,IADAe,EAAS,IAAImF,MAAMsH,GACfxN,EAAE,EAAGA,EAAEwN,IAASxN,EAClBe,EAAOf,GAAK4E,EAEd,OAAO7D,EAUMuwC,CAAkB,EAAN9jC,EAAS5I,GAEhC,MACA,IAAK,SACH,GAA6B,iBAAlB4I,EAAY,OACrB,OAvCR,SAAS+jC,EAAW/jC,EAAO5I,EAAO5E,GAChC,IAAIkE,EAAa,EAATsJ,EAAMxN,GACd,GAAGkE,GAAK,EACN,MAAO,GAET,IAA2BhD,EAAvBH,EAAS,IAAImF,MAAMhC,GACvB,GAAGlE,IAAMwN,EAAMtN,OAAO,EACpB,IAAIgB,EAAE,EAAGA,EAAEgD,IAAKhD,EACdH,EAAOG,GAAK0D,OAGd,IAAI1D,EAAE,EAAGA,EAAEgD,IAAKhD,EACdH,EAAOG,GAAKqwC,EAAW/jC,EAAO5I,EAAO5E,EAAE,GAG3C,OAAOe,EAwBMwwC,CAAW/jC,EAAO5I,EAAO,GAItC,MAAO,K,8BC7CT;;;;;;;AAUA,IAAI4sC,EAAS,EAAQ,KACjBC,EAAU,EAAQ,KAClBl/B,EAAU,EAAQ,KAmDtB,SAASm/B,IACP,OAAOj9B,EAAOk9B,oBACV,WACA,WAGN,SAASC,EAAcjlC,EAAMzM,GAC3B,GAAIwxC,IAAexxC,EACjB,MAAM,IAAIwO,WAAW,8BAcvB,OAZI+F,EAAOk9B,qBAEThlC,EAAO,IAAI8J,WAAWvW,IACjB+F,UAAYwO,EAAOrU,WAGX,OAATuM,IACFA,EAAO,IAAI8H,EAAOvU,IAEpByM,EAAKzM,OAASA,GAGTyM,EAaT,SAAS8H,EAAQhG,EAAKojC,EAAkB3xC,GACtC,KAAKuU,EAAOk9B,qBAAyBtrC,gBAAgBoO,GACnD,OAAO,IAAIA,EAAOhG,EAAKojC,EAAkB3xC,GAI3C,GAAmB,iBAARuO,EAAkB,CAC3B,GAAgC,iBAArBojC,EACT,MAAM,IAAI9uC,MACR,qEAGJ,OAAO+uC,EAAYzrC,KAAMoI,GAE3B,OAAOsjC,EAAK1rC,KAAMoI,EAAKojC,EAAkB3xC,GAW3C,SAAS6xC,EAAMplC,EAAM/H,EAAOitC,EAAkB3xC,GAC5C,GAAqB,iBAAV0E,EACT,MAAM,IAAI4D,UAAU,yCAGtB,MAA2B,oBAAhB+N,aAA+B3R,aAAiB2R,YA6H7D,SAA0B5J,EAAMyF,EAAO4/B,EAAY9xC,GAGjD,GAFAkS,EAAM8D,WAEF87B,EAAa,GAAK5/B,EAAM8D,WAAa87B,EACvC,MAAM,IAAItjC,WAAW,6BAGvB,GAAI0D,EAAM8D,WAAa87B,GAAc9xC,GAAU,GAC7C,MAAM,IAAIwO,WAAW,6BAIrB0D,OADiBxO,IAAfouC,QAAuCpuC,IAAX1D,EACtB,IAAIuW,WAAWrE,QACHxO,IAAX1D,EACD,IAAIuW,WAAWrE,EAAO4/B,GAEtB,IAAIv7B,WAAWrE,EAAO4/B,EAAY9xC,GAGxCuU,EAAOk9B,qBAEThlC,EAAOyF,GACFnM,UAAYwO,EAAOrU,UAGxBuM,EAAOslC,EAActlC,EAAMyF,GAE7B,OAAOzF,EAvJEulC,CAAgBvlC,EAAM/H,EAAOitC,EAAkB3xC,GAGnC,iBAAV0E,EAwFb,SAAqB+H,EAAMwlC,EAAQC,GACT,iBAAbA,GAAsC,KAAbA,IAClCA,EAAW,QAGb,IAAK39B,EAAO49B,WAAWD,GACrB,MAAM,IAAI5pC,UAAU,8CAGtB,IAAItI,EAAwC,EAA/BgW,EAAWi8B,EAAQC,GAG5BE,GAFJ3lC,EAAOilC,EAAajlC,EAAMzM,IAERqyC,MAAMJ,EAAQC,GAE5BE,IAAWpyC,IAIbyM,EAAOA,EAAK9G,MAAM,EAAGysC,IAGvB,OAAO3lC,EA5GE6lC,CAAW7lC,EAAM/H,EAAOitC,GAsJnC,SAAqBllC,EAAM6Y,GACzB,GAAI/Q,EAAOtE,SAASqV,GAAM,CACxB,IAAIpb,EAA4B,EAAtBqoC,EAAQjtB,EAAItlB,QAGtB,OAAoB,KAFpByM,EAAOilC,EAAajlC,EAAMvC,IAEjBlK,QAITslB,EAAI1c,KAAK6D,EAAM,EAAG,EAAGvC,GAHZuC,EAOX,GAAI6Y,EAAK,CACP,GAA4B,oBAAhBjP,aACRiP,EAAIvP,kBAAkBM,aAAgB,WAAYiP,EACpD,MAA0B,iBAAfA,EAAItlB,SA+8CLu0B,EA/8CkCjP,EAAItlB,SAg9CrCu0B,EA/8CFmd,EAAajlC,EAAM,GAErBslC,EAActlC,EAAM6Y,GAG7B,GAAiB,WAAbA,EAAIliB,MAAqBiP,EAAQiT,EAAI9lB,MACvC,OAAOuyC,EAActlC,EAAM6Y,EAAI9lB,MAw8CrC,IAAgB+0B,EAp8Cd,MAAM,IAAIjsB,UAAU,sFA9KbkqC,CAAW/lC,EAAM/H,GA4B1B,SAAS+tC,EAAYC,GACnB,GAAoB,iBAATA,EACT,MAAM,IAAIpqC,UAAU,oCACf,GAAIoqC,EAAO,EAChB,MAAM,IAAIlkC,WAAW,wCA4BzB,SAASojC,EAAanlC,EAAMimC,GAG1B,GAFAD,EAAWC,GACXjmC,EAAOilC,EAAajlC,EAAMimC,EAAO,EAAI,EAAoB,EAAhBH,EAAQG,KAC5Cn+B,EAAOk9B,oBACV,IAAK,IAAI3xC,EAAI,EAAGA,EAAI4yC,IAAQ5yC,EAC1B2M,EAAK3M,GAAK,EAGd,OAAO2M,EAwCT,SAASslC,EAAetlC,EAAMyF,GAC5B,IAAIlS,EAASkS,EAAMlS,OAAS,EAAI,EAA4B,EAAxBuyC,EAAQrgC,EAAMlS,QAClDyM,EAAOilC,EAAajlC,EAAMzM,GAC1B,IAAK,IAAIF,EAAI,EAAGA,EAAIE,EAAQF,GAAK,EAC/B2M,EAAK3M,GAAgB,IAAXoS,EAAMpS,GAElB,OAAO2M,EA+DT,SAAS8lC,EAASvyC,GAGhB,GAAIA,GAAUwxC,IACZ,MAAM,IAAIhjC,WAAW,0DACagjC,IAAap/B,SAAS,IAAM,UAEhE,OAAgB,EAATpS,EAsFT,SAASgW,EAAYi8B,EAAQC,GAC3B,GAAI39B,EAAOtE,SAASgiC,GAClB,OAAOA,EAAOjyC,OAEhB,GAA2B,oBAAhBqW,aAA6D,mBAAvBA,YAAYs8B,SACxDt8B,YAAYs8B,OAAOV,IAAWA,aAAkB57B,aACnD,OAAO47B,EAAOj8B,WAEM,iBAAXi8B,IACTA,EAAS,GAAKA,GAGhB,IAAI/nC,EAAM+nC,EAAOjyC,OACjB,GAAY,IAARkK,EAAW,OAAO,EAItB,IADA,IAAI0oC,GAAc,IAEhB,OAAQV,GACN,IAAK,QACL,IAAK,SACL,IAAK,SACH,OAAOhoC,EACT,IAAK,OACL,IAAK,QACL,UAAKxG,EACH,OAAOmvC,EAAYZ,GAAQjyC,OAC7B,IAAK,OACL,IAAK,QACL,IAAK,UACL,IAAK,WACH,OAAa,EAANkK,EACT,IAAK,MACH,OAAOA,IAAQ,EACjB,IAAK,SACH,OAAO4oC,EAAcb,GAAQjyC,OAC/B,QACE,GAAI4yC,EAAa,OAAOC,EAAYZ,GAAQjyC,OAC5CkyC,GAAY,GAAKA,GAAUa,cAC3BH,GAAc,GAMtB,SAASI,EAAcd,EAAUe,EAAOC,GACtC,IAAIN,GAAc,EAclB,SALclvC,IAAVuvC,GAAuBA,EAAQ,KACjCA,EAAQ,GAINA,EAAQ9sC,KAAKnG,OACf,MAAO,GAOT,SAJY0D,IAARwvC,GAAqBA,EAAM/sC,KAAKnG,UAClCkzC,EAAM/sC,KAAKnG,QAGTkzC,GAAO,EACT,MAAO,GAOT,IAHAA,KAAS,KACTD,KAAW,GAGT,MAAO,GAKT,IAFKf,IAAUA,EAAW,UAGxB,OAAQA,GACN,IAAK,MACH,OAAOiB,EAAShtC,KAAM8sC,EAAOC,GAE/B,IAAK,OACL,IAAK,QACH,OAAOE,EAAUjtC,KAAM8sC,EAAOC,GAEhC,IAAK,QACH,OAAOG,EAAWltC,KAAM8sC,EAAOC,GAEjC,IAAK,SACL,IAAK,SACH,OAAOI,EAAYntC,KAAM8sC,EAAOC,GAElC,IAAK,SACH,OAAOK,EAAYptC,KAAM8sC,EAAOC,GAElC,IAAK,OACL,IAAK,QACL,IAAK,UACL,IAAK,WACH,OAAOM,EAAartC,KAAM8sC,EAAOC,GAEnC,QACE,GAAIN,EAAa,MAAM,IAAItqC,UAAU,qBAAuB4pC,GAC5DA,GAAYA,EAAW,IAAIa,cAC3BH,GAAc,GAStB,SAASa,EAAM5tC,EAAGX,EAAGnB,GACnB,IAAIjE,EAAI+F,EAAEX,GACVW,EAAEX,GAAKW,EAAE9B,GACT8B,EAAE9B,GAAKjE,EAmIT,SAAS4zC,EAAsB39B,EAAQwe,EAAKud,EAAYI,EAAUx1B,GAEhE,GAAsB,IAAlB3G,EAAO/V,OAAc,OAAQ,EAmBjC,GAhB0B,iBAAf8xC,GACTI,EAAWJ,EACXA,EAAa,GACJA,EAAa,WACtBA,EAAa,WACJA,GAAc,aACvBA,GAAc,YAEhBA,GAAcA,EACV/lC,MAAM+lC,KAERA,EAAap1B,EAAM,EAAK3G,EAAO/V,OAAS,GAItC8xC,EAAa,IAAGA,EAAa/7B,EAAO/V,OAAS8xC,GAC7CA,GAAc/7B,EAAO/V,OAAQ,CAC/B,GAAI0c,EAAK,OAAQ,EACZo1B,EAAa/7B,EAAO/V,OAAS,OAC7B,GAAI8xC,EAAa,EAAG,CACzB,IAAIp1B,EACC,OAAQ,EADJo1B,EAAa,EAUxB,GALmB,iBAARvd,IACTA,EAAMhgB,EAAOs9B,KAAKtd,EAAK2d,IAIrB39B,EAAOtE,SAASskB,GAElB,OAAmB,IAAfA,EAAIv0B,QACE,EAEH2zC,EAAa59B,EAAQwe,EAAKud,EAAYI,EAAUx1B,GAClD,GAAmB,iBAAR6X,EAEhB,OADAA,GAAY,IACRhgB,EAAOk9B,qBACiC,mBAAjCl7B,WAAWrW,UAAUkjB,QAC1B1G,EACKnG,WAAWrW,UAAUkjB,QAAQhjB,KAAK2V,EAAQwe,EAAKud,GAE/Cv7B,WAAWrW,UAAU0zC,YAAYxzC,KAAK2V,EAAQwe,EAAKud,GAGvD6B,EAAa59B,EAAQ,CAAEwe,GAAOud,EAAYI,EAAUx1B,GAG7D,MAAM,IAAIpU,UAAU,wCAGtB,SAASqrC,EAAczlC,EAAKqmB,EAAKud,EAAYI,EAAUx1B,GACrD,IA0BI5c,EA1BA+zC,EAAY,EACZC,EAAY5lC,EAAIlO,OAChB+zC,EAAYxf,EAAIv0B,OAEpB,QAAiB0D,IAAbwuC,IAEe,UADjBA,EAAW9kC,OAAO8kC,GAAUa,gBACY,UAAbb,GACV,YAAbA,GAAuC,aAAbA,GAAyB,CACrD,GAAIhkC,EAAIlO,OAAS,GAAKu0B,EAAIv0B,OAAS,EACjC,OAAQ,EAEV6zC,EAAY,EACZC,GAAa,EACbC,GAAa,EACbjC,GAAc,EAIlB,SAASkC,EAAMC,EAAKn0C,GAClB,OAAkB,IAAd+zC,EACKI,EAAIn0C,GAEJm0C,EAAIC,aAAap0C,EAAI+zC,GAKhC,GAAIn3B,EAAK,CACP,IAAIy3B,GAAc,EAClB,IAAKr0C,EAAIgyC,EAAYhyC,EAAIg0C,EAAWh0C,IAClC,GAAIk0C,EAAK9lC,EAAKpO,KAAOk0C,EAAKzf,GAAqB,IAAhB4f,EAAoB,EAAIr0C,EAAIq0C,IAEzD,IADoB,IAAhBA,IAAmBA,EAAar0C,GAChCA,EAAIq0C,EAAa,IAAMJ,EAAW,OAAOI,EAAaN,OAEtC,IAAhBM,IAAmBr0C,GAAKA,EAAIq0C,GAChCA,GAAc,OAKlB,IADIrC,EAAaiC,EAAYD,IAAWhC,EAAagC,EAAYC,GAC5Dj0C,EAAIgyC,EAAYhyC,GAAK,EAAGA,IAAK,CAEhC,IADA,IAAIs0C,GAAQ,EACHpzC,EAAI,EAAGA,EAAI+yC,EAAW/yC,IAC7B,GAAIgzC,EAAK9lC,EAAKpO,EAAIkB,KAAOgzC,EAAKzf,EAAKvzB,GAAI,CACrCozC,GAAQ,EACR,MAGJ,GAAIA,EAAO,OAAOt0C,EAItB,OAAQ,EAeV,SAASu0C,EAAUJ,EAAKhC,EAAQjgC,EAAQhS,GACtCgS,EAASlG,OAAOkG,IAAW,EAC3B,IAAIsiC,EAAYL,EAAIj0C,OAASgS,EACxBhS,GAGHA,EAAS8L,OAAO9L,IACHs0C,IACXt0C,EAASs0C,GAJXt0C,EAASs0C,EASX,IAAIC,EAAStC,EAAOjyC,OACpB,GAAIu0C,EAAS,GAAM,EAAG,MAAM,IAAIjsC,UAAU,sBAEtCtI,EAASu0C,EAAS,IACpBv0C,EAASu0C,EAAS,GAEpB,IAAK,IAAIz0C,EAAI,EAAGA,EAAIE,IAAUF,EAAG,CAC/B,IAAI00C,EAASltB,SAAS2qB,EAAOtc,OAAW,EAAJ71B,EAAO,GAAI,IAC/C,GAAIiM,MAAMyoC,GAAS,OAAO10C,EAC1Bm0C,EAAIjiC,EAASlS,GAAK00C,EAEpB,OAAO10C,EAGT,SAAS20C,EAAWR,EAAKhC,EAAQjgC,EAAQhS,GACvC,OAAO00C,EAAW7B,EAAYZ,EAAQgC,EAAIj0C,OAASgS,GAASiiC,EAAKjiC,EAAQhS,GAG3E,SAAS20C,EAAYV,EAAKhC,EAAQjgC,EAAQhS,GACxC,OAAO00C,EAq6BT,SAAuBxiB,GAErB,IADA,IAAI0iB,EAAY,GACP90C,EAAI,EAAGA,EAAIoyB,EAAIlyB,SAAUF,EAEhC80C,EAAUt0C,KAAyB,IAApB4xB,EAAI2iB,WAAW/0C,IAEhC,OAAO80C,EA36BWE,CAAa7C,GAASgC,EAAKjiC,EAAQhS,GAGvD,SAAS+0C,EAAad,EAAKhC,EAAQjgC,EAAQhS,GACzC,OAAO20C,EAAWV,EAAKhC,EAAQjgC,EAAQhS,GAGzC,SAASg1C,EAAaf,EAAKhC,EAAQjgC,EAAQhS,GACzC,OAAO00C,EAAW5B,EAAcb,GAASgC,EAAKjiC,EAAQhS,GAGxD,SAASi1C,EAAWhB,EAAKhC,EAAQjgC,EAAQhS,GACvC,OAAO00C,EAk6BT,SAAyBxiB,EAAKgjB,GAG5B,IAFA,IAAIlxC,EAAGksC,EAAID,EACP2E,EAAY,GACP90C,EAAI,EAAGA,EAAIoyB,EAAIlyB,WACjBk1C,GAAS,GAAK,KADap1C,EAGhCkE,EAAIkuB,EAAI2iB,WAAW/0C,GACnBowC,EAAKlsC,GAAK,EACVisC,EAAKjsC,EAAI,IACT4wC,EAAUt0C,KAAK2vC,GACf2E,EAAUt0C,KAAK4vC,GAGjB,OAAO0E,EA/6BWO,CAAelD,EAAQgC,EAAIj0C,OAASgS,GAASiiC,EAAKjiC,EAAQhS,GAkF9E,SAASuzC,EAAaU,EAAKhB,EAAOC,GAChC,OAAc,IAAVD,GAAeC,IAAQe,EAAIj0C,OACtBsxC,EAAO8D,cAAcnB,GAErB3C,EAAO8D,cAAcnB,EAAItuC,MAAMstC,EAAOC,IAIjD,SAASE,EAAWa,EAAKhB,EAAOC,GAC9BA,EAAMziC,KAAKlH,IAAI0qC,EAAIj0C,OAAQkzC,GAI3B,IAHA,IAAI7N,EAAM,GAENvlC,EAAImzC,EACDnzC,EAAIozC,GAAK,CACd,IAQMmC,EAAYC,EAAWC,EAAYC,EARrCC,EAAYxB,EAAIn0C,GAChB41C,EAAY,KACZC,EAAoBF,EAAY,IAAQ,EACvCA,EAAY,IAAQ,EACpBA,EAAY,IAAQ,EACrB,EAEJ,GAAI31C,EAAI61C,GAAoBzC,EAG1B,OAAQyC,GACN,KAAK,EACCF,EAAY,MACdC,EAAYD,GAEd,MACF,KAAK,EAEyB,MAAV,KADlBJ,EAAapB,EAAIn0C,EAAI,OAEnB01C,GAA6B,GAAZC,IAAqB,EAAoB,GAAbJ,GACzB,MAClBK,EAAYF,GAGhB,MACF,KAAK,EACHH,EAAapB,EAAIn0C,EAAI,GACrBw1C,EAAYrB,EAAIn0C,EAAI,GACQ,MAAV,IAAbu1C,IAAsD,MAAV,IAAZC,KACnCE,GAA6B,GAAZC,IAAoB,IAAoB,GAAbJ,IAAsB,EAAmB,GAAZC,GACrD,OAAUE,EAAgB,OAAUA,EAAgB,SACtEE,EAAYF,GAGhB,MACF,KAAK,EACHH,EAAapB,EAAIn0C,EAAI,GACrBw1C,EAAYrB,EAAIn0C,EAAI,GACpBy1C,EAAatB,EAAIn0C,EAAI,GACO,MAAV,IAAbu1C,IAAsD,MAAV,IAAZC,IAAsD,MAAV,IAAbC,KAClEC,GAA6B,GAAZC,IAAoB,IAAqB,GAAbJ,IAAsB,IAAmB,GAAZC,IAAqB,EAAoB,GAAbC,GAClF,OAAUC,EAAgB,UAC5CE,EAAYF,GAMJ,OAAdE,GAGFA,EAAY,MACZC,EAAmB,GACVD,EAAY,QAErBA,GAAa,MACbrQ,EAAI/kC,KAAKo1C,IAAc,GAAK,KAAQ,OACpCA,EAAY,MAAqB,KAAZA,GAGvBrQ,EAAI/kC,KAAKo1C,GACT51C,GAAK61C,EAGP,OAQF,SAAgCC,GAC9B,IAAI1rC,EAAM0rC,EAAW51C,OACrB,GAAIkK,GAJqB,KAKvB,OAAOkD,OAAOm0B,aAAa5gC,MAAMyM,OAAQwoC,GAI3C,IAAIvQ,EAAM,GACNvlC,EAAI,EACR,KAAOA,EAAIoK,GACTm7B,GAAOj4B,OAAOm0B,aAAa5gC,MACzByM,OACAwoC,EAAWjwC,MAAM7F,EAAGA,GAdC,OAiBzB,OAAOulC,EAvBAwQ,CAAsBxQ,GA98B/B9jC,EAAQgT,OAASA,EACjBhT,EAAQu0C,WAoTR,SAAqB91C,IACdA,GAAUA,IACbA,EAAS,GAEX,OAAOuU,EAAOwhC,OAAO/1C,IAvTvBuB,EAAQy0C,kBAAoB,GA0B5BzhC,EAAOk9B,yBAAqD/tC,IAA/B8Q,EAAOi9B,oBAChCj9B,EAAOi9B,oBAQX,WACE,IACE,IAAIvjC,EAAM,IAAIqI,WAAW,GAEzB,OADArI,EAAInI,UAAY,CAACA,UAAWwQ,WAAWrW,UAAW+1C,IAAK,WAAc,OAAO,KACvD,KAAd/nC,EAAI+nC,OACiB,mBAAjB/nC,EAAIgoC,UACuB,IAAlChoC,EAAIgoC,SAAS,EAAG,GAAGlgC,WACvB,MAAOtU,GACP,OAAO,GAfPy0C,GAKJ50C,EAAQiwC,WAAaA,IAkErBj9B,EAAO6hC,SAAW,KAGlB7hC,EAAO8hC,SAAW,SAAUnoC,GAE1B,OADAA,EAAInI,UAAYwO,EAAOrU,UAChBgO,GA2BTqG,EAAOs9B,KAAO,SAAUntC,EAAOitC,EAAkB3xC,GAC/C,OAAO6xC,EAAK,KAAMntC,EAAOitC,EAAkB3xC,IAGzCuU,EAAOk9B,sBACTl9B,EAAOrU,UAAU6F,UAAYwQ,WAAWrW,UACxCqU,EAAOxO,UAAYwQ,WACG,oBAAX/R,QAA0BA,OAAO8xC,SACxC/hC,EAAO/P,OAAO8xC,WAAa/hC,GAE7BtU,OAAOmE,eAAemQ,EAAQ/P,OAAO8xC,QAAS,CAC5C5xC,MAAO,KACPizB,cAAc,KAiCpBpjB,EAAOwhC,MAAQ,SAAUrD,EAAM3Y,EAAMmY,GACnC,OArBF,SAAgBzlC,EAAMimC,EAAM3Y,EAAMmY,GAEhC,OADAO,EAAWC,GACPA,GAAQ,EACHhB,EAAajlC,EAAMimC,QAEfhvC,IAATq2B,EAIyB,iBAAbmY,EACVR,EAAajlC,EAAMimC,GAAM3Y,KAAKA,EAAMmY,GACpCR,EAAajlC,EAAMimC,GAAM3Y,KAAKA,GAE7B2X,EAAajlC,EAAMimC,GAQnBqD,CAAM,KAAMrD,EAAM3Y,EAAMmY,IAiBjC39B,EAAOq9B,YAAc,SAAUc,GAC7B,OAAOd,EAAY,KAAMc,IAK3Bn+B,EAAOgiC,gBAAkB,SAAU7D,GACjC,OAAOd,EAAY,KAAMc,IAiH3Bn+B,EAAOtE,SAAW,SAAmBpK,GACnC,QAAe,MAALA,IAAaA,EAAE4f,YAG3BlR,EAAOitB,QAAU,SAAkBnxB,EAAGxK,GACpC,IAAK0O,EAAOtE,SAASI,KAAOkE,EAAOtE,SAASpK,GAC1C,MAAM,IAAIyC,UAAU,6BAGtB,GAAI+H,IAAMxK,EAAG,OAAO,EAKpB,IAHA,IAAI6V,EAAIrL,EAAErQ,OACN2H,EAAI9B,EAAE7F,OAEDF,EAAI,EAAGoK,EAAMuG,KAAKlH,IAAImS,EAAG/T,GAAI7H,EAAIoK,IAAOpK,EAC/C,GAAIuQ,EAAEvQ,KAAO+F,EAAE/F,GAAI,CACjB4b,EAAIrL,EAAEvQ,GACN6H,EAAI9B,EAAE/F,GACN,MAIJ,OAAI4b,EAAI/T,GAAW,EACfA,EAAI+T,EAAU,EACX,GAGTnH,EAAO49B,WAAa,SAAqBD,GACvC,OAAQ9kC,OAAO8kC,GAAUa,eACvB,IAAK,MACL,IAAK,OACL,IAAK,QACL,IAAK,QACL,IAAK,SACL,IAAK,SACL,IAAK,SACL,IAAK,OACL,IAAK,QACL,IAAK,UACL,IAAK,WACH,OAAO,EACT,QACE,OAAO,IAIbx+B,EAAO3I,OAAS,SAAiB0D,EAAMtP,GACrC,IAAKqS,EAAQ/C,GACX,MAAM,IAAIhH,UAAU,+CAGtB,GAAoB,IAAhBgH,EAAKtP,OACP,OAAOuU,EAAOwhC,MAAM,GAGtB,IAAIj2C,EACJ,QAAe4D,IAAX1D,EAEF,IADAA,EAAS,EACJF,EAAI,EAAGA,EAAIwP,EAAKtP,SAAUF,EAC7BE,GAAUsP,EAAKxP,GAAGE,OAItB,IAAI+V,EAASxB,EAAOq9B,YAAY5xC,GAC5B0S,EAAM,EACV,IAAK5S,EAAI,EAAGA,EAAIwP,EAAKtP,SAAUF,EAAG,CAChC,IAAIm0C,EAAM3kC,EAAKxP,GACf,IAAKyU,EAAOtE,SAASgkC,GACnB,MAAM,IAAI3rC,UAAU,+CAEtB2rC,EAAIrrC,KAAKmN,EAAQrD,GACjBA,GAAOuhC,EAAIj0C,OAEb,OAAO+V,GA8CTxB,EAAOyB,WAAaA,EA0EpBzB,EAAOrU,UAAUulB,WAAY,EAQ7BlR,EAAOrU,UAAUs2C,OAAS,WACxB,IAAItsC,EAAM/D,KAAKnG,OACf,GAAIkK,EAAM,GAAM,EACd,MAAM,IAAIsE,WAAW,6CAEvB,IAAK,IAAI1O,EAAI,EAAGA,EAAIoK,EAAKpK,GAAK,EAC5B2zC,EAAKttC,KAAMrG,EAAGA,EAAI,GAEpB,OAAOqG,MAGToO,EAAOrU,UAAUu2C,OAAS,WACxB,IAAIvsC,EAAM/D,KAAKnG,OACf,GAAIkK,EAAM,GAAM,EACd,MAAM,IAAIsE,WAAW,6CAEvB,IAAK,IAAI1O,EAAI,EAAGA,EAAIoK,EAAKpK,GAAK,EAC5B2zC,EAAKttC,KAAMrG,EAAGA,EAAI,GAClB2zC,EAAKttC,KAAMrG,EAAI,EAAGA,EAAI,GAExB,OAAOqG,MAGToO,EAAOrU,UAAUw2C,OAAS,WACxB,IAAIxsC,EAAM/D,KAAKnG,OACf,GAAIkK,EAAM,GAAM,EACd,MAAM,IAAIsE,WAAW,6CAEvB,IAAK,IAAI1O,EAAI,EAAGA,EAAIoK,EAAKpK,GAAK,EAC5B2zC,EAAKttC,KAAMrG,EAAGA,EAAI,GAClB2zC,EAAKttC,KAAMrG,EAAI,EAAGA,EAAI,GACtB2zC,EAAKttC,KAAMrG,EAAI,EAAGA,EAAI,GACtB2zC,EAAKttC,KAAMrG,EAAI,EAAGA,EAAI,GAExB,OAAOqG,MAGToO,EAAOrU,UAAUkS,SAAW,WAC1B,IAAIpS,EAAuB,EAAdmG,KAAKnG,OAClB,OAAe,IAAXA,EAAqB,GACA,IAArBuG,UAAUvG,OAAqBozC,EAAUjtC,KAAM,EAAGnG,GAC/CgzC,EAAaryC,MAAMwF,KAAMI,YAGlCgO,EAAOrU,UAAU4I,OAAS,SAAiBjD,GACzC,IAAK0O,EAAOtE,SAASpK,GAAI,MAAM,IAAIyC,UAAU,6BAC7C,OAAInC,OAASN,GACsB,IAA5B0O,EAAOitB,QAAQr7B,KAAMN,IAG9B0O,EAAOrU,UAAU+xB,QAAU,WACzB,IAAIC,EAAM,GACN1oB,EAAMjI,EAAQy0C,kBAKlB,OAJI7vC,KAAKnG,OAAS,IAChBkyB,EAAM/rB,KAAKiM,SAAS,MAAO,EAAG5I,GAAK2rB,MAAM,SAASnkB,KAAK,KACnD7K,KAAKnG,OAASwJ,IAAK0oB,GAAO,UAEzB,WAAaA,EAAM,KAG5B3d,EAAOrU,UAAUshC,QAAU,SAAkBl+B,EAAQ2vC,EAAOC,EAAKyD,EAAWC,GAC1E,IAAKriC,EAAOtE,SAAS3M,GACnB,MAAM,IAAIgF,UAAU,6BAgBtB,QAbc5E,IAAVuvC,IACFA,EAAQ,QAEEvvC,IAARwvC,IACFA,EAAM5vC,EAASA,EAAOtD,OAAS,QAEf0D,IAAdizC,IACFA,EAAY,QAEEjzC,IAAZkzC,IACFA,EAAUzwC,KAAKnG,QAGbizC,EAAQ,GAAKC,EAAM5vC,EAAOtD,QAAU22C,EAAY,GAAKC,EAAUzwC,KAAKnG,OACtE,MAAM,IAAIwO,WAAW,sBAGvB,GAAImoC,GAAaC,GAAW3D,GAASC,EACnC,OAAO,EAET,GAAIyD,GAAaC,EACf,OAAQ,EAEV,GAAI3D,GAASC,EACX,OAAO,EAQT,GAAI/sC,OAAS7C,EAAQ,OAAO,EAS5B,IAPA,IAAIoY,GAJJk7B,KAAa,IADbD,KAAe,GAMXhvC,GAPJurC,KAAS,IADTD,KAAW,GASP/oC,EAAMuG,KAAKlH,IAAImS,EAAG/T,GAElBkvC,EAAW1wC,KAAKR,MAAMgxC,EAAWC,GACjCE,EAAaxzC,EAAOqC,MAAMstC,EAAOC,GAE5BpzC,EAAI,EAAGA,EAAIoK,IAAOpK,EACzB,GAAI+2C,EAAS/2C,KAAOg3C,EAAWh3C,GAAI,CACjC4b,EAAIm7B,EAAS/2C,GACb6H,EAAImvC,EAAWh3C,GACf,MAIJ,OAAI4b,EAAI/T,GAAW,EACfA,EAAI+T,EAAU,EACX,GA6HTnH,EAAOrU,UAAU62C,SAAW,SAAmBxiB,EAAKud,EAAYI,GAC9D,OAAoD,IAA7C/rC,KAAKid,QAAQmR,EAAKud,EAAYI,IAGvC39B,EAAOrU,UAAUkjB,QAAU,SAAkBmR,EAAKud,EAAYI,GAC5D,OAAOwB,EAAqBvtC,KAAMouB,EAAKud,EAAYI,GAAU,IAG/D39B,EAAOrU,UAAU0zC,YAAc,SAAsBrf,EAAKud,EAAYI,GACpE,OAAOwB,EAAqBvtC,KAAMouB,EAAKud,EAAYI,GAAU,IAkD/D39B,EAAOrU,UAAUmyC,MAAQ,SAAgBJ,EAAQjgC,EAAQhS,EAAQkyC,GAE/D,QAAexuC,IAAXsO,EACFkgC,EAAW,OACXlyC,EAASmG,KAAKnG,OACdgS,EAAS,OAEJ,QAAetO,IAAX1D,GAA0C,iBAAXgS,EACxCkgC,EAAWlgC,EACXhS,EAASmG,KAAKnG,OACdgS,EAAS,MAEJ,KAAIglC,SAAShlC,GAWlB,MAAM,IAAInP,MACR,2EAXFmP,GAAkB,EACdglC,SAASh3C,IACXA,GAAkB,OACD0D,IAAbwuC,IAAwBA,EAAW,UAEvCA,EAAWlyC,EACXA,OAAS0D,GASb,IAAI4wC,EAAYnuC,KAAKnG,OAASgS,EAG9B,SAFetO,IAAX1D,GAAwBA,EAASs0C,KAAWt0C,EAASs0C,GAEpDrC,EAAOjyC,OAAS,IAAMA,EAAS,GAAKgS,EAAS,IAAOA,EAAS7L,KAAKnG,OACrE,MAAM,IAAIwO,WAAW,0CAGlB0jC,IAAUA,EAAW,QAG1B,IADA,IAAIU,GAAc,IAEhB,OAAQV,GACN,IAAK,MACH,OAAOmC,EAASluC,KAAM8rC,EAAQjgC,EAAQhS,GAExC,IAAK,OACL,IAAK,QACH,OAAOy0C,EAAUtuC,KAAM8rC,EAAQjgC,EAAQhS,GAEzC,IAAK,QACH,OAAO20C,EAAWxuC,KAAM8rC,EAAQjgC,EAAQhS,GAE1C,IAAK,SACL,IAAK,SACH,OAAO+0C,EAAY5uC,KAAM8rC,EAAQjgC,EAAQhS,GAE3C,IAAK,SAEH,OAAOg1C,EAAY7uC,KAAM8rC,EAAQjgC,EAAQhS,GAE3C,IAAK,OACL,IAAK,QACL,IAAK,UACL,IAAK,WACH,OAAOi1C,EAAU9uC,KAAM8rC,EAAQjgC,EAAQhS,GAEzC,QACE,GAAI4yC,EAAa,MAAM,IAAItqC,UAAU,qBAAuB4pC,GAC5DA,GAAY,GAAKA,GAAUa,cAC3BH,GAAc,IAKtBr+B,EAAOrU,UAAU+2C,OAAS,WACxB,MAAO,CACL7zC,KAAM,SACN5D,KAAMwG,MAAM9F,UAAUyF,MAAMvF,KAAK+F,KAAK+wC,MAAQ/wC,KAAM,KA4GxD,SAASktC,EAAYY,EAAKhB,EAAOC,GAC/B,IAAI/kC,EAAM,GACV+kC,EAAMziC,KAAKlH,IAAI0qC,EAAIj0C,OAAQkzC,GAE3B,IAAK,IAAIpzC,EAAImzC,EAAOnzC,EAAIozC,IAAOpzC,EAC7BqO,GAAOf,OAAOm0B,aAAsB,IAAT0S,EAAIn0C,IAEjC,OAAOqO,EAGT,SAASmlC,EAAaW,EAAKhB,EAAOC,GAChC,IAAI/kC,EAAM,GACV+kC,EAAMziC,KAAKlH,IAAI0qC,EAAIj0C,OAAQkzC,GAE3B,IAAK,IAAIpzC,EAAImzC,EAAOnzC,EAAIozC,IAAOpzC,EAC7BqO,GAAOf,OAAOm0B,aAAa0S,EAAIn0C,IAEjC,OAAOqO,EAGT,SAASglC,EAAUc,EAAKhB,EAAOC,GAC7B,IAAIhpC,EAAM+pC,EAAIj0C,SAETizC,GAASA,EAAQ,KAAGA,EAAQ,KAC5BC,GAAOA,EAAM,GAAKA,EAAMhpC,KAAKgpC,EAAMhpC,GAGxC,IADA,IAAIuR,EAAM,GACD3b,EAAImzC,EAAOnzC,EAAIozC,IAAOpzC,EAC7B2b,GAAO07B,EAAMlD,EAAIn0C,IAEnB,OAAO2b,EAGT,SAAS+3B,EAAcS,EAAKhB,EAAOC,GAGjC,IAFA,IAAIkE,EAAQnD,EAAItuC,MAAMstC,EAAOC,GACzB7N,EAAM,GACDvlC,EAAI,EAAGA,EAAIs3C,EAAMp3C,OAAQF,GAAK,EACrCulC,GAAOj4B,OAAOm0B,aAAa6V,EAAMt3C,GAAoB,IAAfs3C,EAAMt3C,EAAI,IAElD,OAAOulC,EA0CT,SAASgS,EAAarlC,EAAQoH,EAAKpZ,GACjC,GAAKgS,EAAS,GAAO,GAAKA,EAAS,EAAG,MAAM,IAAIxD,WAAW,sBAC3D,GAAIwD,EAASoH,EAAMpZ,EAAQ,MAAM,IAAIwO,WAAW,yCA+JlD,SAAS8oC,EAAUrD,EAAKvvC,EAAOsN,EAAQoH,EAAK5P,EAAKD,GAC/C,IAAKgL,EAAOtE,SAASgkC,GAAM,MAAM,IAAI3rC,UAAU,+CAC/C,GAAI5D,EAAQ8E,GAAO9E,EAAQ6E,EAAK,MAAM,IAAIiF,WAAW,qCACrD,GAAIwD,EAASoH,EAAM66B,EAAIj0C,OAAQ,MAAM,IAAIwO,WAAW,sBAkDtD,SAAS+oC,EAAmBtD,EAAKvvC,EAAOsN,EAAQwlC,GAC1C9yC,EAAQ,IAAGA,EAAQ,MAASA,EAAQ,GACxC,IAAK,IAAI5E,EAAI,EAAGkB,EAAIyP,KAAKlH,IAAI0qC,EAAIj0C,OAASgS,EAAQ,GAAIlS,EAAIkB,IAAKlB,EAC7Dm0C,EAAIjiC,EAASlS,IAAM4E,EAAS,KAAS,GAAK8yC,EAAe13C,EAAI,EAAIA,MAClC,GAA5B03C,EAAe13C,EAAI,EAAIA,GA8B9B,SAAS23C,EAAmBxD,EAAKvvC,EAAOsN,EAAQwlC,GAC1C9yC,EAAQ,IAAGA,EAAQ,WAAaA,EAAQ,GAC5C,IAAK,IAAI5E,EAAI,EAAGkB,EAAIyP,KAAKlH,IAAI0qC,EAAIj0C,OAASgS,EAAQ,GAAIlS,EAAIkB,IAAKlB,EAC7Dm0C,EAAIjiC,EAASlS,GAAM4E,IAAuC,GAA5B8yC,EAAe13C,EAAI,EAAIA,GAAU,IAmJnE,SAAS43C,EAAczD,EAAKvvC,EAAOsN,EAAQoH,EAAK5P,EAAKD,GACnD,GAAIyI,EAASoH,EAAM66B,EAAIj0C,OAAQ,MAAM,IAAIwO,WAAW,sBACpD,GAAIwD,EAAS,EAAG,MAAM,IAAIxD,WAAW,sBAGvC,SAASmpC,EAAY1D,EAAKvvC,EAAOsN,EAAQwlC,EAAcI,GAKrD,OAJKA,GACHF,EAAazD,EAAKvvC,EAAOsN,EAAQ,GAEnCu/B,EAAQc,MAAM4B,EAAKvvC,EAAOsN,EAAQwlC,EAAc,GAAI,GAC7CxlC,EAAS,EAWlB,SAAS6lC,EAAa5D,EAAKvvC,EAAOsN,EAAQwlC,EAAcI,GAKtD,OAJKA,GACHF,EAAazD,EAAKvvC,EAAOsN,EAAQ,GAEnCu/B,EAAQc,MAAM4B,EAAKvvC,EAAOsN,EAAQwlC,EAAc,GAAI,GAC7CxlC,EAAS,EA/clBuC,EAAOrU,UAAUyF,MAAQ,SAAgBstC,EAAOC,GAC9C,IAoBI4E,EApBA5tC,EAAM/D,KAAKnG,OAqBf,IApBAizC,IAAUA,GAGE,GACVA,GAAS/oC,GACG,IAAG+oC,EAAQ,GACdA,EAAQ/oC,IACjB+oC,EAAQ/oC,IANVgpC,OAAcxvC,IAARwvC,EAAoBhpC,IAAQgpC,GASxB,GACRA,GAAOhpC,GACG,IAAGgpC,EAAM,GACVA,EAAMhpC,IACfgpC,EAAMhpC,GAGJgpC,EAAMD,IAAOC,EAAMD,GAGnB1+B,EAAOk9B,qBACTqG,EAAS3xC,KAAK+vC,SAASjD,EAAOC,IACvBntC,UAAYwO,EAAOrU,cACrB,CACL,IAAI63C,EAAW7E,EAAMD,EACrB6E,EAAS,IAAIvjC,EAAOwjC,OAAUr0C,GAC9B,IAAK,IAAI5D,EAAI,EAAGA,EAAIi4C,IAAYj4C,EAC9Bg4C,EAAOh4C,GAAKqG,KAAKrG,EAAImzC,GAIzB,OAAO6E,GAWTvjC,EAAOrU,UAAU83C,WAAa,SAAqBhmC,EAAQgE,EAAY4hC,GACrE5lC,GAAkB,EAClBgE,GAA0B,EACrB4hC,GAAUP,EAAYrlC,EAAQgE,EAAY7P,KAAKnG,QAKpD,IAHA,IAAIu0B,EAAMpuB,KAAK6L,GACX5I,EAAM,EACNtJ,EAAI,IACCA,EAAIkW,IAAe5M,GAAO,MACjCmrB,GAAOpuB,KAAK6L,EAASlS,GAAKsJ,EAG5B,OAAOmrB,GAGThgB,EAAOrU,UAAU+3C,WAAa,SAAqBjmC,EAAQgE,EAAY4hC,GACrE5lC,GAAkB,EAClBgE,GAA0B,EACrB4hC,GACHP,EAAYrlC,EAAQgE,EAAY7P,KAAKnG,QAKvC,IAFA,IAAIu0B,EAAMpuB,KAAK6L,IAAWgE,GACtB5M,EAAM,EACH4M,EAAa,IAAM5M,GAAO,MAC/BmrB,GAAOpuB,KAAK6L,IAAWgE,GAAc5M,EAGvC,OAAOmrB,GAGThgB,EAAOrU,UAAU85B,UAAY,SAAoBhoB,EAAQ4lC,GAEvD,OADKA,GAAUP,EAAYrlC,EAAQ,EAAG7L,KAAKnG,QACpCmG,KAAK6L,IAGduC,EAAOrU,UAAUg4C,aAAe,SAAuBlmC,EAAQ4lC,GAE7D,OADKA,GAAUP,EAAYrlC,EAAQ,EAAG7L,KAAKnG,QACpCmG,KAAK6L,GAAW7L,KAAK6L,EAAS,IAAM,GAG7CuC,EAAOrU,UAAUg0C,aAAe,SAAuBliC,EAAQ4lC,GAE7D,OADKA,GAAUP,EAAYrlC,EAAQ,EAAG7L,KAAKnG,QACnCmG,KAAK6L,IAAW,EAAK7L,KAAK6L,EAAS,IAG7CuC,EAAOrU,UAAUi4C,aAAe,SAAuBnmC,EAAQ4lC,GAG7D,OAFKA,GAAUP,EAAYrlC,EAAQ,EAAG7L,KAAKnG,SAElCmG,KAAK6L,GACT7L,KAAK6L,EAAS,IAAM,EACpB7L,KAAK6L,EAAS,IAAM,IACD,SAAnB7L,KAAK6L,EAAS,IAGrBuC,EAAOrU,UAAUk4C,aAAe,SAAuBpmC,EAAQ4lC,GAG7D,OAFKA,GAAUP,EAAYrlC,EAAQ,EAAG7L,KAAKnG,QAEpB,SAAfmG,KAAK6L,IACT7L,KAAK6L,EAAS,IAAM,GACrB7L,KAAK6L,EAAS,IAAM,EACrB7L,KAAK6L,EAAS,KAGlBuC,EAAOrU,UAAUm4C,UAAY,SAAoBrmC,EAAQgE,EAAY4hC,GACnE5lC,GAAkB,EAClBgE,GAA0B,EACrB4hC,GAAUP,EAAYrlC,EAAQgE,EAAY7P,KAAKnG,QAKpD,IAHA,IAAIu0B,EAAMpuB,KAAK6L,GACX5I,EAAM,EACNtJ,EAAI,IACCA,EAAIkW,IAAe5M,GAAO,MACjCmrB,GAAOpuB,KAAK6L,EAASlS,GAAKsJ,EAM5B,OAFImrB,IAFJnrB,GAAO,OAESmrB,GAAO9jB,KAAK6nC,IAAI,EAAG,EAAItiC,IAEhCue,GAGThgB,EAAOrU,UAAUq4C,UAAY,SAAoBvmC,EAAQgE,EAAY4hC,GACnE5lC,GAAkB,EAClBgE,GAA0B,EACrB4hC,GAAUP,EAAYrlC,EAAQgE,EAAY7P,KAAKnG,QAKpD,IAHA,IAAIF,EAAIkW,EACJ5M,EAAM,EACNmrB,EAAMpuB,KAAK6L,IAAWlS,GACnBA,EAAI,IAAMsJ,GAAO,MACtBmrB,GAAOpuB,KAAK6L,IAAWlS,GAAKsJ,EAM9B,OAFImrB,IAFJnrB,GAAO,OAESmrB,GAAO9jB,KAAK6nC,IAAI,EAAG,EAAItiC,IAEhCue,GAGThgB,EAAOrU,UAAUs4C,SAAW,SAAmBxmC,EAAQ4lC,GAErD,OADKA,GAAUP,EAAYrlC,EAAQ,EAAG7L,KAAKnG,QACtB,IAAfmG,KAAK6L,IAC0B,GAA5B,IAAO7L,KAAK6L,GAAU,GADK7L,KAAK6L,IAI3CuC,EAAOrU,UAAUu4C,YAAc,SAAsBzmC,EAAQ4lC,GACtDA,GAAUP,EAAYrlC,EAAQ,EAAG7L,KAAKnG,QAC3C,IAAIu0B,EAAMpuB,KAAK6L,GAAW7L,KAAK6L,EAAS,IAAM,EAC9C,OAAc,MAANuiB,EAAsB,WAANA,EAAmBA,GAG7ChgB,EAAOrU,UAAUw4C,YAAc,SAAsB1mC,EAAQ4lC,GACtDA,GAAUP,EAAYrlC,EAAQ,EAAG7L,KAAKnG,QAC3C,IAAIu0B,EAAMpuB,KAAK6L,EAAS,GAAM7L,KAAK6L,IAAW,EAC9C,OAAc,MAANuiB,EAAsB,WAANA,EAAmBA,GAG7ChgB,EAAOrU,UAAUy4C,YAAc,SAAsB3mC,EAAQ4lC,GAG3D,OAFKA,GAAUP,EAAYrlC,EAAQ,EAAG7L,KAAKnG,QAEnCmG,KAAK6L,GACV7L,KAAK6L,EAAS,IAAM,EACpB7L,KAAK6L,EAAS,IAAM,GACpB7L,KAAK6L,EAAS,IAAM,IAGzBuC,EAAOrU,UAAU04C,YAAc,SAAsB5mC,EAAQ4lC,GAG3D,OAFKA,GAAUP,EAAYrlC,EAAQ,EAAG7L,KAAKnG,QAEnCmG,KAAK6L,IAAW,GACrB7L,KAAK6L,EAAS,IAAM,GACpB7L,KAAK6L,EAAS,IAAM,EACpB7L,KAAK6L,EAAS,IAGnBuC,EAAOrU,UAAUqlB,YAAc,SAAsBvT,EAAQ4lC,GAE3D,OADKA,GAAUP,EAAYrlC,EAAQ,EAAG7L,KAAKnG,QACpCuxC,EAAQyC,KAAK7tC,KAAM6L,GAAQ,EAAM,GAAI,IAG9CuC,EAAOrU,UAAU24C,YAAc,SAAsB7mC,EAAQ4lC,GAE3D,OADKA,GAAUP,EAAYrlC,EAAQ,EAAG7L,KAAKnG,QACpCuxC,EAAQyC,KAAK7tC,KAAM6L,GAAQ,EAAO,GAAI,IAG/CuC,EAAOrU,UAAU44C,aAAe,SAAuB9mC,EAAQ4lC,GAE7D,OADKA,GAAUP,EAAYrlC,EAAQ,EAAG7L,KAAKnG,QACpCuxC,EAAQyC,KAAK7tC,KAAM6L,GAAQ,EAAM,GAAI,IAG9CuC,EAAOrU,UAAU64C,aAAe,SAAuB/mC,EAAQ4lC,GAE7D,OADKA,GAAUP,EAAYrlC,EAAQ,EAAG7L,KAAKnG,QACpCuxC,EAAQyC,KAAK7tC,KAAM6L,GAAQ,EAAO,GAAI,IAS/CuC,EAAOrU,UAAU84C,YAAc,SAAsBt0C,EAAOsN,EAAQgE,EAAY4hC,IAC9ElzC,GAASA,EACTsN,GAAkB,EAClBgE,GAA0B,EACrB4hC,IAEHN,EAASnxC,KAAMzB,EAAOsN,EAAQgE,EADfvF,KAAK6nC,IAAI,EAAG,EAAItiC,GAAc,EACO,GAGtD,IAAI5M,EAAM,EACNtJ,EAAI,EAER,IADAqG,KAAK6L,GAAkB,IAARtN,IACN5E,EAAIkW,IAAe5M,GAAO,MACjCjD,KAAK6L,EAASlS,GAAM4E,EAAQ0E,EAAO,IAGrC,OAAO4I,EAASgE,GAGlBzB,EAAOrU,UAAU+4C,YAAc,SAAsBv0C,EAAOsN,EAAQgE,EAAY4hC,IAC9ElzC,GAASA,EACTsN,GAAkB,EAClBgE,GAA0B,EACrB4hC,IAEHN,EAASnxC,KAAMzB,EAAOsN,EAAQgE,EADfvF,KAAK6nC,IAAI,EAAG,EAAItiC,GAAc,EACO,GAGtD,IAAIlW,EAAIkW,EAAa,EACjB5M,EAAM,EAEV,IADAjD,KAAK6L,EAASlS,GAAa,IAAR4E,IACV5E,GAAK,IAAMsJ,GAAO,MACzBjD,KAAK6L,EAASlS,GAAM4E,EAAQ0E,EAAO,IAGrC,OAAO4I,EAASgE,GAGlBzB,EAAOrU,UAAUg5C,WAAa,SAAqBx0C,EAAOsN,EAAQ4lC,GAMhE,OALAlzC,GAASA,EACTsN,GAAkB,EACb4lC,GAAUN,EAASnxC,KAAMzB,EAAOsN,EAAQ,EAAG,IAAM,GACjDuC,EAAOk9B,sBAAqB/sC,EAAQ+L,KAAKhH,MAAM/E,IACpDyB,KAAK6L,GAAmB,IAARtN,EACTsN,EAAS,GAWlBuC,EAAOrU,UAAUi5C,cAAgB,SAAwBz0C,EAAOsN,EAAQ4lC,GAUtE,OATAlzC,GAASA,EACTsN,GAAkB,EACb4lC,GAAUN,EAASnxC,KAAMzB,EAAOsN,EAAQ,EAAG,MAAQ,GACpDuC,EAAOk9B,qBACTtrC,KAAK6L,GAAmB,IAARtN,EAChByB,KAAK6L,EAAS,GAAMtN,IAAU,GAE9B6yC,EAAkBpxC,KAAMzB,EAAOsN,GAAQ,GAElCA,EAAS,GAGlBuC,EAAOrU,UAAUk5C,cAAgB,SAAwB10C,EAAOsN,EAAQ4lC,GAUtE,OATAlzC,GAASA,EACTsN,GAAkB,EACb4lC,GAAUN,EAASnxC,KAAMzB,EAAOsN,EAAQ,EAAG,MAAQ,GACpDuC,EAAOk9B,qBACTtrC,KAAK6L,GAAWtN,IAAU,EAC1ByB,KAAK6L,EAAS,GAAc,IAARtN,GAEpB6yC,EAAkBpxC,KAAMzB,EAAOsN,GAAQ,GAElCA,EAAS,GAUlBuC,EAAOrU,UAAUm5C,cAAgB,SAAwB30C,EAAOsN,EAAQ4lC,GAYtE,OAXAlzC,GAASA,EACTsN,GAAkB,EACb4lC,GAAUN,EAASnxC,KAAMzB,EAAOsN,EAAQ,EAAG,WAAY,GACxDuC,EAAOk9B,qBACTtrC,KAAK6L,EAAS,GAAMtN,IAAU,GAC9ByB,KAAK6L,EAAS,GAAMtN,IAAU,GAC9ByB,KAAK6L,EAAS,GAAMtN,IAAU,EAC9ByB,KAAK6L,GAAmB,IAARtN,GAEhB+yC,EAAkBtxC,KAAMzB,EAAOsN,GAAQ,GAElCA,EAAS,GAGlBuC,EAAOrU,UAAUo5C,cAAgB,SAAwB50C,EAAOsN,EAAQ4lC,GAYtE,OAXAlzC,GAASA,EACTsN,GAAkB,EACb4lC,GAAUN,EAASnxC,KAAMzB,EAAOsN,EAAQ,EAAG,WAAY,GACxDuC,EAAOk9B,qBACTtrC,KAAK6L,GAAWtN,IAAU,GAC1ByB,KAAK6L,EAAS,GAAMtN,IAAU,GAC9ByB,KAAK6L,EAAS,GAAMtN,IAAU,EAC9ByB,KAAK6L,EAAS,GAAc,IAARtN,GAEpB+yC,EAAkBtxC,KAAMzB,EAAOsN,GAAQ,GAElCA,EAAS,GAGlBuC,EAAOrU,UAAUq5C,WAAa,SAAqB70C,EAAOsN,EAAQgE,EAAY4hC,GAG5E,GAFAlzC,GAASA,EACTsN,GAAkB,GACb4lC,EAAU,CACb,IAAI4B,EAAQ/oC,KAAK6nC,IAAI,EAAG,EAAItiC,EAAa,GAEzCshC,EAASnxC,KAAMzB,EAAOsN,EAAQgE,EAAYwjC,EAAQ,GAAIA,GAGxD,IAAI15C,EAAI,EACJsJ,EAAM,EACNF,EAAM,EAEV,IADA/C,KAAK6L,GAAkB,IAARtN,IACN5E,EAAIkW,IAAe5M,GAAO,MAC7B1E,EAAQ,GAAa,IAARwE,GAAsC,IAAzB/C,KAAK6L,EAASlS,EAAI,KAC9CoJ,EAAM,GAER/C,KAAK6L,EAASlS,IAAO4E,EAAQ0E,GAAQ,GAAKF,EAAM,IAGlD,OAAO8I,EAASgE,GAGlBzB,EAAOrU,UAAUu5C,WAAa,SAAqB/0C,EAAOsN,EAAQgE,EAAY4hC,GAG5E,GAFAlzC,GAASA,EACTsN,GAAkB,GACb4lC,EAAU,CACb,IAAI4B,EAAQ/oC,KAAK6nC,IAAI,EAAG,EAAItiC,EAAa,GAEzCshC,EAASnxC,KAAMzB,EAAOsN,EAAQgE,EAAYwjC,EAAQ,GAAIA,GAGxD,IAAI15C,EAAIkW,EAAa,EACjB5M,EAAM,EACNF,EAAM,EAEV,IADA/C,KAAK6L,EAASlS,GAAa,IAAR4E,IACV5E,GAAK,IAAMsJ,GAAO,MACrB1E,EAAQ,GAAa,IAARwE,GAAsC,IAAzB/C,KAAK6L,EAASlS,EAAI,KAC9CoJ,EAAM,GAER/C,KAAK6L,EAASlS,IAAO4E,EAAQ0E,GAAQ,GAAKF,EAAM,IAGlD,OAAO8I,EAASgE,GAGlBzB,EAAOrU,UAAUw5C,UAAY,SAAoBh1C,EAAOsN,EAAQ4lC,GAO9D,OANAlzC,GAASA,EACTsN,GAAkB,EACb4lC,GAAUN,EAASnxC,KAAMzB,EAAOsN,EAAQ,EAAG,KAAO,KAClDuC,EAAOk9B,sBAAqB/sC,EAAQ+L,KAAKhH,MAAM/E,IAChDA,EAAQ,IAAGA,EAAQ,IAAOA,EAAQ,GACtCyB,KAAK6L,GAAmB,IAARtN,EACTsN,EAAS,GAGlBuC,EAAOrU,UAAUy5C,aAAe,SAAuBj1C,EAAOsN,EAAQ4lC,GAUpE,OATAlzC,GAASA,EACTsN,GAAkB,EACb4lC,GAAUN,EAASnxC,KAAMzB,EAAOsN,EAAQ,EAAG,OAAS,OACrDuC,EAAOk9B,qBACTtrC,KAAK6L,GAAmB,IAARtN,EAChByB,KAAK6L,EAAS,GAAMtN,IAAU,GAE9B6yC,EAAkBpxC,KAAMzB,EAAOsN,GAAQ,GAElCA,EAAS,GAGlBuC,EAAOrU,UAAU05C,aAAe,SAAuBl1C,EAAOsN,EAAQ4lC,GAUpE,OATAlzC,GAASA,EACTsN,GAAkB,EACb4lC,GAAUN,EAASnxC,KAAMzB,EAAOsN,EAAQ,EAAG,OAAS,OACrDuC,EAAOk9B,qBACTtrC,KAAK6L,GAAWtN,IAAU,EAC1ByB,KAAK6L,EAAS,GAAc,IAARtN,GAEpB6yC,EAAkBpxC,KAAMzB,EAAOsN,GAAQ,GAElCA,EAAS,GAGlBuC,EAAOrU,UAAU25C,aAAe,SAAuBn1C,EAAOsN,EAAQ4lC,GAYpE,OAXAlzC,GAASA,EACTsN,GAAkB,EACb4lC,GAAUN,EAASnxC,KAAMzB,EAAOsN,EAAQ,EAAG,YAAa,YACzDuC,EAAOk9B,qBACTtrC,KAAK6L,GAAmB,IAARtN,EAChByB,KAAK6L,EAAS,GAAMtN,IAAU,EAC9ByB,KAAK6L,EAAS,GAAMtN,IAAU,GAC9ByB,KAAK6L,EAAS,GAAMtN,IAAU,IAE9B+yC,EAAkBtxC,KAAMzB,EAAOsN,GAAQ,GAElCA,EAAS,GAGlBuC,EAAOrU,UAAU45C,aAAe,SAAuBp1C,EAAOsN,EAAQ4lC,GAapE,OAZAlzC,GAASA,EACTsN,GAAkB,EACb4lC,GAAUN,EAASnxC,KAAMzB,EAAOsN,EAAQ,EAAG,YAAa,YACzDtN,EAAQ,IAAGA,EAAQ,WAAaA,EAAQ,GACxC6P,EAAOk9B,qBACTtrC,KAAK6L,GAAWtN,IAAU,GAC1ByB,KAAK6L,EAAS,GAAMtN,IAAU,GAC9ByB,KAAK6L,EAAS,GAAMtN,IAAU,EAC9ByB,KAAK6L,EAAS,GAAc,IAARtN,GAEpB+yC,EAAkBtxC,KAAMzB,EAAOsN,GAAQ,GAElCA,EAAS,GAgBlBuC,EAAOrU,UAAU65C,aAAe,SAAuBr1C,EAAOsN,EAAQ4lC,GACpE,OAAOD,EAAWxxC,KAAMzB,EAAOsN,GAAQ,EAAM4lC,IAG/CrjC,EAAOrU,UAAU85C,aAAe,SAAuBt1C,EAAOsN,EAAQ4lC,GACpE,OAAOD,EAAWxxC,KAAMzB,EAAOsN,GAAQ,EAAO4lC,IAWhDrjC,EAAOrU,UAAU+5C,cAAgB,SAAwBv1C,EAAOsN,EAAQ4lC,GACtE,OAAOC,EAAY1xC,KAAMzB,EAAOsN,GAAQ,EAAM4lC,IAGhDrjC,EAAOrU,UAAUg6C,cAAgB,SAAwBx1C,EAAOsN,EAAQ4lC,GACtE,OAAOC,EAAY1xC,KAAMzB,EAAOsN,GAAQ,EAAO4lC,IAIjDrjC,EAAOrU,UAAU0I,KAAO,SAAetF,EAAQ62C,EAAalH,EAAOC,GAQjE,GAPKD,IAAOA,EAAQ,GACfC,GAAe,IAARA,IAAWA,EAAM/sC,KAAKnG,QAC9Bm6C,GAAe72C,EAAOtD,SAAQm6C,EAAc72C,EAAOtD,QAClDm6C,IAAaA,EAAc,GAC5BjH,EAAM,GAAKA,EAAMD,IAAOC,EAAMD,GAG9BC,IAAQD,EAAO,OAAO,EAC1B,GAAsB,IAAlB3vC,EAAOtD,QAAgC,IAAhBmG,KAAKnG,OAAc,OAAO,EAGrD,GAAIm6C,EAAc,EAChB,MAAM,IAAI3rC,WAAW,6BAEvB,GAAIykC,EAAQ,GAAKA,GAAS9sC,KAAKnG,OAAQ,MAAM,IAAIwO,WAAW,6BAC5D,GAAI0kC,EAAM,EAAG,MAAM,IAAI1kC,WAAW,2BAG9B0kC,EAAM/sC,KAAKnG,SAAQkzC,EAAM/sC,KAAKnG,QAC9BsD,EAAOtD,OAASm6C,EAAcjH,EAAMD,IACtCC,EAAM5vC,EAAOtD,OAASm6C,EAAclH,GAGtC,IACInzC,EADAoK,EAAMgpC,EAAMD,EAGhB,GAAI9sC,OAAS7C,GAAU2vC,EAAQkH,GAAeA,EAAcjH,EAE1D,IAAKpzC,EAAIoK,EAAM,EAAGpK,GAAK,IAAKA,EAC1BwD,EAAOxD,EAAIq6C,GAAeh0C,KAAKrG,EAAImzC,QAEhC,GAAI/oC,EAAM,MAASqK,EAAOk9B,oBAE/B,IAAK3xC,EAAI,EAAGA,EAAIoK,IAAOpK,EACrBwD,EAAOxD,EAAIq6C,GAAeh0C,KAAKrG,EAAImzC,QAGrC18B,WAAWrW,UAAU2I,IAAIzI,KACvBkD,EACA6C,KAAK+vC,SAASjD,EAAOA,EAAQ/oC,GAC7BiwC,GAIJ,OAAOjwC,GAOTqK,EAAOrU,UAAU65B,KAAO,SAAexF,EAAK0e,EAAOC,EAAKhB,GAEtD,GAAmB,iBAAR3d,EAAkB,CAS3B,GARqB,iBAAV0e,GACTf,EAAWe,EACXA,EAAQ,EACRC,EAAM/sC,KAAKnG,QACa,iBAARkzC,IAChBhB,EAAWgB,EACXA,EAAM/sC,KAAKnG,QAEM,IAAfu0B,EAAIv0B,OAAc,CACpB,IAAIkR,EAAOqjB,EAAIsgB,WAAW,GACtB3jC,EAAO,MACTqjB,EAAMrjB,GAGV,QAAiBxN,IAAbwuC,GAA8C,iBAAbA,EACnC,MAAM,IAAI5pC,UAAU,6BAEtB,GAAwB,iBAAb4pC,IAA0B39B,EAAO49B,WAAWD,GACrD,MAAM,IAAI5pC,UAAU,qBAAuB4pC,OAErB,iBAAR3d,IAChBA,GAAY,KAId,GAAI0e,EAAQ,GAAK9sC,KAAKnG,OAASizC,GAAS9sC,KAAKnG,OAASkzC,EACpD,MAAM,IAAI1kC,WAAW,sBAGvB,GAAI0kC,GAAOD,EACT,OAAO9sC,KAQT,IAAIrG,EACJ,GANAmzC,KAAkB,EAClBC,OAAcxvC,IAARwvC,EAAoB/sC,KAAKnG,OAASkzC,IAAQ,EAE3C3e,IAAKA,EAAM,GAGG,iBAARA,EACT,IAAKz0B,EAAImzC,EAAOnzC,EAAIozC,IAAOpzC,EACzBqG,KAAKrG,GAAKy0B,MAEP,CACL,IAAI6iB,EAAQ7iC,EAAOtE,SAASskB,GACxBA,EACAse,EAAY,IAAIt+B,EAAOggB,EAAK2d,GAAU9/B,YACtClI,EAAMktC,EAAMp3C,OAChB,IAAKF,EAAI,EAAGA,EAAIozC,EAAMD,IAASnzC,EAC7BqG,KAAKrG,EAAImzC,GAASmE,EAAMt3C,EAAIoK,GAIhC,OAAO/D,MAMT,IAAIi0C,EAAoB,qBAmBxB,SAASjD,EAAOjyC,GACd,OAAIA,EAAI,GAAW,IAAMA,EAAEkN,SAAS,IAC7BlN,EAAEkN,SAAS,IAGpB,SAASygC,EAAaZ,EAAQiD,GAE5B,IAAIQ,EADJR,EAAQA,GAASp3B,IAMjB,IAJA,IAAI9d,EAASiyC,EAAOjyC,OAChBq6C,EAAgB,KAChBjD,EAAQ,GAEHt3C,EAAI,EAAGA,EAAIE,IAAUF,EAAG,CAI/B,IAHA41C,EAAYzD,EAAO4C,WAAW/0C,IAGd,OAAU41C,EAAY,MAAQ,CAE5C,IAAK2E,EAAe,CAElB,GAAI3E,EAAY,MAAQ,EAEjBR,GAAS,IAAM,GAAGkC,EAAM92C,KAAK,IAAM,IAAM,KAC9C,SACK,GAAIR,EAAI,IAAME,EAAQ,EAEtBk1C,GAAS,IAAM,GAAGkC,EAAM92C,KAAK,IAAM,IAAM,KAC9C,SAIF+5C,EAAgB3E,EAEhB,SAIF,GAAIA,EAAY,MAAQ,EACjBR,GAAS,IAAM,GAAGkC,EAAM92C,KAAK,IAAM,IAAM,KAC9C+5C,EAAgB3E,EAChB,SAIFA,EAAkE,OAArD2E,EAAgB,OAAU,GAAK3E,EAAY,YAC/C2E,IAEJnF,GAAS,IAAM,GAAGkC,EAAM92C,KAAK,IAAM,IAAM,KAMhD,GAHA+5C,EAAgB,KAGZ3E,EAAY,IAAM,CACpB,IAAKR,GAAS,GAAK,EAAG,MACtBkC,EAAM92C,KAAKo1C,QACN,GAAIA,EAAY,KAAO,CAC5B,IAAKR,GAAS,GAAK,EAAG,MACtBkC,EAAM92C,KACJo1C,GAAa,EAAM,IACP,GAAZA,EAAmB,UAEhB,GAAIA,EAAY,MAAS,CAC9B,IAAKR,GAAS,GAAK,EAAG,MACtBkC,EAAM92C,KACJo1C,GAAa,GAAM,IACnBA,GAAa,EAAM,GAAO,IACd,GAAZA,EAAmB,SAEhB,MAAIA,EAAY,SASrB,MAAM,IAAI7yC,MAAM,sBARhB,IAAKqyC,GAAS,GAAK,EAAG,MACtBkC,EAAM92C,KACJo1C,GAAa,GAAO,IACpBA,GAAa,GAAM,GAAO,IAC1BA,GAAa,EAAM,GAAO,IACd,GAAZA,EAAmB,MAOzB,OAAO0B,EA4BT,SAAStE,EAAe5gB,GACtB,OAAOof,EAAOgJ,YAhIhB,SAAsBpoB,GAIpB,IAFAA,EAUF,SAAqBA,GACnB,OAAIA,EAAIqoB,KAAaroB,EAAIqoB,OAClBroB,EAAI7O,QAAQ,aAAc,IAZ3Bm3B,CAAWtoB,GAAK7O,QAAQ+2B,EAAmB,KAEzCp6C,OAAS,EAAG,MAAO,GAE3B,KAAOkyB,EAAIlyB,OAAS,GAAM,GACxBkyB,GAAY,IAEd,OAAOA,EAuHmBuoB,CAAYvoB,IAGxC,SAASwiB,EAAYjyC,EAAKi4C,EAAK1oC,EAAQhS,GACrC,IAAK,IAAIF,EAAI,EAAGA,EAAIE,KACbF,EAAIkS,GAAU0oC,EAAI16C,QAAYF,GAAK2C,EAAIzC,UADhBF,EAE5B46C,EAAI56C,EAAIkS,GAAUvP,EAAI3C,GAExB,OAAOA,K,gDCrvDTyB,EAAQyU,WAuCR,SAAqB2kC,GACnB,IAAIC,EAAOC,EAAQF,GACfG,EAAWF,EAAK,GAChBG,EAAkBH,EAAK,GAC3B,OAAuC,GAA9BE,EAAWC,GAAuB,EAAKA,GA1ClDx5C,EAAQ+4C,YAiDR,SAAsBK,GACpB,IAAIK,EAcAl7C,EAbA86C,EAAOC,EAAQF,GACfG,EAAWF,EAAK,GAChBG,EAAkBH,EAAK,GAEvB1sC,EAAM,IAAI+sC,EAVhB,SAAsBN,EAAKG,EAAUC,GACnC,OAAuC,GAA9BD,EAAWC,GAAuB,EAAKA,EAS9BG,CAAYP,EAAKG,EAAUC,IAEzCI,EAAU,EAGVjxC,EAAM6wC,EAAkB,EACxBD,EAAW,EACXA,EAGJ,IAAKh7C,EAAI,EAAGA,EAAIoK,EAAKpK,GAAK,EACxBk7C,EACGI,EAAUT,EAAI9F,WAAW/0C,KAAO,GAChCs7C,EAAUT,EAAI9F,WAAW/0C,EAAI,KAAO,GACpCs7C,EAAUT,EAAI9F,WAAW/0C,EAAI,KAAO,EACrCs7C,EAAUT,EAAI9F,WAAW/0C,EAAI,IAC/BoO,EAAIitC,KAAcH,GAAO,GAAM,IAC/B9sC,EAAIitC,KAAcH,GAAO,EAAK,IAC9B9sC,EAAIitC,KAAmB,IAANH,EAGK,IAApBD,IACFC,EACGI,EAAUT,EAAI9F,WAAW/0C,KAAO,EAChCs7C,EAAUT,EAAI9F,WAAW/0C,EAAI,KAAO,EACvCoO,EAAIitC,KAAmB,IAANH,GAGK,IAApBD,IACFC,EACGI,EAAUT,EAAI9F,WAAW/0C,KAAO,GAChCs7C,EAAUT,EAAI9F,WAAW/0C,EAAI,KAAO,EACpCs7C,EAAUT,EAAI9F,WAAW/0C,EAAI,KAAO,EACvCoO,EAAIitC,KAAcH,GAAO,EAAK,IAC9B9sC,EAAIitC,KAAmB,IAANH,GAGnB,OAAO9sC,GA3FT3M,EAAQ6zC,cAkHR,SAAwBiG,GAQtB,IAPA,IAAIL,EACA9wC,EAAMmxC,EAAMr7C,OACZs7C,EAAapxC,EAAM,EACnBqxC,EAAQ,GAIHz7C,EAAI,EAAG07C,EAAOtxC,EAAMoxC,EAAYx7C,EAAI07C,EAAM17C,GAH9B,MAInBy7C,EAAMj7C,KAAKm7C,EACTJ,EAAOv7C,EAAIA,EALM,MAKgB07C,EAAOA,EAAQ17C,EAL/B,QAUF,IAAfw7C,GACFN,EAAMK,EAAMnxC,EAAM,GAClBqxC,EAAMj7C,KACJo7C,EAAOV,GAAO,GACdU,EAAQV,GAAO,EAAK,IACpB,OAEsB,IAAfM,IACTN,GAAOK,EAAMnxC,EAAM,IAAM,GAAKmxC,EAAMnxC,EAAM,GAC1CqxC,EAAMj7C,KACJo7C,EAAOV,GAAO,IACdU,EAAQV,GAAO,EAAK,IACpBU,EAAQV,GAAO,EAAK,IACpB,MAIJ,OAAOO,EAAMvqC,KAAK,KA3IpB,IALA,IAAI0qC,EAAS,GACTN,EAAY,GACZH,EAA4B,oBAAf1kC,WAA6BA,WAAavQ,MAEvDkL,EAAO,mEACFpR,EAAI,EAAGoK,EAAMgH,EAAKlR,OAAQF,EAAIoK,IAAOpK,EAC5C47C,EAAO57C,GAAKoR,EAAKpR,GACjBs7C,EAAUlqC,EAAK2jC,WAAW/0C,IAAMA,EAQlC,SAAS+6C,EAASF,GAChB,IAAIzwC,EAAMywC,EAAI36C,OAEd,GAAIkK,EAAM,EAAI,EACZ,MAAM,IAAIrH,MAAM,kDAKlB,IAAIi4C,EAAWH,EAAIv3B,QAAQ,KAO3B,OANkB,IAAd03B,IAAiBA,EAAW5wC,GAMzB,CAAC4wC,EAJcA,IAAa5wC,EAC/B,EACA,EAAK4wC,EAAW,GAsEtB,SAASW,EAAaJ,EAAOpI,EAAOC,GAGlC,IAFA,IAAI8H,EARoBW,EASpB5mB,EAAS,GACJj1B,EAAImzC,EAAOnzC,EAAIozC,EAAKpzC,GAAK,EAChCk7C,GACIK,EAAMv7C,IAAM,GAAM,WAClBu7C,EAAMv7C,EAAI,IAAM,EAAK,QACP,IAAfu7C,EAAMv7C,EAAI,IACbi1B,EAAOz0B,KAdFo7C,GADiBC,EAeMX,IAdT,GAAK,IACxBU,EAAOC,GAAO,GAAK,IACnBD,EAAOC,GAAO,EAAI,IAClBD,EAAa,GAANC,IAaT,OAAO5mB,EAAO/jB,KAAK,IAjGrBoqC,EAAU,IAAIvG,WAAW,IAAM,GAC/BuG,EAAU,IAAIvG,WAAW,IAAM,I,cCnB/BtzC,EAAQyyC,KAAO,SAAUj+B,EAAQ/D,EAAQ4pC,EAAMC,EAAMC,GACnD,IAAIp6C,EAAGqC,EACHg4C,EAAiB,EAATD,EAAcD,EAAO,EAC7BG,GAAQ,GAAKD,GAAQ,EACrBE,EAAQD,GAAQ,EAChBE,GAAS,EACTp8C,EAAI87C,EAAQE,EAAS,EAAK,EAC1B73C,EAAI23C,GAAQ,EAAI,EAChBx6C,EAAI2U,EAAO/D,EAASlS,GAOxB,IALAA,GAAKmE,EAELvC,EAAIN,GAAM,IAAO86C,GAAU,EAC3B96C,KAAQ86C,EACRA,GAASH,EACFG,EAAQ,EAAGx6C,EAAS,IAAJA,EAAWqU,EAAO/D,EAASlS,GAAIA,GAAKmE,EAAGi4C,GAAS,GAKvE,IAHAn4C,EAAIrC,GAAM,IAAOw6C,GAAU,EAC3Bx6C,KAAQw6C,EACRA,GAASL,EACFK,EAAQ,EAAGn4C,EAAS,IAAJA,EAAWgS,EAAO/D,EAASlS,GAAIA,GAAKmE,EAAGi4C,GAAS,GAEvE,GAAU,IAANx6C,EACFA,EAAI,EAAIu6C,MACH,IAAIv6C,IAAMs6C,EACf,OAAOj4C,EAAIo4C,IAAsBr+B,KAAd1c,GAAK,EAAI,GAE5B2C,GAAQ0M,KAAK6nC,IAAI,EAAGuD,GACpBn6C,GAAQu6C,EAEV,OAAQ76C,GAAK,EAAI,GAAK2C,EAAI0M,KAAK6nC,IAAI,EAAG52C,EAAIm6C,IAG5Ct6C,EAAQ8wC,MAAQ,SAAUt8B,EAAQrR,EAAOsN,EAAQ4pC,EAAMC,EAAMC,GAC3D,IAAIp6C,EAAGqC,EAAGC,EACN+3C,EAAiB,EAATD,EAAcD,EAAO,EAC7BG,GAAQ,GAAKD,GAAQ,EACrBE,EAAQD,GAAQ,EAChBI,EAAe,KAATP,EAAcprC,KAAK6nC,IAAI,GAAI,IAAM7nC,KAAK6nC,IAAI,GAAI,IAAM,EAC1Dx4C,EAAI87C,EAAO,EAAKE,EAAS,EACzB73C,EAAI23C,EAAO,GAAK,EAChBx6C,EAAIsD,EAAQ,GAAgB,IAAVA,GAAe,EAAIA,EAAQ,EAAK,EAAI,EAmC1D,IAjCAA,EAAQ+L,KAAKC,IAAIhM,GAEbqH,MAAMrH,IAAUA,IAAUoZ,KAC5B/Z,EAAIgI,MAAMrH,GAAS,EAAI,EACvBhD,EAAIs6C,IAEJt6C,EAAI+O,KAAKhH,MAAMgH,KAAKymB,IAAIxyB,GAAS+L,KAAK4rC,KAClC33C,GAASV,EAAIyM,KAAK6nC,IAAI,GAAI52C,IAAM,IAClCA,IACAsC,GAAK,IAGLU,GADEhD,EAAIu6C,GAAS,EACNG,EAAKp4C,EAELo4C,EAAK3rC,KAAK6nC,IAAI,EAAG,EAAI2D,IAEpBj4C,GAAK,IACftC,IACAsC,GAAK,GAGHtC,EAAIu6C,GAASD,GACfj4C,EAAI,EACJrC,EAAIs6C,GACKt6C,EAAIu6C,GAAS,GACtBl4C,GAAMW,EAAQV,EAAK,GAAKyM,KAAK6nC,IAAI,EAAGuD,GACpCn6C,GAAQu6C,IAERl4C,EAAIW,EAAQ+L,KAAK6nC,IAAI,EAAG2D,EAAQ,GAAKxrC,KAAK6nC,IAAI,EAAGuD,GACjDn6C,EAAI,IAIDm6C,GAAQ,EAAG9lC,EAAO/D,EAASlS,GAAS,IAAJiE,EAAUjE,GAAKmE,EAAGF,GAAK,IAAK83C,GAAQ,GAI3E,IAFAn6C,EAAKA,GAAKm6C,EAAQ93C,EAClBg4C,GAAQF,EACDE,EAAO,EAAGhmC,EAAO/D,EAASlS,GAAS,IAAJ4B,EAAU5B,GAAKmE,EAAGvC,GAAK,IAAKq6C,GAAQ,GAE1EhmC,EAAO/D,EAASlS,EAAImE,IAAU,IAAJ7C,I,cClF5B,IAAIgR,EAAW,GAAGA,SAElB5Q,EAAOD,QAAUyE,MAAMqM,SAAW,SAAUnE,GAC1C,MAA6B,kBAAtBkE,EAAShS,KAAK8N,K,6BCEvB1M,EAAOD,QAIP,SAAiB/B,EAAM88C,GACjBA,GAAM,IACRC,EAAc,EAAGD,EAAK,EAAG98C,GA+F7B,SAASg9C,EAAUr+B,EAAMgS,EAAO3wB,GAC9B,IAAIi9C,GAAStsB,EAAQhS,EAAO,GAAK,EAAI,EACjCu+B,EAASv+B,EAAOs+B,EAChBE,EAASxsB,EAAQssB,EACjBG,EAASz+B,EAAOgS,GAAS,EACzB0sB,EAASD,EAASH,EAClBK,EAASF,EAASH,EAClBM,EAAML,EACNM,EAAMH,EACNI,EAAML,EACNM,EAAMJ,EACNK,EAAMR,EACNS,EAAOj/B,EAAO,EACdk/B,EAAQltB,EAAQ,EAChB6qB,EAAM,EACPxZ,EAAQub,EAAKC,EAAKx9C,KACnBw7C,EAAM+B,EACNA,EAAMC,EACNA,EAAMhC,GAELxZ,EAAQ0b,EAAKC,EAAK39C,KACnBw7C,EAAMkC,EACNA,EAAMC,EACNA,EAAMnC,GAELxZ,EAAQub,EAAKE,EAAKz9C,KACnBw7C,EAAM+B,EACNA,EAAME,EACNA,EAAMjC,GAELxZ,EAAQwb,EAAKC,EAAKz9C,KACnBw7C,EAAMgC,EACNA,EAAMC,EACNA,EAAMjC,GAELxZ,EAAQub,EAAKG,EAAK19C,KACnBw7C,EAAM+B,EACNA,EAAMG,EACNA,EAAMlC,GAELxZ,EAAQyb,EAAKC,EAAK19C,KACnBw7C,EAAMiC,EACNA,EAAMC,EACNA,EAAMlC,GAELxZ,EAAQwb,EAAKG,EAAK39C,KACnBw7C,EAAMgC,EACNA,EAAMG,EACNA,EAAMnC,GAELxZ,EAAQwb,EAAKC,EAAKz9C,KACnBw7C,EAAMgC,EACNA,EAAMC,EACNA,EAAMjC,GAELxZ,EAAQ0b,EAAKC,EAAK39C,KACnBw7C,EAAMkC,EACNA,EAAMC,EACNA,EAAMnC,GAcR,IAXA,IAAIsC,EAAU99C,EAAK,EAAEw9C,GACjBO,EAAU/9C,EAAK,EAAEw9C,EAAI,GACrBQ,EAAUh+C,EAAK,EAAE09C,GACjBO,EAAUj+C,EAAK,EAAE09C,EAAI,GAErBQ,EAAO,EAAIX,EACXY,EAAO,EAAIV,EACXW,EAAO,EAAIT,EACXU,EAAO,EAAInB,EACXoB,EAAO,EAAIlB,EACXmB,EAAO,EAAIpB,EACNqB,EAAK,EAAGA,EAAK,IAAKA,EAAI,CAC7B,IAAItiC,EAAIlc,EAAKk+C,EAAKM,GACdr2C,EAAInI,EAAKm+C,EAAKK,GACdriC,EAAInc,EAAKo+C,EAAKI,GAClBx+C,EAAKq+C,EAAKG,GAAMtiC,EAChBlc,EAAKs+C,EAAKE,GAAMr2C,EAChBnI,EAAKu+C,EAAKC,GAAMriC,EAGlBsiC,EAAKpB,EAAQ1+B,EAAM3e,GACnBy+C,EAAKnB,EAAQ3sB,EAAO3wB,GACpB,IAAK,IAAI8hB,EAAI87B,EAAM97B,GAAK+7B,IAAS/7B,EAC/B,GAAI48B,EAAa58B,EAAGg8B,EAASC,EAAS/9C,GAChC8hB,IAAM87B,GACR3J,EAAKnyB,EAAG87B,EAAM59C,KAEd49C,OAEF,IAAKc,EAAa58B,EAAGk8B,EAASC,EAASj+C,GACrC,OAAa,CACX,GAAK0+C,EAAab,EAAOG,EAASC,EAASj+C,GAKpC,CACD0+C,EAAab,EAAOC,EAASC,EAAS/9C,IACxC2+C,EAAO78B,EAAG87B,EAAMC,EAAO79C,KACrB49C,IACAC,IAEF5J,EAAKnyB,EAAG+7B,EAAO79C,KACb69C,GAEJ,MAbA,KAAMA,EAAQ/7B,EACZ,MAkBZ88B,EAAajgC,EAAMi/B,EAAK,EAAGE,EAASC,EAAS/9C,GAC7C4+C,EAAajuB,EAAOktB,EAAM,EAAGG,EAASC,EAASj+C,GAC3C49C,EAAO,EAAIj/B,GArNQ,GAsNrBo+B,EAAcp+B,EAAMi/B,EAAO,EAAG59C,GAE9Bg9C,EAAUr+B,EAAMi/B,EAAO,EAAG59C,GAExB2wB,GAASktB,EAAQ,IA1NE,GA2NrBd,EAAcc,EAAQ,EAAGltB,EAAO3wB,GAEhCg9C,EAAUa,EAAQ,EAAGltB,EAAO3wB,GAE1B69C,EAAQD,GA/NW,GAgOrBb,EAAca,EAAMC,EAAO79C,GAE3Bg9C,EAAUY,EAAMC,EAAO79C,GA5NvBg9C,CAAU,EAAGF,EAAK,EAAG98C,IAIzB,SAAS+8C,EAAcp+B,EAAMgS,EAAO3wB,GAElC,IADA,IAAImgB,EAAM,GAAGxB,EAAK,GACVre,EAAEqe,EAAK,EAAGre,GAAGqwB,IAASrwB,EAAG,CAK/B,IAJA,IAAIuQ,EAAI7Q,EAAKmgB,KACT9Z,EAAIrG,EAAKmgB,KACT3e,EAAIlB,EACJu+C,EAAO1+B,EAAI,EACT3e,KAAMmd,GAAM,CAChB,IAAIzC,EAAIlc,EAAK6+C,EAAK,GACd12C,EAAInI,EAAK6+C,EAAK,GAClB,GAAG3iC,EAAIrL,EACL,MACK,GAAGqL,IAAMrL,GAAK1I,EAAI9B,EACvB,MAEFrG,EAAK6+C,GAAU3iC,EACflc,EAAK6+C,EAAK,GAAK12C,EACf02C,GAAQ,EAEV7+C,EAAK6+C,GAAUhuC,EACf7Q,EAAK6+C,EAAK,GAAKx4C,GAInB,SAAS4tC,EAAK3zC,EAAGkB,EAAGxB,GAElBwB,GAAK,EACL,IAAI0a,EAAIlc,EAFRM,GAAK,GAGD6H,EAAInI,EAAKM,EAAE,GACfN,EAAKM,GAAKN,EAAKwB,GACfxB,EAAKM,EAAE,GAAKN,EAAKwB,EAAE,GACnBxB,EAAKwB,GAAK0a,EACVlc,EAAKwB,EAAE,GAAK2G,EAGd,SAASs2C,EAAKn+C,EAAGkB,EAAGxB,GAElBwB,GAAK,EACLxB,EAFAM,GAAK,GAEKN,EAAKwB,GACfxB,EAAKM,EAAE,GAAKN,EAAKwB,EAAE,GAGrB,SAASm9C,EAAOr+C,EAAGkB,EAAGsgB,EAAG9hB,GAEvBwB,GAAK,EACLsgB,GAAK,EACL,IAAI5F,EAAIlc,EAHRM,GAAK,GAID6H,EAAInI,EAAKM,EAAE,GACfN,EAAKM,GAAKN,EAAKwB,GACfxB,EAAKM,EAAE,GAAKN,EAAKwB,EAAE,GACnBxB,EAAKwB,GAAKxB,EAAK8hB,GACf9hB,EAAKwB,EAAE,GAAKxB,EAAK8hB,EAAE,GACnB9hB,EAAK8hB,GAAK5F,EACVlc,EAAK8hB,EAAE,GAAK3Z,EAGd,SAASy2C,EAAat+C,EAAGkB,EAAGokB,EAAIJ,EAAIxlB,GAElCwB,GAAK,EACLxB,EAFAM,GAAK,GAEKN,EAAKwB,GACfxB,EAAKwB,GAAKokB,EACV5lB,EAAKM,EAAE,GAAKN,EAAKwB,EAAE,GACnBxB,EAAKwB,EAAE,GAAKgkB,EAGd,SAASwc,EAAQ1hC,EAAGkB,EAAGxB,GAErBwB,GAAK,EACL,IAAI0a,EAAIlc,EAFRM,GAAK,GAGD6H,EAAInI,EAAKwB,GACb,QAAG0a,EAAI/T,KAEG+T,IAAM/T,GACPnI,EAAKM,EAAE,GAAKN,EAAKwB,EAAE,IAK9B,SAASk9C,EAAap+C,EAAG6H,EAAG9B,EAAGrG,GAE7B,IAAIkc,EAAIlc,EADRM,GAAK,GAEL,OAAG4b,EAAI/T,GAEG+T,IAAM/T,GACPnI,EAAKM,EAAE,GAAK+F,I,6BCnGvBrE,EAAOD,QAsKP,SACE0C,EAAGib,EAAOo/B,EACVC,EAAOC,EAAQC,EACfC,EAAOC,EAAQC,IAtHjB,SAAkB36C,EAAGqJ,GACnB,IAAIuxC,EAAU,EAAIxqC,EAAK6B,KAAK5I,EAAM,IAAMrJ,EAAE,GAAI,EAC1C66C,EAAUzqC,EAAK+B,SAXH,EAWwByoC,GACrCE,EAAW/+C,OAAS8+C,IACrBrgC,EAAK7G,KAAKmnC,GACVA,EAAatgC,EAAKzH,YAAY8nC,IAEhC,IAAIE,EAAa3qC,EAAK+B,SAfN,EAe2ByoC,GACxCI,EAAWj/C,OAASg/C,IACrBvgC,EAAK7G,KAAKqnC,GACVA,EAAaxgC,EAAKrH,aAAa4nC,IA+GjCE,CAASj7C,EAAGs6C,EAAQG,GAEpB,IAEIr+B,EAFAuB,EAAO,EACPhC,EAAW,EAAI3b,EAGnBk7C,EAASv9B,IACL,EACA,EAAG28B,EACH,EAAGG,EACHJ,EAAW,GAAK,GACfxgC,IAAUA,KACXwgC,GACFa,EAASv9B,IACP,EACA,EAAG88B,EACH,EAAGH,EACH,GACCzgC,IAAUA,KAGf,KAAM8D,EAAM,GAAG,CAGb,IAAIw9B,EA1JU,GAwJdx9B,GAAQ,GAGJtE,EAAYyhC,EAAWK,GACvBjgC,EAAY4/B,EAAWK,EAAK,GAC5BhgC,EAAY2/B,EAAWK,EAAK,GAC5B7/B,EAAYw/B,EAAWK,EAAK,GAC5B5/B,EAAYu/B,EAAWK,EAAK,GAC5BvxC,EAAYkxC,EAAWK,EAAK,GAE5BC,EAjKU,EAiKHz9B,EACPquB,EAAYgP,EAAWI,GACvBnP,EAAY+O,EAAWI,EAAK,GAG5B1+B,EAAqB,EAAR9S,EACbijC,KAAuB,GAARjjC,GAGfwR,EAAYm/B,EACZl/B,EAAYm/B,EACZh/B,EAAYk/B,EACZj/B,EAAYk/B,EAQhB,GAPGj+B,IACDtB,EAAcs/B,EACdr/B,EAAcs/B,EACdn/B,EAAc++B,EACd9+B,EAAc++B,KAGL,EAAR5wC,IACDuR,EAASkgC,EACPr7C,EAAGqZ,EACH6B,EAAUC,EAAQC,EAAKC,EACvB4wB,GACC/wB,GAAYC,IAIN,EAARvR,IACDsR,EAAWogC,EACTt7C,EAAGqZ,EACH6B,EAAUC,EAAQC,EAAKC,EACvB2wB,KACa7wB,GALjB,CAUA,IAAIogC,EAAYpgC,EAAUD,EACtBsgC,EAAYjgC,EAAUD,EAE1B,GAAGuxB,GACD,GAAG7sC,EAAIu7C,GAAYA,EAAWC,GAzOP,GAAG,GAyOuC,CAK/D,QAAc,KAJdp/B,EAASgmB,EAAM7kB,aACbvd,EAAGqZ,EAAM4B,EACTC,EAAUC,EAAQC,EAAKC,EACvBC,EAAWC,EAASC,EAAMC,IAE1B,OAAOW,EAET,cAEG,CACL,GAAGpc,EAAIwM,KAAKlH,IAAIi2C,EAAUC,GAtPJ,IAsPqC,CAMzD,QAAc,KAJdp/B,EAASq/B,EACLz7C,EAAGqZ,EAAM4B,EAAOyB,EAChBxB,EAAWC,EAASC,EAAMC,EAC1BC,EAAWC,EAASC,EAAMC,IAE5B,OAAOW,EAET,SACK,GAAGpc,EAAIu7C,EAAWC,EA/PF,GAAG,GA+PwB,CAMhD,QAAc,KAJdp/B,EAASgmB,EAAM3lB,cACbzc,EAAGqZ,EAAM4B,EAAOyB,EAChBxB,EAAUC,EAAQC,EAAKC,EACvBC,EAAWC,EAASC,EAAMC,IAE1B,OAAOW,EAET,UAKJ,IAAIs/B,EAAOC,EACT37C,EAAGqZ,EACH6B,EAAUC,EAAQC,EAAKC,EACvB2wB,EAAIC,GAGN,GAAG/wB,EAAWwgC,EAEZ,GAAG17C,GAAK07C,EAAOxgC,GAtRO,KA4RpB,QAAc,KAJdkB,EAASw/B,EACP57C,EAAGqZ,EAAK,EAAG4B,EACXC,EAAUwgC,EAAMtgC,EAAKC,EACrBC,EAAWC,EAASC,EAAMC,IAE1B,OAAOW,OAEJ,GAAG/C,IAASrZ,EAAE,GAYnB,QAAc,KAVZoc,EADCM,EACQ0lB,EAAMpnB,eACbhb,EAAGib,EACHK,EAAWC,EAASC,EAAMC,EAC1BP,EAAUwgC,EAAMtgC,EAAKC,GAEd+mB,EAAMpnB,eACbhb,EAAGib,EACHC,EAAUwgC,EAAMtgC,EAAKC,EACrBC,EAAWC,EAASC,EAAMC,IAG5B,OAAOW,OAGT8+B,EAASv9B,IACPtE,EAAK,EACL6B,EAAUwgC,EACVpgC,EAAWC,EACXmB,GACC7C,IAAUA,KACbqhC,EAASv9B,IACPtE,EAAK,EACLiC,EAAWC,EACXL,EAAUwgC,EACL,EAALh/B,GACC7C,IAAUA,KAKjB,GAAG6hC,EAAOvgC,EAAQ,CAQhB,IAAI0gC,EAAQC,EACV97C,EAAGqZ,EACHiC,EAAWC,EAASC,EAAMC,GACxBsgC,EAAMvgC,EAAKG,EAAWkgC,EAAQxiC,GAC9B2iC,EAAQC,EACVj8C,EAAGqZ,EACHwiC,EAAOtgC,EAASC,EAAMC,EACtBsgC,GAuBF,GApBGC,EAAQzgC,GACT2/B,EAASv9B,IACPtE,EACAqiC,EAAMvgC,EACN6gC,EAAOzgC,GACD,EAALmB,IAAWmwB,EAAO,GAAK,GACxBkP,EAAK9P,GAIN3wB,EAAYugC,GACbX,EAASv9B,IACPtE,EACAqiC,EAAMvgC,EACNG,EAAWugC,GACL,EAALn/B,IAAWmwB,EAAO,GAAK,GACxBb,EAAI+P,GAILF,EAAQ,IAAMG,GAaf,QAAc,KAVZ5/B,EADCywB,EACQqP,EACPl8C,EAAGqZ,EAAM4B,EACTygC,EAAMvgC,EAAQC,EAAKC,EACnBwgC,EAAOrgC,EAAMC,EAAUogC,IAEhBM,EACPn8C,EAAGqZ,EAAM4B,EAAOyB,EAChBg/B,EAAMvgC,EAAQC,EAAKC,EACnBwgC,EAAOrgC,EAAMC,EAAUogC,KAGzB,OAAOz/B,OAEJ,GAAGy/B,EAAQG,EAAO,CACvB,IAAII,EACJ,GAAGvP,GAMD,GAJAuP,EAAOC,EACLr8C,EAAGqZ,EACHqiC,EAAMvgC,EAAQC,EAAKC,EACnB0gC,GACCL,EAAOU,EAAM,CACd,IAAIE,EAAOL,EACTj8C,EAAGqZ,EACHqiC,EAAMU,EAAMhhC,EAAKC,EACjB0gC,GACF,GAAG1iC,IAASrZ,EAAE,EAAG,CAGf,GAAG07C,EAAOY,QAKM,KAJdlgC,EAASgmB,EAAM9lB,cACbtc,EAAGib,EACHygC,EAAMY,EAAMlhC,EAAKC,EACjBwgC,EAAOG,EAAOxgC,EAAMC,IAEpB,OAAOW,EAMX,GAAGkgC,EAAOF,QAKM,KAJdhgC,EAASgmB,EAAMpnB,eACbhb,EAAGib,EACHqhC,EAAMF,EAAMhhC,EAAKC,EACjBwgC,EAAOG,EAAOxgC,EAAMC,IAEpB,OAAOW,OAIRs/B,EAAOY,GACRpB,EAASv9B,IACPtE,EAAK,EACLqiC,EAAMY,EACNT,EAAOG,EACP,IACCniC,IAAUA,KAEZyiC,EAAOF,IACRlB,EAASv9B,IACPtE,EAAK,EACLijC,EAAMF,EACNP,EAAOG,EACP,GACCniC,IAAUA,KACbqhC,EAASv9B,IACPtE,EAAK,EACLwiC,EAAOG,EACPM,EAAMF,EACN,GACCviC,IAAUA,YAMjBuiC,EADC1/B,EACM6/B,EACLv8C,EAAGqZ,EACHqiC,EAAMvgC,EAAQC,EAAKC,EACnB0gC,GAEKM,EACLr8C,EAAGqZ,EACHqiC,EAAMvgC,EAAQC,EAAKC,EACnB0gC,GAEDL,EAAOU,IACL/iC,IAASrZ,EAAE,EAEVoc,EADCM,EACQ0lB,EAAMpnB,eACbhb,EAAGib,EACH4gC,EAAOG,EAAOxgC,EAAMC,EACpBigC,EAAMU,EAAMhhC,EAAKC,GAEV+mB,EAAMpnB,eACbhb,EAAGib,EACHygC,EAAMU,EAAMhhC,EAAKC,EACjBwgC,EAAOG,EAAOxgC,EAAMC,IAGxBy/B,EAASv9B,IACPtE,EAAK,EACLqiC,EAAMU,EACNP,EAAOG,EACPt/B,GACC7C,IAAUA,KACbqhC,EAASv9B,IACPtE,EAAK,EACLwiC,EAAOG,EACPN,EAAMU,EACD,EAAL1/B,GACC7C,IAAUA,YAle3B,IAAIW,EAAO,EAAQ,IACfpK,EAAO,EAAQ,KACfosC,EAAa,EAAQ,KACrBf,EAAoBe,EAAWC,QAC/Bb,EAAiBY,EAAW3P,KAC5BzK,EAAQ,EAAQ,KAChB0Z,EAAa,EAAQ,KACrBY,EAAe,EAAQ,KAQvBf,EAAoCe,EACtC,uBACA,CAAC,KAAM,OAELT,EAAsBS,EACxB,UACA,CAAC,OAECrB,EAAyBqB,EAC3B,QACA,CAAC,OAECpB,EAA4BoB,EAC9B,SACA,CAAC,OAECL,EAAyBK,EAC3B,iBACA,CAAC,OAECH,EAA+BG,EACjC,gBACA,CAAC,OAQC5B,EAActgC,EAAKzH,YADH,MAEhBioC,EAAcxgC,EAAKrH,aAFH,MAoBpB,SAAS+nC,EAASx/B,EAChBrC,EACA6B,EAAUC,EACVG,EAAWC,EACX3R,EACAoiC,EAAIC,GAEJ,IAAIkP,EA/BY,EA+BSz/B,EACzBo/B,EAAWK,GAAU9hC,EACrByhC,EAAWK,EAAK,GAAKjgC,EACrB4/B,EAAWK,EAAK,GAAKhgC,EACrB2/B,EAAWK,EAAK,GAAK7/B,EACrBw/B,EAAWK,EAAK,GAAK5/B,EACrBu/B,EAAWK,EAAK,GAAKvxC,EAErB,IAAIwxC,EAtCY,EAsCS1/B,EACzBs/B,EAAWI,GAAUpP,EACrBgP,EAAWI,EAAK,GAAKnP,EAIvB,SAASkQ,EACPn8C,EAAGqZ,EAAM4B,EAAOyB,EAChBxB,EAAUC,EAAQC,EAAKC,EACvBU,EAAYP,EAAMsB,GAElB,IAAInB,EAAW,EAAI3b,EACf+c,EAAWhB,EAAaJ,EACxBghC,EAAWnhC,EAAKuB,EAAU1D,GAEhC6D,EACE,IAAI,IAAIrhB,EAAEqf,EAAUkC,EAAOlC,EAASS,EAAU9f,EAAEsf,IAAUtf,EAAGuhB,GAAQzB,EAAU,CAC7E,IAAIihC,EAAKxhC,EAAIgC,EAAO/D,GAChBwjC,EAAKzhC,EAAIgC,EAAO/D,EAAKrZ,GACzB,KAAG28C,EAAQC,GAAMC,EAAKF,MAGnBjgC,GAAQigC,IAAUC,GAArB,CAIA,IADA,IAUIxgC,EAVAkB,EAAQjC,EAASxf,GACbkB,EAAEsc,EAAK,EAAGtc,EAAEiD,IAAKjD,EAAG,CACtB6/C,EAAKxhC,EAAIgC,EAAOrgB,GAChB8/C,EAAKzhC,EAAIgC,EAAOrgB,EAAEiD,GADtB,IAEIgd,EAAKxB,EAAKuB,EAAQhgB,GAClBkgB,EAAKzB,EAAKuB,EAAQhgB,EAAEiD,GACxB,GAAG68C,EAAK7/B,GAAMC,EAAK2/B,EACjB,SAAS1/B,EASb,QAAc,KAJZd,EADCM,EACQzB,EAAM6B,EAAQQ,GAEdrC,EAAMqC,EAAOR,IAGtB,OAAOV,IAMb,SAAS8/B,EACPl8C,EAAGqZ,EAAM4B,EACTC,EAAUC,EAAQC,EAAKC,EACvBU,EAAYP,EAAMsB,GAElB,IAAInB,EAAW,EAAI3b,EACf+c,EAAWhB,EAAaJ,EACxBghC,EAAWnhC,EAAKuB,EAAU1D,GAEhC6D,EACE,IAAI,IAAIrhB,EAAEqf,EAAUkC,EAAOlC,EAASS,EAAU9f,EAAEsf,IAAUtf,EAAGuhB,GAAQzB,EAAU,CAC7E,IAAI2B,EAAQjC,EAASxf,GACrB,GAAGyhB,IAAUR,EAAb,CAGA,IAAI8/B,EAAKxhC,EAAIgC,EAAO/D,GAChBwjC,EAAKzhC,EAAIgC,EAAO/D,EAAKrZ,GACzB,KAAG28C,EAAQC,GAAMC,EAAKF,GAAtB,CAGA,IAAI,IAAI5/C,EAAEsc,EAAK,EAAGtc,EAAEiD,IAAKjD,EAAG,CACtB6/C,EAAKxhC,EAAIgC,EAAOrgB,GAChB8/C,EAAKzhC,EAAIgC,EAAOrgB,EAAEiD,GADtB,IAEIgd,EAAKxB,EAAKuB,EAAQhgB,GAClBkgB,EAAKzB,EAAKuB,EAAQhgB,EAAEiD,GACxB,GAAG68C,EAAK7/B,GAAMC,EAAK2/B,EACjB,SAAS1/B,EAGb,IAAId,EAASnB,EAAMqC,EAAOR,GAC1B,QAAc,IAAXV,EACD,OAAOA,O,6BChKb,IAuBI0gC,EAAO,CAvBO,IACA,KACA,KAKA,KACA,KACA,KACA,KAGA,KACA,KACA,KACA,MAkFlB,SAASC,EAAkBlQ,GACzB,IAAIjP,EAAW,cAAgBiP,EAAO,OAAS,WAC3C9N,EAAS,GACT/f,EAAQ89B,EAAKp7C,QACbmrC,GACF7tB,EAAM/hB,OAAO,EAAG,EApGF,MAuGhB,IAAIgQ,EAAO,CAAC,YAAc2wB,EAAW,IAAM5e,EAAMjS,OAAS,MAE1D,SAASiwC,EAAOC,EAAUvgC,GACxB,IAAI0kB,EAxER,SAA4B6b,EAAUvgC,EAAMmwB,GAC1C,IAAIjP,EAAW,cACZqf,EAAW,MAAQ,SACnBvgC,EAAO,OAAS,KAChBmwB,EAAO,OAAS,IAEf5/B,EAAO,CAAC,YAAa2wB,EAAU,IAAKkf,EAAK/vC,OAAQ,KACnD,OAvCc,KAuCK,MA5CL,IA4CuB,KAEnCmwC,EACF,mFAOEC,EACF,4DAIStQ,EAAO,kBAA4E,IAJ5F,YAqCF,OA9BGoQ,EACDhwC,EAAK5Q,KAAK6gD,EA1CI,IA0CkB,IAAKC,GAErClwC,EAAK5Q,KAAK8gD,EA5CI,IA4CmB,IAAKD,GAGrCrQ,EACD5/B,EAAK5Q,KAAK,6BACFqgB,EACRzP,EAAK5Q,KAAK,8BAEV4Q,EAAK5Q,KAAK,6BAGZ4Q,EAAK5Q,KAAK,0HAQPqgB,EACDzP,EAAK5Q,KAAK,SAEV4Q,EAAK5Q,KAAK,SAGZ4Q,EAAK5Q,KAAK,kCAEH,CACLkD,KAAMq+B,EACN3wB,KAAMA,EAAKF,KAAK,KAeNqwC,CAAmBH,EAAUvgC,EAAMmwB,GAC7C9N,EAAO1iC,KAAK+kC,EAAIn0B,MAChBA,EAAK5Q,KAAK,UAAY+kC,EAAI7hC,KAAO,IAAMu9C,EAAK/vC,OAAS,MAGvDE,EAAK5Q,KAAK,oBAGPwwC,GACDmQ,GAAO,GAAM,GACb/vC,EAAK5Q,KAAK,UACV2gD,GAAO,GAAO,KAEd/vC,EAAK5Q,KAAK,WACV2gD,GAAO,GAAM,GACb/vC,EAAK5Q,KAAK,UACV2gD,GAAO,GAAM,GACb/vC,EAAK5Q,KAAK,kBACV2gD,GAAO,GAAO,GACd/vC,EAAK5Q,KAAK,UACV2gD,GAAO,GAAO,GACd/vC,EAAK5Q,KAAK,MAEZ4Q,EAAK5Q,KAAK,YAAcuhC,GAExB,IAAIyf,EAAUte,EAAOhyB,KAAK,IAAME,EAAKF,KAAK,IAE1C,OADW,IAAIxF,SAAS81C,EACjBC,GAIThgD,EAAQm/C,QAAUM,GAAkB,GACpCz/C,EAAQuvC,KAAUkQ,GAAkB,I,6BC7IpCx/C,EAAOD,QAkCP,SAAoB0C,EAAGqZ,EAAM21B,EAAOC,EAAKtC,EAAOC,GAC9C,GAAGqC,GAAOD,EAAM,EACd,OAAOA,EAGT,IAAIhD,EAAWgD,EACX/C,EAAWgD,EACX8M,EAAa9M,EAAMD,IAAW,EAC9BrzB,EAAW,EAAE3b,EACbu9C,EAAWxB,EACXt7C,EAAWksC,EAAMhxB,EAASogC,EAAI1iC,GAElC,KAAM2yB,EAAKC,GAAI,CACb,GAAGA,EAAKD,EAzCc,EAyCY,CAChCsM,EAAct4C,EAAGqZ,EAAM2yB,EAAIC,EAAIU,EAAOC,GACtCnsC,EAAQksC,EAAMhxB,EAASogC,EAAI1iC,GAC3B,MAIF,IAAIhQ,EAAS4iC,EAAKD,EACdwR,EAAUhxC,KAAK9F,SAAS2C,EAAM2iC,EAAI,EAClCyR,EAAS9Q,EAAMhxB,EAAS6hC,EAASnkC,GACjCqkC,EAAUlxC,KAAK9F,SAAS2C,EAAM2iC,EAAI,EAClC2R,EAAShR,EAAMhxB,EAAS+hC,EAASrkC,GACjCukC,EAAUpxC,KAAK9F,SAAS2C,EAAM2iC,EAAI,EAClC6R,EAASlR,EAAMhxB,EAASiiC,EAASvkC,GAClCokC,GAAUE,EACRE,GAAUF,GACXJ,EAAQG,EACRj9C,EAAQk9C,GACAF,GAAUI,GAClBN,EAAQC,EACR/8C,EAAQg9C,IAERF,EAAQK,EACRn9C,EAAQo9C,GAGPF,GAAUE,GACXN,EAAQG,EACRj9C,EAAQk9C,GACAE,GAAUJ,GAClBF,EAAQC,EACR/8C,EAAQg9C,IAERF,EAAQK,EACRn9C,EAAQo9C,GAOZ,IAFA,IAAIC,EAAOniC,GAAYswB,EAAG,GACtB8R,EAAOpiC,EAAW4hC,EACd1hD,EAAE,EAAGA,EAAE8f,IAAY9f,IAAKiiD,IAAQC,EAAM,CAC5C,IAAItmC,EAAIk1B,EAAMmR,GACdnR,EAAMmR,GAAQnR,EAAMoR,GACpBpR,EAAMoR,GAAQtmC,EAEhB,IAAI/T,EAAIkpC,EAAIX,EAAG,GACfW,EAAIX,EAAG,GAAKW,EAAI2Q,GAChB3Q,EAAI2Q,GAAS75C,EAGb65C,EAAQlC,EACNr7C,EAAGqZ,EACH2yB,EAAIC,EAAG,EAAGU,EAAOC,EACjBnsC,GAKF,IAFIq9C,EAAOniC,GAAYswB,EAAG,GACtB8R,EAAOpiC,EAAW4hC,EACd1hD,EAAE,EAAGA,EAAE8f,IAAY9f,IAAKiiD,IAAQC,EAAM,CACxCtmC,EAAIk1B,EAAMmR,GACdnR,EAAMmR,GAAQnR,EAAMoR,GACpBpR,EAAMoR,GAAQtmC,EAEZ/T,EAAIkpC,EAAIX,EAAG,GAKf,GAJAW,EAAIX,EAAG,GAAKW,EAAI2Q,GAChB3Q,EAAI2Q,GAAS75C,EAGVq4C,EAAMwB,EAAO,CAEd,IADAtR,EAAKsR,EAAM,EACLvR,EAAKC,GACTU,EAAMhxB,GAAUswB,EAAG,GAAG5yB,KAAU5Y,GAChCwrC,GAAM,EAERA,GAAM,MACD,MAAGsR,EAAQxB,GAOhB,MALA,IADA/P,EAAKuR,EAAQ,EACPvR,EAAKC,GACTU,EAAMhxB,EAASqwB,EAAG3yB,KAAU5Y,GAC5BurC,GAAM,GAQZ,OAAOqP,EACLr7C,EAAGqZ,EACH21B,EAAO+M,EAAKpP,EAAOC,EACnBD,EAAMhxB,EAASogC,EAAI1iC,KAxIvB,IAEIgiC,EAFe,EAAQ,IAEEqB,CAAa,QAAS,CAAC,OAKpD,SAASpE,EAAct4C,EAAGqZ,EAAM21B,EAAOC,EAAKtC,EAAOC,GAGjD,IAFA,IAAIjxB,EAAW,EAAI3b,EACfg+C,EAASriC,GAAYqzB,EAAM,GAAK31B,EAC5Bxd,EAAEmzC,EAAM,EAAGnzC,EAAEozC,IAAOpzC,EAAGmiD,GAAQriC,EAErC,IADA,IAAIlE,EAAIk1B,EAAMqR,GACNjhD,EAAElB,EAAG6f,EAAIC,GAAU9f,EAAE,GACzBkB,EAAEiyC,GAASrC,EAAMjxB,EAAIrC,GAAQ5B,IAC3B1a,EAAG2e,GAAKC,EAAU,CAItB,IAFA,IAAImiC,EAAOpiC,EACPqiC,EAAOriC,EAAIC,EACP0B,EAAE,EAAGA,EAAE1B,IAAY0B,IAAKygC,IAAQC,EAAM,CAC5C,IAAIr6C,EAAIipC,EAAMmR,GACdnR,EAAMmR,GAAQnR,EAAMoR,GACpBpR,EAAMoR,GAAQr6C,EAEhB,IAAIqzC,EAAMnK,EAAI7vC,GACd6vC,EAAI7vC,GAAK6vC,EAAI7vC,EAAE,GACf6vC,EAAI7vC,EAAE,GAAKg6C,K,oCC3BF,sBACX,MAAO,CAEHx3C,KAAM,iBAEN8M,MAAO,EAEPzC,MAAO,CACH8O,SAAU,MAGdpD,MAAO,SAAUC,EAAK3L,GAElB,IAAIuM,EAAOX,EAAIyoC,SACX9nC,EAAK+nC,WAAW3oC,KACLY,EAAKgoC,eAAe5oC,GAC1B8tB,UAAY,SAAuB+a,GACpC,IAAI/qB,EAAK7d,EAAIW,KAAKkoC,kBAAkB9oC,GAAKmD,SACrC2a,GAAIA,EAAG+qB,EAAS7oC,MAKhCG,SAAU,SAAUH,EAAK3L,GACrB,IAAIuM,EAAOX,EAAIyoC,SACX9nC,EAAK+nC,WAAW3oC,KAChBY,EAAKgoC,eAAe5oC,GAAK8tB,UAAY,U,oCCtBtC,sBACX,MAAO,CAEH9jC,KAAM,aAEN8M,MAAO,GAEPzC,MAAO,CACH00C,OAAQ,IACRC,UAAU,GAGdjpC,MAAO,KAEPI,SAAU,KAEVC,OAAQ,SAAwBC,EAAIC,GAChC,IAAI2oC,EAAOhpC,EAAIipC,OAAOC,YAClBvoC,EAAOX,EAAIyoC,SACfpoC,EAAO5O,QAAQ2C,KAQ3B,SAAmBA,EAAOmN,EAAIynC,EAAMroC,GAChC,IAAKA,EAAKwoC,QAAQ5nC,GAAK,OAEvB,GAAInN,EAAM20C,UAAYC,EAAO50C,EAAM00C,SAAW10C,EAAM20C,UAAYC,EAAO50C,EAAM00C,OAAQ,CACtEnoC,EAAKyoC,YAAY7nC,GAAI8nC,KAC3BC,WAAal1C,EAAM20C,SAAYC,EAAO50C,EAAM00C,QAZzCS,CAAUn1C,EAAOA,EAAMyM,KAAMmoC,EAAMroC,S,6BC1BnD,WAAI3H,EAAO,EAAQ,IAQJ,sBAEX,MAAO,CAEHjP,KAAM,gBAEN8M,MAAO,GAEPzC,MAAO,CACHo1C,OAAQ,EACRjxC,OAAQ,MAGZuH,MAAO,SAAUC,EAAK3L,GAClB,IAAI8B,EAAM8C,EAAK1N,SACf8I,EAAMmE,OAAUnE,EAAY,OAAI4E,EAAK7J,KAAK+G,EAAK9B,EAAMmE,QAAUrC,EAC/DuzC,EAAer1C,GACfs1C,EAAqBt1C,IAGzB8L,SAAU,KAIVC,OAAQ,SAAsBC,EAAIC,GAC9BA,EAAO5O,QAAQ2C,GAASq1C,EAAer1C,KAK3C+M,aAAc,SAA0Bf,EAAIC,GACxCA,EAAO5O,QAAQ2C,GAASs1C,EAAqBt1C,MAMrD,SAASq1C,EAAer1C,GACpB,IAAImN,EAAKnN,EAAMyM,KACX6d,EAAO1e,EAAIW,KAAKC,gBAAgBW,GAChCooC,EAAQ3pC,EAAIW,KAAKC,gBAAgBxM,EAAMo1C,QAC3C,IAAKG,EACD,OAAO3pC,EAAIW,KAAKkzB,gBAAgBtyB,EAAIvB,EAAIW,KAAKipC,MAAMC,eAEvD7wC,EAAKzJ,IAAImvB,EAAKhf,eAAgBiqC,EAAMjqC,eAAgBtL,EAAMmE,QAG9D,SAASmxC,EAAqBt1C,GAC1B,IAAImN,EAAKnN,EAAMyM,KACX6d,EAAO1e,EAAIW,KAAKC,gBAAgBW,GAChCooC,EAAQ3pC,EAAIW,KAAKC,gBAAgBxM,EAAMo1C,QAC3C,IAAKG,EACD,OAAO3pC,EAAIW,KAAKkzB,gBAAgBtyB,EAAIvB,EAAIW,KAAKipC,MAAMC,eAEvD7wC,EAAKzJ,IAAImvB,EAAK7e,gBAAiB8pC,EAAM9pC,gBAAiBzL,EAAMmE,W,oCC7DpE,IAAIS,EAAO,EAAQ,IAGJ,sBACX,MAAO,CAEHjP,KAAM,OAEN8M,MAAO,IAEPzC,MAAO,CACHi1C,KAAM,KACN9wC,OAAQ,MAIZuH,MAAO,SAAUC,EAAK3L,GAElB,IAAI01C,EAAS9pC,EAAIW,KAAKC,gBAAgBb,GACtC,IAAI3L,EAAMi1C,KAGN,MAAM,IAAIjgD,MAAM,yDAFhB4W,EAAI+pC,UAAUC,eAAe51C,EAAMi1C,MAAM,EAAOS,EAAOh0C,UAItD1B,EAAMmE,SAAQnE,EAAMmE,OAAS,IAAIS,EAAK1N,QAG3C,IAAI2+C,EAAOH,EAAOjqC,gBAClBzL,EAAMi1C,KAAKvzC,SAASo0C,eAChBD,EAAK,GAAK71C,EAAMmE,OAAO,GACvB0xC,EAAK,GAAK71C,EAAMmE,OAAO,GACvB0xC,EAAK,GAAK71C,EAAMmE,OAAO,KAI/B2H,SAAU,SAAUH,EAAK3L,GACrBA,EAAMi1C,KAAKc,WAKfhpC,aAAc,SAAUf,EAAIC,GAIxBA,EAAO5O,QAAQ2C,IACX,IAAImN,EAAKnN,EAAMyM,KAEXopC,EAAOjqC,EAAIW,KAAKC,gBAAgBW,GAAI1B,gBACxCzL,EAAMi1C,KAAKvzC,SAASo0C,eAChBD,EAAK,GAAK71C,EAAMmE,OAAO,GACvB0xC,EAAK,GAAK71C,EAAMmE,OAAO,GACvB0xC,EAAK,GAAK71C,EAAMmE,OAAO,U,6BCrD3C,WAAIS,EAAO,EAAQ,IAWJ,sBACX,MAAO,CAEHjP,KAAM,WAEN8M,MAAO,GAEPzC,MAAO,CAEHg2C,QAAS,EACTC,SAAS,EACTC,SAAS,EAGTC,SAAU,GACVC,UAAW,GACXC,eAAgB,GAChBC,gBAAiB,EACjBC,iBAAkB,EAElBC,YAAa,GACbC,YAAa,GACbC,UAAW,GACXC,SAAU,IACVC,SAAU,EAGVC,WAAY,EACZC,WAAY,EACZC,cAAe,GAGnBrrC,MAAO,KAEPI,SAAU,KAGVC,OAAQ,SAA2BC,EAAIC,GACnC,IAAIM,EAAOX,EAAIyoC,SAEfpoC,EAAO5O,QAAQ2C,IACX,IAAIpG,EAAO2S,EAAKgoC,eAAev0C,EAAMyM,OAgBrD,SAA8BT,EAAIhM,EAAOpG,GAMrC,IAAIo9C,EAAYp9C,EAAKwjC,UAAY,EAC7B6Z,EAAWD,GAAYh3C,EAAM62C,WAAa72C,EAAM42C,SAChDI,IACAh3C,EAAM82C,YAAa,EACnB92C,EAAM62C,WAAa,GAIvB,GAAI72C,EAAMk2C,QACN,GAAIl2C,EAAM82C,YACN,GAAI92C,EAAM+2C,cAAgB,EAAG,CACzB,IAAIG,EAAKl3C,EAAM02C,UACX12C,EAAM+2C,cAAgB/qC,IAAIkrC,GAAMl3C,EAAM+2C,cAAgB/qC,GAC1DpS,EAAKmhC,WAAW,CAAC,EAAGmc,EAAI,IACxBl3C,EAAM+2C,eAAiB/qC,QAEpBirC,IACPj3C,EAAM82C,YAAa,EACdE,GAAUh3C,EAAM62C,aACrB72C,EAAM+2C,cAAgB/2C,EAAM22C,SAC5B/8C,EAAK0iC,aAAa,CAAC,EAAGt8B,EAAMy2C,YAAa,KAEpCO,GAAYp9C,EAAK+T,SAAS,GAAK,IAAG/T,EAAK+T,SAAS,GAAK,SAG9D3N,EAAM82C,YAAa,EAIvB,IAAI5gD,EAAIihD,EACJ1kD,EAAO2kD,EACX,GAAIp3C,EAAMi2C,QAAS,CAEf,IAAIoB,EAAQr3C,EAAMm2C,SAIlBvxC,EAAK5J,IAAI9E,EAAG,EAAG,EAAGmhD,GAGlBzyC,EAAKzH,QAAQjH,EAAGA,EAAGohD,EAASt3C,EAAMg2C,SAKlCpxC,EAAKxJ,SAAS3I,EAAMyD,EAAG0D,EAAK+T,UAC5Blb,EAAK,GAAK,EACV,IAAI8kD,EAAU3yC,EAAKzS,OAAOM,GAG1B,GAFAmS,EAAKlI,UAAUjK,EAAMA,GAEjB8kD,EAAU,EAAG,CAEb,IAAIC,EAAUx3C,EAAMo2C,UACfY,IAAUQ,GAAWx3C,EAAMw2C,aAGhC,IAAIiB,EAAUz3C,EAAMq2C,eAAiBkB,EACjCC,EAAUC,IAASD,EAAUC,GAEjC7yC,EAAK7I,MAAMtJ,EAAMA,EAAM+kD,GACvB59C,EAAKmhC,WAAWtoC,GAKpBmH,EAAK0/B,SAAWt5B,EAAMs2C,qBAEtB18C,EAAK0/B,SAAWt5B,EAAMu2C,iBAxFdmB,CAAqB1rC,EAAIhM,EAAOpG,QAUhD,IAAIu9C,EAAUvyC,EAAK1N,SACfkgD,EAAWxyC,EAAK1N,SAChBogD,EAAU1yC,EAAK1N,U,oCCxDJ,sBACX,MAAO,CAEHvB,KAAM,iBAEN8M,MAAO,GAEPzC,MAAO,GAEP0L,MAAO,KAEPI,SAAU,KAEVC,OAAQ,SAAwBC,EAAIC,GAChC,IAAIM,EAAOX,EAAIyoC,SACXsD,EAAa/rC,EAAIkrB,OAAO92B,MACxB43C,EAAahsC,EAAIipC,OAAOmB,QAE5B/pC,EAAO5O,QAAQ2C,KAW3B,SAA0BA,EAAO82B,EAAQ8gB,GACrC53C,EAAMk2C,UAAYpf,EAAO+gB,KAEzB,IAAIC,EAAKhhB,EAAOihB,QAAWjhB,EAAOkhB,SAAW,EAAI,EAAMlhB,EAAOkhB,UAAY,EAAI,EAC1EC,EAAKnhB,EAAOxU,MAASwU,EAAOxmB,KAAO,EAAI,EAAMwmB,EAAOxmB,MAAQ,EAAI,EAElD,IAAbwnC,EAAKG,GACNj4C,EAAMi2C,SAAU,GAEhBj2C,EAAMi2C,SAAU,EACZ6B,IACW,GAAPA,IAAUF,GAAch1C,KAAK0T,IAC7B2hC,IACAL,GAAch1C,KAAK0T,GAAK,EAAIwhC,EAAKG,IAGrCL,GAAcK,EAAKr1C,KAAK0T,GAAK,EAEjCtW,EAAMg2C,QAAU4B,GA3BRM,CADgB3rC,EAAK4rC,YAAYn4C,EAAMyM,MACXkrC,EAAYC,S,sDC1BpDhzC,EAAO,EAAQ,IAGJ,wBAEX,IAAIwzC,EAAal8C,EAGbm8C,EAAQzsC,EAAI+pC,UAAU2C,WACtBC,EAAO,IAAKC,WAAW,SAAU,IAAM,GAAIH,GAY/C,OAXAE,EAAKE,SAAS5qC,EAAIjL,KAAK0T,GAAK,EAC5BiiC,EAAKG,SAAW9sC,EAAI+pC,UAAUgD,qBAAqB,aACnDJ,EAAKG,SAASE,aAAe,IAAOC,QACpCN,EAAKG,SAASI,aAAe,IAAOD,QACpCN,EAAKG,SAASK,MAAQ,GACtBR,EAAKS,YAAW,GAGhBX,EAAMY,WAAWV,GAGV,CAEH5iD,KAAM,SAEN8M,MAAO,GAEPzC,MAAO,CACH6kC,KAAM,GACNqU,MAAO,MAIXxtC,MAAO,SAAUC,EAAK3L,GAClB,IAAIi1C,EAAOsD,EAAKY,eAAe,mBAC/BvtC,EAAI+pC,UAAUC,eAAeX,GAC7BA,EAAK+D,YAAW,GAChBh5C,EAAMk5C,MAAQjE,GAIlBnpC,SAAU,SAAUH,EAAK3L,GACrBA,EAAMk5C,MAAMnD,WAIhBhqC,OAAQ,SAAsBC,EAAIC,GAC9B,IAAImtC,EAAOxtC,EAAIipC,OAAOwE,oBAClBn9C,EAAOk8C,EACXnsC,EAAO5O,QAAQ2C,IACX,IAAIwN,EAAW5B,EAAIW,KAAKC,gBAAgBxM,EAAMyM,MAC1Cc,EAAY3B,EAAIW,KAAK+sC,WAAWt5C,EAAMyM,OAyB1D,SAA4Bb,EAAK8pC,EAAQ6D,EAAStE,EAAMpQ,EAAMuT,EAAYoB,GAGtE,IAAIC,EACJ,GAAIF,GAAWA,EAAQ3/C,KAAKigC,QAAQ,GAAK,EACrC4f,EAAS/D,EAAOpqC,eAAe,OAC5B,CACH,IAAIksB,EAAM5rB,EAAI8tC,WAAWhE,EAAOpqC,eAAgB+R,EAAM+6B,GACtD,IAAK5gB,EAED,YADAyd,EAAK+D,YAAW,GAGpBS,EAASjiB,EAAI91B,SAAS,GAAKkK,EAAIM,kBAAkB,GAIrDutC,EAAS72C,KAAK9G,MAAM29C,GACpB70C,EAAK7J,KAAK4+C,EAAWjE,EAAOpqC,gBAC5BquC,EAAU,GAAKF,EACf,IAEIt1C,EAAS,IAFAS,EAAKzI,gBAAgBq9C,EAAQG,GAEN,KAAhB,GAChBx1C,EAAS,KAAKA,EAAS,IAC3B8wC,EAAKvzC,SAAS5H,EAAI2/C,EAASt1C,EAE3B,IAAIjI,EAAOw5C,EAAOpqC,eAAe,GAAKmuC,EAClC19C,EAAe,GAAP8oC,GAAc,EAAI3oC,EAAOk8C,GACrCnD,EAAK2E,QAAQ9D,eAAe/5C,EAAOA,EAAOA,GAC1Ck5C,EAAK+D,YAAW,GApDJa,CAAmBjuC,EAAK4B,EAAUD,EAAWvN,EAAMk5C,MAAOl5C,EAAM6kC,KAAM3oC,EAAMk9C,MAKpFrsC,aAAc,SAAUf,EAAIC,GAExBA,EAAO5O,QAAQ2C,IACX,IAAI61C,EAAOjqC,EAAIW,KAAKC,gBAAgBxM,EAAMyM,MAAMhB,gBAC5CquC,EAAO95C,EAAMk5C,MAAMx3C,SACvBo4C,EAAKjsC,EAAIgoC,EAAK,GACdiE,EAAKhsC,EAAI+nC,EAAK,QAU9B,IAAI8D,EAAY/0C,EAAK9J,WAAW,EAAG,EAAG,GAClCuiB,EAAOzY,EAAK9J,WAAW,GAAI,EAAG,I,oCC3EnB,sBACX,MAAO,CAEHnF,KAAM,gBAEN8M,MAAO,GAEPzC,MAAO,CACH8oB,KAAM,OAGVpd,MAAO,KAEPI,SAAU,KAEVC,OAAQ,SAAUC,EAAIC,GAElBA,EAAO5O,QAAQ2C,IACXA,EAAM8oB,MAAQ9c,EACVhM,EAAM8oB,KAAO,GAAGld,EAAIW,KAAKkzB,gBAAgBz/B,EAAMyM,KAAM,uB,qoDCrBzE,IAAIjG,EAAO,EAAQ,KAEnB,SAASq+B,EAAKxvC,GAIZ,IAHA,IAEWkF,EAAG3G,EAFV6L,EAAQ,EACRs6C,EAAY1kD,EAAMlD,OAClBF,EAAI,EACFA,EAAEoD,EAAMlD,QAAQ,CAGpB,IAFAoI,EAAIlF,EAAMpD,GACV2B,EAAI,EACE3B,EAAI8nD,GAAa1kD,EAAMpD,KAAOsI,KAChCtI,IACA2B,EAEJ6L,GAAU+G,EAAK6B,KAAKzU,GAAK,EAAG,EAC5B6L,GAAU+G,EAAK6B,KAAK9N,IAAI,GAAK,EAAG,EAChCkF,GAAS,EAEX,OAAOA,EAET/L,EAAQmxC,KAAOA,EAmCfnxC,EAAQsmD,OAjCR,SAAgB3kD,EAAO4kD,GACjBA,IACFA,EAAO,IAAIvxC,WAAWm8B,EAAKxvC,KAI7B,IAFA,IACWkF,EAAG3G,EADVsmD,EAAO,EAAGC,EAAQF,EAAK9nD,OACvBF,EAAI,EACFA,EAAEoD,EAAMlD,QAAQ,CAGpB,IAFAoI,EAAIlF,EAAMpD,GACV2B,EAAI,EACE3B,EAAIoD,EAAMlD,QAAUkD,EAAMpD,KAAOsI,KACnCtI,IACA2B,EAEJ,KAAMsmD,EAAOC,GAASvmD,GAAK,KACzBqmD,EAAKC,KAAU,KAAS,IAAFtmD,GACtBA,KAAO,EAET,GAAGsmD,GAAQC,EACT,MAAM,IAAInlD,MAAM,uBAIlB,IAFAilD,EAAKC,KAAUtmD,EACf2G,KAAO,EACD2/C,EAAOC,GAAS5/C,GAAK,KACzB0/C,EAAKC,KAAU,KAAS,IAAF3/C,GACtBA,KAAO,EAET,GAAG2/C,GAAQC,EACT,MAAM,IAAInlD,MAAM,uBAElBilD,EAAKC,KAAU3/C,EAEjB,OAAO0/C,GAwCTvmD,EAAQ0mD,OApCR,SAAgBH,EAAM5kD,GAMpB,IALA,IAIIzB,EAAGL,EAAGgH,EAAGtI,EAJTooD,EAAUhlD,EAAMlD,OAChBgoD,EAAQF,EAAK9nD,OACbmoD,EAAO,EACPxoC,EAAM,EAEJA,EAAMqoC,GAAO,CAGjB,IAFAvmD,EAAI,EACJL,EAAI,EACEue,EAAMqoC,GAASF,EAAKnoC,IAAQ,KAChCle,IAAkB,IAAZqmD,EAAKnoC,OAAgBve,EAC3BA,GAAK,EAGP,GADAK,GAAKqmD,EAAKnoC,MAAUve,EACjBue,GAAOqoC,EACR,MAAM,IAAInlD,MAAM,uBAElB,GAAGslD,EAAO1mD,EAAIymD,EACZ,MAAM,IAAIrlD,MAAM,yBAIlB,IAFAuF,EAAI,EACJhH,EAAI,EACEue,EAAMqoC,GAASF,EAAKnoC,IAAQ,KAChCvX,IAAkB,IAAZ0/C,EAAKnoC,OAAgBve,EAC3BA,GAAK,EAEP,GAAGue,GAAOqoC,EACR,MAAM,IAAInlD,MAAM,uBAGlB,IADAuF,GAAK0/C,EAAKnoC,MAAUve,EAChBtB,EAAE,EAAGA,EAAE2B,IAAK3B,EACdoD,EAAMilD,KAAU//C,EAGpB,OAAOlF,I,6BCpBT,SAAS2e,EAAmBzZ,GAC1B,IAAIpE,EAAI,GAQR,OAPAoE,IAAMA,IACCpE,IACC,MAAJoE,IAAgBpE,GAAK,IACjB,SAAJoE,IAAgBpE,GAAK,GACjB,UAAJoE,IAAgBpE,GAAK,GACjB,UAAJoE,IAAgBpE,GAAK,GACjB,WAAJoE,IAAgBpE,GAAK,GAClBA,EAhETzC,EAAQugB,SAHO,GAIfvgB,EAAQwgB,QAAa,WACrBxgB,EAAQygB,SAAa,GAAG,GAGxBzgB,EAAQ0gB,KAAO,SAAS7Z,GACtB,OAAQA,EAAI,IAAMA,EAAI,IAIxB7G,EAAQmP,IAAM,SAAStI,GACrB,IAAI8Z,EAAO9Z,GAAK,GAChB,OAAQA,EAAI8Z,GAAQA,GAItB3gB,EAAQgI,IAAM,SAASmS,EAAG/T,GACxB,OAAOA,GAAM+T,EAAI/T,KAAO+T,EAAI/T,IAI9BpG,EAAQiI,IAAM,SAASkS,EAAG/T,GACxB,OAAO+T,GAAMA,EAAI/T,KAAO+T,EAAI/T,IAI9BpG,EAAQ4gB,OAAS,SAAS/Z,GACxB,QAASA,EAAKA,EAAE,IAAUA,IAI5B7G,EAAQ2U,KAAO,SAAS9N,GACtB,IAAI7D,EAAG9D,EAKP,OAJA8D,GAAS6D,EAAI,QAAW,EACiB7D,GAAzC9D,IAD2B2H,KAAO7D,GACrB,MAAW,EACiBA,GAAzC9D,IAD2B2H,KAAO3H,GACrB,KAAW,GACiB8D,GAAzC9D,IAD2B2H,KAAO3H,GACrB,IAAW,IAAG2H,KAAO3H,IACjB,GAInBc,EAAQ6gB,MAAQ,SAASha,GACvB,OAASA,GAAK,IAAc,EAAKA,GAAK,IAAa,EAAKA,GAAK,IAAY,EAChEA,GAAK,IAAW,EAAKA,GAAK,IAAU,EAAKA,GAAK,IAAS,EACvDA,GAAK,IAAQ,EAAKA,GAAK,IAAO,EAAKA,GAAK,GAAM,EAAI,GAI7D7G,EAAQ8gB,SAAW,SAASja,GAG1B,OAAsC,WADtCA,GAAS,WADTA,GAAUA,IAAM,EAAK,cACIA,IAAM,EAAK,aACtBA,IAAM,GAAK,aAA4B,IAevD7G,EAAQsgB,mBAAqBA,EAG7BtgB,EAAQ6U,SAAW,SAAShO,GAQ1B,OAPAA,GAAW,IAANA,IACHA,EACFA,GAAKA,IAAM,EACXA,GAAKA,IAAM,EACXA,GAAKA,IAAM,EACXA,GAAKA,IAAM,GACXA,GAAKA,IAAM,IACA,GAIb7G,EAAQ+gB,SAAW,SAASla,GAM1B,OALAA,GAAKA,IAAM,EACXA,GAAKA,IAAM,EACXA,GAAKA,IAAM,EACXA,GAAKA,IAAM,GACXA,GAAKA,IAAM,KACCA,IAAI,IAIlB7G,EAAQghB,OAAS,SAASna,GAKxB,OAJAA,GAAKA,IAAM,GACXA,GAAKA,IAAM,EACXA,GAAKA,IAAM,EAEH,SADRA,GAAK,IACmB,GAG1B,IAAIoa,EAAgB,IAAIxc,MAAM,MAE9B,SAAUyc,GACR,IAAI,IAAI3iB,EAAE,EAAGA,EAAE,MAAOA,EAAG,CACvB,IAAIsI,EAAItI,EAAGyE,EAAIzE,EAAGsB,EAAI,EACtB,IAAKgH,KAAO,EAAGA,EAAGA,KAAO,EACvB7D,IAAM,EACNA,GAAS,EAAJ6D,IACHhH,EAEJqhB,EAAI3iB,GAAMyE,GAAKnD,EAAK,KARxB,CAUGohB,GAGHjhB,EAAQmhB,QAAU,SAASta,GACzB,OAASoa,EAA2B,IAAZpa,IAAqB,GACpCoa,EAAepa,IAAM,EAAM,MAAS,GACpCoa,EAAepa,IAAM,GAAM,MAAS,EACpCoa,EAAepa,IAAM,GAAM,MAItC7G,EAAQohB,YAAc,SAASjH,EAAG/T,GAahC,OARA+T,EAAqB,aADrBA,EAAqB,YADrBA,EAAqB,YADrBA,EAAqB,WADrBA,GAAK,OACKA,GAAK,IACLA,GAAK,IACLA,GAAK,IACLA,GAAK,KAMf/T,EAAqB,aADrBA,EAAqB,YADrBA,EAAqB,YADrBA,EAAqB,WADrBA,GAAK,OACKA,GAAK,IACLA,GAAK,IACLA,GAAK,IACLA,GAAK,KAEE,GAInBpG,EAAQqhB,cAAgB,SAASxa,EAAGlD,GAMlC,OADAkD,EAAuB,QADvBA,EAAuB,WADvBA,EAAuB,YADvBA,EAAuB,YADvBA,EAAKA,IAAMlD,EAAK,YACNkD,IAAM,IACNA,IAAM,IACNA,IAAM,IACNA,IAAM,MACH,IAAO,IAKtB7G,EAAQshB,YAAc,SAASnH,EAAG/T,EAAGgU,GAoBnC,OAfAD,EAAqB,aADrBA,EAAqB,aADrBA,EAAqB,YADrBA,EAAqB,aADrBA,GAAK,MACMA,GAAG,KACHA,GAAG,IACHA,GAAG,IACHA,GAAG,IAOdA,IADA/T,EAAqB,aADrBA,EAAqB,aADrBA,EAAqB,YADrBA,EAAqB,aADrBA,GAAK,MACMA,GAAG,KACHA,GAAG,IACHA,GAAG,IACHA,GAAG,KACH,IAMXgU,EAAqB,aADrBA,EAAqB,aADrBA,EAAqB,YADrBA,EAAqB,aADrBA,GAAK,MACMA,GAAG,KACHA,GAAG,IACHA,GAAG,IACHA,GAAG,KAEG,GAInBpa,EAAQuhB,cAAgB,SAAS1a,EAAGlD,GAMlC,OADAkD,EAAsB,OADtBA,EAAsB,aADtBA,EAAsB,YADtBA,EAAsB,aADtBA,EAAKA,IAAMlD,EAAW,YACZkD,IAAI,IACJA,IAAI,IACJA,IAAI,IACJA,IAAI,MACH,IAAK,IAIlB7G,EAAQwhB,gBAAkB,SAAS3a,GACjC,IAAIzD,EAAIyD,EAAKA,EAAI,EACjB,OAAQzD,EAAI,IAASA,IAAMA,GAAK,IAAQkd,EAAmBzZ,GAAK,I,oCCxMlE,IAAIggD,EAAkB,EAAQ,KAE1Bp8C,EAAe,EAAQ,IAAUA,aAerC,SAASq8C,EAAU5uC,EAAKuZ,GACpBA,EAAOA,GAAQ,GACf7sB,KAAKmiD,KAAO7uC,EACZtT,KAAK2iB,QAAUkK,EAAKyS,YA2ExB,WAEI,IAAIzV,EAAY7tB,SAASC,cAAc,OAavC,OAZA4tB,EAAUC,SAAW,EACrBD,EAAUE,MAAM3gB,SAAW,QAC3BygB,EAAUE,MAAM/R,KAAO,MACvB6R,EAAUE,MAAMC,MAAQ,MACxBH,EAAUE,MAAMtO,IAAM,MACtBoO,EAAUE,MAAME,OAAS,MACzBJ,EAAUE,MAAMjd,OAAS,OACzB+c,EAAUE,MAAMG,SAAW,SAC3BluB,SAASsF,KAAK5D,YAAYmsB,GAC1B7tB,SAASsF,KAAKyoB,MAAMG,SAAW,SAC/BluB,SAASsF,KAAKyoB,MAAMjd,OAAS,OAC7B+c,EAAUhV,GAAK,gBACRgV,EA1F2Bu4B,GAClCpiD,KAAKqiD,OAyGT,SAA2BC,GAEvB,IAAID,EAASC,EAAG73B,cAAc,UACzB43B,KACDA,EAASrmD,SAASC,cAAc,WACzB8tB,MAAM3gB,SAAW,WACxBi5C,EAAOt4B,MAAM/R,KAAO,MACpBqqC,EAAOt4B,MAAMtO,IAAM,MACnB4mC,EAAOt4B,MAAMjd,OAAS,OACtBu1C,EAAOt4B,MAAMld,MAAQ,OACrBw1C,EAAOxtC,GAAK,aACZytC,EAAGC,aAAaF,EAAQC,EAAGE,aAE/B,OAAOH,EAtHOI,CAAkBziD,KAAK2iB,SACrC3iB,KAAK0iD,OA4FT,SAAqBL,EAAQx1B,IAKzBA,EAAO/yB,OAAOqG,OAJM,CAChBmqB,aAAa,EACb7H,iBAAiB,GAEeoK,IAC/BlK,QAAU0/B,EACf,IAAIv+B,EAAQm+B,EAAgBp1B,GAE5B,OADA/I,EAAMrB,gBAAkBoK,EAAKpK,gBACtBqB,EArGO6+B,CAAY3iD,KAAKqiD,OAAQx1B,GAGvC7sB,KAAK4iD,gBAAiB,EACtB5iD,KAAK6iD,qBAAsB,EAC3B7iD,KAAK8iD,eAAgB,EACrB9iD,KAAK4nB,UAAY5rB,SAAS+mD,WAG1B,IAAI/wB,EAAOhyB,KACPgjD,EAAa,SAAU77B,IAgH/B,SAAsB6K,EAAM7K,GACxB,IAAIm7B,EAAKtmD,SAASwqB,oBACdxqB,SAASyqB,uBACTzqB,SAAS0qB,yBACT47B,GACAtwB,EAAK4wB,gBAAiB,EACtB5wB,EAAKnrB,KAAK,uBAEVmrB,EAAK4wB,gBAAiB,EACtB5wB,EAAKnrB,KAAK,oBAIVy7C,IAEAtwB,EAAK8wB,eAAgB,GA/HQrjB,CAAazN,IAC9Ch2B,SAASivB,iBAAiB,oBAAqB+3B,GAAY,GAC3DhnD,SAASivB,iBAAiB,uBAAwB+3B,GAAY,GAC9DhnD,SAASivB,iBAAiB,0BAA2B+3B,GAAY,GAqIrE,SAA2BhxB,GAKvB,GAHK,uBAAwBh2B,UACxB,0BAA2BA,UAC3B,6BAA8BA,SACZ,CACnBg2B,EAAK6wB,qBAAsB,EAC3B,IAAIz8C,EAAW,SAAU7K,GACrBy2B,EAAK6wB,qBAAsB,EAC3B7mD,SAASw4B,oBAAoBj5B,EAAE0B,KAAMmJ,IAEzCpK,SAASivB,iBAAiB,YAAa7kB,IA/I3C68C,CAAkBjxB,GAElBA,EAAKrP,QAAQsI,iBAAiB,cAAc,WAAc+G,EAAK8wB,eAAgB,KAC/E9wB,EAAKrP,QAAQsI,iBAAiB,cAAc,WAAc+G,EAAK8wB,eAAgB,KAE/ExjD,OAAO2rB,iBAAiB,SAAS,WAAc+G,EAAKpK,WAAY,KAChEtoB,OAAO2rB,iBAAiB,QAAQ,WAAc+G,EAAKpK,WAAY,KAG/D5nB,KAAK0iD,OAAO35C,GAAG,OAAQm6C,EAAYpkD,KAAK,KAAMkB,OAWlD,SAASkjD,EAAYlxB,GAEjB,IAAI1e,EAAM0e,EAAKmwB,KACXr+B,EAAQkO,EAAK0wB,OACjB5+B,EAAM/a,GAAG,QAAQ,SAAgBhK,GAAKuU,EAAI0T,KAAKjoB,MAC/C+kB,EAAM/a,GAAG,UAAU,SAAkBhK,GAAKuU,EAAI2T,OAAOloB,MACrD+kB,EAAM/a,GAAG,SAAUuK,EAAI+pC,UAAU8F,OAAOrkD,KAAKwU,EAAI+pC,YAGjDrrB,EAAKnrB,KAAK,YC/DP,SAASu8C,EAAwBj6C,EAAMqS,GAC1C,IAAI7hB,EAAIwP,EAAK8T,QAAQzB,GACjB7hB,EAAI,IACJA,IAAMwP,EAAKtP,OAAS,EACpBsP,EAAK/G,MAEL+G,EAAKxP,GAAKwP,EAAK/G,OAOhB,SAASihD,EAAYC,EAAa9sC,EAAUwM,GAG/C,IAFA,IAAIo5B,GAAUp5B,GAAaya,YAAYC,OAAS4lB,EAEvC3pD,EAAI,EAAGA,EADF,IACeA,IAAK,CAE9B,GADU6c,KACCinB,YAAYC,MAAQ0e,EAAQ,QD4B/C8F,EAAUnoD,UAAYD,OAAO8E,OAAOiH,EAAa9L,WA0BjDmoD,EAAUnoD,UAAUwpD,SAAW,SAAUC,GACrCxjD,KAAK2iB,QAAQjlB,YAAY8lD,IAK7BtB,EAAUnoD,UAAU0pD,eAAiB,SAAUC,GAE3C1jD,KAAK0iD,OAAOp4B,cAAgBo5B,GCtChC,IAAIC,EAAU,EAAGC,EAAa,EAQvB,SAASC,EAAoBvnD,EAAKooC,EAAKn4B,EAAKggC,EAAMuX,GACjDxnD,EAQR,SAAuBA,EAAKooC,EAAKqf,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,GAC7D,IAAK,IAAI5qD,EAAI,EAAGA,EAAIuqD,EAAIvqD,IACpB,IAAK,IAAIkB,EAAI,EAAGA,EAAIspD,EAAItpD,IAGpB,IAFA,IAAI2pD,EAAMloD,EAAIgN,MAAMy6C,EAAKpqD,EAAGqqD,EAAKnpD,EAAGopD,GAChCQ,EAAM/f,EAAIp7B,MAAM+6C,EAAK1qD,EAAG2qD,EAAKzpD,EAAG0pD,GAC3BppC,EAAI,EAAGA,EAAIipC,EAAIjpC,IACpBupB,EAAIrrC,KAAKorD,GAAOnoD,EAAIjD,KAAKmrD,GACzBA,GAAOloD,EAAI8N,OAAO,GAClBq6C,GAAO/f,EAAIt6B,OAAO,GAf1Bs6C,CAAcpoD,EAAKooC,EAAKn4B,EAAI,GAAIA,EAAI,GAAIA,EAAI,GACxCggC,EAAK,GAAIA,EAAK,GAAIA,EAAK,GAAIuX,EAAO,GAAIA,EAAO,GAAIA,EAAO,IAoBpE,SAAuBpf,EAAKqf,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,GAC5C,IAAK,IAAIzqD,EAAI,EAAGA,EAAIuqD,EAAIvqD,IACpB,IAAK,IAAIkB,EAAI,EAAGA,EAAIspD,EAAItpD,IAEpB,IADA,IAAI4jB,EAAKimB,EAAIp7B,MAAMy6C,EAAKpqD,EAAGqqD,EAAKnpD,EAAGopD,GAC1B9oC,EAAI,EAAGA,EAAIipC,EAAIjpC,IACpBupB,EAAIrrC,KAAKolB,GAAM,EACfA,GAAMimB,EAAIt6B,OAAO,GAxBzBu6C,CAAcjgB,EAAKof,EAAO,GAAIA,EAAO,GAAIA,EAAO,GAC5CvX,EAAK,GAAIA,EAAK,GAAIA,EAAK,IAyC5B,SAASqY,IACZ5kD,KAAK+H,IAAM,GACX/H,KAAKmuB,KAAO,GAEhBy2B,EAAW7qD,UAAU62C,SAAW,SAAU/xC,GACtC,OAAOmB,KAAKmuB,KAAKtvB,IAErB+lD,EAAW7qD,UAAU8I,IAAM,SAAUhE,GAC7BmB,KAAKmuB,KAAKtvB,KACdmB,KAAK+H,IAAI5N,KAAK0E,GACdmB,KAAKmuB,KAAKtvB,IAAO,IAErB+lD,EAAW7qD,UAAUisC,OAAS,SAAUnnC,GAC/BmB,KAAKmuB,KAAKtvB,KACfmB,KAAK+H,IAAIhN,OAAOiF,KAAK+H,IAAIkV,QAAQpe,GAAM,UAChCmB,KAAKmuB,KAAKtvB,KAErB+lD,EAAW7qD,UAAUoN,MAAQ,WAAc,OAAOnH,KAAK+H,IAAIlO,QAC3D+qD,EAAW7qD,UAAUgL,QAAU,SAAUmF,EAAGxK,GAAK,OAAOM,KAAK+H,IAAIhD,QAAQmF,EAAGxK,IAC5EklD,EAAW7qD,UAAUyF,MAAQ,SAAU0K,EAAGxK,GAAK,OAAOM,KAAK+H,IAAIvI,MAAM0K,EAAGxK,IACxEklD,EAAW7qD,UAAU8qD,QAAU,WAAc,OAA4B,IAApB7kD,KAAK+H,IAAIlO,QAC9D+qD,EAAW7qD,UAAU+qD,MAAQ,WACzB9kD,KAAK+H,IAAIlO,OAAS,EAClBmG,KAAKmuB,KAAO,IAEhBy2B,EAAW7qD,UAAUqI,IAAM,WACvB,IAAIvD,EAAMmB,KAAK+H,IAAI3F,MAEnB,cADOpC,KAAKmuB,KAAKtvB,GACVA,GAEX+lD,EAAW7qD,UAAUyQ,KAAO,SAAUu6C,GAClC,IAAIC,EAAU,GACdhlD,KAAK+H,IAAIhD,QAAQlG,IAASmmD,EAAQnmD,GAAOkmD,EAAgBlmD,KACzDmB,KAAK+H,IAAIyC,KAAK,CAACN,EAAGxK,IAAMslD,EAAQtlD,GAAKslD,EAAQ96C,KAEjD06C,EAAW7qD,UAAUkrD,SAAW,SAAU97C,GACtCnJ,KAAK+H,IAAMoB,EAAKpB,IAAIvI,QACpBQ,KAAKmuB,KAAOr0B,OAAOqG,OAAO,GAAIgJ,EAAKglB,O,oFCzInC+2B,G,OAAS,EAAQ,KA4BjB3kB,EAAW,CACX4kB,SAAS,EACTC,WAAW,EACXC,WAAY,CAAC,GAAK,GAAK,GACvB7E,aAAc,CAAC,EAAG,EAAG,GACrB8E,aAAc,CAAC,EAAG,EAAG,GACrBC,cAAe,CAAC,EAAG,EAAG,GACtBC,iBAAkB,CAAC,GAAK,GAAK,IAC7BC,OAAO,EACPC,cAAe,CAAC,IAAM,GAAK,IAC3BC,oBAAqB,EACrBC,uBAAuB,GAW3B,SAASC,EAAUvyC,EAAKuZ,EAAMw1B,GAC1BriD,KAAKsT,IAAMA,EAoBXuZ,EAAO/yB,OAAOqG,OAAO,GAAIogC,EAAU1T,GAGnC7sB,KAAKylD,QAAU54B,EAAK44B,MACpBzlD,KAAK8lD,OAASj5B,EAAK64B,cACnB1lD,KAAK+lD,SAAWl5B,EAAK84B,oBACrB3lD,KAAKgmD,kBAAoB,EACzBhmD,KAAKimD,gBAAkB,IAW3B,SAAmBj0B,EAAMqwB,EAAQx1B,GAG7BmF,EAAKk0B,QAAU,IAAI,IAAO7D,EAAQx1B,EAAKu4B,UAAW,CAC9CQ,sBAAuB/4B,EAAK+4B,wBAEhC5zB,EAAKm0B,OAAS,IAAI,IAAMn0B,EAAKk0B,SAC7B,IAAInG,EAAQ/tB,EAAKm0B,OAEjBpG,EAAMqG,gBAGNrG,EAAMsG,cAAc,IAAI,IAAqBtG,IAC7C/tB,EAAKs0B,QAAU,IAAI,IAAOC,OAC1Bv0B,EAAKs0B,QAAQE,OAAS,GACtBzG,EAAM0G,iBAAmBz0B,EAAKs0B,QAG9Bt0B,EAAK00B,cAAgB,IAAI,IAAK,YAAa3G,GAC3C/tB,EAAK20B,QAAU,IAAI,IAAW,SAAU,IAAI,IAAQ,EAAG,EAAG,GAAI5G,GAC9D/tB,EAAK20B,QAAQC,OAAS50B,EAAK00B,cAC3B10B,EAAK20B,QAAQE,KAAO,IACpB70B,EAAK00B,cAAc9J,YAAa,EAGhC5qB,EAAK80B,WAAa,IAAKC,YAAY,YAAa,GAAIhH,GACpD/tB,EAAKsrB,eAAetrB,EAAK80B,YACzB90B,EAAK80B,WAAW19C,SAASoM,EAAI,GAC7Bwc,EAAK80B,WAAWF,OAAS50B,EAAK20B,QAC9B30B,EAAKg1B,cAAgBh1B,EAAKquB,qBAAqB,gBAC/CruB,EAAK80B,WAAW1G,SAAWpuB,EAAKg1B,cAChCh1B,EAAK80B,WAAWpG,YAAW,GAC3B1uB,EAAKi1B,aAAe,EAGpB,IAAIC,EAAW,IAAI,IAAQ,GAAK,EAAG,IAGnC,SAASC,EAAWj9C,GAAK,OAAO,IAAI,IAAOA,EAAE,GAAIA,EAAE,GAAIA,EAAE,IAFzD8nB,EAAKo1B,OAAS,IAAI,IAAiB,QAASF,EAAUnH,GAGtDA,EAAMsF,WAAa8B,EAAWt6B,EAAKw4B,YACnCtF,EAAMS,aAAe2G,EAAWt6B,EAAK2zB,cACrCxuB,EAAKo1B,OAAOC,QAAUF,EAAWt6B,EAAKy4B,cACtCtzB,EAAKo1B,OAAOE,SAAWH,EAAWt6B,EAAK04B,eACvCvzB,EAAKo1B,OAAOG,YAAcJ,EAAWt6B,EAAK24B,kBAG1CxzB,EAAKw1B,aAAex1B,EAAKquB,qBAAqB,WAtD9CoH,CAAUznD,KAAMqiD,EAAQx1B,GAGpBA,EAAKs4B,SA0db,WACI,IAAIhiD,EAAMnH,SAASC,cAAc,OACjCkH,EAAI0R,GAAK,UAEA,iDACA,0CACA,6BACT1R,EAAI4mB,MADJA,+JAEA/tB,SAASsF,KAAK5D,YAAYyF,GAC1B,IACI88B,EAAK,EACLynB,EAAU,EACV5a,EAAQrP,YAAYC,MACpBiqB,EAAO7a,EACX8a,EAAW,WACP3nB,IACA,IAAI4nB,EAAKpqB,YAAYC,MAGrB,GAFImqB,EAAKF,EAAOD,IAASA,EAAUG,EAAKF,GACxCA,EAAOE,IACHA,EAAK/a,EAVD,KAUR,CACA,IAAIgb,EAAMx9C,KAAK9G,MAAMy8B,GAAM4nB,EAAK/a,GAAS,KACrC1pC,EAAMkH,KAAK9G,MAAM,EAAIkkD,EAAU,KACnCvkD,EAAI4kD,UAAYD,EAAM,OAAS1kD,EAC/B68B,EAAK,EACLynB,EAAU,EACV5a,EAAQ+a,IAnfMG,GAkEtBnC,EAAU9rD,UAAUimD,SAAW,WAC3B,OAAOhgD,KAAKmmD,QAIhBN,EAAU9rD,UAAUitB,KAAO,SAAUtT,KAQrCmyC,EAAU9rD,UAAUktB,OAAS,SAAUvT,GACnCu0C,EAAa,SAkNjB,SAA+Bj2B,GAC3B,IAAIk2B,EAAMl2B,EAAK1e,IAAIipC,OACf4L,EAASD,EAAIE,0BACjBp2B,EAAK00B,cAAct9C,SAASo0C,eAAe2K,EAAO,GAAIA,EAAO,GAAIA,EAAO,IACxEn2B,EAAK00B,cAAcvG,SAAS5qC,EAAI2yC,EAAIG,MACpCr2B,EAAK00B,cAAcvG,SAAS3+C,EAAI0mD,EAAIxK,QACpC1rB,EAAK20B,QAAQv9C,SAASoM,GAAK0yC,EAAI1L,YAG/B,IAAI8L,EAAOJ,EAAInH,oBACXv3C,EAAMwoB,EAAK1e,IAAIM,kBACfquB,EAAK33B,KAAKhH,MAAMglD,EAAK,GAAK9+C,EAAI,IAC9B84B,EAAKh4B,KAAKhH,MAAMglD,EAAK,GAAK9+C,EAAI,IAC9B04B,EAAK53B,KAAKhH,MAAMglD,EAAK,GAAK9+C,EAAI,IAC9BqL,EAAKmd,EAAK1e,IAAIi1C,SAAStmB,EAAIK,EAAIJ,IAQvC,SAA2BlQ,EAAMnd,GAC7B,GAAIA,IAAOmd,EAAKi1B,aAAc,OAC9B,GAAW,IAAPpyC,EACAmd,EAAK80B,WAAWpG,YAAW,OACxB,CACH,IAAI8H,EAAQx2B,EAAK1e,IAAIm1C,SAASC,qBAAqB7zC,EAAI,GACvD,GAAI2zC,EAAO,CACP,IAAIG,EAAU32B,EAAK1e,IAAIm1C,SAASG,gBAAgBJ,GAC5CK,EAAMF,EAAQruC,MACdmmC,EAAQkI,EAAQlI,MAChBoI,GAAOpI,GAASA,EAAQ,IACxBzuB,EAAKg1B,cAAc1G,aAAa59C,IAAI,EAAG,EAAG,GAC1CsvB,EAAKg1B,cAAcxG,aAAa99C,IAAImmD,EAAI,GAAIA,EAAI,GAAIA,EAAI,IACxD72B,EAAKg1B,cAAcvG,MAAQA,EAC3BzuB,EAAK80B,WAAWpG,YAAW,KAIvC1uB,EAAKi1B,aAAepyC,EAzBpBi0C,CAAkB92B,EAAMnd,GAhOxBk0C,CAAsB/oD,MACtBioD,EAAa,gBACbjoD,KAAKkmD,QAAQ8C,aACbf,EAAa,cACbjoD,KAAKmmD,OAAOl/B,SACZghC,EAAa,UACbL,IACA5nD,KAAKkmD,QAAQ+C,WACbhB,EAAa,YACbA,EAAa,QAKjBpC,EAAU9rD,UAAUopD,OAAS,SAAU5nD,GAC9B2tD,IACDA,GAAgB,EAChB1rD,WAAW,KACPwC,KAAKkmD,QAAQ/C,SACb+F,GAAgB,GACjBlpD,KAAKimD,mBAGhB,IAAIiD,GAAgB,EAIpBrD,EAAU9rD,UAAUovD,mBAAqB,SAAUC,EAAMC,EAAQC,GAC7D,IAAI1rD,EAsOR,SAA0By/C,GACtB,IAAIV,EAAOU,EAAUkM,eACrB,IAAK5M,EAAM,CACPA,EAAO,IAAKoK,YAAY,YAAa,EAAK1J,EAAU8I,QACpD,IAAIqD,EAAMnM,EAAUgD,qBAAqB,gBACzCmJ,EAAIC,iBAAkB,EACtBD,EAAIE,cAAgB,IAAI,IAAO,EAAG,EAAG,GACrCF,EAAI/I,MAAQ,GACZ9D,EAAKyD,SAAWoJ,EAGhB,IAAIvuD,EAAI,GACJ0uD,EAAQ,IAAKC,YAAY,kBAAmB,CAC5C,IAAI,IAAQ3uD,EAAGA,EAAG,GAClB,IAAI,IAAQA,GAAIA,EAAG,GACnB,IAAI,KAASA,GAAIA,EAAG,GACpB,IAAI,KAASA,EAAGA,EAAG,GACnB,IAAI,IAAQA,EAAGA,EAAG,IACnBoiD,EAAU8I,QACbwD,EAAMrvC,MAAQ,IAAI,IAAO,EAAG,EAAG,GAC/BqvC,EAAM/C,OAASjK,EAEfU,EAAUC,eAAeX,GACzBU,EAAUC,eAAeqM,GACzBtM,EAAUkM,eAAiB5M,EAE/B,OAAOA,EAhQCkN,CAAiB7pD,MACzB,GAAIopD,EAAM,CAENppD,KAAKsT,IAAIC,cAAc81C,EAAQ,KAAMS,GAIrC,IAFA,IACIC,EAAO,KAAQ,KADR7E,EAAOthD,KAAK5D,KAAKsT,IAAIipC,OAAOwE,oBAAqB+I,GAEnDnwD,EAAI,EAAGA,EAAI,EAAGA,IACA,IAAf2vD,EAAQ3vD,GACRmwD,EAAMnwD,IAAM,GAEZmwD,EAAMnwD,IAAO2vD,EAAQ3vD,GAAK,EAAK,EAAIowD,GAAQA,EAGnDnsD,EAAEwL,SAASo0C,eAAesM,EAAM,GAAIA,EAAM,GAAIA,EAAM,IACpDlsD,EAAEuiD,SAAS5qC,EAAK+zC,EAAQ,GAAMh/C,KAAK0T,GAAK,EAAI,EAC5CpgB,EAAEuiD,SAAS3+C,EAAK8nD,EAAQ,GAAMh/C,KAAK0T,GAAK,EAAI,EAEhDpgB,EAAE8iD,WAAW0I,IAEjB,IAAIU,EAAQ,GAcZjE,EAAU9rD,UAAUujD,eAAiB,SAAUX,EAAMqN,EAAUz9C,EAAK09C,GAEhE,IAAItN,EAAKuN,sBACLlqD,KAAKsmD,QAAQ6D,eAAevZ,SAAS+L,GAAzC,CAGA,IAAKA,EAAKiK,OAAQ,CACTr6C,IAAKA,EAAM,CAACowC,EAAKvzC,SAASmM,EAAGonC,EAAKvzC,SAAS5H,EAAGm7C,EAAKvzC,SAASoM,IACjE,IAAIzC,EAAO,GACX/S,KAAKsT,IAAIC,cAAchH,EAAK,KAAMwG,GAClC4pC,EAAKvzC,SAASo0C,eAAezqC,EAAK,GAAIA,EAAK,GAAIA,EAAK,IAIxD,IAAIq3C,GAAc,EAClB,GAAIJ,EAAU,CACV,IAAIjtD,EAAQktD,GACRjqD,KAAKsT,IAAI+2C,MAAMC,kBAAkB/9C,EAAI,GAAIA,EAAI,GAAIA,EAAI,IACzD69C,KAAiBrtD,IAASA,EAAMwtD,aAGhCH,GACArtD,EAAMwtD,YAAYC,QAAQrwD,KAAKwiD,GAC/BA,EAAKuN,oBAAsBntD,GAE3BiD,KAAKsmD,QAAQ6D,eAAehwD,KAAKwiD,GAGjCqN,IACArN,EAAK8N,oBACL9N,EAAK+N,iBAIT,IAAIC,EAAU3qD,KAAK4qD,oBAAoB9rD,KAAKkB,KAAM28C,GAClDA,EAAKkO,oBAAoBhoD,IAAI8nD,KAQjC9E,EAAU9rD,UAAU6wD,oBAAsB,SAAUjO,GAC5CA,EAAKuN,qBAAuBvN,EAAKuN,oBAAoBK,aACrDnH,EAAwBzG,EAAKuN,oBAAoBK,YAAYC,QAAS7N,GAE1EA,EAAKuN,oBAAsB,KAC3B9G,EAAwBpjD,KAAKsmD,QAAQ6D,eAAgBxN,IAazDkJ,EAAU9rD,UAAUsmD,qBAAuB,SAAUhjD,GACjD,IAAIytD,EAAM,IAAI,IAAiBztD,EAAM2C,KAAKmmD,QAI1C,OAHA2E,EAAIC,cAAcvN,eAAe,EAAG,EAAG,GACvCsN,EAAItK,aAAahD,eAAe,EAAG,EAAG,GACtCsN,EAAIxK,aAAa9C,eAAe,EAAG,EAAG,GAC/BsN,GAiBXjF,EAAU9rD,UAAUixD,yBAA2B,SAAUjuD,GACrD,IAAIkuD,EAAKluD,EAAMwvC,KACX2e,EAAM,GACVlrD,KAAKsT,IAAIC,cAAc,CAACxW,EAAMwY,EAAGxY,EAAMyE,EAAGzE,EAAMyY,GAAI,KAAM01C,GAC1D,IAAI9nD,EAAM,IAAI,IAAQ8nD,EAAI,GAAIA,EAAI,GAAIA,EAAI,IACtC7nD,EAAM,IAAI,IAAQ6nD,EAAI,GAAKD,EAAIC,EAAI,GAAKD,EAAIC,EAAI,GAAKD,GACzDluD,EAAMwtD,YAAc,IAAI,IAAYnnD,EAAKC,OAAK9F,OAAWA,OAAWA,EAAWgpD,OAC/EvmD,KAAKsmD,QAAQE,OAAOrsD,KAAK4C,EAAMwtD,cAGnC1E,EAAU9rD,UAAUoxD,yBAA2B,SAAUpuD,GAChDA,EAAMwtD,cACXnH,EAAwBpjD,KAAKsmD,QAAQE,OAAQzpD,EAAMwtD,aACnDxtD,EAAMwtD,YAAYC,QAAQ3wD,OAAS,EACnCkD,EAAMwtD,YAAc,OAqBxB1E,EAAU9rD,UAAUqxD,cAAgB,SAAUC,GAC1C,IAAIC,EAAO,IAAI,IAAQD,EAAM,GAAIA,EAAM,GAAIA,EAAM,IAEjDrrD,KAAKmmD,OAAOoF,OAAOxmD,QAAQ43C,IAEnBA,EAAKiK,SAGTjK,EAAKvzC,SAASoiD,gBAAgBF,GAE1B3O,EAAK8O,sBAAsB9O,EAAK+O,iBAIxC1rD,KAAKsmD,QAAQE,OAAOzhD,QAAQwlD,IACxBA,EAAYoB,SAASH,gBAAgBF,GACrCf,EAAYqB,SAASJ,gBAAgBF,GACrCf,EAAYsB,iBAAiB9mD,QAAQ9C,IACjCA,EAAEupD,gBAAgBF,QAuG9BzF,EAAU9rD,UAAU+xD,iBAAmB,WACnC,IAAIP,EAASvrD,KAAKmmD,OAAOoF,OACrBQ,EAAO/rD,KAAKsmD,QAAQ6D,eACpB6B,EAAO,GACPC,EAAU,EACVC,EAAU,EACVC,EAAOnsD,KAAKmmD,OAAOiG,UACnBC,EAAU,GACdF,EAAKpnD,QAAQ+lD,IACLA,EAAIwB,aAAcxB,EAAIwB,aAAavnD,QAAQ+lD,GAAOuB,EAAQlyD,KAAK2wD,IAC9DuB,EAAQlyD,KAAK2wD,KAEtB9qD,KAAKsmD,QAAQE,OAAOzhD,SAAQ,SAAUwnD,GAClCN,IACAM,EAAM/B,QAAQzlD,QAAQnH,GAAKouD,EAAK7xD,KAAKyD,OAEzC2tD,EAAOxmD,SAAQ,SAAUnH,GAErB,GADIA,EAAE4uD,aAAaplD,EAAKxJ,EAAG,0BAoC6B,IAnC9CA,EAmCsB6uD,aAAa5yD,OAjC7C,GADI6yD,EAAQ9uD,EAAGmuD,EAAMC,IAAO5kD,EAAKxJ,EAAG,sCAC/BA,EAAEwiD,SAAP,CACA8L,GAAYtuD,EAAW,UAAIA,EAAE+uD,UAAU9yD,OAAS,EAChD,IAAIsyD,EAAOvuD,EAAEwiD,SAASkM,cAAgB,CAAC1uD,EAAEwiD,UACzC+L,EAAKpnD,SAAQ,SAAU+lD,GACf4B,EAAQ5B,EAAKqB,IAAO/kD,EAAK0jD,EAAK,sCAJnB1jD,EAAKxJ,EAAG,4CAO/B,IAAIgvD,EAAa,GACjBP,EAAQtnD,QAAQ+lD,IACZ,IAAI+B,GAAO,EACXtB,EAAOxmD,QAAQ43C,IACPA,EAAKyD,WAAa0K,IAAK+B,GAAO,GAC7BlQ,EAAKyD,UAAazD,EAAKyD,SAASkM,cACjC3P,EAAKyD,SAASkM,aAAa1b,SAASka,KAAM+B,GAAO,KAEpDA,GAAMD,EAAWzyD,KAAK2wD,EAAIztD,QAE/BuvD,EAAW/yD,QACXuF,QAAQgI,KAAK,iCAAkCwlD,EAAW/hD,KAAK,OAEnEkhD,EAAKhnD,SAAQ,SAAUnH,GACf8uD,EAAQ9uD,EAAG2tD,IAASnkD,EAAKxJ,EAAG,uCAEpCouD,EAAKjnD,SAAQ,SAAUnH,GACf8uD,EAAQ9uD,EAAG2tD,IAASnkD,EAAKxJ,EAAG,qCAEpC,IAAIkvD,EAAYxiD,KAAK9G,MAAM,GAAKwoD,EAAKnyD,OAASoyD,GAAW,GAKzD,SAAS7kD,EAAK+X,EAAKkN,GAAOjtB,QAAQgI,KAAK+X,EAAI9hB,KAAO,QAAUgvB,GAI5D,SAASqgC,EAAQvtC,EAAK4tC,EAAOC,GACzB,QAAK7tC,KACD4tC,EAAMnc,SAASzxB,MACf6tC,IAASA,EAAMpc,SAASzxB,KAGhC,OAdA/f,QAAQ2xB,IAAI,mBAAoBi7B,EAAKnyD,OAAQ,aAAckyD,EAAKlyD,OAC5D,gBAAiBqyD,EACjB,6BAA8BY,GAY3B,SAGXjH,EAAU9rD,UAAUkzD,gBAAkB,WAClC,IAAIhtB,EAAK,GAUT,IAAK,IAAIhlC,KATT+E,KAAKmmD,OAAOoF,OAAOxmD,QAAQnH,IACvB,IAAImB,EAAInB,EAAEP,MAAQ,GAIlB0B,GADAA,GADAA,GADAA,EAAIA,EAAEme,QAAQ,SAAU,MAClBA,QAAQ,QAAS,MACjBA,QAAQ,kCAAmC,kBAC3CA,QAAQ,kBAAmB,iBACjC+iB,EAAGlhC,GAAKkhC,EAAGlhC,IAAM,EACjBkhC,EAAGlhC,OAEOkhC,EAAI7gC,QAAQ2xB,IAAI,OAASkP,EAAGhlC,GAAK,WAAWu0B,OAAO,EAAG,GAAKv0B,IAU7E,IAAIgtD,EAC2C,OAI3CL,EAAW,a,oDCrhBX,EAAIsF,GACJ,EAAY,GAAK,IACjB,EAAa,GAAK,IAClBC,EAAa,GAAK,IAIXC,EAAY,CAEvB,QAfc,IAgBd,SAZe,MAafA,EAAUC,UAAY,EACtBD,EAAUE,WAAa,EACvBF,EAAUD,WAAaA,ECxBR,UAkBf,WAEI,IAAII,EAAe,IAAIC,EACnBC,EAAc,IAAIC,EAStB1tD,KAAK2tD,UAAY,SAAU5wD,EAAO6wD,EAAWC,EAAWC,EAAiBrI,EAAOK,EAAQC,GACpF,EAAa,SACb,IAAIzyC,EAAMvW,EAAMuW,IAGZ64C,EAAOyB,GAAat6C,EAAIm1C,SAASC,qBACjCqF,EAAOF,GAAav6C,EAAIm1C,SAASuF,wBACjCC,OAAgB1wD,IAAVkoD,EAAuBnyC,EAAI+pC,UAAUoI,MAAQA,EACnDyI,EAAOpI,GAAUxyC,EAAI+pC,UAAUyI,OAC/BqI,EAAMvoD,MAAMmgD,GAAYzyC,EAAI+pC,UAAU0I,SAAWA,EAGjDqI,EAqCZ,SAA+BrxD,GAC3B,IACIkuD,EADMluD,EAAMqxD,OACHxiD,MAAM,GACf84B,EAAM2pB,EAGV,GAAIpD,EAAK,IAAMvmB,EAAI94B,MAAM,GAAI,CACzB,IAAI0iD,EAAKrD,EAAK,EACdvmB,EAAM,IAAI,IAAQ,IAAIp0B,YAAYg+C,EAAKA,EAAKA,GAAK,CAACA,EAAIA,EAAIA,IAC1DD,EAAe3pB,EAKnB,IAAIwmB,EAAMqD,EAAM,GACZhiD,EAAMgiD,EAAM,GACZhiB,EAAOgiB,EAAM,GACbzK,EAASyK,EAAM,GACfC,EAAYD,EAAM,GAClBE,EAAaF,EAAM,GACnBG,EAAeH,EAAM,GACrBtD,IAAO0D,IACPA,EAAiB1D,EA2BzB,SAAyB1e,EAAMiiB,EAAWC,EAAYC,GAClD,IAAK,IAAI/0D,EAAI,EAAGA,EAAI,EAAGA,IACnB60D,EAAU70D,GAAK,CAAC4yC,EAAO,EAAG,EAAG,GAAG5yC,GAChC80D,EAAW90D,GAAK,CAAC,EAAG4yC,EAAM,GAAG5yC,GAC7B+0D,EAAa/0D,GAAK,CAAC,EAAG,EAAG4yC,EAAO,GAAG5yC,GA9BnCi1D,CAAgB3D,EAAIuD,EAAWC,EAAYC,IAG/C,IAAK,IAAI/0D,EAAI,EAAGA,EAAI,EAAGA,IAAK,CACxBuxD,EAAI,GAAKvxD,EACT,IAAK,IAAIkB,EAAI,EAAGA,EAAI,EAAGA,IAAK,CACxBqwD,EAAI,GAAKrwD,EACT,IAAK,IAAIsgB,EAAI,EAAGA,EAAI,EAAGA,IAAK,CACxB+vC,EAAI,GAAK/vC,EACT,IAAK,IAAIpc,EAAI,EAAGA,EAAI,EAAGA,IAAK,CACxB,IAAImZ,EAAQgzC,EAAInsD,GAChBwN,EAAIxN,GAAKyvD,EAAUt2C,GACnBq0B,EAAKxtC,GAAK0vD,EAAWv2C,GACrB4rC,EAAO/kD,GAAK2vD,EAAax2C,GAE7B,IAAI22C,EAAM9xD,EAAM+xD,WAAW3wD,IAAIxE,EAAI,EAAGkB,EAAI,EAAGsgB,EAAI,GAEjD0oC,EADW,EAAQgL,EAAIT,OAAS,KACN1pB,EAAKn4B,EAAKggC,EAAMuX,KAItD,OAAOpf,EAjFUqqB,CAAsBhyD,GACnC,EAAa,QAGb,IAII4/C,EAJAqS,EAAYjyD,EAAMkyD,QAAUlyD,EAAM8nD,QAClC8H,EAAYY,EAAa5Q,KAAKyR,EAAQjC,EAAM4B,EAAME,EAAIC,EAAMC,EAAKa,GAUrE,OANIrC,EAAU9yD,SACV8iD,EAAO8Q,EAAYyB,MAAMnyD,EAAO4vD,EAAWmB,GAC3C,EAAa,YAGjB,EAAa,OACNnR,GAAQ,OAoEvB,IAEIgS,EAFAN,EAAe,IAAI,IAAQ,IAAI/9C,YAAY,IAAK,CAAC,EAAG,EAAG,IACvDi+C,EAAQ1uD,MAAM6rC,KAAK7rC,MAAM,KAAKsL,IAAIpM,GAAK,CAAC,EAAG,EAAG,IAyBlD,SAASowD,EAAQt6C,GACb7U,KAAK6U,GAAU,EAALA,EACV7U,KAAKovD,UAAY,GACjBpvD,KAAKkL,QAAU,GACflL,KAAKqvD,QAAU,GACfrvD,KAAKktB,OAAS,GACdltB,KAAKsvD,IAAM,GACXtvD,KAAKuvD,WAAY,EAyBrB,SAAS7B,IAEL,IAAIp6C,EAyCJ,SAASk8C,EAAeC,EAAcC,GAMlC,IALA,IAAIC,EAAW,GACXzkD,EAAU,GACV0kD,EAAS,GAETzyD,EAAS,KACJxD,EAAI,EAAGA,EAAI81D,EAAa51D,SAAUF,EAAG,CAC1C,IAAIk2D,EAAOJ,EAAa91D,GACxB,GAAM+1D,GAAYG,EAAKN,UAMvB,GAJAI,EAASx1D,KAAK01D,EAAKT,UAAUv1D,QAC7BqR,EAAQ/Q,KAAK01D,EAAK3kD,QAAQrR,QAC1B+1D,EAAOz1D,KAAK01D,EAAKh7C,IAEZ1X,EAGE,CACH,IAAI2yD,EAAc3yD,EAAOiyD,UAAUv1D,OAAS,EAE5Ck2D,EAAY5yD,EAAOiyD,UAAWS,EAAKT,WACnCW,EAAY5yD,EAAOkyD,QAASQ,EAAKR,SACjCU,EAAY5yD,EAAO+vB,OAAQ2iC,EAAK3iC,QAChC6iC,EAAY5yD,EAAOmyD,IAAKO,EAAKP,KAE7B,IAAK,IAAIz0D,EAAI,EAAGkJ,EAAM8rD,EAAK3kD,QAAQrR,OAAQgB,EAAIkJ,IAAOlJ,EAClDsC,EAAO+N,QAAQ/Q,KAAK01D,EAAK3kD,QAAQrQ,GAAKi1D,GAG1CL,EAAa10D,OAAOpB,EAAG,GACvBk2D,EAAKpS,UACL9jD,SAhBAwD,EAAS0yD,EAoBjB,MAAO,CACHF,SAAUA,EACVzkD,QAASA,EACT0kD,OAAQA,GAIhB,SAASG,EAAYrrB,EAAKpoC,GACtB,IAAK,IAAI3C,EAAI,EAAGA,EAAI2C,EAAIzC,OAAQF,IAAK+qC,EAAIvqC,KAAKmC,EAAI3C,IAjFtDqG,KAAKkvD,MAAQ,SAAUnyD,EAAO0yD,EAAc3B,GACxCx6C,EAAMvW,EAAMuW,IAIZ,IADA,IAAI08C,EAAe,EACVr2D,EAAI,EAAGA,EAAI81D,EAAa51D,OAAQF,IAAK,CAC1C,IAAIk2D,EAAOJ,EAAa91D,GACxB,GAAIm0D,EACA+B,EAAKN,WAAY,MACd,CACH,IAAIU,EAAM38C,EAAIm1C,SAASyH,mBAAmBL,EAAKh7C,IAC3C8zC,EAAUr1C,EAAIm1C,SAASG,gBAAgBiH,EAAKh7C,IAChDg7C,EAAKN,WAAcU,GACO,IAAlBtH,EAAQlI,QACPkI,EAAQwH,UAEjBN,EAAKN,WAAWS,IAEpBA,EAAe,GAAGR,EAAeC,GAAc,GAGnD,IAAIW,EAAUZ,EAAeC,GAAc,GAS3C,OAuDJ,SAA8BY,EAAShzD,EAAM8uD,EAAMmE,EAAOC,GAGtD,IAAIxQ,EAAQzsC,EAAI+pC,UAAU2C,WACtBrD,EAAO,IAAI,IAAKt/C,EAAM0iD,GACtByQ,EAAO,IAAI,IASf,GARAA,EAAKpB,UAAYiB,EAAQjB,UACzBoB,EAAKtlD,QAAUmlD,EAAQnlD,QACvBslD,EAAKnB,QAAUgB,EAAQhB,QACvBmB,EAAKtjC,OAASmjC,EAAQnjC,OACtBsjC,EAAKlB,IAAMe,EAAQf,IACnBkB,EAAKC,YAAY9T,GACjB0T,EAAQ5S,UAEY,IAAhB0O,EAAKtyD,OAEL8iD,EAAKyD,SAAW+L,EAAK,OAElB,CAEH,IAAIuE,EAAW,IAAI,IAAc,YAAcrzD,EAAM0iD,GACrDpD,EAAKgQ,UAAY,GAKjB,IAFA,IAAIgE,EAAY,EACZC,EAAW,EACNj3D,EAAI,EAAGA,EAAIwyD,EAAKtyD,OAAQF,IAAK,CAClC+2D,EAASpE,aAAa3yD,GAAKwyD,EAAKxyD,GAChC,IAAIoJ,EAAM,IAAI,IAAQpJ,EAAGg3D,EAAWL,EAAM32D,GAAIi3D,EAAUL,EAAK52D,GAAIgjD,GACjEA,EAAKgQ,UAAUhzD,GAAKoJ,EACpB4tD,GAAaL,EAAM32D,GACnBi3D,GAAYL,EAAK52D,GAErBgjD,EAAKyD,SAAWsQ,EAGpB,OAAO/T,EA9FIkU,CAHEpB,EAAa,GACf,SAAW1yD,EAAM8X,GACjBu7C,EAAQR,OAAOzkD,IAAI0J,GA2GlC,SAA4Bi8C,EAAOC,GAC/B,GAAIA,EAAQ,OAAOz9C,EAAI+pC,UAAUmK,aACjC,IAAInqD,EAAO,eAAiByzD,EACvBE,EAAc3zD,KAAO2zD,EAAc3zD,GAM5C,SAA6BwX,GAEzB,IAAI8zC,EAAUr1C,EAAIm1C,SAASG,gBAAgB/zC,GAC3C,GAAI8zC,EAAQwH,UAAW,OAAOxH,EAAQwH,UAEtC,IAAIF,EAAM38C,EAAIm1C,SAASyH,mBAAmBr7C,GACtC4rC,EAAQkI,EAAQlI,MACpB,IAAKwP,GAAgB,GAATxP,EAER,OAAOntC,EAAI+pC,UAAUmK,aAEzB,IAAIsD,EAAMx3C,EAAI+pC,UAAUmK,aAAallD,MAAM,UAAYuS,GACvD,GAAIo7C,EAAK,CACL,IAAIlQ,EAAQzsC,EAAI+pC,UAAU2C,WACtBiR,EAAM,IAAI,IAAQhB,EAAKlQ,GAAO,GAAM,EAAO,IAAQmR,sBACnDvI,EAAQwI,eAAcF,EAAIG,UAAW,GACzCtG,EAAIuG,eAAiBJ,EAErBtI,EAAQlI,MAAQ,IAChBqK,EAAIrK,MAAQkI,EAAQlI,OAExB,OAAOqK,EA3ByCwG,CAAoBR,IACpE,OAAOE,EAAc3zD,GA/Gek0D,CAAmB18C,EAAIi5C,IACPsC,EAAQT,SAAUS,EAAQllD,UAuGlF,IAAI8lD,EAAgB,GA2ExB,SAASxD,IAEL,IAAIgE,EAAUpE,EAAUoE,QACpBnE,EAAYD,EAAUC,UACtBC,EAAaF,EAAUE,WAKvBmE,EAAY,IAAI7gD,WAAW,IAC3B8gD,EAAc,IAAIphD,YAAY,IAoElC,SAASqhD,EAAmBh4D,EAAGmE,EAAG8zD,EAAMC,EAAaC,GAajD,IAZA,IAAI/tD,EAAM6tD,EAAKhmD,MAAM,GACjBmQ,EAAO01C,EACPM,EAASL,EAET3yD,EAAI,EACJizD,EAAkB,EAAJl0D,EACdzE,EAAOu4D,EAAKv4D,KACZ44D,EAAQL,EAAKtoD,MAAM3P,EAAI,EAAG,EAAG,GAC7Bu4D,EAAUN,EAAKxnD,OAAO,GACtB+nD,EAAUP,EAAKxnD,OAAO,GACtBgoD,EAAUR,EAAKxnD,OAAO,GAEjB+Q,EAAI,EAAGA,EAAIpX,IAAOoX,EAAG,CAC1B,IAAIk3C,EAAKJ,EACTA,GAASG,EACT,IAAK,IAAIv3D,EAAI,EAAGA,EAAIkJ,EAAKlJ,IAAKkE,IAAKszD,GAAMF,EAAS,CAS9C,IAAIG,EAAMj5D,EAAKg5D,GACXE,EAAMl5D,EAAKg5D,EAAKH,GAIpB,GAAII,IAAQC,EAAZ,CAEA,IAAIC,EAAUC,EAAWH,EAAKC,EAAKV,EAAaG,GAC5CQ,IAEAz2C,EAAKhd,GAAMyzD,EAAU,EACjBX,EAAYS,EAAMd,EAASQ,IAC1BH,EAAYU,EAAMf,EAASQ,EAAc,GAG1CF,IAEAC,EAAOhzD,GAAMyzD,EAAU,EACnBV,EAAUF,EAAMj4D,EAAGA,EAAI,EAAGkB,EAAGsgB,GAC7B22C,EAAUF,EAAMj4D,EAAI,EAAGA,EAAGkB,EAAGsgB,QASrD,SAASs3C,EAAWH,EAAKC,EAAKV,EAAaG,GAEvC,IAAIU,EAAMJ,EAAMhF,EACZqF,EAAMJ,EAAMjF,EAChB,GAAIoF,GAAOC,EAAK,OAAO,EAEvB,GAAID,EAAK,OAAO,EAChB,GAAIC,EAAK,OAAQ,EAEjB,IAAIC,EAAKf,EAAYS,EAAMd,EAASQ,GAChCa,EAAKhB,EAAYU,EAAMf,EAASQ,EAAc,GAElD,OAAIY,IAAOC,EAAa,EACR,IAAPD,GAAoB,EACb,IAAPC,EAAmB,EAGrB,EAaX,SAASC,EAA2Bn5D,EAAGmE,EAAGi1D,EAAG9wD,EAAG+wD,EAAM3d,EAClD4d,EAAMC,EAAWC,EAAUC,EAAUrN,GAUrC,IATA,IAAIhnD,EAAI,EACJgd,EAAO01C,EACPM,EAASL,EAIT2B,EAAiB,EAASC,EAAcC,EACxCC,EAAe,EAASC,EAAiBC,EAEpCv4C,EAAI,EAAGA,EAAIk6B,IAAQl6B,EAGxB,IAFA,IAAInU,EAAI,EACJ2iB,EAAI,EACC9uB,EAAI,EAAGA,EAAIm4D,EAAMn4D,GAAKmM,EAAGjI,GAAKiI,EAAG,CAEtC,IAAI2sD,EAAoB,EAAV53C,EAAKhd,GACnB,GAAK40D,EAAL,CAIA,IAAI1F,EAAiB,EAAZ8D,EAAOhzD,GAGhB,IAAKiI,EAAI,EAAGA,EAAIgsD,EAAOn4D,GACdw4D,EAAet0D,EAAIiI,EAAG+U,EAAM43C,EAAS5B,EAAQ9D,KAD1BjnD,GAI5B4sD,EACA,IAAKjqC,EAAI,EAAGA,EAAI0rB,EAAOl6B,IAAKwO,EACxB,IAAK,IAAI/rB,EAAI,EAAGA,EAAIoJ,IAAKpJ,EAAG,CAExB,IAAKy1D,EADIt0D,EAAInB,EAAI+rB,EAAIqpC,EACGj3C,EAAM43C,EAAS5B,EAAQ9D,GAAK,MAAM2F,EAQlE,IAAI9C,EAAQxmD,KAAKC,IAAIopD,GAChBT,EAAUpC,KAAQoC,EAAUpC,GAAS,IAAI3B,EAAQ2B,IACtD,IAAInU,EAAOuW,EAAUpC,GAOjB+C,EAASL,EANA7W,EAAKzvB,OACVimC,EAASrC,GAKoB7C,EAAImF,EAAUrN,GAI/CxwC,EAAI,CAAC,EAAG,EAAG,GACfA,EAAEzX,GAAKnE,EACP4b,EAAEw9C,GAAKl4D,EACP0a,EAAEtT,GAAKkZ,EACP,IAAI24C,EAAK,CAAC,EAAG,EAAG,GACZ77C,EAAK,CAAC,EAAG,EAAG,GAChB67C,EAAGf,GAAK/rD,EACRiR,EAAGhW,GAAK0nB,EAER,IAAIpd,EAAMowC,EAAKyS,UACf7iD,EAAIpS,KACAob,EAAE,GAAIA,EAAE,GAAIA,EAAE,GACdA,EAAE,GAAKu+C,EAAG,GAAIv+C,EAAE,GAAKu+C,EAAG,GAAIv+C,EAAE,GAAKu+C,EAAG,GACtCv+C,EAAE,GAAKu+C,EAAG,GAAK77C,EAAG,GAAI1C,EAAE,GAAKu+C,EAAG,GAAK77C,EAAG,GAAI1C,EAAE,GAAKu+C,EAAG,GAAK77C,EAAG,GAC9D1C,EAAE,GAAK0C,EAAG,GAAI1C,EAAE,GAAK0C,EAAG,GAAI1C,EAAE,GAAK0C,EAAG,IAK1C,IAAI1B,EAAOo9C,EAAU,EAAK,GAAK,EAErB,IAAN71D,EACA6+C,EAAK2S,IAAIn1D,KACL,EAAGwvB,GACFpT,EAAMvP,EAAG2iB,GACTpT,EAAMvP,EAAG,EACV,EAAG,GAEP21C,EAAK2S,IAAIn1D,KACL,EAAG6M,EACH,EAAG,EACHuP,EAAMoT,EAAG,EACTpT,EAAMoT,EAAG3iB,GAMjB,IAAI+sD,EAAKxnD,EAAI1S,OAAS,EAAI,EAEtB85D,EAAU,EACNE,EACAlX,EAAKzxC,QAAQ/Q,KAAK45D,EAAIA,EAAK,EAAGA,EAAK,EAAGA,EAAIA,EAAK,EAAGA,EAAK,GAEvDpX,EAAKzxC,QAAQ/Q,KAAK45D,EAAK,EAAGA,EAAK,EAAGA,EAAK,EAAGA,EAAIA,EAAK,EAAGA,EAAK,GAG3DF,EACAlX,EAAKzxC,QAAQ/Q,KAAK45D,EAAIA,EAAK,EAAGA,EAAK,EAAGA,EAAIA,EAAK,EAAGA,EAAK,GAEvDpX,EAAKzxC,QAAQ/Q,KAAK45D,EAAK,EAAGA,EAAK,EAAGA,EAAIA,EAAK,EAAGA,EAAK,EAAGA,EAAK,GAMnE,IAAIC,EAAc,IAANl2D,EAAUyY,EAAM,EACxB09C,EAAc,IAANn2D,EAAUyY,EAAM,EACxB29C,EAAc,IAANp2D,EAAUyY,EAAM,EAG5BomC,EAAK0S,QAAQl1D,KACT65D,EAAOC,EAAOC,EACdF,EAAOC,EAAOC,EACdF,EAAOC,EAAOC,EACdF,EAAOC,EAAOC,GAIlB,IAAK,IAAIC,EAAK,EAAGA,EAAKxqC,IAAKwqC,EACvB,IAAK,IAAIC,EAAK,EAAGA,EAAKptD,IAAKotD,EACvBr4C,EAAKhd,EAAIq1D,EAAKD,EAAKnB,GAAQ,OA1G/BhsD,EAAI,GAsHpB,SAASssD,EAAYhqD,EAAOyS,EAAM43C,EAAS5B,EAAQsC,GAC/C,OAAIV,IAAY53C,EAAKzS,IACjB+qD,IAAUtC,EAAOzoD,GAIzB,SAASiqD,EAAiBjqD,EAAOyS,EAAM43C,EAAS5B,EAAQsC,GACpD,OAAIV,IAAY53C,EAAKzS,GAIzB,SAASoqD,EAAoBxmC,EAAQrvB,EAAGowD,EAAImF,EAAUrN,GAKlD,OAJA74B,EAAO/yB,KAAK0D,EAAE,GAAIA,EAAE,GAAIA,EAAE,GAAI,GAC9BqvB,EAAO/yB,KAAK0D,EAAE,GAAIA,EAAE,GAAIA,EAAE,GAAI,GAC9BqvB,EAAO/yB,KAAK0D,EAAE,GAAIA,EAAE,GAAIA,EAAE,GAAI,GAC9BqvB,EAAO/yB,KAAK0D,EAAE,GAAIA,EAAE,GAAIA,EAAE,GAAI,IACvB,EAGX,SAAS41D,EAAevmC,EAAQrvB,EAAGowD,EAAImF,EAAUrN,GAC7C,IAAIuO,EAAOC,EAAatG,EAAI,EAAG,GAC3BuG,EAAOD,EAAatG,EAAI,EAAG,GAC3BwG,EAAOF,EAAatG,EAAI,EAAG,GAC3ByG,EAAOH,EAAatG,EAAI,EAAG,GAC/B0G,EAAYznC,EAAQrvB,EAAGy2D,EAAMlB,EAAUrN,GACvC4O,EAAYznC,EAAQrvB,EAAG22D,EAAMpB,EAAUrN,GACvC4O,EAAYznC,EAAQrvB,EAAG42D,EAAMrB,EAAUrN,GACvC4O,EAAYznC,EAAQrvB,EAAG62D,EAAMtB,EAAUrN,GASvC,OALIuO,IAASG,EACCC,IAASF,GAAiB,GAARE,EAElBA,IAASF,GAAiBF,EAAOG,EAAOC,EAAOF,EA0BjE,SAASI,EAAoBv7D,EAAMw7D,EAAMC,EAAMj6D,EAAGsgB,GAC9C,IAAI45C,EAAM,EACNC,EAAM,EACNC,EAAM,EACNC,EAAM,EACNC,EAAW9H,EAGX+H,EAAeD,EAAW97D,EAAK8E,IAAI02D,EAAMh6D,EAAGsgB,GAuBhD,OApBI9hB,EAAK8E,IAAI02D,EAAMh6D,EAAI,EAAGsgB,GAAKg6C,MAAcF,IAAOC,GAChD77D,EAAK8E,IAAI02D,EAAMh6D,EAAI,EAAGsgB,GAAKg6C,MAAcJ,IAAOC,GAChD37D,EAAK8E,IAAI02D,EAAMh6D,EAAGsgB,EAAI,GAAKg6C,MAAcH,IAAOE,GAChD77D,EAAK8E,IAAI02D,EAAMh6D,EAAGsgB,EAAI,GAAKg6C,MAAcJ,IAAOE,GAGhDG,GAEAF,EAAc,GAAPA,GAAY77D,EAAK8E,IAAI02D,EAAMh6D,EAAI,EAAGsgB,EAAI,GAAKg6C,EAAY,EAAI,EAClEH,EAAc,GAAPA,GAAY37D,EAAK8E,IAAI02D,EAAMh6D,EAAI,EAAGsgB,EAAI,GAAKg6C,EAAY,EAAI,EAClEF,EAAc,GAAPA,GAAY57D,EAAK8E,IAAI02D,EAAMh6D,EAAI,EAAGsgB,EAAI,GAAKg6C,EAAY,EAAI,EAClEJ,EAAc,GAAPA,GAAY17D,EAAK8E,IAAI02D,EAAMh6D,EAAI,EAAGsgB,EAAI,GAAKg6C,EAAY,EAAI,IAGtD,IAARD,GAAc77D,EAAK8E,IAAI02D,EAAMh6D,EAAI,EAAGsgB,EAAI,GAAKg6C,IAAaD,EAAM,GACxD,IAARF,GAAc37D,EAAK8E,IAAI02D,EAAMh6D,EAAI,EAAGsgB,EAAI,GAAKg6C,IAAaH,EAAM,GACxD,IAARC,GAAc57D,EAAK8E,IAAI02D,EAAMh6D,EAAI,EAAGsgB,EAAI,GAAKg6C,IAAaF,EAAM,GACxD,IAARF,GAAc17D,EAAK8E,IAAI02D,EAAMh6D,EAAI,EAAGsgB,EAAI,GAAKg6C,IAAaJ,EAAM,IAGjEG,GAAO,EAAID,GAAO,EAAID,GAAO,EAAID,EAK5C,SAASM,EAAWh8D,EAAMw7D,EAAMC,EAAMj6D,EAAGsgB,GACrC,IAAI45C,EAAM,EACNC,EAAM,EACNC,EAAM,EACNC,EAAM,EACNC,EAAW9H,EAGX+H,EAAeD,EAAW97D,EAAK8E,IAAI02D,EAAMh6D,EAAGsgB,GA0DhD,OAvDI9hB,EAAK8E,IAAI02D,EAAMh6D,EAAI,EAAGsgB,GAAKg6C,MAAcF,IAAOC,GAChD77D,EAAK8E,IAAI02D,EAAMh6D,EAAI,EAAGsgB,GAAKg6C,MAAcJ,IAAOC,GAChD37D,EAAK8E,IAAI02D,EAAMh6D,EAAGsgB,EAAI,GAAKg6C,MAAcH,IAAOE,GAChD77D,EAAK8E,IAAI02D,EAAMh6D,EAAGsgB,EAAI,GAAKg6C,MAAcJ,IAAOE,GAEhDG,GAEAF,EAAc,GAAPA,GAAY77D,EAAK8E,IAAI02D,EAAMh6D,EAAI,EAAGsgB,EAAI,GAAKg6C,EAAY,EAAI,EAClEH,EAAc,GAAPA,GAAY37D,EAAK8E,IAAI02D,EAAMh6D,EAAI,EAAGsgB,EAAI,GAAKg6C,EAAY,EAAI,EAClEF,EAAc,GAAPA,GAAY57D,EAAK8E,IAAI02D,EAAMh6D,EAAI,EAAGsgB,EAAI,GAAKg6C,EAAY,EAAI,EAClEJ,EAAc,GAAPA,GAAY17D,EAAK8E,IAAI02D,EAAMh6D,EAAI,EAAGsgB,EAAI,GAAKg6C,EAAY,EAAI,IAItD,IAARD,IACI77D,EAAK8E,IAAI02D,EAAMh6D,EAAI,EAAGsgB,EAAI,GAAKg6C,EAC/BD,EAAM,EACG77D,EAAK8E,IAAI22D,EAAMj6D,EAAGsgB,EAAI,GAAKg6C,GAClC97D,EAAK8E,IAAI22D,EAAMj6D,EAAI,EAAGsgB,GAAKg6C,GAC3B97D,EAAK8E,IAAI22D,EAAMj6D,EAAI,EAAGsgB,EAAI,GAAKg6C,IACjCD,EAAM,IAIF,IAARD,IACI57D,EAAK8E,IAAI02D,EAAMh6D,EAAI,EAAGsgB,EAAI,GAAKg6C,EAC/BF,EAAM,EACG57D,EAAK8E,IAAI22D,EAAMj6D,EAAGsgB,EAAI,GAAKg6C,GAClC97D,EAAK8E,IAAI22D,EAAMj6D,EAAI,EAAGsgB,GAAKg6C,GAC3B97D,EAAK8E,IAAI22D,EAAMj6D,EAAI,EAAGsgB,EAAI,GAAKg6C,IACjCF,EAAM,IAIF,IAARD,IACI37D,EAAK8E,IAAI02D,EAAMh6D,EAAI,EAAGsgB,EAAI,GAAKg6C,EAC/BH,EAAM,EACG37D,EAAK8E,IAAI22D,EAAMj6D,EAAGsgB,EAAI,GAAKg6C,GAClC97D,EAAK8E,IAAI22D,EAAMj6D,EAAI,EAAGsgB,GAAKg6C,GAC3B97D,EAAK8E,IAAI22D,EAAMj6D,EAAI,EAAGsgB,EAAI,GAAKg6C,IACjCH,EAAM,IAIF,IAARD,IACI17D,EAAK8E,IAAI02D,EAAMh6D,EAAI,EAAGsgB,EAAI,GAAKg6C,EAC/BJ,EAAM,EACG17D,EAAK8E,IAAI22D,EAAMj6D,EAAGsgB,EAAI,GAAKg6C,GAClC97D,EAAK8E,IAAI22D,EAAMj6D,EAAI,EAAGsgB,GAAKg6C,GAC3B97D,EAAK8E,IAAI22D,EAAMj6D,EAAI,EAAGsgB,EAAI,GAAKg6C,IACjCJ,EAAM,KAKXG,GAAO,EAAID,GAAO,EAAID,GAAO,EAAID,EAO5C,SAASR,EAAaxC,EAAQuD,EAAMC,GAEhC,OAAOxD,IADMuD,EAAQC,EAAO,EAAI,EAAMA,EAAO,EAAI,GACvB,EAM9B,SAASZ,EAAYznC,EAAQsoC,EAASvH,EAAInI,EAAQC,GAC9C,IAAIjjB,EAAe,IAAPmrB,EAAYlI,EAAWD,EAAOmI,EAAK,GAC/C/gC,EAAO/yB,KAAKq7D,EAAQ,GAAK1yB,EAAM0yB,EAAQ,GAAK1yB,EAAM0yB,EAAQ,GAAK1yB,EAAM,GA7czE9iC,KAAK28C,KAAO,SAAUyR,EAAQyD,EAAasB,EAAUF,EAAMG,EAAUrN,EAAUiJ,GAG3E,IAII8C,EAJAnF,EAAY,GAGZ8I,EAAiBxC,GAASlN,IAAaqN,EAAS,GAEhDH,IAAMnB,EAAY,EAAkB8C,EAAsBS,GAI9D,IAAK,IAAIv3D,EAAI,EAAGA,EAAI,IAAKA,EAAG,CACxB,IAAIi1D,GAAKj1D,EAAI,GAAK,EACdmE,GAAKnE,EAAI,GAAK,EAGd8N,EAAQwiD,EAAOxiD,MACfgmD,EAAOxD,EAAOsH,UAAU53D,EAAGi1D,EAAG9wD,GAAG6nC,GAAG,EAAG,EAAG,GAAGC,GAAGn+B,EAAM9N,GAAK,EAAG8N,EAAMmnD,GAAK,EAAGnnD,EAAM3J,GAAK,GAGvF0zD,EAAO/D,EAAKhmD,MAAM,GAAK,EACvBonD,EAAOpB,EAAKhmD,MAAM,GAClBypC,EAAOuc,EAAKhmD,MAAM,GAGlB6lD,EAAU53D,OAASm5D,EAAO3d,IAC1Boc,EAAY,IAAI7gD,WAAWoiD,EAAO3d,GAClCqc,EAAc,IAAIphD,YAAY0iD,EAAO3d,IAIzC,IAAK,IAAI17C,EAAI,EAAGA,GAAKg8D,IAAQh8D,EAGzBg4D,EAAmBh4D,EAAGmE,EAAG8zD,EAAMC,EAAaC,GAC5C,EAAa,SAGbgB,EAA2Bn5D,EAAGmE,EAAGi1D,EAAG9wD,EAAG+wD,EAAM3d,EACzC4d,EAAMtG,EAAWwG,EAAUC,EAAUrN,GAGrCiJ,IAAWr1D,GAAMg8D,EAAO,GAE5B,EAAa,aAKrB,OAAO77D,OAAO4P,KAAKijD,GAAWxhD,IAAIgQ,GAAKwxC,EAAUxxC,KAzSzDg0C,EAAQp1D,UAAU0jD,QAAU,WACxBz9C,KAAKovD,UAAY,KACjBpvD,KAAKkL,QAAU,KACflL,KAAKqvD,QAAU,KACfrvD,KAAKktB,OAAS,KACdltB,KAAKsvD,IAAM,MA2sBf,IAAI,EACoD,O,SC33BzC,MAiCf,WAyGI,SAASsG,EAAyB74D,EAAOgjD,EAAO8V,EAAU7oD,EAAIC,EAAIC,GAC9D,IAAI4oD,EAAY/4D,EAAMg5D,cAElBC,EAAM,IAAI,IAAoB,cAAgBj5D,EAAM8X,GAAIkrC,EAAO,CAC/DkW,WAAW,IAGXC,EAAqBn5D,EAAMuW,IAAIm1C,SAAS0N,oBACxCC,EAAmBr5D,EAAMuW,IAAIm1C,SAAS4N,iBAG1C,IAAK,IAAIC,KAAWT,EAAU,CAC1B,IAIIU,EAJA5Z,EAAOyZ,EAAiBE,GACxBE,EAAWX,EAASS,GACpBnvD,EAAQqvD,EAAS38D,OAGjB48D,EAAWP,EAAmBI,GAC9BG,IAAUF,EAAYE,EAASC,oBASnCV,EAAIW,SAASha,EAAMx1C,EAAO,CAAEyvD,iBARb,SAAUC,EAAUC,EAAWC,GAC1C,IAAIl4D,EAAM23D,EAASO,GACfnuB,EAAMktB,EAAUj3D,GAGpBg4D,EAASztD,SAAS1G,IAAIkmC,EAAIrzB,EAAI,GAAKqzB,EAAIpnC,EAAGonC,EAAIpzB,EAAI,IAC9C+gD,GAAWA,EAAUM,EAAU7pD,EAAK47B,EAAIrzB,EAAGtI,EAAK27B,EAAIpnC,EAAG0L,EAAK07B,EAAIpzB,MAGxEghD,EAAS38D,OAAS,EAGtB,OAAOm8D,EApIXh2D,KAAKg3D,UAAY,SAAUj6D,GACvBA,EAAMg5D,cAAgB,GACtBh5D,EAAMk6D,eAAiB,IAG3Bj3D,KAAKk3D,aAAe,SAAUn6D,GAC1BiD,KAAKm3D,mBAAmBp6D,GACxBA,EAAMg5D,cAAgB,MAO1B/1D,KAAKo3D,eAAiB,SAAUr6D,EAAO8X,EAAIU,EAAG/T,EAAGgU,GAC7C,IAAI3W,EAAM0W,EAAI,IAAM/T,EAAI,IAAMgU,EAC9BzY,EAAMg5D,cAAcl3D,GAAO,IAAIw4D,EAAWxiD,EAAIU,EAAG/T,EAAGgU,EAAG,OAG3DxV,KAAKs3D,kBAAoB,SAAUv6D,EAAOwY,EAAG/T,EAAGgU,GAC5C,IAAI3W,EAAM0W,EAAI,IAAM/T,EAAI,IAAMgU,EAC1BzY,EAAMg5D,cAAcl3D,WAAa9B,EAAMg5D,cAAcl3D,IAY7DmB,KAAKm3D,mBAAqB,SAAUp6D,GAGhC,IADA,IAAIsoC,EAAUtoC,EAAMk6D,gBAAkB,GAC/B5xB,EAAQxrC,QAAQ,CACnB,IAAIm8D,EAAM3wB,EAAQjjC,MACd4zD,EAAIrZ,MAAMqZ,EAAIrZ,KAAKc,UACvBuY,EAAIvY,YAIZz9C,KAAKu3D,kBAAoB,SAAUx6D,GAC/B,GAAa,SAEb,IAAIgjD,EAAQhjD,EAAMuW,IAAI+pC,UAAU2C,WAC5BoW,EAAmBr5D,EAAMuW,IAAIm1C,SAAS4N,iBAItCmB,EAAa,GACjB,IAAK,IAAI34D,KAAO9B,EAAMg5D,cAAe,CACjC,IACIO,EADWv5D,EAAMg5D,cAAcl3D,GACZgW,GACnBi2C,EAAMsL,EAAiBE,GAASlW,SAChCqX,EAAW,EAAQ1X,EAAMqM,UAAUnvC,QAAQ6tC,IAAQ,EAClD0M,EAAWC,KAAWD,EAAWC,GAAY,IAC7CD,EAAWC,GAAUnB,KAAUkB,EAAWC,GAAUnB,GAAW,IACpEkB,EAAWC,GAAUnB,GAASn8D,KAAK0E,GAEvC,GAAa,cAWb,IAAImO,EAAKjQ,EAAMpD,EAAIoD,EAAMwvC,KACrBt/B,EAAKlQ,EAAMlC,EAAIkC,EAAMwvC,KACrBr/B,EAAKnQ,EAAMoe,EAAIpe,EAAMwvC,KAGrBgf,EAAS,GACb,IAAK,IAAI9sC,KAAM+4C,EAAY,CAEvB,IACIxB,EAAMJ,EAAyB74D,EAAOgjD,EAD3ByX,EAAW/4C,GACiCzR,EAAIC,EAAIC,GACnE,GAAa,YAGb,IAAIwqD,EAAS1B,EAAI2B,YACjB,GAAa,cAGbD,EAAOtX,SAAY3hC,GAAM,EAAKshC,EAAMqM,UAAU3tC,GAAM,KACpD8sC,EAAOpxD,KAAKu9D,GACZ36D,EAAMk6D,eAAe98D,KAAK67D,GAI9B,OADA,GAAa,OACNzK,IA1Hf,SAAS8L,EAAWxiD,EAAIU,EAAG/T,EAAGgU,GAC1BxV,KAAK6U,GAAU,EAALA,EACV7U,KAAKuV,EAAQ,EAAJA,EACTvV,KAAKwB,EAAQ,EAAJA,EACTxB,KAAKwV,EAAQ,EAAJA,EA0Kb,IClFIoiD,EACAC,EACA,GACA,GD+EA,GACwC,OC3LxC,GAAU,EAAQ,IAQP,MAeX,GAAUzK,EAAUoE,QAEpB,GAAYpE,EAAUC,UACtB,GAAaD,EAAUE,WACvB,GAAaF,EAAUD,WAW3B,SAAS2K,GAAMxkD,EAAKuB,EAAIlb,EAAGkB,EAAGsgB,EAAGoxB,EAAMwrB,GACnC/3D,KAAK6U,GAAKA,EACV7U,KAAKg4D,UAAY,GAEjBh4D,KAAKsT,IAAMA,EACXtT,KAAKi4D,YAAa,EAClBj4D,KAAKuqD,YAAc,KAGnBvqD,KAAKouD,OAAS2J,EACd/3D,KAAKrG,EAAIA,EACTqG,KAAKnF,EAAIA,EACTmF,KAAKmb,EAAIA,EACTnb,KAAKusC,KAAOA,EACZvsC,KAAKuV,EAAI5b,EAAI4yC,EACbvsC,KAAKwB,EAAI3G,EAAI0xC,EACbvsC,KAAKwV,EAAI2F,EAAIoxB,EAGbvsC,KAAKk4D,eAAgB,EACrBl4D,KAAKm4D,eAAgB,EAmDzB,SAAyB7kD,GACrBskD,EAActkD,EAAIm1C,SAAS2P,gBAC3BP,EAAevkD,EAAIm1C,SAAS4P,eAC5B,GAAmB/kD,EAAIm1C,SAAS4N,iBAChC,GAAqB/iD,EAAIm1C,SAAS0N,oBApDlCmC,CAAgBhlD,GAGhBtT,KAAKu4D,aAAe,KACpBv4D,KAAK+1D,cAAgB,KACrB/1D,KAAKi3D,eAAiB,KACtBuB,EAAaxB,UAAUh3D,MAEvBA,KAAKivD,QAAS,EACdjvD,KAAK6kD,SAAU,EAGf,IAAI4T,EAAO54D,MAAM6rC,KAAK7rC,MAAM,KAAKsL,IAAI,IAAM,MAC3CnL,KAAK8uD,WAAa,IAAI,GAAQ2J,EAAM,CAAC,EAAG,EAAG,IAAI3uB,GAAG,EAAG,EAAG,GACxD9pC,KAAK8uD,WAAWpsD,IAAI,EAAG,EAAG,EAAG1C,MAC7BA,KAAK04D,eAAiB,EACtB14D,KAAK24D,oBAAsB,EAC3B34D,KAAK44D,aAAe,EAGpBC,GAAc74D,MAqHlB,SAAS84D,GAAiB/7D,EAAOu5D,EAASr5D,EAAMsY,EAAG/T,EAAGgU,GAClD,IAAIujD,EAAO,GAAmBzC,GAC9B,GAAKyC,EAAL,CACA,IAAInwD,EAAUmwD,EAAK97D,GACd2L,GACLA,EAAQ7L,EAAMwY,EAAIA,EAAGxY,EAAMyE,EAAIA,EAAGzE,EAAMyY,EAAIA,IA8ChD,SAASwjD,GAAenkD,GACpB,OAAW,IAAPA,OACAA,EAAK,KACqB,IAArBA,EAAK,KAIlB,SAASokD,GAAOpkD,GACZ,IAAIqkD,EAAQrkD,EAIZ,OAHI+iD,EAAY/iD,KAAKqkD,GAAS,IAC1BrB,EAAahjD,KAAKqkD,GAAS,IAC3B,GAAiBrkD,KAAKqkD,GAAS,IAC5BA,EAkBX,SAASL,GAAc97D,GAQnB,IANA,IAAIo8D,EAAc,GACdC,GAAW,EACXC,GAAS,EAETjL,EAASrxD,EAAMqxD,OACfrqD,EAAMqqD,EAAOxiD,MAAM,GACdjS,EAAI,EAAGA,EAAIoK,IAAOpK,EACvB,IAAK,IAAIkB,EAAI,EAAGA,EAAIkJ,IAAOlJ,EAEvB,IADA,IAAIyO,EAAQ8kD,EAAO9kD,MAAM3P,EAAGkB,EAAG,GACtBsgB,EAAI,EAAGA,EAAIpX,IAAOoX,IAAK7R,EAAO,CAEnC,IAAIuL,EAAKu5C,EAAO/0D,KAAKiQ,GAAS,GAE9B,GAAW,IAAPuL,EAAJ,CAKA,IAAIykD,EAAsB,EAAbL,GAAOpkD,GACpBu5C,EAAO/0D,KAAKiQ,GAASgwD,EACrBH,GAAeG,EACfF,GAAW,EAEP,GAAaE,IACblC,GAAer6D,EAAO8X,EAAIlb,EAAGkB,EAAGsgB,GAChCk+C,GAAS,GAEbP,GAAiB/7D,EAAO8X,EAAI,SAAUlb,EAAGkB,EAAGsgB,QAbxCg+C,EAAc,EAkB9Bp8D,EAAMkyD,UAAYkK,EAAc,IAChCp8D,EAAM8nD,UAAY,EAClB9nD,EAAMm7D,eAAiBn7D,EAAM8nD,QAC7B9nD,EAAMo7D,cAAgBkB,EAS1B,SAASjC,GAAer6D,EAAO8X,EAAIU,EAAG/T,EAAGgU,GACrCgjD,EAAapB,eAAer6D,EAAO8X,EAAIU,EAAG/T,EAAGgU,GAC7CzY,EAAMo7D,eAAgB,EAiC1B,SAASoB,GAAqBx8D,EAAOE,GAGjC,IAFA,IAAI8K,EAAMhL,EAAMqxD,OACZ7hB,EAAOxkC,EAAI6D,MAAM,GACZjS,EAAI,EAAGA,EAAI4yC,IAAQ5yC,EACxB,IAAK,IAAIkB,EAAI,EAAGA,EAAI0xC,IAAQ1xC,EACxB,IAAK,IAAIsgB,EAAI,EAAGA,EAAIoxB,IAAQpxB,EAAG,CAC3B,IAAItG,EAAK,GAAU9M,EAAI5J,IAAIxE,EAAGkB,EAAGsgB,GAC7BtG,EAAK,GAAGikD,GAAiB/7D,EAAO8X,EAAI5X,EAAMtD,EAAGkB,EAAGsgB,IAzRpE28C,GAAM0B,kBAAoB,SAAUjtB,GAChC,IAAIxkC,EAAM,IAAIuI,YAAYi8B,EAAOA,EAAOA,GACxC,OAAO,IAAI,GAAQxkC,EAAK,CAACwkC,EAAMA,EAAMA,KAGzCurB,GAAM/9D,UAAU0/D,kBAAoB,SAAU1B,GAE1CwB,GAAqBv5D,KAAM,YAC3Bw4D,EAAatB,aAAal3D,MAC1BA,KAAKouD,OAAS2J,EACd/3D,KAAKk4D,eAAgB,EACrBl4D,KAAKm4D,eAAgB,EACrBK,EAAaxB,UAAUh3D,MACvB64D,GAAc74D,OAgClB83D,GAAM/9D,UAAUoE,IAAM,SAAUoX,EAAG/T,EAAGgU,GAClC,OAAO,GAAUxV,KAAKouD,OAAOjwD,IAAIoX,EAAG/T,EAAGgU,IAG3CsiD,GAAM/9D,UAAU2/D,cAAgB,SAAUnkD,EAAG/T,EAAGgU,GAC5C,SAAQ,GAAYxV,KAAKouD,OAAOjwD,IAAIoX,EAAG/T,EAAGgU,KAG9CsiD,GAAM/9D,UAAU2I,IAAM,SAAU6S,EAAG/T,EAAGgU,EAAGX,GACrC,IAAI8kD,EAAQ35D,KAAKouD,OAAOjwD,IAAIoX,EAAG/T,EAAGgU,GAC9BokD,EAAWD,EAAQ,GACvB,GAAI9kD,IAAO+kD,EAAX,CAGA,IAAIV,EAAQD,GAAOpkD,GAuBnB,GAtBA7U,KAAKouD,OAAO1rD,IAAI6S,EAAG/T,EAAGgU,EAAG0jD,GAGrBS,EAAQ,IAqLhB,SAA2B58D,EAAOwY,EAAG/T,EAAGgU,GACpCgjD,EAAalB,kBAAkBv6D,EAAOwY,EAAG/T,EAAGgU,GAC5CzY,EAAMo7D,eAAgB,EAvLEb,CAAkBt3D,KAAMuV,EAAG/T,EAAGgU,GAClD0jD,EAAQ,IAAY9B,GAAep3D,KAAM6U,EAAIU,EAAG/T,EAAGgU,GACvDsjD,GAAiB94D,KAAM45D,EAAU,UAAWrkD,EAAG/T,EAAGgU,GAClDsjD,GAAiB94D,KAAM6U,EAAI,QAASU,EAAG/T,EAAGgU,GAGb,IAAxB0jD,EAAQ,MAAmBl5D,KAAKivD,QAAS,GAChC,IAAViK,IAAal5D,KAAK6kD,SAAU,IAC5BmU,GAAeE,IAAUF,GAAeW,MACxC35D,KAAKk4D,eAAgB,IAGrBl4D,KAAKk4D,eAAiBl4D,KAAKm4D,gBAC3Bn4D,KAAKsT,IAAI+2C,MAAMwP,qBAAqB75D,OAK5Bk5D,GAAS,GAAY,QADpBS,GAAS,GAAY,KAEZ,CAClB,IAAIG,EAAO95D,KAAKusC,KAAO,EACnBwtB,EAAe,IAANxkD,GAAY,EAAKA,EAAIukD,EAAQ,EAAI,EAC1CE,EAAe,IAANx4D,GAAY,EAAKA,EAAIs4D,EAAQ,EAAI,EAC1CG,EAAe,IAANzkD,GAAY,EAAKA,EAAIskD,EAAQ,EAAI,EAC9C,GAAIC,EAAQC,EAAQC,EAAO,CACvB,IACIC,EAAK,EAAU,CAAC,EAAGF,GAAS,CAAC,GAC7BG,EAAK,EAAU,CAAC,EAAGF,GAAS,CAAC,IAFxB,EAAU,CAAC,EAAGF,GAAS,CAAC,IAG9Bh1D,QAAQpL,IACPugE,EAAGn1D,QAAQlK,IACPs/D,EAAGp1D,QAAQoW,IACP,GAAoB,IAAfxhB,EAAIkB,EAAIsgB,GAAb,CACA,IAAI0zC,EAAM7uD,KAAK8uD,WAAW3wD,IAAIxE,EAAGkB,EAAGsgB,GAC/B0zC,IACLA,EAAIqJ,eAAgB,EACpBl4D,KAAKsT,IAAI+2C,MAAMwP,qBAAqBhL,eA0B5DiJ,GAAM/9D,UAAU4iD,KAAO,SAAUiR,EAAWC,EAAWpI,EAAOK,EAAQC,GAClE,OAAOqU,EAAczM,UAAU3tD,KAAM4tD,EAAWC,EAAWpI,EAAOK,EAAQC,IAQ9E+R,GAAM/9D,UAAUsgE,aAAe,WAC3B,IAAIhd,EAAYr9C,KAAKsT,IAAI+pC,UACzB,GAAIr9C,KAAKk4D,cAAe,CAChBl4D,KAAKu4D,cAAcv4D,KAAKu4D,aAAa9a,UACzC,IAAId,EAAO38C,KAAK28C,OAChB,GAAIA,GAAQA,EAAK8P,aAAa5yD,OAAS,EAAG,CACtC,IAAI0S,EAAM,CAACvM,KAAKuV,EAAGvV,KAAKwB,EAAGxB,KAAKwV,GAChC6nC,EAAUC,eAAeX,GAAM,EAAMpwC,EAAKvM,MAE9CA,KAAKu4D,aAAe5b,GAAQ,KAC5B38C,KAAKk4D,eAAgB,EACrBl4D,KAAK44D,eACL54D,KAAK24D,oBAAsBruD,KAAKjH,IAAIrD,KAAK24D,oBAAqB34D,KAAK04D,gBAEvE,GAAI14D,KAAKm4D,cAAe,CACpBK,EAAarB,mBAAmBn3D,MAChC,IAAIurD,EAASiN,EAAajB,kBAAkBv3D,MACxCyM,EAAO,CAACzM,KAAKuV,EAAGvV,KAAKwB,EAAGxB,KAAKwV,GACjC+1C,EAAOxmD,QAAQ43C,GAAQU,EAAUC,eAAeX,GAAM,EAAMlwC,EAAMzM,OAClEA,KAAKm4D,eAAgB,IAuG7BL,GAAM/9D,UAAU0jD,QAAU,WAEtB8b,GAAqBv5D,KAAM,YAG3Bw4D,EAAatB,aAAal3D,MACtBA,KAAKu4D,cAAcv4D,KAAKu4D,aAAa9a,UAGzCz9C,KAAKouD,OAAO/0D,KAAO,KACnB2G,KAAKouD,OAAS,KACdpuD,KAAK8uD,WAAWz1D,KAAO,KACvB2G,KAAK8uD,WAAa,KAElB9uD,KAAKi4D,YAAa,GCnWtB,IAAI,GAAe,EAAQ,IAAUpyD,aAgBjCy0D,GAAiB,CACjBC,UAAW,GACXC,iBAAkB,EAClBC,oBAAqB,EACrBC,qBAAqB,GAczB,SAASC,GAAMrnD,EAAKuZ,GA4UpB,IAAyBw9B,EA3UrBrqD,KAAKsT,IAAMA,EACXuZ,EAAO/yB,OAAOqG,OAAO,GAAIm6D,GAAgBztC,GAEzC7sB,KAAK46D,mBAAoB,EACzB56D,KAAK83D,MAAQ,GAEb93D,KAAKu6D,UAAY1tC,EAAK0tC,UACtBv6D,KAAKw6D,iBAAmB3tC,EAAK2tC,iBAC7Bx6D,KAAKy6D,oBAAsB5tC,EAAK4tC,oBAC5Bz6D,KAAKy6D,oBAAsBz6D,KAAKw6D,mBAChCx6D,KAAKy6D,oBAAsBz6D,KAAKw6D,kBAIpCx6D,KAAK66D,mBAAqB,EAG1B76D,KAAK86D,yBAA2B,GAChC96D,KAAK+6D,wBAA0B,GAC/B/6D,KAAKg7D,qBAAuB,EAC5Bh7D,KAAKi7D,uBAAyB,EAC9Bj7D,KAAK06D,oBAAsB7tC,EAAK6tC,oBAGhC16D,KAAKk7D,iBAAmB,GACxBl7D,KAAKm7D,mBAAqB,GAC1Bn7D,KAAKo7D,cAAgB,IAiTA/Q,EAhTLrqD,MAwTVq7D,eAAiB,IAAIzW,EAC3ByF,EAAMiR,mBAAqB,IAAI1W,EAC/ByF,EAAMkR,iBAAmB,IAAI3W,EAC7ByF,EAAMmR,gBAAkB,IAAI5W,EAC5ByF,EAAMoR,qBAAuB,IAAI7W,EACjCyF,EAAMqR,kBAAoB,IAAI9W,EAE9ByF,EAAMwP,qBAAwB98D,IAC1B4+D,GAAoBtR,EAAOttD,IAjEnC,SAA0BstD,GAEtBA,EAAMuR,UAAY,CAACjiE,EAAGkB,EAAGsgB,KACrB,IAAItG,EAAKgnD,GAAWliE,EAAGkB,EAAGsgB,GAC1B,OAAOkvC,EAAM+Q,cAAcvmD,IAAO,MAEtCw1C,EAAMyR,UAAY,CAACniE,EAAGkB,EAAGsgB,EAAG5c,KACxB,IAAIsW,EAAKgnD,GAAWliE,EAAGkB,EAAGsgB,GACtB5c,EACA8rD,EAAM+Q,cAAcvmD,GAAMtW,SAEnB8rD,EAAM+Q,cAAcvmD,IAInCw1C,EAAMC,kBAAoB,SAAU/0C,EAAG/T,EAAGgU,GACtC,IAAI7b,EAAI0wD,EAAM0R,wBAAwBxmD,GAClC1a,EAAIwvD,EAAM0R,wBAAwBv6D,GAClC2Z,EAAIkvC,EAAM0R,wBAAwBvmD,GACtC,OAAO60C,EAAMuR,UAAUjiE,EAAGkB,EAAGsgB,IAjRjC6gD,CAAiBh8D,MAIjB,IAAIirD,EAAKjrD,KAAKu6D,UACd,GAAsB,IAAjBtP,EAAKA,EAAK,GAAU,CACrB,IAAI3wD,EAAwB,EAAhBgQ,KAAKyF,KAAKk7C,GAClBlvC,EAAQkvC,EAAK,EAAK,EACtBjrD,KAAK+7D,wBAA0B7jD,GAAUA,GAAS5d,EAAS,EAC3D0F,KAAKi8D,wBAA0B/jD,GAAUA,EAAQ6D,EAAQ,OAEzD/b,KAAK+7D,wBAA0B7jD,GAAkC,EAAzB5N,KAAKhH,MAAM4U,EAAQ+yC,GAC3DjrD,KAAKi8D,wBAA0B/jD,IAAYA,EAAQ+yC,EAAMA,GAAMA,EAAM,EAwO7E,SAAS4Q,GAAWliE,EAAGkB,EAAGsgB,GAEtB,OAAOxhB,EAAI,IAAMkB,EAAI,IAAMsgB,EAG/B,SAAS+gD,GAAarnD,GAElB,OAAOA,EAAGkI,MAAM,KAAK5R,IAAIlQ,GAAKkmB,SAASlmB,IA0B3C,SAASkhE,GAAqB9R,GAC1B,IAAI99C,EAAM89C,EAAM/2C,IAAIyoC,SAASnX,YAAYylB,EAAM/2C,IAAI8oD,cAInD,MAAO,CAHC/R,EAAM0R,wBAAwBxvD,EAAI,IAClC89C,EAAM0R,wBAAwBxvD,EAAI,IAClC89C,EAAM0R,wBAAwBxvD,EAAI,KAzQ9CouD,GAAM5gE,UAAYD,OAAO8E,OAAO,GAAa7E,WAoB7C4gE,GAAM5gE,UAAUsiE,WAAa,SAAU9mD,EAAG/T,EAAGgU,GACzC,IAAIzY,EAAQiD,KAAKsqD,kBAAkB/0C,EAAG/T,EAAGgU,GACzC,OAAKzY,EACEA,EAAMoB,IACT6B,KAAKi8D,wBAAwB1mD,GAC7BvV,KAAKi8D,wBAAwBz6D,GAC7BxB,KAAKi8D,wBAAwBzmD,IAJd,GAQvBmlD,GAAM5gE,UAAUuiE,iBAAmB,SAAU/mD,EAAG/T,EAAGgU,GAC/C,IAAIzY,EAAQiD,KAAKsqD,kBAAkB/0C,EAAG/T,EAAGgU,GACzC,QAAKzY,KACIA,EAAM28D,cACX15D,KAAKi8D,wBAAwB1mD,GAC7BvV,KAAKi8D,wBAAwBz6D,GAC7BxB,KAAKi8D,wBAAwBzmD,KAIrCmlD,GAAM5gE,UAAUwiE,gBAAkB,SAAUhnD,EAAG/T,EAAGgU,GAC9C,IAAIX,EAAK7U,KAAKq8D,WAAW9mD,EAAG/T,EAAGgU,GAC/B,OAAOxV,KAAKsT,IAAIm1C,SAAS8T,gBAAgB1nD,IAI7C8lD,GAAM5gE,UAAUyiE,iBAAmB,SAAUjnD,EAAG/T,EAAGgU,GAC/C,IAAIX,EAAK7U,KAAKq8D,WAAW9mD,EAAG/T,EAAGgU,GAC/B,OAAOxV,KAAKsT,IAAIm1C,SAAS+T,iBAAiB3nD,IAI9C8lD,GAAM5gE,UAAU0iE,mBAAqB,SAAUlnD,EAAG/T,EAAGgU,GACjD,IAAIX,EAAK7U,KAAKq8D,WAAW9mD,EAAG/T,EAAGgU,GAC/B,OAAOxV,KAAKsT,IAAIm1C,SAASiU,cAAc7nD,IAI3C8lD,GAAM5gE,UAAU4iE,mBAAqB,SAAUpnD,EAAG/T,EAAGgU,GACjD,IAAIzY,EAAQiD,KAAKsqD,kBAAkB/0C,EAAG/T,EAAGgU,GACzC,OAAKzY,EACEA,EAAM6/D,gBACT58D,KAAKi8D,wBAAwB1mD,GAC7BvV,KAAKi8D,wBAAwBz6D,GAC7BxB,KAAKi8D,wBAAwBzmD,IAJd,GASvBmlD,GAAM5gE,UAAU8iE,WAAa,SAAUzuC,EAAK7Y,EAAG/T,EAAGgU,GAC9C,IAAI7b,EAAIqG,KAAK+7D,wBAAwBxmD,GACjC1a,EAAImF,KAAK+7D,wBAAwBv6D,GACjC2Z,EAAInb,KAAK+7D,wBAAwBvmD,GACjCiJ,EAAKze,KAAKi8D,wBAAwB1mD,GAClCmJ,EAAK1e,KAAKi8D,wBAAwBz6D,GAClCmd,EAAK3e,KAAKi8D,wBAAwBzmD,GAIlCzY,EAAQiD,KAAK47D,UAAUjiE,EAAGkB,EAAGsgB,GAC7Bpe,GAAOA,EAAM2F,IAAI+b,EAAIC,EAAIC,EAAIyP,IAKrCusC,GAAM5gE,UAAU+iE,kBAAoB,SAAU3nD,GAG1C,IAFA,IAAIzI,EAAOyI,EAAIzI,KACXrJ,EAAM8R,EAAI9R,IACL1J,EAAI2Q,KAAKhH,MAAMoJ,EAAK,IAAK/S,EAAI0J,EAAI,GAAK,EAAG1J,IAC9C,IAAK,IAAIkB,EAAIyP,KAAKhH,MAAMoJ,EAAK,IAAK7R,EAAIwI,EAAI,GAAK,EAAGxI,IAC9C,IAAK,IAAIsgB,EAAI7Q,KAAKhH,MAAMoJ,EAAK,IAAKyO,EAAI9X,EAAI,GAAK,EAAG8X,IAC9C,GAAInb,KAAKs8D,iBAAiB3iE,EAAGkB,EAAGsgB,GAAI,OAAO,EAIvD,OAAO,GAUXw/C,GAAM5gE,UAAUgjE,aAAe,SAAUloD,EAAI9I,EAAOixD,IAmXpD,SAAsB3S,EAAO4S,EAAOlxD,EAAOixD,GACvC,IAAIj1D,EAAMk1D,EAAMlgD,MAAM,KAClBpjB,EAAIwnB,SAASpZ,EAAIzN,SACjBO,EAAIsmB,SAASpZ,EAAIzN,SACjB6gB,EAAIgG,SAASpZ,EAAIzN,SACjB4iE,EAAYn1D,EAAI8C,KAAK,KACrBgK,EAAKgnD,GAAWliE,EAAGkB,EAAGsgB,GAG1B,GAFAkvC,EAAMkR,iBAAiBv1B,OAAOnxB,GAE1BqoD,IAAc7S,EAAM/2C,IAAI4pD,UAAW,OAEvC,IAAK7S,EAAMgR,eAAezqB,SAAS/7B,GAAK,OACxC,GAAIw1C,EAAMqR,kBAAkB9qB,SAAS/7B,GAAK,OAC1C,IAAI9X,EAAQstD,EAAM+Q,cAAcvmD,GAChC,GAAK9X,EAUE,CAEHA,EAAM08D,kBAAkB1tD,GAEbhP,EAAM+xD,WAAWz1D,KACvB0L,QAAQ8pD,IACJA,GAAOA,IAAQ9xD,GAChB8xD,EAAI6J,eAAiB,IAAIiD,GAAoBtR,EAAOwE,SAjBpD,CAER,IAAItiB,EAAO8d,EAAMkQ,UACjBx9D,EAAQ,IAAI,GAAMstD,EAAM/2C,IAAKuB,EAAIlb,EAAGkB,EAAGsgB,EAAGoxB,EAAMxgC,GAChDs+C,EAAMyR,UAAUniE,EAAGkB,EAAGsgB,EAAGpe,GACzBA,EAAMi7D,UAAYiF,EAClBlgE,EAAMigE,SAAWA,EACjBG,GAAuB9S,EAAO1wD,EAAGkB,EAAGsgB,EAAGpe,GACvCstD,EAAM/2C,IAAI+pC,UAAU2N,yBAAyBjuD,GAC7CstD,EAAMxjD,KAAK,aAAc9J,GAY7B4+D,GAAoBtR,EAAOttD,GAC3BqgE,GAAoB,WAtZpBL,CAAa/8D,KAAM6U,EAAI9I,EAAOixD,IAWlCrC,GAAM5gE,UAAUsjE,uBAAyB,SAAUloD,IAgPnD,SAA+Bk1C,EAAOl1C,GAClC,IAAI/R,EAAM+R,EAAIzI,KAAKvB,IAAIpM,GAAKuL,KAAKhH,MAAM+mD,EAAM0R,wBAAwBh9D,KACjEsE,EAAM8R,EAAI9R,IAAI8H,IAAIpM,GAAKuL,KAAKhH,MAAM+mD,EAAM0R,wBAAwBh9D,KACpEsrD,EAAMgR,eAAet2D,QAAQ8P,IAEzB,IADA,IAAItI,EAAM2vD,GAAarnD,GACdlb,EAAI,EAAGA,EAAI,EAAGA,IACnB,GAAI4S,EAAI5S,GAAKyJ,EAAIzJ,IAAM4S,EAAI5S,GAAK0J,EAAI1J,GAAI,OAExC0wD,EAAMqR,kBAAkB9qB,SAAS/7B,IACrCw1C,EAAMiR,mBAAmBz4D,IAAIgS,KAxPjCyoD,CAAsBt9D,KAAMmV,IAsBhCwlD,GAAM5gE,UAAUitB,KAAO,WACnB,IAAIu2C,EAAgB9/B,YAAYC,MAG5B19B,KAAKk7D,mBAAqBl7D,KAAKsT,IAAI4pD,aAmO3C,SAAiC7S,GAC7BA,EAAMqR,kBAAkBzW,SAASoF,EAAMgR,gBACvChR,EAAMiR,mBAAmBxW,QACzBuF,EAAMmR,gBAAgB1W,QACtBuF,EAAMoR,qBAAqB3W,QAC3B,IAAIoG,EAAMiR,GAAqB9R,GAC/BmT,GAAyBnT,EAAMqR,kBAAmBxQ,EAAI,GAAIA,EAAI,GAAIA,EAAI,IAxOlEuS,CAAwBz9D,MACxBA,KAAKk7D,iBAAmBl7D,KAAKsT,IAAI4pD,WAIrC,IAyL+B7S,EAAOqT,EAAIC,EAAIC,EAC1CC,EACAC,EA3LAvxD,EAAM4vD,GAAqBn8D,MAC3B+9D,EAAUlC,GAAWtvD,EAAI,GAAIA,EAAI,GAAIA,EAAI,IACzCyxD,EAAiBD,GAAW/9D,KAAKm7D,mBACjC6C,IACAh+D,KAAK6G,KAAK,qBAAsB0F,EAAI,GAAIA,EAAI,GAAIA,EAAI,IACpDvM,KAAKm7D,mBAAqB4C,GAE9B,GAAa,SACbX,GAAoB,SAGhBY,IA8K2B3T,EA7KDrqD,KA6KQ09D,EA7KFnxD,EAAI,GA6KEoxD,EA7KEpxD,EAAI,GA6KFqxD,EA7KMrxD,EAAI,GA8KpDsxD,EAAYxT,EAAMoQ,oBAAsBpQ,EAAMoQ,oBAC9CqD,EAAWzT,EAAMqR,kBACrBrR,EAAMgR,eAAet2D,QAAQ8P,IACzB,IAAIipD,EAASltB,SAAS/7B,GAAtB,CACA,IAAIq2C,EAAMgR,GAAarnD,GACnBopD,EAAK/S,EAAI,GAAKwS,EACdQ,EAAKhT,EAAI,GAAKyS,EACdQ,EAAKjT,EAAI,GAAK0S,EACLK,EAAKA,EAAKC,EAAKA,EAAKC,EAAKA,EACzBN,IAEbxT,EAAMqR,kBAAkB74D,IAAIgS,GAC5Bw1C,EAAMiR,mBAAmBt1B,OAAOnxB,GAChCw1C,EAAMmR,gBAAgBx1B,OAAOnxB,GAC7Bw1C,EAAMoR,qBAAqBz1B,OAAOnxB,OAEtC2oD,GAAyBM,EAAUJ,EAAIC,EAAIC,GA7LvC,GAAa,aAEjB,IAAIQ,ENvND,SAAgCx0B,GACnC,GAAIA,IAAQ+Z,EAAS,OAAOC,EAE5B,IADA,IAAI3wC,EAAM3I,KAAK/G,KAAKqmC,GAAM3J,EAAK,EAAGo+B,EAAMz0B,EAAMA,EACrCjwC,GAAKsZ,EAAKtZ,GAAKsZ,IAAOtZ,EAC3B,IAAK,IAAIkB,GAAKoY,EAAKpY,GAAKoY,IAAOpY,EAC3B,IAAK,IAAIsgB,GAAKlI,EAAKkI,GAAKlI,IAAOkI,EAAG,CACpBxhB,EAAIA,EAAIkB,EAAIA,EAAIsgB,EAAIA,EACpBkjD,GAAKp+B,IAM3B,OAFA0jB,EAAU/Z,EACVga,EAAa3jB,EACNA,EM0MSq+B,CAAuBt+D,KAAKw6D,mBACxCwD,GAAkBh+D,KAAKq7D,eAAel0D,QAAUi3D,MA+IxD,SAA8B/T,EAAOqT,EAAIC,EAAIC,GAMzC,IALA,IAAI/6D,EAAMyH,KAAK/G,KAAK8mD,EAAMmQ,kBACtB+D,EAAYlU,EAAMmQ,iBAAmBnQ,EAAMmQ,iBAC3CgE,EAAQnU,EAAMgR,eACdoD,EAAYpU,EAAMiR,mBAEb3hE,EAAI+jE,EAAK76D,EAAKlJ,GAAK+jE,EAAK76D,IAAOlJ,EACpC,IAAK,IAAIkB,EAAI8iE,EAAK96D,EAAKhI,GAAK8iE,EAAK96D,IAAOhI,EACpC,IAAK,IAAIsgB,EAAIyiD,EAAK/6D,EAAKsY,GAAKyiD,EAAK/6D,IAAOsY,EAAG,CACvC,IAAItG,EAAKgnD,GAAWliE,EAAGkB,EAAGsgB,GAC1B,IAAIqjD,EAAM5tB,SAAS/7B,GAAnB,CACA,IAAIopD,EAAKtkE,EAAI+jE,EACTQ,EAAKrjE,EAAI8iE,EACTQ,EAAKhjD,EAAIyiD,EACAK,EAAKA,EAAKC,EAAKA,EAAKC,EAAKA,EACzBI,IACbC,EAAM37D,IAAIgS,GACV4pD,EAAU57D,IAAIgS,KAI1B2oD,GAAyBiB,EAAWf,EAAIC,EAAIC,GAnKxCc,CAAqB1+D,KAAMuM,EAAI,GAAIA,EAAI,GAAIA,EAAI,IAC/C,GAAa,aAIjB82C,EAAYrjD,KAAKg7D,qBAAsB,KACnC,IAAI75D,EAsOZ,SAA6BkpD,GACzB,IAAIoU,EAAYpU,EAAMiR,mBACtB,GAAImD,EAAU5Z,UAAW,OAAO,EAEhC,IAAI8Z,EAAUtU,EAAMkR,iBAAiBp0D,QACjCy3D,EAASvU,EAAMmR,gBAAgBr0D,QACnC,GAAIw3D,GAAWtU,EAAMyQ,yBAA0B,OAAO,EACtD,GAAI8D,GAAUvU,EAAM0Q,wBAAyB,OAAO,EACpD,IAAIlmD,EAAK4pD,EAAUr8D,MAEnB,OA4CJ,SAAyBioD,EAAOx1C,GAC5B,IAAItI,EAAM2vD,GAAarnD,GACnBlb,EAAI4S,EAAI,GACR1R,EAAI0R,EAAI,GACR4O,EAAI5O,EAAI,GACRggC,EAAO8d,EAAMkQ,UACbsE,EAAU,GAAMrF,kBAAkBnP,EAAMkQ,WACxC2C,EAAY7S,EAAM/2C,IAAI4pD,UACtBlF,EAAY,CAACr+D,EAAGkB,EAAGsgB,EAAG+hD,GAAWryD,KAAK,KACtC0K,EAAI5b,EAAI4yC,EACR/qC,EAAI3G,EAAI0xC,EACR/2B,EAAI2F,EAAIoxB,EACZ8d,EAAMkR,iBAAiB14D,IAAIgS,GAC3Bw1C,EAAMxjD,KAAK,kBAAmBmxD,EAAW6G,EAAStpD,EAAG/T,EAAGgU,EAAG0nD,GAC3DE,GAAoB,WA3DpB0B,CAAgBzU,EAAOx1C,GAChB4pD,EAAU5Z,UAhPFka,CAAoB/+D,MAM/B,OALA,GAAa,YACbmB,EAAOA,GAkPf,SAA4BkpD,GACxB,IAAIyT,EAAWzT,EAAMqR,kBACrB,QAAIoC,EAASjZ,YAmGjB,SAAqBwF,EAAOx1C,GACxB,IAAIq2C,EAAMgR,GAAarnD,GACnB9X,EAAQstD,EAAMuR,UAAU1Q,EAAI,GAAIA,EAAI,GAAIA,EAAI,IAC5CnuD,IACAstD,EAAMxjD,KAAK,oBAAqB9J,EAAMi7D,UAAWj7D,EAAMqxD,OAAQrxD,EAAMigE,UACrE3S,EAAM/2C,IAAI+pC,UAAU8N,yBAAyBpuD,GAC7CA,EAAM0gD,UACN2f,GAAoB,WACpBD,GAAuB9S,EAAOa,EAAI,GAAIA,EAAI,GAAIA,EAAI,GAAI,OAE1Db,EAAMyR,UAAU5Q,EAAI,GAAIA,EAAI,GAAIA,EAAI,GAAI,MACxCb,EAAMgR,eAAer1B,OAAOnxB,GAC5Bw1C,EAAMmR,gBAAgBx1B,OAAOnxB,GAC7Bw1C,EAAMoR,qBAAqBz1B,OAAOnxB,GA/GlCmqD,CAAY3U,EAAOyT,EAAS17D,OACpB07D,EAASjZ,WAtPEoa,CAAmBj/D,MAClC,GAAa,WACbmB,EAAOA,GAAQ+9D,GAAoBl/D,MAAM,GACzC,GAAa,UACNmB,GACRo8D,GAGM9/B,YAAYC,MAAQ6/B,EACpB,EAAIv9D,KAAKg7D,wBAsMtB,SAA6B3Q,GAIzB,IAHA,IAAI9uC,EAAQ8uC,EAAMgR,eAAetzD,IAC7Bk4B,EAAK31B,KAAKlH,IAAI,GAAImY,EAAM1hB,QACxBslE,EAAY9U,EAAMmR,gBAAgBr0D,QAAUkjD,EAAMoR,qBAAqBt0D,QAClExN,EAAI,EAAGA,EAAIsmC,EAAItmC,IAAK,CACzBylE,IAAaA,GAAY,GAAK7jD,EAAM1hB,OACpC,IAAIgb,EAAK0G,EAAM6jD,IACXriE,EAAQstD,EAAM+Q,cAAcvmD,GAChC,GAAK9X,EAAL,CACA,IAAIX,EAAKW,EAAM27D,eACf,KAAIt8D,EAAKiuD,EAAMwQ,uBACXz+D,GAAMW,EAAM47D,uBAChBgD,GAAoBtR,EAAOttD,KACrBoiE,EAAY,IAAI,SAlNtBE,CAAoBr/D,MACpB,GAAa,WACbqjD,EAAYrjD,KAAKg7D,qBAAsB,KACnC,IAAI75D,EAAO+9D,GAAoBl/D,MAAM,GAErC,OADA,GAAa,UACNmB,GACRo8D,IAIP,IAAI+B,EAASt/D,KAAK47D,UAAUrvD,EAAI,GAAIA,EAAI,GAAIA,EAAI,IAChDvM,KAAK46D,oBAAsB0E,EAE3BlC,GAAoB,MAAOp9D,MAC3B,GAAa,QAIjB26D,GAAM5gE,UAAUktB,OAAS,WAGrBo8B,EAAYrjD,KAAKi7D,uBAAwB,IAC9BiE,GAAoBl/D,MAAM,KA+LzC,IAAIo/D,IAAa,EA4BjB,SAASF,GAAoB7U,EAAOkV,GAChC,IAAIhkD,EAAQ8uC,EAAMoR,qBAElB,GADIlgD,EAAMspC,YAAc0a,IAAWhkD,EAAQ8uC,EAAMmR,iBAC7CjgD,EAAMspC,UAAW,OAAO,EAE5B,IAAIhwC,EAAK0G,EAAMnZ,MACf,IAAIioD,EAAMqR,kBAAkB9qB,SAAS/7B,GAArC,CACA,IAAI9X,EAAQstD,EAAM+Q,cAAcvmD,GAC5B9X,GAgHR,SAAuBstD,EAAOttD,GAC1BstD,EAAMmR,gBAAgBx1B,OAAOjpC,EAAM8X,IACnCw1C,EAAMoR,qBAAqBz1B,OAAOjpC,EAAM8X,IACxC9X,EAAMs9D,eACN+C,GAAoB,QApHToC,CAAcnV,EAAOttD,IAqGpC,SAAS4+D,GAAoBtR,EAAOttD,GAChC,IAAIX,EAAKW,EAAM27D,eAEXt8D,EADQkO,KAAKlH,IAAIinD,EAAMwQ,mBAAoB,MAE/C99D,EAAMm7D,eAAgB,GACF,KAAP97D,EACTiuD,EAAMoR,qBAAuBpR,EAAMmR,iBACjC34D,IAAI9F,EAAM8X,KAiCpB,SAAS2oD,GAAyBr0D,EAAMxP,EAAGkB,EAAGsgB,GAC1ChS,EAAKqB,KAAKqK,IACN,IAAItI,EAAM2vD,GAAarnD,GACnB+K,EAAKrT,EAAI,GAAK5S,EACdkmB,EAAKtT,EAAI,GAAK1R,EACdilB,EAAKvT,EAAI,GAAK4O,EAElB,OAAQyE,EAAKA,EAAKE,EAAKA,EAAMxV,KAAKC,IAAIsV,KAM9C,SAASs9C,GAAuB9S,EAAOqT,EAAIC,EAAIC,EAAI7gE,GAC/C,IAAK,IAAIpD,GAAK,EAAGA,GAAK,EAAGA,IACrB,IAAK,IAAIkB,GAAK,EAAGA,GAAK,EAAGA,IACrB,IAAK,IAAIsgB,GAAK,EAAGA,GAAK,EAAGA,IACrB,GAAoB,IAAfxhB,EAAIkB,EAAIsgB,GAAb,CACA,IAAIskD,EAAM5D,GAAW6B,EAAK/jE,EAAGgkE,EAAK9iE,EAAG+iE,EAAKziD,GACtCukD,EAAWrV,EAAM+Q,cAAcqE,GAC9BC,IACD3iE,GACAA,EAAM27D,iBACN37D,EAAM+xD,WAAWpsD,IAAI/I,EAAGkB,EAAGsgB,EAAGukD,GAC9BA,EAAShH,iBACTgH,EAAS5Q,WAAWpsD,KAAK/I,GAAIkB,GAAIsgB,EAAGpe,GAEJ,KAA5B2iE,EAAShH,gBACTiD,GAAoBtR,EAAOqV,KAG/BA,EAAShH,iBACTgH,EAAS5Q,WAAWpsD,KAAK/I,GAAIkB,GAAIsgB,EAAG,SAmCxD,SAASwkD,GAAQtV,EAAOhtD,EAAM0K,EAAKkL,GAC/B,IAAI03B,EAAO,EACPma,EAAQ,EACR8a,EAAQ,EACRC,EAAa,EACbC,EAAW,GACf/3D,EAAIhD,QAAQ8P,IACR,IAAI9X,EAAQstD,EAAM+Q,cAAcvmD,GAC3B9X,IACL6iE,IACAE,EAAS3lE,KAAK4C,EAAM67D,cAChB77D,EAAMkyD,QAAQtkB,IACd5tC,EAAM8nD,SAASC,IACU,KAAzB/nD,EAAM27D,gBAAuBmH,OAErC,IAAIvqD,EAAMvN,EAAIlO,OAAOoS,WAAW8zD,OAAO,GAKvC,GAJAzqD,IAAQ,UAAYsqD,GAAOG,OAAO,IAClCzqD,IAAQ,SAAWq1B,GAAMo1B,OAAO,IAChCzqD,IAAQ,UAAYwvC,GAAOib,OAAO,IAClCzqD,IAAQ,SAAWuqD,GAAYE,OAAO,IAClC9sD,EAAK,CACL,IAAI+sD,EAAMF,EAAS5wC,OAAO,CAAC+wC,EAAK7xC,IAAQ6xC,EAAM7xC,EAAK,GAC/C/qB,EAAMy8D,EAAS5wC,OAAO,CAAC+wC,EAAK7xC,IAAQ9jB,KAAKjH,IAAI48D,EAAK7xC,GAAM,GACxDhrB,EAAM08D,EAAS5wC,OAAO,CAAC+wC,EAAK7xC,IAAQ9jB,KAAKlH,IAAI68D,EAAK7xC,GAAM,GAC5D9Y,GAAO,sBAAwB0qD,EAAMJ,GAAOM,QAAQ,GACpD5qD,GAAO,SAAWjS,EAClBiS,GAAO,SAAWlS,EAEtBhE,QAAQ2xB,IAAI1zB,EAAMiY,GArCtBqlD,GAAM5gE,UAAUomE,OAAS,WACrB/gE,QAAQ2xB,IAAI,qCAAsC/wB,KAAK46D,mBACvD+E,GAAQ3/D,KAAM,gBAAiBA,KAAKq7D,eAAetzD,KAAK,GACxD43D,GAAQ3/D,KAAM,gBAAiBA,KAAKs7D,mBAAmBvzD,KACvD43D,GAAQ3/D,KAAM,gBAAiBA,KAAK07D,kBAAkB3zD,KACtD43D,GAAQ3/D,KAAM,gBAAiBA,KAAKu7D,iBAAiBxzD,KACrD43D,GAAQ3/D,KAAM,gBAAiBA,KAAKw7D,gBAAgBzzD,IAAItC,OAAOzF,KAAKy7D,qBAAqB1zD,OAoC7F,IAAI,GACuC,OACvCq1D,GAAsB,OCpvB1B,IAAIgD,GAAe,EAAQ,KAIZ,mBACX,OA4BJ,SAAoB9sD,EAAKuZ,EAAMlK,GAC3BkK,EAAO/yB,OAAOqG,OAAO,GAAIkgE,GAAiBxzC,GAC1C,IAAI2R,EAAS4hC,GAAaz9C,EAASkK,GAC/BntB,EAAImtB,EAAKjK,SACb,IAAK,IAAIvlB,KAAQqC,EAAG,CAChB,IAAIqI,EAAOlI,MAAMqM,QAAQxM,EAAErC,IAAUqC,EAAErC,GAAQ,CAACqC,EAAErC,IAClD0K,EAAIjB,QAAQzJ,GACZmhC,EAAO1/B,KAAKtE,MAAMgkC,EAAQz2B,GAE9B,OAAOy2B,EArCA8hC,CAAWhtD,EAAKuZ,EAAMlK,IAY7B09C,GAAkB,CAClBz9C,SAAU,CACN,QAAW,CAAC,IAAK,QACjB,KAAQ,CAAC,IAAK,UACd,SAAY,CAAC,IAAK,UAClB,MAAS,CAAC,IAAK,WACf,KAAQ,YACR,WAAY,CAAC,YAAa,KAC1B,WAAY,CAAC,YAAa,KAC1B,KAAQ,UACR,OAAU,UACV,OAAU,cC5BlB,IAAI29C,GAAgB,EAAQ,KAIb,iBACX,OAkBJ,SAAqBjtD,EAAKuZ,GACtBA,EAAO/yB,OAAOqG,OAAO,GAAI,GAAU0sB,GACnC,IAAIw9B,EAAQ/2C,EAAI+2C,MAEZx+C,EAASyH,EAAIM,kBAUjB,OAFc2sD,GAAc1zC,EAPV,CAACtX,EAAG/T,EAAGgU,IACd60C,EAAMiS,iBAAiB/mD,EAAI1J,EAAO,GAAIrK,EAAIqK,EAAO,GAAI2J,EAAI3J,EAAO,IAEvD,CAAC0J,EAAG/T,EAAGgU,IAChB60C,EAAMmS,iBAAiBjnD,EAAI1J,EAAO,GAAIrK,EAAIqK,EAAO,GAAI2J,EAAI3J,EAAO,KA3BpE20D,CAAYltD,EAAKuZ,IAYxB,GAAW,CACX2T,QAAS,CAAC,GAAI,GAAI,GAClBE,QAAS,ICnBb,IAAIp0B,GAAO,EAAQ,IACfoB,GAAO,EAAQ,IACfwyB,GAAQ,EAAQ,KAUhB,GAAW,CACXugC,UAAU,EACVC,UAAU,EACVC,aAAc,GACdC,aAAc,GACdC,YAAa,EACbC,UAAW,IAWf,SAASC,GAAOztD,EAAKuZ,GACjB7sB,KAAKsT,IAAMA,EAeXuZ,EAAO/yB,OAAOqG,OAAO,GAAI,GAAU0sB,GAKnC7sB,KAAK2gE,aAAe9zC,EAAK8zC,aAKzB3gE,KAAK4gE,aAAe/zC,EAAK+zC,aAGzB5gE,KAAKygE,SAAW5zC,EAAK4zC,SAGrBzgE,KAAK0gE,SAAW7zC,EAAK6zC,SAOrB1gE,KAAK09C,QAAU,EAQf19C,KAAKqoD,MAAQ,EAqBbroD,KAAKghE,aAAehhE,KAAKsT,IAAIW,KAAKyyB,aAAa,CAAC,aAGhD,IAAIu6B,EAAY,GAAM3tD,EAAIW,KAAKC,gBAAgBZ,EAAI8oD,cAActvD,OACjEwG,EAAIW,KAAK2yB,aAAa5mC,KAAKghE,aAAc,gBAAiB,CACtDlkB,OAAQxpC,EAAI8oD,aACZvwD,OAAQ,CAAC,EAAGo1D,EAAW,KAI3BjhE,KAAKkhE,aAAer0C,EAAKg0C,YAGzB7gE,KAAK8gE,UAAYj0C,EAAKi0C,UAKtB9gE,KAAKw8C,YAAc3vB,EAAKg0C,YAGxB7gE,KAAKmhE,WAAa70D,GAAK9J,WAAW,EAAG,EAAG,GAS5Cu+D,GAAOhnE,UAAUquD,wBAA0B,WACvC,IAAI/zC,EAAOrU,KAAKsT,IAAIW,KAAKC,gBAAgBlU,KAAKghE,cAC9C,OAAO10D,GAAK7J,KAAK2+D,GAAS/sD,EAAKlB,kBAGnC4tD,GAAOhnE,UAAUgnD,kBAAoB,WACjC,IAAImK,EAAMlrD,KAAKooD,0BACf,OAAyB,IAArBpoD,KAAKw8C,YAA0B0O,EAC5B5+C,GAAK5I,YAAYwnD,EAAKA,EAAKlrD,KAAKmhE,YAAanhE,KAAKw8C,cAE7D,IAAI4kB,GAAU90D,GAAK1N,SAYnBmiE,GAAOhnE,UAAUsnE,kBAAoB,WACjC,IAAInW,EAAMlrD,KAAKooD,0BACf,OAAOpoD,KAAKsT,IAAIguD,cAAcpW,EAAKqW,KAEvC,IAAIA,GAAe,GAKnBR,GAAOhnE,UAAU6qC,YAAc,WAC3B,IAAIsmB,EAAMlrD,KAAK+gD,oBACf,OAAO/gD,KAAKsT,IAAIguD,cAAcpW,EAAKqW,KAQvCR,GAAOhnE,UAAUynE,aAAe,WAC5B,OAAOxhE,KAAKmhE,YAuBhBJ,GAAOhnE,UAAU0nE,oBAAsB,WAEnC,IAAI/5D,EAAQ1H,KAAKsT,IAAIkrB,OAAO92B,OA4EhC,SAAgBA,GACZ,IAAIkY,EAAKlY,EAAMkY,GACXC,EAAKnY,EAAMmY,GACX6hD,EAAO1lE,SAASsF,KAAKymB,YAAc,EACnC45C,EAAO3lE,SAASsF,KAAK0mB,aAAe,EACpC45C,EAAQt3D,KAAKC,IAAIqV,GAAM8hD,GAAS9hD,EAAKiiD,IAAU,EAC/CC,EAAQx3D,KAAKC,IAAIsV,GAAM8hD,GAAS9hD,EAAKkiD,IAAU,EAC/CH,GAAQE,GACRp6D,EAAMkY,GAAKiiD,GACXn6D,EAAMmY,GAAKkiD,GACXF,GAASjiD,EAAK,EAAK,GAAK,EACxBmiD,GAASliD,EAAK,EAAK,GAAK,IAEpBD,IAAIiiD,GAAQjiD,GACZC,IAAIkiD,GAAQliD,IAzFpBmiD,CAAOt6D,GAGP,IAAIu6D,EAAO,MAAS33D,KAAK0T,GAAK,IAC1B6B,EAAKnY,EAAMmY,GAAK7f,KAAK4gE,aAAeqB,EACpCriD,EAAKlY,EAAMkY,GAAK5f,KAAK2gE,aAAesB,EACpCjiE,KAAK0gE,WAAU7gD,GAAMA,GACrB7f,KAAKygE,WAAU7gD,GAAMA,GAGzB,IAAIsiD,EAAQ,EAAI53D,KAAK0T,GACrBhe,KAAK09C,SAAY99B,EAAK,EAAKA,EAAKsiD,EAAQtiD,EACpC5f,KAAK09C,QAAUwkB,IAAOliE,KAAK09C,SAAWwkB,GAC1C,IAAIC,EAAW73D,KAAK0T,GAAK,EAAI,KAC7Bhe,KAAKqoD,MAAQ/9C,KAAKjH,KAAK8+D,EAAU73D,KAAKlH,IAAI++D,EAAUniE,KAAKqoD,MAAQxoC,IAEjEvT,GAAK5J,IAAI1C,KAAKmhE,WAAY,EAAG,EAAG,GAChC70D,GAAK1H,QAAQ5E,KAAKmhE,WAAYnhE,KAAKmhE,WAAY5hD,GAAQvf,KAAKqoD,OAC5D/7C,GAAKzH,QAAQ7E,KAAKmhE,WAAYnhE,KAAKmhE,WAAY5hD,GAAQvf,KAAK09C,UAEhE,IAAIn+B,GAASjT,GAAK1N,SAQlBmiE,GAAOhnE,UAAUqoE,gCAAkC,WAE/CpiE,KAAKw8C,cAAgBx8C,KAAKkhE,aAAelhE,KAAKw8C,aAAex8C,KAAK8gE,WAGtEC,GAAOhnE,UAAUsoE,+BAAiC,WAE9C,IAAIC,EAaR,SAAmCtwC,GAC/B,IAAKuwC,GAAS,CACV,IAAI/4D,EAAMwoB,EAAK1e,IAAIM,kBACnB2uD,GAAU,IAAI70D,GAAK,CAAC,EAAG,EAAG,GAAIpB,GAAKhK,MAAMkgE,KACzCC,GAAY,CAACltD,EAAG/T,EAAGgU,IAAMwc,EAAK1e,IAAI+2C,MAAMiS,iBAAiB/mD,EAAI/L,EAAI,GAAIhI,EAAIgI,EAAI,GAAIgM,EAAIhM,EAAI,IACzF8C,GAAK7I,MAAM++D,GAAYA,IAAa,IAExCD,GAAQ/0D,YAAYwkB,EAAKo2B,2BACzBma,GAAQj1D,UAAUk1D,IAClB,IAAI5+D,EAAO0G,KAAKjH,IAAI2uB,EAAKkvC,aAAclvC,EAAKwqB,aAAe,GAE3D,OADAlwC,GAAK7I,MAAMi/D,GAAW1wC,EAAKwvC,gBAAiB59D,GACrCs8B,GAAMuiC,GAAWF,GAASG,GAAWC,IAAQ,GAxBtCC,CAA0B5iE,MACpCA,KAAKw8C,YAAc8lB,IAAStiE,KAAKw8C,YAAc8lB,IA0BvD,IAEIC,GACAE,GAHAD,GAAal2D,GAAK9J,WAAW,GAAK,GAAK,IACvCkgE,GAAYp2D,GAAK1N,SAGjB+jE,GAAS,KAAM,EA2BnB,IAAId,GAAQ,EACRE,GAAQ,EC1QR,GAAW,CACXc,YAAa,IAGbC,GAAgB,CAChBC,OAAO,EACPC,QAAQ,EACRpiC,aAAc,EACdqiC,UAAW,IAKXC,GAAe,WAAa9V,EAAUoE,QAU1C,SAAS2R,GAAS7vD,EAAKuZ,GACnB7sB,KAAKsT,IAAMA,EACXuZ,EAAO/yB,OAAOqG,OAAO,GAAI,GAAU0sB,GAWnC,IAAIu2C,EAAgB,EAAC,GACjBC,EAAe,EAAC,GAChBC,EAAe,EAAC,GAChBC,EAAY,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,GAC5BC,EAAa,CAAC,MACdC,EAAc,CAAC,MACfC,EAAgB,CAAC,MAGjB9T,EAAS,GACTjH,EAAU,CAAC,MAGXka,EAAch2C,EAAKg2C,YAuCvB7iE,KAAK2jE,cAAgB,SAAU9uD,EAAI+uD,GAC/BA,EAAWA,GAAY,GACvBd,GAAcC,OAASa,EAASC,MAChCf,GAAcE,QAAUY,EAASC,MACjC,IAAIh3C,EAAO/yB,OAAOqG,OAAO,GAAI2iE,GAAec,GAG5C,GAAI/uD,EAAK,GAAKA,EAAKquD,GAAc,KAAM,0BAA4BruD,EAInE,KAAOA,EAAKuuD,EAAcvpE,QACtBmG,KAAK2jE,cAAcP,EAAcvpE,OAAQ,IAI7CupE,EAAcvuD,KAAQgY,EAAKk2C,MAC3BM,EAAaxuD,KAAQgY,EAAKm2C,OAC1BM,EAAazuD,KAAQgY,EAAKg3C,MAG1BJ,EAAY5uD,GAAMgY,EAAKi3C,WAAa,KAIpC,IACI3X,EADArB,EAAMj+B,EAAKuzB,UAAY,KAE3B,GAAK0K,EAEE,GAAkB,iBAAPA,EACdqB,EAAO,CAACrB,EAAKA,EAAKA,EAAKA,EAAKA,EAAKA,QAC9B,GAAIA,EAAIjxD,QAAwB,GAAdixD,EAAIjxD,OAEzBsyD,EAAO,CAACrB,EAAI,GAAIA,EAAI,GAAIA,EAAI,GAAIA,EAAI,GAAIA,EAAI,GAAIA,EAAI,SACjD,GAAIA,EAAIjxD,QAAwB,GAAdixD,EAAIjxD,OAEzBsyD,EAAO,CAACrB,EAAI,GAAIA,EAAI,GAAIA,EAAI,GAAIA,EAAI,GAAIA,EAAI,GAAIA,EAAI,QACjD,KAAIA,EAAIjxD,QAAwB,GAAdixD,EAAIjxD,OAGtB,KAAM,+BAAiCixD,EAD1CqB,EAAOrB,OAXPqB,EAAO,CAAC,KAAM,KAAM,KAAM,KAAM,KAAM,MAe1C,IAAK,IAAIxyD,EAAI,EAAGA,EAAI,IAAKA,EACrB4pE,EAAe,EAAL1uD,EAASlb,GAAKoqE,GAAc/jE,KAAM4vD,EAAQzD,EAAKxyD,IAAI,GAIjE6pE,EAAW3uD,GAAM,GAGbyuD,EAAazuD,KACb2uD,EAAW3uD,GAAI+rB,aAAe/T,EAAK+T,aACnC4iC,EAAW3uD,GAAIouD,UAAYp2C,EAAKo2C,WAIpC,IAAIe,EAAan3C,EAAKo3C,QAAUp3C,EAAKq3C,UAAYr3C,EAAKs3C,OAASt3C,EAAKu3C,SAAWv3C,EAAK6pC,mBAGpF,OAFAgN,EAAc7uD,GAAM,EAAe,IAAIwvD,GAAoBx3C,GAAQ,KAE5DhY,GAgBX7U,KAAKskE,iBAAmB,SAAUjnE,EAAMid,EAAOiqD,EAAYC,EAAaC,GAEpE,IAAI5vD,EAAK+6C,EAAOvyD,IAASsrD,EAAQ9uD,OACjC+1D,EAAOvyD,GAAQwX,EACf,IAAI4rC,EAAQ,EAWZ,OAVInmC,GAAyB,GAAhBA,EAAMzgB,SACf4mD,EAAQnmC,EAAMlY,OAElBumD,EAAQ9zC,GAAM,CACVyF,MAAOA,GAAS,CAAC,EAAG,EAAG,GACvBmmC,MAAOA,EACPikB,QAASH,EAAa1B,EAAc0B,EAAa,GACjDpT,eAAgBqT,EAChBrU,UAAWsU,GAAkB,MAE1B5vD,GAaX7U,KAAKs8D,iBAAmB,SAAUznD,GAC9B,OAAOuuD,EAAcvuD,IAQzB7U,KAAKu8D,gBAAkB,SAAU1nD,GAC7B,OAAOwuD,EAAaxuD,IAOxB7U,KAAKw8D,iBAAmB,SAAU3nD,GAC9B,OAAOyuD,EAAazuD,IAOxB7U,KAAK08D,cAAgB,SAAU7nD,GAC3B,OAAO2uD,EAAW3uD,IAKtB7U,KAAK0oD,qBAAuB,SAAUic,EAASpuD,GAC3C,OAAOgtD,EAAoB,EAAVoB,EAAcpuD,IAQnCvW,KAAK4kE,iBAAmB,SAAU9T,GAC9B,OAAOnI,EAAQmI,GAAOx2C,OAI1Bta,KAAKkwD,mBAAqB,SAAUY,GAChC,OAAOnI,EAAQmI,GAAO4T,SAI1B1kE,KAAK4oD,gBAAkB,SAAUkI,GAC7B,OAAOnI,EAAQmI,IAenB9wD,KAAKo4D,gBAAkBgL,EACvBpjE,KAAKq4D,eAAiBgL,EACtBrjE,KAAKq2D,iBAAmBoN,EACxBzjE,KAAKm2D,oBAAsBuN,EAS3B1jE,KAAKguD,wBAA0B,SAAU8C,GACrC,OAAInI,EAAQmI,GAAO4T,QAAgBG,EAC5Blc,EAAQmI,GAAOx2C,OAE1B,IAAIuqD,EAAQ,CAAC,EAAG,EAAG,GAcnB7kE,KAAKskE,iBAAiB,OAAQ,CAAC,GAAK,GAAK,GAAI,MAC7CtkE,KAAK2jE,cAAc,EAAG,CAAEvjB,SAAU,SAkBtC,SAAS2jB,GAAce,EAAKlV,EAAQvyD,EAAM0nE,GACtC,IAAK1nE,EAAM,OAAO,EAClB,IAAIwX,EAAK+6C,EAAOvyD,GAEhB,YADWE,IAAPsX,GAAoBkwD,IAAUlwD,EAAKiwD,EAAIR,iBAAiBjnE,IACrDwX,EAMX,SAASwvD,GAAoBx3C,GACzB7sB,KAAKikE,OAASp3C,EAAKo3C,QAAU,KAC7BjkE,KAAKkkE,SAAWr3C,EAAKq3C,UAAY,KACjClkE,KAAKmkE,MAAQt3C,EAAKs3C,OAAS,KAC3BnkE,KAAKokE,QAAUv3C,EAAKu3C,SAAW,KAC/BpkE,KAAK02D,mBAAqB7pC,EAAK6pC,oBAAsB,K,sBCzVrD,GAAO,EAAQ,IACfsO,GAAU,EAAQ,KAelB,GAAW,CACXC,eAAgB,IAgBpB,SAASC,GAAS5xD,EAAKuZ,GAEnBm4C,GAAQ/qE,KAAK+F,MAEbA,KAAKsT,IAAMA,EACXuZ,EAAO/yB,OAAOqG,OAAO,GAAI,GAAU0sB,GAInC7sB,KAAKk9C,MAAQ,GAGb,IAAIioB,EAAgB,CAChB,OAAUt4C,EAAKo4C,gBAKfG,EAAa,OACjBA,EAAW17D,OAAO3E,QAAQ1H,IAEtB,IAAIgoE,EAAW,eAAeC,KAAKjoE,GAAM,GACrC+K,EAAM+8D,EAAcE,SAAa9nE,EACjCgoE,EAASH,EAAW/nE,GACpBkoE,EAAOC,UAASD,EAASA,EAAOC,SACpC,IAAIC,EAAUF,EAAOjyD,EAAKlL,GACtBs9D,EAAO1lE,KAAK+mC,gBAAgB0+B,GAChCzlE,KAAKk9C,MAAMmoB,GAAYK,IAM3B1lE,KAAK2lE,SAAW,SAAU9wD,GAAM,OAAOA,IAAOvB,EAAI8oD,cAGlDp8D,KAAKg8C,WAAah8C,KAAK2nC,qBAAqB3nC,KAAKk9C,MAAMppC,SAGvD9T,KAAK+U,eAAiB/U,KAAK2nC,qBAAqB3nC,KAAKk9C,MAAM0oB,cAG3D5lE,KAAKy8C,QAAUz8C,KAAK2nC,qBAAqB3nC,KAAKk9C,MAAMP,MAIpD38C,KAAKoU,YAAcpU,KAAK2nC,qBAAqB3nC,KAAKk9C,MAAM9zC,UACxD,IAAIy8D,EAAS7lE,KAAK0nC,iBAAiB1nC,KAAKk9C,MAAM9zC,UAgD9C,SAAS08D,EAA0BjxD,EAAIuoC,GACnC,GAAK36C,KAAK26C,EAAOjqC,gBAAiBiqC,EAAOpqC,gBACzC,GAAKnQ,IAAIu6C,EAAOh0C,SAAUg0C,EAAOpqC,eAAgBM,EAAIM,mBACrD,iCAAsBwpC,GACtB,IAAI6D,EAAU8kB,EAAQlxD,GAClBosC,GAAS,kCAAuBA,EAAS7D,GAlDjDp9C,KAAKkU,gBAAkB2xD,EAGvB7lE,KAAK+gD,kBAAoB,SAAUlsC,GAC/B,OAAOgxD,EAAOhxD,GAAI7B,gBAItBhT,KAAK4kC,YAAc,SAAU/vB,GACzB,OAAOgxD,EAAOhxD,GAAIzL,UAItBpJ,KAAKgmE,kBAAoB,SAAUnxD,EAAItI,GACnC,IAAI6wC,EAASyoB,EAAOhxD,GACpB,GAAKpS,KAAK26C,EAAOpqC,eAAgBzG,GACjCu5D,EAA0BjxD,EAAIuoC,IAIlCp9C,KAAKwN,YAAc,CAACqH,EAAItI,EAAK05D,EAAOC,KAEb,iBAAR35D,IAAkBA,EAAM,CAACA,EAAK05D,EAAOC,IAEhD,IAAIhb,EAAM53C,EAAIC,cAAchH,EAAK,KAAM,IACvCvM,KAAKgmE,kBAAkBnxD,EAAIq2C,IAI/BlrD,KAAKmmE,cAAgB,SAAUtxD,EAAIuxD,EAAIC,EAAIC,GACvC,IAAIlpB,EAASyoB,EAAOhxD,GACpBuoC,EAAOvwC,OAASu5D,EAAKE,GAAM,EAC3BlpB,EAAOtwC,OAASu5D,EAChBP,EAA0BjxD,EAAIuoC,IAIlCp9C,KAAKorD,cAAgB,SAAUC,GAC3BrrD,KAAKynC,cAAcznC,KAAKk9C,MAAM9zC,UAAUrE,QAAQ2C,IAC5C,GAAK5E,SAAS4E,EAAMsL,eAAgBtL,EAAMsL,eAAgBq4C,GAC1Dya,EAA0Bp+D,EAAMyM,KAAMzM,MAgB9C,IAAIq+D,EAAU/lE,KAAK0nC,iBAAiB1nC,KAAKk9C,MAAMppC,SAC/C9T,KAAKghD,WAAa+kB,EAClB/lE,KAAKi8C,eAAiB,SAAUpnC,GAAM,OAAOkxD,EAAQlxD,GAAIvT,MAGzDtB,KAAK08C,YAAc18C,KAAK0nC,iBAAiB1nC,KAAKk9C,MAAMP,MACpD38C,KAAK6/C,YAAc7/C,KAAK0nC,iBAAiB1nC,KAAKk9C,MAAMqpB,UACpDvmE,KAAKm8C,kBAAoBn8C,KAAK0nC,iBAAiB1nC,KAAKk9C,MAAMspB,gBAC1DxmE,KAAKymE,mBAAqBzmE,KAAK0nC,iBAAiB1nC,KAAKk9C,MAAMwpB,iBAG3D1mE,KAAKypC,0BAA4B,SAAU8oB,EAAKoU,KAkDpD,SAASC,GAAeC,EAAMC,GAC1B,QAAID,EAAK,GAAKC,EAAK,QACfD,EAAK,GAAKC,EAAK,QACfD,EAAK,GAAKC,EAAK,QACfD,EAAK,GAAKC,EAAK,QACfD,EAAK,GAAKC,EAAK,OACfD,EAAK,GAAKC,EAAK,QApDvB5B,GAASnrE,UAAYD,OAAO8E,OAAOomE,GAAQjrE,WAC3CmrE,GAASnrE,UAAUkG,YAAcilE,GAgBjCA,GAASnrE,UAAUgtE,kBAAoB,SAAUlyD,EAAIxX,EAAMqK,GAEnD1H,KAAKunC,aAAa1yB,EAAIxX,IAAO2C,KAAKmnC,gBAAgBtyB,EAAIxX,GAAM,GAChE2C,KAAK4mC,aAAa/xB,EAAIxX,EAAMqK,IAKhCw9D,GAASnrE,UAAUitE,iBAAmB,SAAUzxD,EAAG/T,EAAGgU,GAWlD,IATA,IAAIhM,EAAMxJ,KAAKsT,IAAIM,kBACfqzD,EAAS38D,KAAKhH,MAAMiS,EAAI/L,EAAI,IAC5B09D,EAAS58D,KAAKhH,MAAM9B,EAAIgI,EAAI,IAC5B29D,EAAS78D,KAAKhH,MAAMkS,EAAIhM,EAAI,IAC5B49D,EAAW,CACXH,EAAS,KAAOC,EAAS,KAAOC,EAAS,KACzCF,EAAS,KAAOC,EAAS,KAAOC,EAAS,MAEzCh+D,EAAOnJ,KAAKynC,cAAcznC,KAAKk9C,MAAMspB,gBAChC7sE,EAAI,EAAGA,EAAIwP,EAAKtP,OAAQF,IAAK,CAClC,IAAIkb,EAAK1L,EAAKxP,GAAGwa,KAEjB,GAAIyyD,GAAeQ,EADTpnE,KAAKkU,gBAAgBW,GAAI3B,UACA,OAAO,EAE9C,OAAO,GAmBXgyD,GAASnrE,UAAUstE,kBAAoB,SAAUlyD,EAAKmyD,GAElD,IAAI99D,EAAMxJ,KAAKsT,IAAIM,kBACf2zD,EAAc,CACdpyD,EAAIzI,KAAK,GAAKlD,EAAI,GAAI2L,EAAIzI,KAAK,GAAKlD,EAAI,GAAI2L,EAAIzI,KAAK,GAAKlD,EAAI,GAC9D2L,EAAI9R,IAAI,GAAKmG,EAAI,GAAI2L,EAAI9R,IAAI,GAAKmG,EAAI,GAAI2L,EAAI9R,IAAI,GAAKmG,EAAI,IAG3Dg+D,EAAY,EACZxnE,KAAKynC,cAAc6/B,GAAen8D,IAAIzD,GAC3B1H,KAAKkU,gBAAgBxM,EAAMyM,OACjCnU,KAAKynC,cAAcznC,KAAKk9C,MAAM9zC,UAEnCq+D,EAAO,GAMX,OALAD,EAAUziE,QAAQ2C,IACVk/D,GAAeW,EAAa7/D,EAAMwL,WAClCu0D,EAAKttE,KAAKuN,EAAMyM,QAGjBszD,GAcXvC,GAASnrE,UAAU8I,IAAM,SAAUuG,EAAUyD,EAAOC,EAChD6vC,EAAM+qB,EAAYC,EAAWC,GAE7B,IAAI51C,EAAOhyB,KAGPqT,EAAMrT,KAAK0mC,eAUf,GAPA1mC,KAAK4mC,aAAavzB,EAAKrT,KAAKk9C,MAAM9zC,SAAU,CACxCA,SAAUA,GAAY,CAAC,EAAG,EAAG,GAC7ByD,MAAOA,EACPC,OAAQA,IAIR66D,EAAW,CAEX3nE,KAAK4mC,aAAavzB,EAAKrT,KAAKk9C,MAAMppC,SAClC,IAAIxS,EAAOtB,KAAKi8C,eAAe5oC,GAG3Bw0D,EAAa7nE,KAAKk9C,MAAM0oB,aAC5BtkE,EAAKwiC,OAAS,WACV9R,EAAK+0C,kBAAkB1zD,EAAKw0D,IAkBpC,OAbIlrB,IACK+qB,IAAYA,EAAa,GAAK9oE,UACnCoB,KAAK4mC,aAAavzB,EAAKrT,KAAKk9C,MAAMP,KAAM,CACpCA,KAAMA,EACN9wC,OAAQ67D,KAKZE,GACA5nE,KAAK4mC,aAAavzB,EAAKrT,KAAKk9C,MAAM0qB,OAAQ,CAAEr7B,KAAM1/B,IAG/CwG;;;;;;IC3RX,IAAI,GAAO,EAAQ,IACf,GAAU,EAAQ,IAClBy0D,GAAU,EAAQ,KAClB,GAAe,EAAQ,IAAUjiE,aAetB,MAUX,GAAW,CACXkiE,OAAO,EACPC,QAAQ,EACRC,aAAc,IACdC,YAAa,GACbC,YAAa,CAAC,EAAG,GAAI,GACrBC,gBAAgB,EAChB79C,SAAU,GACV89C,kBAAmB,GACnBjlD,mBAAmB,EACnBklD,8BAA8B,EAC9BC,yBAAyB,EACzBC,qBAAsB,IA4C1B,SAASC,GAAO57C,GACZ,KAAM7sB,gBAAgByoE,IAAS,OAAO,IAAIA,GAAO57C,GAGjD7sB,KAAKszB,QAAU,EAAQ,KAAmBA,QAE1CzG,EAAO/yB,OAAOqG,OAAO,GAAI,GAAU0sB,GACnC7sB,KAAK4U,UAAYiY,EAAKtC,SACtBvqB,KAAK0oE,gBAAkB,EACvB1oE,KAAKgiB,SAAU,EACfhiB,KAAK2oE,iBAAmB97C,EAAKy7C,6BAC7B,IAAIt2C,EAAOhyB,KAEX,IAAK6sB,EAAKm7C,OAAQ,CACd,IAAIY,EAAY/7C,EAAU,MAAI,WAAa,GAC3CztB,QAAQ2xB,IAAI,eAAe/wB,KAAKszB,UAAUs1C,KAI9C5oE,KAAK4T,kBAAoB,CAAC,EAAG,EAAG,GAChC5T,KAAK6oE,sBAAwBh8C,EAAK27C,qBAGlCxoE,KAAKsM,KAAO,GAGZtM,KAAK2U,sBAAwB,EAK7B3U,KAAKk9D,UAAY,UAMjBl9D,KAAK6pB,Ub1HM,cACX,OAAO,IAAIq4B,EAAU5uC,EAAKuZ,GayHT,CAAgB7sB,KAAM6sB,GAMvC7sB,KAAKw+B,OAAS,GAAax+B,EAAM6sB,EAAM7sB,KAAK6pB,UAAUlH,SAMtD3iB,KAAKyoD,SFzIM,cACX,OAAO,IAAI0a,GAAS7vD,EAAKuZ,GEwIT,CAAe7sB,KAAM6sB,GAMrC7sB,KAAKqqD,MNxIM,cACX,OAAO,IAAIsQ,GAAMrnD,EAAKuZ,GMuIT,CAAY7sB,KAAM6sB,GAM/B7sB,KAAKq9C,UXvIM,gBACX,OAAO,IAAIwI,EAAUvyC,EAAKuZ,EAAMw1B,GWsIf,CAAgBriD,KAAM6sB,EAAM7sB,KAAK6pB,UAAUw4B,QAM5DriD,KAAK8T,QAAU,GAAc9T,KAAM6sB,GAMnC7sB,KAAK+7C,SDzJM,cACX,OAAO,IAAImpB,GAAS5xD,EAAKuZ,GCwJT,CAAe7sB,KAAM6sB,GACrC7sB,KAAKiU,KAAOjU,KAAK+7C,SACjB,IAAI9nC,EAAOjU,KAAKiU,KAGhBjU,KAAKo8D,aAAenoD,EAAKpR,IACrBgqB,EAAKs7C,YACLt7C,EAAKq7C,YAAar7C,EAAKo7C,aACvB,KAAM,MACN,GAAM,GAIVh0D,EAAK2yB,aAAa5mC,KAAKo8D,aAAcnoD,EAAKipC,MAAMspB,gBAChDvyD,EAAK2yB,aAAa5mC,KAAKo8D,aAAcnoD,EAAKipC,MAAMwpB,iBAGhD,IAAIplE,EAAO2S,EAAKgoC,eAAej8C,KAAKo8D,cACpC96D,EAAKqgC,kBAAoB,EACzBrgC,EAAKyhC,SAAWlW,EAAKu7C,eAGrBn0D,EAAK2yB,aAAa5mC,KAAKo8D,aAAcnoD,EAAKipC,MAAM4rB,gBAGhD70D,EAAK2yB,aAAa5mC,KAAKo8D,aAAcnoD,EAAKipC,MAAM6rB,YAIhD,IA0boBz1D,EAChB01D,EACAC,EAzbJh1D,EAAK2yB,aAAa5mC,KAAKo8D,aAAcnoD,EAAKipC,MAAMqpB,SAHjC,CACXjoB,SAAU,IASdt+C,KAAKu8C,OHrMM,cACX,OAAO,IAAIwkB,GAAOztD,EAAKuZ,GGoMT,CAAa7sB,KAAM6sB,GAIjC7sB,KAAKqoE,kBAAoBx7C,EAAKw7C,kBAI9BroE,KAAKkpE,mBAAqBlpE,KAAKyoD,SAAS6T,iBAaxCt8D,KAAKmpE,cAAgB,KAGhBt8C,EAAK07C,0BAENvoE,KAAKopE,8BAAgC,SAAU1kC,GACvCA,EACA1S,EAAKqrB,UAAU8L,oBAAmB,EAAMzkB,EAAIt7B,SAAUs7B,EAAI2kC,QAE1Dr3C,EAAKqrB,UAAU8L,oBAAmB,IAG1CnpD,KAAK+I,GAAG,qBAAsB/I,KAAKopE,gCAKvCppE,KAAKspE,WAAalc,EAGdvgC,EAAKk7C,QACLzoE,OAAOgU,IAAMtT,KACbV,OAAOygD,MAAQ//C,KAAKq9C,UAAU8I,OAC9B7mD,OAAOiqE,QAAU,GACjBjqE,OAAOgN,KAAO,GACd2H,EAAK4rC,YAAY,GAAGvB,SAAW,IAC/Bt+C,KAAKwpE,gBAAkB,SAAU5lE,GAC7B,IAAIqnD,EAAKjrD,KAAKqqD,MAAMkQ,UACpBv6D,KAAKqqD,MAAMmQ,iBAAmB52D,EAAOqnD,EACrCjrD,KAAKqqD,MAAMoQ,oBAAsB72D,EAAOqnD,EAAK,EAC7CjrD,KAAKqqD,MAAM8Q,mBAAqB,KA8XpC6N,EAAM,QACNC,EAAM,CAAC/d,EAAK7tD,EAAMgvB,KAClB,IAAIo9C,EAAU,KAAQ,KAAM,4BAA4BT,OAAS38C,KACjEvyB,OAAOmE,eAAeitD,EAAK7tD,EAAM,CAAEc,IAAKsrE,EAAS/mE,IAAK+mE,MAJtCn2D,EAxXLtT,KA8XN,uBAAwB,8EACjCipE,EAAI31D,EAAK,uBAAwB,8EACjC21D,EAAI31D,EAAK,oBAAqB,2DAC9B21D,EAAI31D,EAAK,kBAAmB,iCAC5B21D,EAAI31D,EAAK,gBAAiB,gEAC1B21D,EAAI31D,EAAK,aAAc,mDACvB21D,EAAI31D,EAAI+pC,UAAW,eAAgB,iCACnC4rB,EAAI31D,EAAI+pC,UAAW,eAAgB,gCACnC4rB,EAAI31D,EAAI+pC,UAAW,mBAAoB,8BACvC4rB,EAAI31D,EAAI+pC,UAAW,kBAAmB,iCACtC4rB,EAAI31D,EAAI+pC,UAAW,oBAAqB,qCACxC4rB,EAAI31D,EAAI+pC,UAAW,oBAAqB,mDACxC4rB,EAAI31D,EAAI+pC,UAAW,oBAAqB,8DACxC2rB,EAAM,OACNC,EAAI31D,EAAI+pC,UAAW,mBAAoB,gDACvC4rB,EAAI31D,EAAI+2C,MAAO,4BAA6B,2CAC5C4e,EAAI31D,EAAI+2C,MAAO,2BAA4B,0CAC3C4e,EAAI31D,EAAI+2C,MAAO,wBAAyB,uCACxC4e,EAAI31D,EAAI+2C,MAAO,0BAA2B,yCA7Y9Coe,GAAO1uE,UAAYD,OAAO8E,OAAO,GAAa7E,WAoB9C0uE,GAAO1uE,UAAUitB,KAAO,WACpB,GAAIhnB,KAAKgiB,QACDhiB,KAAKqqD,MAAMqQ,qBAAqB16D,KAAKqqD,MAAMrjC,KAAKtT,OADxD,CAIA,GAAa,SAgKjB,SAA0BJ,GACtB,IAAIP,EAAOO,EAAIW,KAAKC,gBAAgBZ,EAAI8oD,cAAcppD,eAClDopC,EAAS9oC,EAAIu1D,sBACjB,GAAI,GAAK5kE,OAAO8O,GAAQqpC,EAASA,EAAQ,OAEzC,IADA,IAAIiP,EAAQ,GACH1xD,EAAI,EAAGA,EAAI,EAAGA,IAAK,CACxB,IAAImE,EAAIwM,KAAKhH,MAAMyP,EAAKpZ,IACxB0xD,EAAM1xD,GAAKmE,EACXwV,EAAIM,kBAAkBja,IAAMmE,EAEhCwV,EAAI+pC,UAAU+N,cAAcC,GAC5B/3C,EAAIyoC,SAASqP,cAAcC,GA1K3Bqe,CAAiB1pE,MACjB,IAAI0T,EAAK1T,KAAK4U,UAGd,GAFA5U,KAAKqqD,MAAMrjC,KAAKtT,GAChB,GAAa,SACR1T,KAAKqqD,MAAMuQ,kBAAhB,CAKA56D,KAAK8T,QAAQkT,KAAKtT,GAClB,GAAa,WACb1T,KAAKq9C,UAAUr2B,KAAKtT,GACpB,GAAa,aAuSjB,SAA4BJ,GACxB,IAAIq2D,EAAU,GACVC,EAAYt2D,EAAI41D,oBAAsB51D,EAAIm1C,SAAS6T,iBACnD5hE,EAAS4Y,EAAI8tC,WAAW,KAAM,KAAM,KAAMwoB,GAC9C,GAAIlvE,EAAQ,CACR,IAAIkuC,EAAMihC,GAEV,GAAKvmE,MAAMslC,EAAIkhC,SAAUpvE,EAAO0O,UAChC,GAAK3G,KAAKmmC,EAAIygC,OAAQ3uE,EAAO2uE,QAC7B,GAAKtmE,IAAI6lC,EAAIx/B,SAAUw/B,EAAIkhC,SAAUlhC,EAAIygC,QACzCzgC,EAAI0tB,QAAUhjD,EAAI+2C,MAAMgS,WAAWzzB,EAAIx/B,SAAS,GAAIw/B,EAAIx/B,SAAS,GAAIw/B,EAAIx/B,SAAS,IAClFkK,EAAI61D,cAAgBvgC,EACpB+gC,EAAU/gC,EAAIx/B,SAASyB,KAAK,KAAO+9B,EAAIygC,OAAOx+D,KAAK,KAAO,IAAM+9B,EAAI0tB,aAEpEhjD,EAAI61D,cAAgB,KAEpBQ,GAAWI,KACXz2D,EAAIzM,KAAK,qBAAsByM,EAAI61D,eACnCY,GAAkBJ,GAxTtBK,CAAmBhqE,MACnB,GAAa,WACbA,KAAK+7C,SAAS/0B,KAAKtT,GACnB,GAAa,YACb1T,KAAK6G,KAAK,OAAQ6M,GAClB,GAAa,cACb,GAAa,OAEb,IAAIu2D,EAAKjqE,KAAKw+B,OAAO92B,MACrBuiE,EAAGlsC,QAAUksC,EAAGjsC,QAAUisC,EAAGhsC,QAAU,OAhBnCj+B,KAAKq9C,UAAUr2B,KAAKtT,KA4B5B+0D,GAAO1uE,UAAUktB,OAAS,SAAUijD,GAEhClqE,KAAK2U,sBAAwBu1D,EAG7B,IAAI1rE,EAAIi/B,YAAYC,MAChBhqB,EAAKlV,GAAKwB,KAAK0oE,iBAAoBlqE,EAAI,IAC3CwB,KAAK0oE,gBAAkBlqE,EAGnBwB,KAAKgiB,QACDhiB,KAAKqqD,MAAMqQ,qBAAqB16D,KAAKqqD,MAAMpjC,UAInDkjD,GAAoB,UAGhBnqE,KAAK6pB,UAAU+4B,iBACd5iD,KAAK6pB,UAAUg5B,qBACf7iD,KAAK2oE,kBAAoB3oE,KAAKw+B,OAAO92B,MAAM0iE,OAC5CpqE,KAAKu8C,OAAOklB,sBAEhB0I,GAAoB,QAGpBnqE,KAAKqqD,MAAMpjC,OAAOvT,GAClBy2D,GAAoB,WAGpBnqE,KAAKu8C,OAAO6lB,kCACZpiE,KAAK+7C,SAAS90B,OAAOvT,GACrB1T,KAAKu8C,OAAO8lB,iCACZ8H,GAAoB,YAGpBnqE,KAAK6G,KAAK,eAAgB6M,GAC1By2D,GAAoB,iBAEpBnqE,KAAKq9C,UAAUp2B,OAAOvT,GACtBy2D,GAAoB,UAEpBnqE,KAAK6G,KAAK,cAAe6M,GACzBy2D,GAAoB,gBACpBA,GAAoB,OAGpBnqE,KAAKw+B,OAAO92B,MAAMkY,GAAK5f,KAAKw+B,OAAO92B,MAAMmY,GAAK,IA2BlD4oD,GAAO1uE,UAAUwZ,cAAgB,SAAUlF,EAAQg8D,EAAer1D,GAC9D,IAAIxL,EAAMxJ,KAAK4T,kBACf,GAAIy2D,EAAe,CACf,IAAK,IAAI1wE,EAAI,EAAGA,EAAI,EAAGA,IAAK,CACxB,IAAIue,EAAQ7J,EAAO1U,GAAK6P,EAAI7P,GAC5Bue,GAASmyD,EAAc1wE,GACvBqb,EAAMrb,GAAKue,EAEf,OAAOlD,EAEP,OAAO,GAAKjS,IAAIiS,EAAO3G,EAAQ7E,IAmBvCi/D,GAAO1uE,UAAUunE,cAAgB,SAAUtsD,EAAO3G,EAAQg8D,GACtD,IAAI7gE,EAAMxJ,KAAK4T,kBACf,GAAIy2D,EAAe,CACf,IAAK,IAAI1wE,EAAI,EAAGA,EAAI,EAAGA,IAAK,CACxB,IAAI2wE,EAAUhgE,KAAKhH,MAAM0R,EAAMrb,IAC/B0U,EAAO1U,GAAK2wE,EAAU9gE,EAAI7P,GAC1B0wE,EAAc1wE,GAAKqb,EAAMrb,GAAK2wE,EAElC,OAAOj8D,EAEP,OAAO,GAAKxL,IAAIwL,EAAQ2G,EAAOxL,IAuCvCi/D,GAAO1uE,UAAUwwE,UAAY,SAAUh/C,GACnCvrB,KAAKgiB,UAAYuJ,EAEZA,IACDvrB,KAAKw+B,OAAO92B,MAAMkY,GAAK5f,KAAKw+B,OAAO92B,MAAMmY,GAAK,IAKtD4oD,GAAO1uE,UAAUwuD,SAAW,SAAUhzC,EAAG/T,EAAGgU,GACxC,OAAID,EAAE1b,OACKmG,KAAKqqD,MAAMgS,WAAW9mD,EAAE,GAAIA,EAAE,GAAIA,EAAE,IAEpCvV,KAAKqqD,MAAMgS,WAAW9mD,EAAG/T,EAAGgU,IAK3CizD,GAAO1uE,UAAUywE,SAAW,SAAU31D,EAAIU,EAAG/T,EAAGgU,GAE5C,OAAID,EAAE1b,OACKmG,KAAKqqD,MAAMwS,WAAWhoD,EAAIU,EAAE,GAAIA,EAAE,GAAIA,EAAE,IAExCvV,KAAKqqD,MAAMwS,WAAWhoD,EAAIU,EAAG/T,EAAGgU,IAO/CizD,GAAO1uE,UAAU0wE,SAAW,SAAU51D,EAAIU,EAAG/T,EAAGgU,GAE5C,GAAID,EAAE1b,OAAQ,CACV,GAAImG,KAAK+7C,SAASirB,iBAAiBzxD,EAAE,GAAIA,EAAE,GAAIA,EAAE,IAAK,OAEtD,OADAvV,KAAKqqD,MAAMwS,WAAWhoD,EAAIU,EAAE,GAAIA,EAAE,GAAIA,EAAE,IACjCV,EAEP,IAAI7U,KAAK+7C,SAASirB,iBAAiBzxD,EAAG/T,EAAGgU,GAEzC,OADAxV,KAAKqqD,MAAMwS,WAAWhoD,EAAIU,EAAG/T,EAAGgU,GACzBX,GAuBf4zD,GAAO1uE,UAAU2wE,KAAO,SAAUn+D,EAAKC,EAAK5I,EAAM+mE,GAC9C,OAAa,IAAT/mE,EAAmB,MAEnB2I,IACAvM,KAAKuT,cAAchH,EAAK,KAAMq+D,IAC9Br+D,EAAMq+D,IAEH5qE,KAAKohD,WAAW70C,EAAKC,EAAK5I,EAAM+mE,KAE3C,IAAIC,GAAW,GAAKhsE,SAapB6pE,GAAO1uE,UAAUqnD,WAAa,SAAU70C,EAAKC,EAAK5I,EAAM+mE,GAEpD,GAAa,IAAT/mE,EAAY,OAAO,KACvB,IAAIinE,EAASF,GAAuB3qE,KAAKyoD,SAAS6T,iBAC9CjS,EAAQrqD,KAAKqqD,MACb7gD,EAAMxJ,KAAK4T,kBAKVrH,IAAKA,EAAMvM,KAAKu8C,OAAO6L,2BAC5B57C,EAAMA,GAAOxM,KAAKu8C,OAAOilB,eACzB59D,EAAOA,GAAQ5D,KAAKqoE,kBACpB,IAAI9qB,EAAOutB,GAAW93D,eAClB+3D,EAAQD,GAAWzB,OAEvB,OADUvB,IATM,SAAUvyD,EAAG/T,EAAGgU,GAC5B,IAAIX,EAAKw1C,EAAMgS,WAAW9mD,EAAI/L,EAAI,GAAIhI,EAAIgI,EAAI,GAAIgM,EAAIhM,EAAI,IAC1D,OAAOqhE,EAAOh2D,KAOWtI,EAAKC,EAAK5I,EAAM25C,EAAMwtB,IAInD,GAAKrnE,YAAY65C,EAAMA,EAAMwtB,EAAO,KAEpC/qE,KAAKshE,cAAc/jB,EAAMutB,GAAW1hE,UAC7B0hE,IANU,MAQrB,IAAIA,GAAa,CACb93D,eAAgB,GAAKpU,SACrBwK,SAAU,CAAC,EAAG,EAAG,GACjBigE,OAAQ,CAAC,EAAG,EAAG,IAgCnB,IAAIQ,GAAoB,CACpBvT,QAAS,EACTltD,SAAU,GACVigE,OAAQ,GACRS,SAAU,IAGVC,GAAkB,GA6CtB,IAAI,GACkC,OAClCI,GACkC,O,UCrpBtC,IC4FIa,GACAC,GACAC,GD1FAC,GAAW,EAAQ,KACnB/lC,GAAU,G,OEId,IAAI,GAAM,IAAI,GAAO,CACjB2iC,OAAO,EACP5iB,SAAS,EACTub,UAAU,EACVD,UAAU,EACVlG,UAAW,GACXC,iBAAkB,IAClBC,oBAAqB,EACrB4N,kBAAmB,GACnBxF,YAAa,YACbsF,YAAa,CAAC,GAAK,EAAG,IACtBF,aAAc,IACdC,YAAa,GACbE,gBAAgB,EAChB3iB,OAAO,EACPC,cAAe,CAAC,IAAM,GAAK,IAC3BC,oBAAqB,KFXlB,SAAsBryC,EAAK83D,GAG9B93D,EAAI4pD,UAjBK,SAkBT5pD,EAAIkrB,OAAO1/B,KAAK,aAAc,KAC9BwU,EAAIkrB,OAAOzZ,KAAKhc,GAAG,cAAc,WAC7BuK,EAAI4pD,UApBC,WAoBY5pD,EAAI4pD,UAnBhB,SADA,YAyBT5pD,EAAI+2C,MAAMthD,GAAG,qBAAqB,SAAU8L,EAAI9I,EAAOixD,GAlB1C,EAACnoD,EAAI9M,KAAUq9B,GAAQvwB,GAAMs2D,GAASzpB,OAAO35C,EAAI1O,OAmB1DgyE,CAAWx2D,EAAI9I,MAKnB,IAAIu/D,EAAe,GA8DnB,SAASC,EAAah2D,EAAGC,EAAGg2D,EAAOC,GAG/B,MAFS,GAAM,EAAInhE,KAAK6T,IAAI5I,EAAIi2D,IACvB,GAAM,EAAIlhE,KAAK6T,IAAI3I,EAAIi2D,EAAQl2D,EAAI,KAIhD,SAASm2D,EAAYn2D,EAAG/T,EAAGgU,EAAG1I,GAE1B,GAAIyI,EAAI,GAAKC,EAAI,EAAG,CAChB,IAAImU,EAAI,EAER,OADS,IAALnU,GAAgB,IAALD,IAASoU,EAAI,IACpBnoB,EAAImoB,EAAKyhD,EAASO,QAAU,EAGxC,OAAInqE,EAAIsL,EACItL,EAAI,EAAK4pE,EAASQ,OAASR,EAASO,QAEpCnqE,EAAI,EAAK4pE,EAASS,QAAU,EAqC5C,SAASC,EAASjyE,EAAQ0b,EAAGC,EAAG+2C,GAC5B,IAAK,IAAI5yD,EAAI,EAAGA,EAAIE,EAAQF,IACxB2Z,EAAIk3D,SAASje,EAAOh3C,EAAI5b,EAAG,EAAG6b,EAAI7b,GAClC2Z,EAAIk3D,SAASje,EAAgB,EAAT1yD,EAAa0b,EAAI5b,EAAG,EAAG6b,EAAI7b,GAtHvD2Z,EAAI+2C,MAAMthD,GAAG,mBAAmB,SAAU8L,EAAI9I,EAAOwJ,EAAG/T,EAAGgU,EAAG0nD,GAC1DoO,EAAanxE,KAAK,CAAE0a,KAAI9I,QAAOwJ,IAAG/T,IAAGgU,IAAG0nD,iBAM5C53C,aAAY,WACR,GAA4B,IAAxBgmD,EAAazxE,OAAjB,CACA,IAnCagb,EAmCTwzB,EAAMijC,EAAahxE,QAnCVua,EAoCKwzB,EAAIxzB,GApCSuwB,GAAQvwB,GAE3B,EAACA,EAAI9M,KAAUojE,GAASrpB,OAAO1c,GAAQvwB,GAAK9M,EAAI1O,OAmCxD0yE,CAAc1jC,EAAIxzB,GAAIwzB,EAAIt8B,OAalC,SAAuBA,EAAOwJ,EAAG/T,EAAGgU,EAAG0nD,GAxD9B,WAyDDA,GAIR,SAAwBnxD,EAAOwJ,EAAG/T,EAAGgU,GACjC,IAAK,IAAI7b,EAAI,EAAGA,EAAIoS,EAAMH,MAAM,KAAMjS,EAClC,IAAK,IAAIwhB,EAAI,EAAGA,EAAIpP,EAAMH,MAAM,KAAMuP,EAElC,IADA,IAAIrO,EAASy+D,EAAah2D,EAAI5b,EAAG6b,EAAI2F,EAAG,GAAI,IACnCtgB,EAAI,EAAGA,EAAIkR,EAAMH,MAAM,KAAM/Q,EAAG,CACrC,IAAI6E,EAAIgsE,EAAYn2D,EAAI5b,EAAG6H,EAAI3G,EAAG2a,EAAI2F,EAAGrO,GACrCpN,GAAGqM,EAAMrJ,IAAI/I,EAAGkB,EAAGsgB,EAAGzb,IAVZssE,CAAejgE,EAAOwJ,EAAG/T,EAAGgU,GAxDjD,WAyDD0nD,GAeR,SAAwBnxD,EAAOwJ,EAAG/T,EAAGgU,GACjC,IAAK,IAAI7b,EAAI,EAAGA,EAAIoS,EAAMH,MAAM,KAAMjS,EAClC,IAAK,IAAIwhB,EAAI,EAAGA,EAAIpP,EAAMH,MAAM,KAAMuP,EAElC,IADA,IAAIrO,EAASy+D,EAAah2D,EAAI5b,EAAG6b,EAAI2F,EAAG,GAAI,IACnCtgB,EAAI,EAAGA,EAAIkR,EAAMH,MAAM,KAAM/Q,EAAG,CACrC,IAAI6E,EAAIgsE,EAAYn2D,EAAI5b,EAAG6H,EAAI3G,EAAG2a,EAAI2F,EAAGrO,GACrCpN,IAAM0rE,EAASO,UAASjsE,EAAI0rE,EAASa,UACrCvsE,GAAGqM,EAAMrJ,IAAI/I,EAAGkB,EAAGsgB,EAAGzb,IAtBZwsE,CAAengE,EAAOwJ,EAAG/T,EAAGgU,GAblD22D,CAAc9jC,EAAIt8B,MAAOs8B,EAAI9yB,EAAG8yB,EAAI7mC,EAAG6mC,EAAI7yB,EAAG6yB,EAAI60B,WAGtD5pD,EAAI+2C,MAAM0S,aAAa10B,EAAIxzB,GAAIwzB,EAAIt8B,UACpC,IAuEHvO,YAAW,YAIX,WACI8V,EAAIk3D,SAASY,EAASgB,SAAU,EAAG,EAAG,GACtC94D,EAAIk3D,SAASY,EAASiB,SAAU,EAAG,EAAG,GACtC/4D,EAAIk3D,SAASY,EAASkB,SAAU,EAAG,EAAG,GAEtCh5D,EAAIk3D,SAASY,EAASmB,WAAY,IAAK,EAAG,GAC1Cj5D,EAAIk3D,SAASY,EAASmB,WAAY,IAAK,EAAG,GAC1Cj5D,EAAIk3D,SAASY,EAASmB,WAAY,IAAK,EAAG,GAE1C,IAAI/2D,EAAI,EACRs2D,EAAS,GAAI,EAAGt2D,EAAG41D,EAASoB,aAC5BV,EAAS,GAAI,EAAGt2D,EAAI,EAAG41D,EAASQ,QAChCE,EAAS,GAAI,EAAGt2D,EAAI,EAAG41D,EAASQ,QAChCE,EAAS,GAAI,EAAGt2D,EAAI,EAAG41D,EAASQ,QAChCE,EAAS,GAAI,EAAGt2D,EAAI,GAAI41D,EAASQ,QAEjCE,EAAS,GAAI,EADbt2D,GAAK,GACc41D,EAASqB,UAC5BX,EAAS,GAAI,EAAGt2D,EAAI,EAAG41D,EAASqB,UAChCX,EAAS,GAAI,EAAGt2D,EAAI,EAAG41D,EAASqB,UAChCX,EAAS,GAAI,EAAGt2D,EAAI,EAAG41D,EAASqB,UAChCX,EAAS,GAAI,EAAGt2D,EAAI,GAAI41D,EAASqB,UAvBjCC,KACD,KEzFPC,CAAa,GC9BN,SAA0Br5D,GAG7B,IAAIs5D,EAAW,CAAC,IAAM,IAAM,KAG5Bt5D,EAAIm1C,SAAS6b,iBAAiB,QAFf,CAAC,GAAK,GAAK,IAEuB,MACjDhxD,EAAIm1C,SAAS6b,iBAAiB,SAFd,CAAC,GAAK,GAAK,IAEwB,MACnDhxD,EAAIm1C,SAAS6b,iBAAiB,OAAQsI,EAAU,MAAM,GAEtD,IADA,IAAIC,EAAO,CAAC,IAAK,IAAK,IAAK,IAAK,IAAK,KAC5BlzE,EAAI,EAAGA,EAAI,EAAGA,IAAK,CACxB,IAAIsB,EAAI4xE,EAAKlzE,GACb2Z,EAAIm1C,SAAS6b,iBAAiBrpE,EAAG,KAAMA,EAAI,QAC3CqY,EAAIm1C,SAAS6b,iBAAiB,IAAMrpE,EAAG,KAAM,IAAMA,EAAI,QAAQ,GAEnEqY,EAAIm1C,SAAS6b,iBAAiB,QAAS,CAAC,GAAK,GAAK,GAAK,IAAM,MAI7D,IAAIvkB,EAAQzsC,EAAI+pC,UAAU2C,WAItB8sB,EAAWx5D,EAAI+pC,UAAUgD,qBAAqB,gBAClDysB,EAAS/hB,cAAcvN,eAAe,EAAG,EAAG,GAC5CsvB,EAASC,cAAgB,GACzBD,EAASE,YAAc,IAAI,KAAQ,qBAAsBjtB,GACzDzsC,EAAIm1C,SAAS6b,iBAAiB,YAAasI,EAAU,MAAM,EAAOE,GAIlE,IAAInwB,EAAO,IAAKswB,UAAU,IAAK,EAAGltB,GAC9B+K,EAAM,IAAOoiB,QAAQ,GAAK,EAAG,IACjCpiB,EAAIqiB,eAAe,IAAI,IAAQ,EAAG,GAAK,IACvCxwB,EAAKywB,0BAA0BtiB,GAC/B/K,EAAMY,WAAWhE,GAIjB,IAAIyuB,EAAW,GACXiC,EAAM,EAgCV,OA9BAjC,EAASQ,OAASt4D,EAAIm1C,SAASkb,cAAc0J,IAAO,CAAEjtB,SAAU,SAChEgrB,EAASoB,YAAcl5D,EAAIm1C,SAASkb,cAAc0J,IAAO,CAAEjtB,SAAU,cACrEgrB,EAASO,QAAUr4D,EAAIm1C,SAASkb,cAAc0J,IAAO,CAAEjtB,SAAU,UACjEgrB,EAASa,SAAW34D,EAAIm1C,SAASkb,cAAc0J,IAAO,CAAEjtB,SAAU,WAClEgrB,EAASgB,QAAU94D,EAAIm1C,SAASkb,cAAc0J,IAAO,CAAEjtB,SAAU,CAAC,IAAK,IAAK,IAAK,IAAK,IAAK,OAC3FgrB,EAASiB,QAAU/4D,EAAIm1C,SAASkb,cAAc0J,IAAO,CACjDjtB,SAAU,CAAC,KAAM,KAAM,KAAM,KAAM,KAAM,MACzC4iB,QAAQ,IAEZoI,EAASkB,QAAUh5D,EAAIm1C,SAASkb,cAAc0J,IAAO,CAAEjtB,SAAU,CAAC,IAAK,IAAK,OAC5EgrB,EAASS,QAAUv4D,EAAIm1C,SAASkb,cAAc0J,IAAO,CACjDjtB,SAAU,QACVyjB,OAAO,IAEXuH,EAASqB,SAAWn5D,EAAIm1C,SAASkb,cAAc0J,IAAO,CAClDvJ,UAAWnnB,EACXqmB,QAAQ,EACRtM,mBAAoB,SAAU/Z,EAAMpnC,EAAG/T,EAAGgU,GACtCmnC,EAAKwD,SAAS3+C,GAAmB,OAAb+T,EAAI,MAA+B,MAAbC,EAAI,QAAkB,EAAIlL,KAAK0T,OAIjFotD,EAASmB,UAAYj5D,EAAIm1C,SAASkb,cAAc0J,IAAO,CACnDvJ,UAAWnnB,EACXomB,OAAO,EACPC,QAAQ,EACR5iB,SAAU,QACVyjB,OAAO,IAGJuH,ED7CIkC,CAAiB,KD7BzB,SAA2Bh6D,GAE9B,IAAID,EAAMC,EAAI8oD,aACVxzB,EAAMt1B,EAAIyoC,SAAS7nC,gBAAgBb,GACnCrM,EAAI4hC,EAAI/7B,MACR8c,EAAIif,EAAI97B,OAGRygE,EAAa,IAAKN,UAAU,SAAU,EAAG35D,EAAI+pC,UAAU2C,YAC3DutB,EAAWjsB,QAAQ/rC,EAAIg4D,EAAWjsB,QAAQ9rC,EAAIxO,EAC9CumE,EAAWjsB,QAAQ9/C,EAAImoB,EAGvB,IAAI9d,EAAS,CAAC,EAAG8d,EAAI,EAAG,GAGxBrW,EAAIyoC,SAASnV,aAAavzB,EAAKC,EAAIyoC,SAASmB,MAAMP,KAAM,CACpDA,KAAM4wB,EACN1hE,OAAQA,ICiBhB2hE,CAAkB,IElCX,SAA2Bl6D,GAG9BA,EAAIkrB,OAAOzZ,KAAKhc,GAAG,QAAQ,WACnBuK,EAAI61D,eAAe71D,EAAIk3D,SAAS,EAAGl3D,EAAI61D,cAAc//D,aAK7D,IAAIqkE,EAAW,EACfn6D,EAAIkrB,OAAOzZ,KAAKhc,GAAG,YAAY,WACvBuK,EAAI61D,eAAe71D,EAAIm3D,SAASgD,EAAUn6D,EAAI61D,cAAcW,aAKpEx2D,EAAIkrB,OAAOzZ,KAAKhc,GAAG,YAAY,WACvBuK,EAAI61D,gBAAesE,EAAWn6D,EAAI61D,cAAc7S,YAKxDhjD,EAAIkrB,OAAO1/B,KAAK,QAAS,KACzBwU,EAAIkrB,OAAOzZ,KAAKhc,GAAG,SAAS,WACxBwiB,GAAUA,EACVjY,EAAIi3D,UAAUh/C,MAElB,IAAIA,GAAS,EAIbjY,EAAIkrB,OAAO1/B,KAAK,QAAS,KACzB,IACI4uE,EAAUvxE,EADVwxE,EAAQ,IHTT,SAAyBr6D,GAC5B,IAAIW,EAAOX,EAAIyoC,SAGVivB,KACDA,GAAW,IAAK4C,aAAa,OAAQ,EAAG,GAAYt6D,EAAI+pC,UAAU2C,aAItE,IAAI6tB,EAAU55D,EAAK2wB,YAAYtxB,EAAI8oD,cAC/B7vD,EAAM,CAACshE,EAAQ,GAAIA,EAAQ,GAAK,GAAKA,EAAQ,IAI7ClxB,EAAOquB,GAASnqB,eAAe,iBAC/B6mB,EAAa,CAAC,EAbL,GAagB,GAIzB7yD,EAAKvB,EAAIyoC,SAASl5C,IAClB0J,EATQ,GACC,GASTowC,EAAM+qB,GALM,GACH,GAQTpmE,EAAO2S,EAAKgoC,eAAepnC,GAC/BvT,EAAK2/B,YAAc,GACnB3/B,EAAK0/B,SAAW,GAGhB,IAFA,IAAIzqB,EAAMjD,EAAIipC,OAAOilB,eACjBsM,EAAM,GACDn0E,EAAI,EAAGA,EAAI,EAAGA,IAAKm0E,EAAIn0E,GAAK,EAAI4c,EAAI5c,GAC7Cm0E,EAAI,IAAM,EACVxsE,EAAK0iC,aAAa8pC,GAIb7C,KAAgBA,GAAiB,CAACp2D,EAAIooC,KAIvC,IAHA,IAAI8wB,EAAK95D,EAAK2wB,YAAY/vB,GACtBm5D,EAAK/5D,EAAK2wB,YAAYqY,GACtB6wB,EAAM,GACDn0E,EAAI,EAAGA,EAAI,EAAGA,IAAKm0E,EAAIn0E,GAAK,GAAKo0E,EAAGp0E,GAAKq0E,EAAGr0E,IAC7Csa,EAAKgoC,eAAepnC,GAC1BmvB,aAAa8pC,KAEnB75D,EAAK2yB,aAAa/xB,EAAIZ,EAAKipC,MAAMwpB,gBAAiB,CAC9Cj+B,UAAU,EACVjyB,SAAWymC,GAAUguB,GAAep2D,EAAIooC,KAKvCiuB,KAAYA,GAAaj3D,EAAK8yB,gBAAgB,CAC/C1pC,KAAM,SACNoW,OAAQ,CAACC,EAAIC,KACT,IAAIo6D,EAAK95D,EAAK2wB,YAAYtxB,EAAI8oD,cAC9BzoD,EAAO5O,QAAQ2C,IAGX,IAFA,IAAIsmE,EAAK/5D,EAAK2wB,YAAYl9B,EAAMyM,MAC5BvQ,EAAO,EACFjK,EAAI,EAAGA,EAAI,EAAGA,IAAKiK,GAAQ0G,KAAKC,IAAIwjE,EAAGp0E,GAAKq0E,EAAGr0E,IACpDiK,EAAO,KAAKqQ,EAAK4yB,aAAan/B,EAAMyM,YAIpDF,EAAK2yB,aAAa/xB,EAAIq2D,IGtDJ+C,CAAgB36D,GAElCA,EAAIkrB,OAAOzZ,KAAKhc,GAAG,SAAS,WACxB4kE,IACAxxE,EAAUqB,WAAW,KACjBkwE,EAAWpoD,YAAYqoD,EAAO,KAC/B,QAEPr6D,EAAIkrB,OAAOrZ,GAAGpc,GAAG,SAAS,WACtBjM,aAAaX,GACbqpB,cAAckoD,MAKlBp6D,EAAIvK,GAAG,QAAQ,SAAU2K,GACrB,IAAI2P,EAAS/P,EAAIkrB,OAAO92B,MAAMs2B,QACf,IAAX3a,IACA/P,EAAIipC,OAAO2kB,cAAiB79C,EAAS,EAAK,GAAK,EAC3C/P,EAAIipC,OAAO2kB,aAAe,IAAG5tD,EAAIipC,OAAO2kB,aAAe,GACvD5tD,EAAIipC,OAAO2kB,aAAe,KAAI5tD,EAAIipC,OAAO2kB,aAAe,QAMpE,IAAI6G,GAAQ,EACRhoB,EAAQzsC,EAAI+pC,UAAU2C,WAC1B1sC,EAAIkrB,OAAO1/B,KAAK,QAAS,KACzBwU,EAAIkrB,OAAOzZ,KAAKhc,GAAG,QAAS,KAExB,kCAA+B3H,KAAK/H,KAChC0uE,GAASA,GACEhoB,EAAMmuB,WAAW9kB,OACvBrJ,EAAMmuB,WAAWC,WF7BlCC,CAAkB","file":"bundle.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t1: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// script path function\n \tfunction jsonpScriptSrc(chunkId) {\n \t\treturn __webpack_require__.p + \"\" + chunkId + \".bundle.js\"\n \t}\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n \t// This file contains only the entry chunk.\n \t// The chunk loading function for additional chunks\n \t__webpack_require__.e = function requireEnsure(chunkId) {\n \t\tvar promises = [];\n\n\n \t\t// JSONP chunk loading for javascript\n\n \t\tvar installedChunkData = installedChunks[chunkId];\n \t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n \t\t\t// a Promise means \"currently loading\".\n \t\t\tif(installedChunkData) {\n \t\t\t\tpromises.push(installedChunkData[2]);\n \t\t\t} else {\n \t\t\t\t// setup Promise in chunk cache\n \t\t\t\tvar promise = new Promise(function(resolve, reject) {\n \t\t\t\t\tinstalledChunkData = installedChunks[chunkId] = [resolve, reject];\n \t\t\t\t});\n \t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n \t\t\t\t// start chunk loading\n \t\t\t\tvar script = document.createElement('script');\n \t\t\t\tvar onScriptComplete;\n\n \t\t\t\tscript.charset = 'utf-8';\n \t\t\t\tscript.timeout = 120;\n \t\t\t\tif (__webpack_require__.nc) {\n \t\t\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n \t\t\t\t}\n \t\t\t\tscript.src = jsonpScriptSrc(chunkId);\n\n \t\t\t\t// create error before stack unwound to get useful stacktrace later\n \t\t\t\tvar error = new Error();\n \t\t\t\tonScriptComplete = function (event) {\n \t\t\t\t\t// avoid mem leaks in IE.\n \t\t\t\t\tscript.onerror = script.onload = null;\n \t\t\t\t\tclearTimeout(timeout);\n \t\t\t\t\tvar chunk = installedChunks[chunkId];\n \t\t\t\t\tif(chunk !== 0) {\n \t\t\t\t\t\tif(chunk) {\n \t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n \t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n \t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n \t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n \t\t\t\t\t\t\terror.type = errorType;\n \t\t\t\t\t\t\terror.request = realSrc;\n \t\t\t\t\t\t\tchunk[1](error);\n \t\t\t\t\t\t}\n \t\t\t\t\t\tinstalledChunks[chunkId] = undefined;\n \t\t\t\t\t}\n \t\t\t\t};\n \t\t\t\tvar timeout = setTimeout(function(){\n \t\t\t\t\tonScriptComplete({ type: 'timeout', target: script });\n \t\t\t\t}, 120000);\n \t\t\t\tscript.onerror = script.onload = onScriptComplete;\n \t\t\t\tdocument.head.appendChild(script);\n \t\t\t}\n \t\t}\n \t\treturn Promise.all(promises);\n \t};\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// on error function for async loading\n \t__webpack_require__.oe = function(err) { console.error(err); throw err; };\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([279,0]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","module.exports = {\n  EPSILON: require('./epsilon')\n  , create: require('./create')\n  , clone: require('./clone')\n  , angle: require('./angle')\n  , fromValues: require('./fromValues')\n  , copy: require('./copy')\n  , set: require('./set')\n  , equals: require('./equals')\n  , exactEquals: require('./exactEquals')\n  , add: require('./add')\n  , subtract: require('./subtract')\n  , sub: require('./sub')\n  , multiply: require('./multiply')\n  , mul: require('./mul')\n  , divide: require('./divide')\n  , div: require('./div')\n  , min: require('./min')\n  , max: require('./max')\n  , floor: require('./floor')\n  , ceil: require('./ceil')\n  , round: require('./round')\n  , scale: require('./scale')\n  , scaleAndAdd: require('./scaleAndAdd')\n  , distance: require('./distance')\n  , dist: require('./dist')\n  , squaredDistance: require('./squaredDistance')\n  , sqrDist: require('./sqrDist')\n  , length: require('./length')\n  , len: require('./len')\n  , squaredLength: require('./squaredLength')\n  , sqrLen: require('./sqrLen')\n  , negate: require('./negate')\n  , inverse: require('./inverse')\n  , normalize: require('./normalize')\n  , dot: require('./dot')\n  , cross: require('./cross')\n  , lerp: require('./lerp')\n  , random: require('./random')\n  , transformMat4: require('./transformMat4')\n  , transformMat3: require('./transformMat3')\n  , transformQuat: require('./transformQuat')\n  , rotateX: require('./rotateX')\n  , rotateY: require('./rotateY')\n  , rotateZ: require('./rotateZ')\n  , forEach: require('./forEach')\n}\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n  }\n\nvar ReflectOwnKeys\nif (R && typeof R.ownKeys === 'function') {\n  ReflectOwnKeys = R.ownKeys\n} else if (Object.getOwnPropertySymbols) {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target)\n      .concat(Object.getOwnPropertySymbols(target));\n  };\n} else {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target);\n  };\n}\n\nfunction ProcessEmitWarning(warning) {\n  if (console && console.warn) console.warn(warning);\n}\n\nvar NumberIsNaN = Number.isNaN || function NumberIsNaN(value) {\n  return value !== value;\n}\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._eventsCount = 0;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nvar defaultMaxListeners = 10;\n\nfunction checkListener(listener) {\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n}\n\nObject.defineProperty(EventEmitter, 'defaultMaxListeners', {\n  enumerable: true,\n  get: function() {\n    return defaultMaxListeners;\n  },\n  set: function(arg) {\n    if (typeof arg !== 'number' || arg < 0 || NumberIsNaN(arg)) {\n      throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received ' + arg + '.');\n    }\n    defaultMaxListeners = arg;\n  }\n});\n\nEventEmitter.init = function() {\n\n  if (this._events === undefined ||\n      this._events === Object.getPrototypeOf(this)._events) {\n    this._events = Object.create(null);\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || NumberIsNaN(n)) {\n    throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received ' + n + '.');\n  }\n  this._maxListeners = n;\n  return this;\n};\n\nfunction _getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return _getMaxListeners(this);\n};\n\nEventEmitter.prototype.emit = function emit(type) {\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    ReflectApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      ReflectApply(listeners[i], this, args);\n  }\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  checkListener(listener);\n\n  events = target._events;\n  if (events === undefined) {\n    events = target._events = Object.create(null);\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener !== undefined) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (existing === undefined) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] =\n        prepend ? [listener, existing] : [existing, listener];\n      // If we've already got an array, just append.\n    } else if (prepend) {\n      existing.unshift(listener);\n    } else {\n      existing.push(listener);\n    }\n\n    // Check for listener leak\n    m = _getMaxListeners(target);\n    if (m > 0 && existing.length > m && !existing.warned) {\n      existing.warned = true;\n      // No error code for this since it is a Warning\n      // eslint-disable-next-line no-restricted-syntax\n      var w = new Error('Possible EventEmitter memory leak detected. ' +\n                          existing.length + ' ' + String(type) + ' listeners ' +\n                          'added. Use emitter.setMaxListeners() to ' +\n                          'increase limit');\n      w.name = 'MaxListenersExceededWarning';\n      w.emitter = target;\n      w.type = type;\n      w.count = existing.length;\n      ProcessEmitWarning(w);\n    }\n  }\n\n  return target;\n}\n\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction onceWrapper() {\n  if (!this.fired) {\n    this.target.removeListener(this.type, this.wrapFn);\n    this.fired = true;\n    if (arguments.length === 0)\n      return this.listener.call(this.target);\n    return this.listener.apply(this.target, arguments);\n  }\n}\n\nfunction _onceWrap(target, type, listener) {\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n  var wrapped = onceWrapper.bind(state);\n  wrapped.listener = listener;\n  state.wrapFn = wrapped;\n  return wrapped;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  checkListener(listener);\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      checkListener(listener);\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// Emits a 'removeListener' event if and only if the listener was removed.\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      checkListener(listener);\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      list = events[type];\n      if (list === undefined)\n        return this;\n\n      if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0)\n          this._events = Object.create(null);\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n          if (list[i] === listener || list[i].listener === listener) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (position === 0)\n          list.shift();\n        else {\n          spliceOne(list, position);\n        }\n\n        if (list.length === 1)\n          events[type] = list[0];\n\n        if (events.removeListener !== undefined)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events, i;\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (events.removeListener === undefined) {\n        if (arguments.length === 0) {\n          this._events = Object.create(null);\n          this._eventsCount = 0;\n        } else if (events[type] !== undefined) {\n          if (--this._eventsCount === 0)\n            this._events = Object.create(null);\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        var key;\n        for (i = 0; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = Object.create(null);\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners !== undefined) {\n        // LIFO order\n        for (i = listeners.length - 1; i >= 0; i--) {\n          this.removeListener(type, listeners[i]);\n        }\n      }\n\n      return this;\n    };\n\nfunction _listeners(target, type, unwrap) {\n  var events = target._events;\n\n  if (events === undefined)\n    return [];\n\n  var evlistener = events[type];\n  if (evlistener === undefined)\n    return [];\n\n  if (typeof evlistener === 'function')\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n  return unwrap ?\n    unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  return _listeners(this, type, true);\n};\n\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\n  return _listeners(this, type, false);\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events !== undefined) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener !== undefined) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];\n};\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction spliceOne(list, index) {\n  for (; index + 1 < list.length; index++)\n    list[index] = list[index + 1];\n  list.pop();\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n","var iota = require(\"iota-array\")\nvar isBuffer = require(\"is-buffer\")\n\nvar hasTypedArrays  = ((typeof Float64Array) !== \"undefined\")\n\nfunction compare1st(a, b) {\n  return a[0] - b[0]\n}\n\nfunction order() {\n  var stride = this.stride\n  var terms = new Array(stride.length)\n  var i\n  for(i=0; i<terms.length; ++i) {\n    terms[i] = [Math.abs(stride[i]), i]\n  }\n  terms.sort(compare1st)\n  var result = new Array(terms.length)\n  for(i=0; i<result.length; ++i) {\n    result[i] = terms[i][1]\n  }\n  return result\n}\n\nfunction compileConstructor(dtype, dimension) {\n  var className = [\"View\", dimension, \"d\", dtype].join(\"\")\n  if(dimension < 0) {\n    className = \"View_Nil\" + dtype\n  }\n  var useGetters = (dtype === \"generic\")\n\n  if(dimension === -1) {\n    //Special case for trivial arrays\n    var code =\n      \"function \"+className+\"(a){this.data=a;};\\\nvar proto=\"+className+\".prototype;\\\nproto.dtype='\"+dtype+\"';\\\nproto.index=function(){return -1};\\\nproto.size=0;\\\nproto.dimension=-1;\\\nproto.shape=proto.stride=proto.order=[];\\\nproto.lo=proto.hi=proto.transpose=proto.step=\\\nfunction(){return new \"+className+\"(this.data);};\\\nproto.get=proto.set=function(){};\\\nproto.pick=function(){return null};\\\nreturn function construct_\"+className+\"(a){return new \"+className+\"(a);}\"\n    var procedure = new Function(code)\n    return procedure()\n  } else if(dimension === 0) {\n    //Special case for 0d arrays\n    var code =\n      \"function \"+className+\"(a,d) {\\\nthis.data = a;\\\nthis.offset = d\\\n};\\\nvar proto=\"+className+\".prototype;\\\nproto.dtype='\"+dtype+\"';\\\nproto.index=function(){return this.offset};\\\nproto.dimension=0;\\\nproto.size=1;\\\nproto.shape=\\\nproto.stride=\\\nproto.order=[];\\\nproto.lo=\\\nproto.hi=\\\nproto.transpose=\\\nproto.step=function \"+className+\"_copy() {\\\nreturn new \"+className+\"(this.data,this.offset)\\\n};\\\nproto.pick=function \"+className+\"_pick(){\\\nreturn TrivialArray(this.data);\\\n};\\\nproto.valueOf=proto.get=function \"+className+\"_get(){\\\nreturn \"+(useGetters ? \"this.data.get(this.offset)\" : \"this.data[this.offset]\")+\n\"};\\\nproto.set=function \"+className+\"_set(v){\\\nreturn \"+(useGetters ? \"this.data.set(this.offset,v)\" : \"this.data[this.offset]=v\")+\"\\\n};\\\nreturn function construct_\"+className+\"(a,b,c,d){return new \"+className+\"(a,d)}\"\n    var procedure = new Function(\"TrivialArray\", code)\n    return procedure(CACHED_CONSTRUCTORS[dtype][0])\n  }\n\n  var code = [\"'use strict'\"]\n\n  //Create constructor for view\n  var indices = iota(dimension)\n  var args = indices.map(function(i) { return \"i\"+i })\n  var index_str = \"this.offset+\" + indices.map(function(i) {\n        return \"this.stride[\" + i + \"]*i\" + i\n      }).join(\"+\")\n  var shapeArg = indices.map(function(i) {\n      return \"b\"+i\n    }).join(\",\")\n  var strideArg = indices.map(function(i) {\n      return \"c\"+i\n    }).join(\",\")\n  code.push(\n    \"function \"+className+\"(a,\" + shapeArg + \",\" + strideArg + \",d){this.data=a\",\n      \"this.shape=[\" + shapeArg + \"]\",\n      \"this.stride=[\" + strideArg + \"]\",\n      \"this.offset=d|0}\",\n    \"var proto=\"+className+\".prototype\",\n    \"proto.dtype='\"+dtype+\"'\",\n    \"proto.dimension=\"+dimension)\n\n  //view.size:\n  code.push(\"Object.defineProperty(proto,'size',{get:function \"+className+\"_size(){\\\nreturn \"+indices.map(function(i) { return \"this.shape[\"+i+\"]\" }).join(\"*\"),\n\"}})\")\n\n  //view.order:\n  if(dimension === 1) {\n    code.push(\"proto.order=[0]\")\n  } else {\n    code.push(\"Object.defineProperty(proto,'order',{get:\")\n    if(dimension < 4) {\n      code.push(\"function \"+className+\"_order(){\")\n      if(dimension === 2) {\n        code.push(\"return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})\")\n      } else if(dimension === 3) {\n        code.push(\n\"var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);\\\nif(s0>s1){\\\nif(s1>s2){\\\nreturn [2,1,0];\\\n}else if(s0>s2){\\\nreturn [1,2,0];\\\n}else{\\\nreturn [1,0,2];\\\n}\\\n}else if(s0>s2){\\\nreturn [2,0,1];\\\n}else if(s2>s1){\\\nreturn [0,1,2];\\\n}else{\\\nreturn [0,2,1];\\\n}}})\")\n      }\n    } else {\n      code.push(\"ORDER})\")\n    }\n  }\n\n  //view.set(i0, ..., v):\n  code.push(\n\"proto.set=function \"+className+\"_set(\"+args.join(\",\")+\",v){\")\n  if(useGetters) {\n    code.push(\"return this.data.set(\"+index_str+\",v)}\")\n  } else {\n    code.push(\"return this.data[\"+index_str+\"]=v}\")\n  }\n\n  //view.get(i0, ...):\n  code.push(\"proto.get=function \"+className+\"_get(\"+args.join(\",\")+\"){\")\n  if(useGetters) {\n    code.push(\"return this.data.get(\"+index_str+\")}\")\n  } else {\n    code.push(\"return this.data[\"+index_str+\"]}\")\n  }\n\n  //view.index:\n  code.push(\n    \"proto.index=function \"+className+\"_index(\", args.join(), \"){return \"+index_str+\"}\")\n\n  //view.hi():\n  code.push(\"proto.hi=function \"+className+\"_hi(\"+args.join(\",\")+\"){return new \"+className+\"(this.data,\"+\n    indices.map(function(i) {\n      return [\"(typeof i\",i,\"!=='number'||i\",i,\"<0)?this.shape[\", i, \"]:i\", i,\"|0\"].join(\"\")\n    }).join(\",\")+\",\"+\n    indices.map(function(i) {\n      return \"this.stride[\"+i + \"]\"\n    }).join(\",\")+\",this.offset)}\")\n\n  //view.lo():\n  var a_vars = indices.map(function(i) { return \"a\"+i+\"=this.shape[\"+i+\"]\" })\n  var c_vars = indices.map(function(i) { return \"c\"+i+\"=this.stride[\"+i+\"]\" })\n  code.push(\"proto.lo=function \"+className+\"_lo(\"+args.join(\",\")+\"){var b=this.offset,d=0,\"+a_vars.join(\",\")+\",\"+c_vars.join(\",\"))\n  for(var i=0; i<dimension; ++i) {\n    code.push(\n\"if(typeof i\"+i+\"==='number'&&i\"+i+\">=0){\\\nd=i\"+i+\"|0;\\\nb+=c\"+i+\"*d;\\\na\"+i+\"-=d}\")\n  }\n  code.push(\"return new \"+className+\"(this.data,\"+\n    indices.map(function(i) {\n      return \"a\"+i\n    }).join(\",\")+\",\"+\n    indices.map(function(i) {\n      return \"c\"+i\n    }).join(\",\")+\",b)}\")\n\n  //view.step():\n  code.push(\"proto.step=function \"+className+\"_step(\"+args.join(\",\")+\"){var \"+\n    indices.map(function(i) {\n      return \"a\"+i+\"=this.shape[\"+i+\"]\"\n    }).join(\",\")+\",\"+\n    indices.map(function(i) {\n      return \"b\"+i+\"=this.stride[\"+i+\"]\"\n    }).join(\",\")+\",c=this.offset,d=0,ceil=Math.ceil\")\n  for(var i=0; i<dimension; ++i) {\n    code.push(\n\"if(typeof i\"+i+\"==='number'){\\\nd=i\"+i+\"|0;\\\nif(d<0){\\\nc+=b\"+i+\"*(a\"+i+\"-1);\\\na\"+i+\"=ceil(-a\"+i+\"/d)\\\n}else{\\\na\"+i+\"=ceil(a\"+i+\"/d)\\\n}\\\nb\"+i+\"*=d\\\n}\")\n  }\n  code.push(\"return new \"+className+\"(this.data,\"+\n    indices.map(function(i) {\n      return \"a\" + i\n    }).join(\",\")+\",\"+\n    indices.map(function(i) {\n      return \"b\" + i\n    }).join(\",\")+\",c)}\")\n\n  //view.transpose():\n  var tShape = new Array(dimension)\n  var tStride = new Array(dimension)\n  for(var i=0; i<dimension; ++i) {\n    tShape[i] = \"a[i\"+i+\"]\"\n    tStride[i] = \"b[i\"+i+\"]\"\n  }\n  code.push(\"proto.transpose=function \"+className+\"_transpose(\"+args+\"){\"+\n    args.map(function(n,idx) { return n + \"=(\" + n + \"===undefined?\" + idx + \":\" + n + \"|0)\"}).join(\";\"),\n    \"var a=this.shape,b=this.stride;return new \"+className+\"(this.data,\"+tShape.join(\",\")+\",\"+tStride.join(\",\")+\",this.offset)}\")\n\n  //view.pick():\n  code.push(\"proto.pick=function \"+className+\"_pick(\"+args+\"){var a=[],b=[],c=this.offset\")\n  for(var i=0; i<dimension; ++i) {\n    code.push(\"if(typeof i\"+i+\"==='number'&&i\"+i+\">=0){c=(c+this.stride[\"+i+\"]*i\"+i+\")|0}else{a.push(this.shape[\"+i+\"]);b.push(this.stride[\"+i+\"])}\")\n  }\n  code.push(\"var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}\")\n\n  //Add return statement\n  code.push(\"return function construct_\"+className+\"(data,shape,stride,offset){return new \"+className+\"(data,\"+\n    indices.map(function(i) {\n      return \"shape[\"+i+\"]\"\n    }).join(\",\")+\",\"+\n    indices.map(function(i) {\n      return \"stride[\"+i+\"]\"\n    }).join(\",\")+\",offset)}\")\n\n  //Compile procedure\n  var procedure = new Function(\"CTOR_LIST\", \"ORDER\", code.join(\"\\n\"))\n  return procedure(CACHED_CONSTRUCTORS[dtype], order)\n}\n\nfunction arrayDType(data) {\n  if(isBuffer(data)) {\n    return \"buffer\"\n  }\n  if(hasTypedArrays) {\n    switch(Object.prototype.toString.call(data)) {\n      case \"[object Float64Array]\":\n        return \"float64\"\n      case \"[object Float32Array]\":\n        return \"float32\"\n      case \"[object Int8Array]\":\n        return \"int8\"\n      case \"[object Int16Array]\":\n        return \"int16\"\n      case \"[object Int32Array]\":\n        return \"int32\"\n      case \"[object Uint8Array]\":\n        return \"uint8\"\n      case \"[object Uint16Array]\":\n        return \"uint16\"\n      case \"[object Uint32Array]\":\n        return \"uint32\"\n      case \"[object Uint8ClampedArray]\":\n        return \"uint8_clamped\"\n      case \"[object BigInt64Array]\":\n        return \"bigint64\"\n      case \"[object BigUint64Array]\":\n        return \"biguint64\"\n    }\n  }\n  if(Array.isArray(data)) {\n    return \"array\"\n  }\n  return \"generic\"\n}\n\nvar CACHED_CONSTRUCTORS = {\n  \"float32\":[],\n  \"float64\":[],\n  \"int8\":[],\n  \"int16\":[],\n  \"int32\":[],\n  \"uint8\":[],\n  \"uint16\":[],\n  \"uint32\":[],\n  \"array\":[],\n  \"uint8_clamped\":[],\n  \"bigint64\": [],\n  \"biguint64\": [],\n  \"buffer\":[],\n  \"generic\":[]\n}\n\n;(function() {\n  for(var id in CACHED_CONSTRUCTORS) {\n    CACHED_CONSTRUCTORS[id].push(compileConstructor(id, -1))\n  }\n});\n\nfunction wrappedNDArrayCtor(data, shape, stride, offset) {\n  if(data === undefined) {\n    var ctor = CACHED_CONSTRUCTORS.array[0]\n    return ctor([])\n  } else if(typeof data === \"number\") {\n    data = [data]\n  }\n  if(shape === undefined) {\n    shape = [ data.length ]\n  }\n  var d = shape.length\n  if(stride === undefined) {\n    stride = new Array(d)\n    for(var i=d-1, sz=1; i>=0; --i) {\n      stride[i] = sz\n      sz *= shape[i]\n    }\n  }\n  if(offset === undefined) {\n    offset = 0\n    for(var i=0; i<d; ++i) {\n      if(stride[i] < 0) {\n        offset -= (shape[i]-1)*stride[i]\n      }\n    }\n  }\n  var dtype = arrayDType(data)\n  var ctor_list = CACHED_CONSTRUCTORS[dtype]\n  while(ctor_list.length <= d+1) {\n    ctor_list.push(compileConstructor(dtype, ctor_list.length-1))\n  }\n  var ctor = ctor_list[d+1]\n  return ctor(data, shape, stride, offset)\n}\n\nmodule.exports = wrappedNDArrayCtor\n","module.exports = AABB\n\nvar vec3 = require('gl-vec3')\n\nfunction AABB(pos, vec) {\n\n  if(!(this instanceof AABB)) {\n    return new AABB(pos, vec)\n  }\n\n  var pos2 = vec3.create()\n  vec3.add(pos2, pos, vec)\n \n  this.base = vec3.min(vec3.create(), pos, pos2)\n  this.vec = vec3.clone(vec)\n  this.max = vec3.max(vec3.create(), pos, pos2)\n\n  this.mag = vec3.length(this.vec)\n\n}\n\nvar cons = AABB\n  , proto = cons.prototype\n\nproto.width = function() {\n  return this.vec[0]\n}\n\nproto.height = function() {\n  return this.vec[1]\n}\n\nproto.depth = function() {\n  return this.vec[2]\n}\n\nproto.x0 = function() {\n  return this.base[0]\n}\n\nproto.y0 = function() {\n  return this.base[1]\n}\n\nproto.z0 = function() {\n  return this.base[2]\n}\n\nproto.x1 = function() {\n  return this.max[0]\n}\n\nproto.y1 = function() {\n  return this.max[1]\n}\n\nproto.z1 = function() {\n  return this.max[2]\n}\n\nproto.translate = function(by) {\n  vec3.add(this.max, this.max, by)\n  vec3.add(this.base, this.base, by)\n  return this\n}\n\nproto.setPosition = function(pos) {\n  vec3.add(this.max, pos, this.vec)\n  vec3.copy(this.base, pos)\n  return this\n}\n\nproto.expand = function(aabb) {\n  var max = vec3.create()\n    , min = vec3.create()\n\n  vec3.max(max, aabb.max, this.max)\n  vec3.min(min, aabb.base, this.base)\n  vec3.subtract(max, max, min)\n\n  return new AABB(min, max)\n}\n\nproto.intersects = function(aabb) {\n  if(aabb.base[0] > this.max[0]) return false\n  if(aabb.base[1] > this.max[1]) return false\n  if(aabb.base[2] > this.max[2]) return false\n  if(aabb.max[0] < this.base[0]) return false\n  if(aabb.max[1] < this.base[1]) return false\n  if(aabb.max[2] < this.base[2]) return false\n\n  return true\n}\n\nproto.touches = function(aabb) {\n\n  var intersection = this.union(aabb);\n\n  return (intersection !== null) &&\n         ((intersection.width() == 0) ||\n         (intersection.height() == 0) || \n         (intersection.depth() == 0))\n\n}\n\nproto.union = function(aabb) {\n  if(!this.intersects(aabb)) return null\n\n  var base_x = Math.max(aabb.base[0], this.base[0])\n    , base_y = Math.max(aabb.base[1], this.base[1])\n    , base_z = Math.max(aabb.base[2], this.base[2])\n    , max_x = Math.min(aabb.max[0], this.max[0])\n    , max_y = Math.min(aabb.max[1], this.max[1])\n    , max_z = Math.min(aabb.max[2], this.max[2])\n\n  return new AABB([base_x, base_y, base_z], [max_x - base_x, max_y - base_y, max_z - base_z])\n}\n\n\n\n\n","'use strict'\n\nvar bits = require('bit-twiddle')\nvar dup = require('dup')\nvar Buffer = require('buffer').Buffer\n\n//Legacy pool support\nif(!global.__TYPEDARRAY_POOL) {\n  global.__TYPEDARRAY_POOL = {\n      UINT8     : dup([32, 0])\n    , UINT16    : dup([32, 0])\n    , UINT32    : dup([32, 0])\n    , BIGUINT64 : dup([32, 0])\n    , INT8      : dup([32, 0])\n    , INT16     : dup([32, 0])\n    , INT32     : dup([32, 0])\n    , BIGINT64  : dup([32, 0])\n    , FLOAT     : dup([32, 0])\n    , DOUBLE    : dup([32, 0])\n    , DATA      : dup([32, 0])\n    , UINT8C    : dup([32, 0])\n    , BUFFER    : dup([32, 0])\n  }\n}\n\nvar hasUint8C = (typeof Uint8ClampedArray) !== 'undefined'\nvar hasBigUint64 = (typeof BigUint64Array) !== 'undefined'\nvar hasBigInt64 = (typeof BigInt64Array) !== 'undefined'\nvar POOL = global.__TYPEDARRAY_POOL\n\n//Upgrade pool\nif(!POOL.UINT8C) {\n  POOL.UINT8C = dup([32, 0])\n}\nif(!POOL.BIGUINT64) {\n  POOL.BIGUINT64 = dup([32, 0])\n}\nif(!POOL.BIGINT64) {\n  POOL.BIGINT64 = dup([32, 0])\n}\nif(!POOL.BUFFER) {\n  POOL.BUFFER = dup([32, 0])\n}\n\n//New technique: Only allocate from ArrayBufferView and Buffer\nvar DATA    = POOL.DATA\n  , BUFFER  = POOL.BUFFER\n\nexports.free = function free(array) {\n  if(Buffer.isBuffer(array)) {\n    BUFFER[bits.log2(array.length)].push(array)\n  } else {\n    if(Object.prototype.toString.call(array) !== '[object ArrayBuffer]') {\n      array = array.buffer\n    }\n    if(!array) {\n      return\n    }\n    var n = array.length || array.byteLength\n    var log_n = bits.log2(n)|0\n    DATA[log_n].push(array)\n  }\n}\n\nfunction freeArrayBuffer(buffer) {\n  if(!buffer) {\n    return\n  }\n  var n = buffer.length || buffer.byteLength\n  var log_n = bits.log2(n)\n  DATA[log_n].push(buffer)\n}\n\nfunction freeTypedArray(array) {\n  freeArrayBuffer(array.buffer)\n}\n\nexports.freeUint8 =\nexports.freeUint16 =\nexports.freeUint32 =\nexports.freeBigUint64 =\nexports.freeInt8 =\nexports.freeInt16 =\nexports.freeInt32 =\nexports.freeBigInt64 =\nexports.freeFloat32 = \nexports.freeFloat =\nexports.freeFloat64 = \nexports.freeDouble = \nexports.freeUint8Clamped = \nexports.freeDataView = freeTypedArray\n\nexports.freeArrayBuffer = freeArrayBuffer\n\nexports.freeBuffer = function freeBuffer(array) {\n  BUFFER[bits.log2(array.length)].push(array)\n}\n\nexports.malloc = function malloc(n, dtype) {\n  if(dtype === undefined || dtype === 'arraybuffer') {\n    return mallocArrayBuffer(n)\n  } else {\n    switch(dtype) {\n      case 'uint8':\n        return mallocUint8(n)\n      case 'uint16':\n        return mallocUint16(n)\n      case 'uint32':\n        return mallocUint32(n)\n      case 'int8':\n        return mallocInt8(n)\n      case 'int16':\n        return mallocInt16(n)\n      case 'int32':\n        return mallocInt32(n)\n      case 'float':\n      case 'float32':\n        return mallocFloat(n)\n      case 'double':\n      case 'float64':\n        return mallocDouble(n)\n      case 'uint8_clamped':\n        return mallocUint8Clamped(n)\n      case 'bigint64':\n        return mallocBigInt64(n)\n      case 'biguint64':\n        return mallocBigUint64(n)\n      case 'buffer':\n        return mallocBuffer(n)\n      case 'data':\n      case 'dataview':\n        return mallocDataView(n)\n\n      default:\n        return null\n    }\n  }\n  return null\n}\n\nfunction mallocArrayBuffer(n) {\n  var n = bits.nextPow2(n)\n  var log_n = bits.log2(n)\n  var d = DATA[log_n]\n  if(d.length > 0) {\n    return d.pop()\n  }\n  return new ArrayBuffer(n)\n}\nexports.mallocArrayBuffer = mallocArrayBuffer\n\nfunction mallocUint8(n) {\n  return new Uint8Array(mallocArrayBuffer(n), 0, n)\n}\nexports.mallocUint8 = mallocUint8\n\nfunction mallocUint16(n) {\n  return new Uint16Array(mallocArrayBuffer(2*n), 0, n)\n}\nexports.mallocUint16 = mallocUint16\n\nfunction mallocUint32(n) {\n  return new Uint32Array(mallocArrayBuffer(4*n), 0, n)\n}\nexports.mallocUint32 = mallocUint32\n\nfunction mallocInt8(n) {\n  return new Int8Array(mallocArrayBuffer(n), 0, n)\n}\nexports.mallocInt8 = mallocInt8\n\nfunction mallocInt16(n) {\n  return new Int16Array(mallocArrayBuffer(2*n), 0, n)\n}\nexports.mallocInt16 = mallocInt16\n\nfunction mallocInt32(n) {\n  return new Int32Array(mallocArrayBuffer(4*n), 0, n)\n}\nexports.mallocInt32 = mallocInt32\n\nfunction mallocFloat(n) {\n  return new Float32Array(mallocArrayBuffer(4*n), 0, n)\n}\nexports.mallocFloat32 = exports.mallocFloat = mallocFloat\n\nfunction mallocDouble(n) {\n  return new Float64Array(mallocArrayBuffer(8*n), 0, n)\n}\nexports.mallocFloat64 = exports.mallocDouble = mallocDouble\n\nfunction mallocUint8Clamped(n) {\n  if(hasUint8C) {\n    return new Uint8ClampedArray(mallocArrayBuffer(n), 0, n)\n  } else {\n    return mallocUint8(n)\n  }\n}\nexports.mallocUint8Clamped = mallocUint8Clamped\n\nfunction mallocBigUint64(n) {\n  if(hasBigUint64) {\n    return new BigUint64Array(mallocArrayBuffer(8*n), 0, n)\n  } else {\n    return null;\n  }\n}\nexports.mallocBigUint64 = mallocBigUint64\n\nfunction mallocBigInt64(n) {\n  if (hasBigInt64) {\n    return new BigInt64Array(mallocArrayBuffer(8*n), 0, n)\n  } else {\n    return null;\n  }\n}\nexports.mallocBigInt64 = mallocBigInt64\n\nfunction mallocDataView(n) {\n  return new DataView(mallocArrayBuffer(n), 0, n)\n}\nexports.mallocDataView = mallocDataView\n\nfunction mallocBuffer(n) {\n  n = bits.nextPow2(n)\n  var log_n = bits.log2(n)\n  var cache = BUFFER[log_n]\n  if(cache.length > 0) {\n    return cache.pop()\n  }\n  return new Buffer(n)\n}\nexports.mallocBuffer = mallocBuffer\n\nexports.clearCache = function clearCache() {\n  for(var i=0; i<32; ++i) {\n    POOL.UINT8[i].length = 0\n    POOL.UINT16[i].length = 0\n    POOL.UINT32[i].length = 0\n    POOL.INT8[i].length = 0\n    POOL.INT16[i].length = 0\n    POOL.INT32[i].length = 0\n    POOL.FLOAT[i].length = 0\n    POOL.DOUBLE[i].length = 0\n    POOL.BIGUINT64[i].length = 0\n    POOL.BIGINT64[i].length = 0\n    POOL.UINT8C[i].length = 0\n    DATA[i].length = 0\n    BUFFER[i].length = 0\n  }\n}\n","var vec3 = require('gl-vec3')\n\nexport default function (noa) {\n\n    /**\n     * \n     * \tComponent holding entity's position, width, and height.\n     *  By convention, entity's \"position\" is the bottom center of its AABB\n     * \n     *  Of the various properties, _localPosition is the \"real\", \n     *  single-source-of-truth position. Others are derived.\n     *  Local coords are relative to `noa.worldOriginOffset`.\n     * \n     *  Props:\n     *      position: pos in global coords (may be low precision)\n     *      _localPosition: precise pos in local coords\n     *      _renderPosition: [x,y,z] in LOCAL COORDS\n     *      _extents: array [lo, lo, lo, hi, hi, hi] in LOCAL COORDS\n     * \n     */\n\n\n\n    return {\n\n        name: 'position',\n\n        order: 60,\n\n        state: {\n            position: null,\n            width: +1,\n            height: +1,\n            _localPosition: null,\n            _renderPosition: null,\n            _extents: null,\n        },\n\n\n        onAdd: function (eid, state) {\n            // copy position into a plain array\n            var pos = [0, 0, 0]\n            if (state.position) vec3.copy(pos, state.position)\n            state.position = pos\n\n            state._localPosition = vec3.create()\n            state._renderPosition = vec3.create()\n            state._extents = new Float32Array(6)\n\n            // on init only, set local from global\n            noa.globalToLocal(state.position, null, state._localPosition)\n            vec3.copy(state._renderPosition, state._localPosition)\n            updatePositionExtents(state)\n        },\n\n        onRemove: null,\n\n\n\n        system: function (dt, states) {\n            var off = noa.worldOriginOffset\n            states.forEach(state => {\n                vec3.add(state.position, state._localPosition, off)\n                updatePositionExtents(state)\n            })\n        },\n\n\n    }\n}\n\n\n\n// update an entity's position state `_extents` \nexport function updatePositionExtents(state) {\n    var hw = state.width / 2\n    var lpos = state._localPosition\n    var ext = state._extents\n    ext[0] = lpos[0] - hw\n    ext[1] = lpos[1]\n    ext[2] = lpos[2] - hw\n    ext[3] = lpos[0] + hw\n    ext[4] = lpos[1] + state.height\n    ext[5] = lpos[2] + hw\n}\n","var vec3 = require('gl-vec3')\n\n\nexport default function (noa) {\n\n\n    return {\n\n        name: 'physics',\n\n        order: 40,\n\n        state: {\n            body: null,\n        },\n\n\n        onAdd: function (entID, state) {\n            state.body = noa.physics.addBody()\n            // implicitly assume body has a position component, to get size\n            var posDat = noa.ents.getPositionData(state.__id)\n            setPhysicsFromPosition(state, posDat)\n        },\n\n\n        onRemove: function (entID, state) {\n            // update position before removing\n            // this lets entity wind up at e.g. the result of a collision\n            // even if physics component is removed in collision handler\n            if (noa.ents.hasPosition(state.__id)) {\n                var pdat = noa.ents.getPositionData(state.__id)\n                setPositionFromPhysics(state, pdat)\n                backtrackRenderPos(state, pdat, 0, false)\n            }\n            noa.physics.removeBody(state.body)\n        },\n\n\n        system: function (dt, states) {\n            states.forEach(state => {\n                var pdat = noa.ents.getPositionData(state.__id)\n                setPositionFromPhysics(state, pdat)\n            })\n\n        },\n\n\n        renderSystem: function (dt, states) {\n\n            var tickPos = noa.positionInCurrentTick\n            var tickMS = tickPos * noa._tickRate\n\n            // tickMS is time since last physics engine tick\n            // to avoid temporal aliasing, render the state as if lerping between\n            // the last position and the next one \n            // since the entity data is the \"next\" position this amounts to \n            // offsetting each entity into the past by tickRate - dt\n            // http://gafferongames.com/game-physics/fix-your-timestep/\n\n            var backtrackAmt = (tickMS - noa._tickRate) / 1000\n            states.forEach(state => {\n                var id = state.__id\n                var pdat = noa.ents.getPositionData(id)\n                var smoothed = noa.ents.cameraSmoothed(id)\n                backtrackRenderPos(state, pdat, backtrackAmt, smoothed)\n            })\n        }\n\n    }\n\n}\n\n\n\n// var offset = vec3.create()\nvar local = vec3.create()\n\nexport function setPhysicsFromPosition(physState, posState) {\n    var box = physState.body.aabb\n    var ext = posState._extents\n    vec3.copy(box.base, ext)\n    vec3.set(box.vec, posState.width, posState.height, posState.width)\n    vec3.add(box.max, box.base, box.vec)\n}\n\n\nfunction setPositionFromPhysics(physState, posState) {\n    var base = physState.body.aabb.base\n    var hw = posState.width / 2\n    vec3.set(posState._localPosition, base[0] + hw, base[1], base[2] + hw)\n}\n\n\nfunction backtrackRenderPos(physState, posState, backtrackAmt, smoothed) {\n    // pos = pos + backtrack * body.velocity\n    var vel = physState.body.velocity\n    vec3.scaleAndAdd(local, posState._localPosition, vel, backtrackAmt)\n\n    // smooth out update if component is present\n    // (this is set after sudden movements like auto-stepping)\n    if (smoothed) vec3.lerp(local, posState._renderPosition, local, 0.3)\n\n    // copy values over to renderPosition, \n    vec3.copy(posState._renderPosition, local)\n}\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","module.exports = 0.000001\n","module.exports = create;\n\n/**\n * Creates a new, empty vec3\n *\n * @returns {vec3} a new 3D vector\n */\nfunction create() {\n    var out = new Float32Array(3)\n    out[0] = 0\n    out[1] = 0\n    out[2] = 0\n    return out\n}","module.exports = fromValues;\n\n/**\n * Creates a new vec3 initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} a new 3D vector\n */\nfunction fromValues(x, y, z) {\n    var out = new Float32Array(3)\n    out[0] = x\n    out[1] = y\n    out[2] = z\n    return out\n}","module.exports = normalize;\n\n/**\n * Normalize a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a vector to normalize\n * @returns {vec3} out\n */\nfunction normalize(out, a) {\n    var x = a[0],\n        y = a[1],\n        z = a[2]\n    var len = x*x + y*y + z*z\n    if (len > 0) {\n        //TODO: evaluate use of glm_invsqrt here?\n        len = 1 / Math.sqrt(len)\n        out[0] = a[0] * len\n        out[1] = a[1] * len\n        out[2] = a[2] * len\n    }\n    return out\n}","module.exports = dot;\n\n/**\n * Calculates the dot product of two vec3's\n *\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {Number} dot product of a and b\n */\nfunction dot(a, b) {\n    return a[0] * b[0] + a[1] * b[1] + a[2] * b[2]\n}","module.exports = subtract;\n\n/**\n * Subtracts vector b from vector a\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nfunction subtract(out, a, b) {\n    out[0] = a[0] - b[0]\n    out[1] = a[1] - b[1]\n    out[2] = a[2] - b[2]\n    return out\n}","module.exports = multiply;\n\n/**\n * Multiplies two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nfunction multiply(out, a, b) {\n    out[0] = a[0] * b[0]\n    out[1] = a[1] * b[1]\n    out[2] = a[2] * b[2]\n    return out\n}","module.exports = divide;\n\n/**\n * Divides two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nfunction divide(out, a, b) {\n    out[0] = a[0] / b[0]\n    out[1] = a[1] / b[1]\n    out[2] = a[2] / b[2]\n    return out\n}","module.exports = distance;\n\n/**\n * Calculates the euclidian distance between two vec3's\n *\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {Number} distance between a and b\n */\nfunction distance(a, b) {\n    var x = b[0] - a[0],\n        y = b[1] - a[1],\n        z = b[2] - a[2]\n    return Math.sqrt(x*x + y*y + z*z)\n}","module.exports = squaredDistance;\n\n/**\n * Calculates the squared euclidian distance between two vec3's\n *\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {Number} squared distance between a and b\n */\nfunction squaredDistance(a, b) {\n    var x = b[0] - a[0],\n        y = b[1] - a[1],\n        z = b[2] - a[2]\n    return x*x + y*y + z*z\n}","module.exports = length;\n\n/**\n * Calculates the length of a vec3\n *\n * @param {vec3} a vector to calculate length of\n * @returns {Number} length of a\n */\nfunction length(a) {\n    var x = a[0],\n        y = a[1],\n        z = a[2]\n    return Math.sqrt(x*x + y*y + z*z)\n}","module.exports = squaredLength;\n\n/**\n * Calculates the squared length of a vec3\n *\n * @param {vec3} a vector to calculate squared length of\n * @returns {Number} squared length of a\n */\nfunction squaredLength(a) {\n    var x = a[0],\n        y = a[1],\n        z = a[2]\n    return x*x + y*y + z*z\n}","\"use strict\"\n\nfunction iota(n) {\n  var result = new Array(n)\n  for(var i=0; i<n; ++i) {\n    result[i] = i\n  }\n  return result\n}\n\nmodule.exports = iota","'use strict'\n\n\n// reused array instances\n\nvar tr_arr = []\nvar ldi_arr = []\nvar tri_arr = []\nvar step_arr = []\nvar tDelta_arr = []\nvar tNext_arr = []\nvar vec_arr = []\nvar normed_arr = []\nvar base_arr = []\nvar max_arr = []\nvar left_arr = []\nvar result_arr = []\n\n\n\n// core implementation:\n\nfunction sweep_impl(getVoxel, callback, vec, base, max, epsilon) {\n\n    // consider algo as a raycast along the AABB's leading corner\n    // as raycast enters each new voxel, iterate in 2D over the AABB's \n    // leading face in that axis looking for collisions\n    // \n    // original raycast implementation: https://github.com/andyhall/fast-voxel-raycast\n    // original raycast paper: http://www.cse.chalmers.se/edu/year/2010/course/TDA361/grid.pdf\n\n    var tr = tr_arr\n    var ldi = ldi_arr\n    var tri = tri_arr\n    var step = step_arr\n    var tDelta = tDelta_arr\n    var tNext = tNext_arr\n    var normed = normed_arr\n\n    var floor = Math.floor\n    var cumulative_t = 0.0\n    var t = 0.0\n    var max_t = 0.0\n    var axis = 0\n    var i = 0\n\n\n    // init for the current sweep vector and take first step\n    initSweep()\n    if (max_t === 0) return 0\n\n    axis = stepForward()\n\n    // loop along raycast vector\n    while (t <= max_t) {\n\n        // sweeps over leading face of AABB\n        if (checkCollision(axis)) {\n            // calls the callback and decides whether to continue\n            var done = handleCollision()\n            if (done) return cumulative_t\n        }\n\n        axis = stepForward()\n    }\n\n    // reached the end of the vector unobstructed, finish and exit\n    cumulative_t += max_t\n    for (i = 0; i < 3; i++) {\n        base[i] += vec[i]\n        max[i] += vec[i]\n    }\n    return cumulative_t\n\n\n\n\n\n    // low-level implementations of each step:\n    function initSweep() {\n\n        // parametrization t along raycast\n        t = 0.0\n        max_t = Math.sqrt(vec[0] * vec[0] + vec[1] * vec[1] + vec[2] * vec[2])\n        if (max_t === 0) return\n        for (var i = 0; i < 3; i++) {\n            var dir = (vec[i] >= 0)\n            step[i] = dir ? 1 : -1\n            // trailing / trailing edge coords\n            var lead = dir ? max[i] : base[i]\n            tr[i] = dir ? base[i] : max[i]\n            // int values of lead/trail edges\n            ldi[i] = leadEdgeToInt(lead, step[i])\n            tri[i] = trailEdgeToInt(tr[i], step[i])\n            // normed vector\n            normed[i] = vec[i] / max_t\n            // distance along t required to move one voxel in each axis\n            tDelta[i] = Math.abs(1 / normed[i])\n            // location of nearest voxel boundary, in units of t \n            var dist = dir ? (ldi[i] + 1 - lead) : (lead - ldi[i])\n            tNext[i] = (tDelta[i] < Infinity) ? tDelta[i] * dist : Infinity\n        }\n\n    }\n\n\n    // check for collisions - iterate over the leading face on the advancing axis\n\n    function checkCollision(i_axis) {\n        var stepx = step[0]\n        var x0 = (i_axis === 0) ? ldi[0] : tri[0]\n        var x1 = ldi[0] + stepx\n\n        var stepy = step[1]\n        var y0 = (i_axis === 1) ? ldi[1] : tri[1]\n        var y1 = ldi[1] + stepy\n\n        var stepz = step[2]\n        var z0 = (i_axis === 2) ? ldi[2] : tri[2]\n        var z1 = ldi[2] + stepz\n\n        // var j_axis = (i_axis + 1) % 3\n        // var k_axis = (i_axis + 2) % 3\n        // var s = ['x', 'y', 'z'][i_axis]\n        // var js = ['x', 'y', 'z'][j_axis]\n        // var ks = ['x', 'y', 'z'][k_axis]\n        // var i0 = [x0, y0, z0][i_axis]\n        // var j0 = [x0, y0, z0][j_axis]\n        // var k0 = [x0, y0, z0][k_axis]\n        // var i1 = [x1 - stepx, y1 - stepy, z1 - stepz][i_axis]\n        // var j1 = [x1 - stepx, y1 - stepy, z1 - stepz][j_axis]\n        // var k1 = [x1 - stepx, y1 - stepy, z1 - stepz][k_axis]\n        // console.log('=== step', s, 'to', i0, '   sweep', js, j0 + ',' + j1, '   ', ks, k0 + ',' + k1)\n\n        for (var x = x0; x != x1; x += stepx) {\n            for (var y = y0; y != y1; y += stepy) {\n                for (var z = z0; z != z1; z += stepz) {\n                    if (getVoxel(x, y, z)) return true\n                }\n            }\n        }\n        return false\n    }\n\n\n    // on collision - call the callback and return or set up for the next sweep\n\n    function handleCollision() {\n\n        // set up for callback\n        cumulative_t += t\n        var dir = step[axis]\n\n        // vector moved so far, and left to move\n        var done = t / max_t\n        var left = left_arr\n        for (i = 0; i < 3; i++) {\n            var dv = vec[i] * done\n            base[i] += dv\n            max[i] += dv\n            left[i] = vec[i] - dv\n        }\n\n        // set leading edge of stepped axis exactly to voxel boundary\n        // else we'll sometimes rounding error beyond it\n        if (dir > 0) {\n            max[axis] = Math.round(max[axis])\n        } else {\n            base[axis] = Math.round(base[axis])\n        }\n        \n        // call back to let client update the \"left to go\" vector\n        var res = callback(cumulative_t, axis, dir, left)\n\n        // bail out out on truthy response\n        if (res) return true\n\n        // init for new sweep along vec\n        for (i = 0; i < 3; i++) vec[i] = left[i]\n        initSweep()\n        if (max_t === 0) return true // no vector left\n\n        return false\n    }\n\n\n    // advance to next voxel boundary, and return which axis was stepped\n\n    function stepForward() {\n        var axis = (tNext[0] < tNext[1]) ?\n            ((tNext[0] < tNext[2]) ? 0 : 2) :\n            ((tNext[1] < tNext[2]) ? 1 : 2)\n        var dt = tNext[axis] - t\n        t = tNext[axis]\n        ldi[axis] += step[axis]\n        tNext[axis] += tDelta[axis]\n        for (i = 0; i < 3; i++) {\n            tr[i] += dt * normed[i]\n            tri[i] = trailEdgeToInt(tr[i], step[i])\n        }\n\n        return axis\n    }\n\n\n\n    function leadEdgeToInt(coord, step) {\n        return floor(coord - step * epsilon)\n    }\n    function trailEdgeToInt(coord, step) {\n        return floor(coord + step * epsilon)\n    }\n\n}\n\n\n\n\n\n// conform inputs\n\nfunction sweep(getVoxel, box, dir, callback, noTranslate, epsilon) {\n\n    var vec = vec_arr\n    var base = base_arr\n    var max = max_arr\n    var result = result_arr\n\n    // init parameter float arrays\n    for (var i = 0; i < 3; i++) {\n        vec[i] = +dir[i]\n        max[i] = +box.max[i]\n        base[i] = +box.base[i]\n    }\n\n    if (!epsilon) epsilon = 1e-10\n\n    // run sweep implementation\n    var dist = sweep_impl(getVoxel, callback, vec, base, max, epsilon)\n\n    // translate box by distance needed to updated base value\n    if (!noTranslate) {\n        for (i = 0; i < 3; i++) {\n            result[i] = (dir[i] > 0) ? max[i] - box.max[i] : base[i] - box.base[i]\n        }\n        box.translate(result)\n    }\n\n    // return value is total distance moved (not necessarily magnitude of [end]-[start])\n    return dist\n}\n\nmodule.exports = sweep\n\n","'use strict'\n\nmodule.exports = {\n  init:           sqInit,\n  sweepBipartite: sweepBipartite,\n  sweepComplete:  sweepComplete,\n  scanBipartite:  scanBipartite,\n  scanComplete:   scanComplete\n}\n\nvar pool  = require('typedarray-pool')\nvar bits  = require('bit-twiddle')\nvar isort = require('./sort')\n\n//Flag for blue\nvar BLUE_FLAG = (1<<28)\n\n//1D sweep event queue stuff (use pool to save space)\nvar INIT_CAPACITY      = 1024\nvar RED_SWEEP_QUEUE    = pool.mallocInt32(INIT_CAPACITY)\nvar RED_SWEEP_INDEX    = pool.mallocInt32(INIT_CAPACITY)\nvar BLUE_SWEEP_QUEUE   = pool.mallocInt32(INIT_CAPACITY)\nvar BLUE_SWEEP_INDEX   = pool.mallocInt32(INIT_CAPACITY)\nvar COMMON_SWEEP_QUEUE = pool.mallocInt32(INIT_CAPACITY)\nvar COMMON_SWEEP_INDEX = pool.mallocInt32(INIT_CAPACITY)\nvar SWEEP_EVENTS       = pool.mallocDouble(INIT_CAPACITY * 8)\n\n//Reserves memory for the 1D sweep data structures\nfunction sqInit(count) {\n  var rcount = bits.nextPow2(count)\n  if(RED_SWEEP_QUEUE.length < rcount) {\n    pool.free(RED_SWEEP_QUEUE)\n    RED_SWEEP_QUEUE = pool.mallocInt32(rcount)\n  }\n  if(RED_SWEEP_INDEX.length < rcount) {\n    pool.free(RED_SWEEP_INDEX)\n    RED_SWEEP_INDEX = pool.mallocInt32(rcount)\n  }\n  if(BLUE_SWEEP_QUEUE.length < rcount) {\n    pool.free(BLUE_SWEEP_QUEUE)\n    BLUE_SWEEP_QUEUE = pool.mallocInt32(rcount)\n  }\n  if(BLUE_SWEEP_INDEX.length < rcount) {\n    pool.free(BLUE_SWEEP_INDEX)\n    BLUE_SWEEP_INDEX = pool.mallocInt32(rcount)\n  }\n  if(COMMON_SWEEP_QUEUE.length < rcount) {\n    pool.free(COMMON_SWEEP_QUEUE)\n    COMMON_SWEEP_QUEUE = pool.mallocInt32(rcount)\n  }\n  if(COMMON_SWEEP_INDEX.length < rcount) {\n    pool.free(COMMON_SWEEP_INDEX)\n    COMMON_SWEEP_INDEX = pool.mallocInt32(rcount)\n  }\n  var eventLength = 8 * rcount\n  if(SWEEP_EVENTS.length < eventLength) {\n    pool.free(SWEEP_EVENTS)\n    SWEEP_EVENTS = pool.mallocDouble(eventLength)\n  }\n}\n\n//Remove an item from the active queue in O(1)\nfunction sqPop(queue, index, count, item) {\n  var idx = index[item]\n  var top = queue[count-1]\n  queue[idx] = top\n  index[top] = idx\n}\n\n//Insert an item into the active queue in O(1)\nfunction sqPush(queue, index, count, item) {\n  queue[count] = item\n  index[item]  = count\n}\n\n//Recursion base case: use 1D sweep algorithm\nfunction sweepBipartite(\n    d, visit,\n    redStart,  redEnd, red, redIndex,\n    blueStart, blueEnd, blue, blueIndex) {\n\n  //store events as pairs [coordinate, idx]\n  //\n  //  red create:  -(idx+1)\n  //  red destroy: idx\n  //  blue create: -(idx+BLUE_FLAG)\n  //  blue destroy: idx+BLUE_FLAG\n  //\n  var ptr      = 0\n  var elemSize = 2*d\n  var istart   = d-1\n  var iend     = elemSize-1\n\n  for(var i=redStart; i<redEnd; ++i) {\n    var idx = redIndex[i]\n    var redOffset = elemSize*i\n    SWEEP_EVENTS[ptr++] = red[redOffset+istart]\n    SWEEP_EVENTS[ptr++] = -(idx+1)\n    SWEEP_EVENTS[ptr++] = red[redOffset+iend]\n    SWEEP_EVENTS[ptr++] = idx\n  }\n\n  for(var i=blueStart; i<blueEnd; ++i) {\n    var idx = blueIndex[i]+BLUE_FLAG\n    var blueOffset = elemSize*i\n    SWEEP_EVENTS[ptr++] = blue[blueOffset+istart]\n    SWEEP_EVENTS[ptr++] = -idx\n    SWEEP_EVENTS[ptr++] = blue[blueOffset+iend]\n    SWEEP_EVENTS[ptr++] = idx\n  }\n\n  //process events from left->right\n  var n = ptr >>> 1\n  isort(SWEEP_EVENTS, n)\n  \n  var redActive  = 0\n  var blueActive = 0\n  for(var i=0; i<n; ++i) {\n    var e = SWEEP_EVENTS[2*i+1]|0\n    if(e >= BLUE_FLAG) {\n      //blue destroy event\n      e = (e-BLUE_FLAG)|0\n      sqPop(BLUE_SWEEP_QUEUE, BLUE_SWEEP_INDEX, blueActive--, e)\n    } else if(e >= 0) {\n      //red destroy event\n      sqPop(RED_SWEEP_QUEUE, RED_SWEEP_INDEX, redActive--, e)\n    } else if(e <= -BLUE_FLAG) {\n      //blue create event\n      e = (-e-BLUE_FLAG)|0\n      for(var j=0; j<redActive; ++j) {\n        var retval = visit(RED_SWEEP_QUEUE[j], e)\n        if(retval !== void 0) {\n          return retval\n        }\n      }\n      sqPush(BLUE_SWEEP_QUEUE, BLUE_SWEEP_INDEX, blueActive++, e)\n    } else {\n      //red create event\n      e = (-e-1)|0\n      for(var j=0; j<blueActive; ++j) {\n        var retval = visit(e, BLUE_SWEEP_QUEUE[j])\n        if(retval !== void 0) {\n          return retval\n        }\n      }\n      sqPush(RED_SWEEP_QUEUE, RED_SWEEP_INDEX, redActive++, e)\n    }\n  }\n}\n\n//Complete sweep\nfunction sweepComplete(d, visit, \n  redStart, redEnd, red, redIndex,\n  blueStart, blueEnd, blue, blueIndex) {\n\n  var ptr      = 0\n  var elemSize = 2*d\n  var istart   = d-1\n  var iend     = elemSize-1\n\n  for(var i=redStart; i<redEnd; ++i) {\n    var idx = (redIndex[i]+1)<<1\n    var redOffset = elemSize*i\n    SWEEP_EVENTS[ptr++] = red[redOffset+istart]\n    SWEEP_EVENTS[ptr++] = -idx\n    SWEEP_EVENTS[ptr++] = red[redOffset+iend]\n    SWEEP_EVENTS[ptr++] = idx\n  }\n\n  for(var i=blueStart; i<blueEnd; ++i) {\n    var idx = (blueIndex[i]+1)<<1\n    var blueOffset = elemSize*i\n    SWEEP_EVENTS[ptr++] = blue[blueOffset+istart]\n    SWEEP_EVENTS[ptr++] = (-idx)|1\n    SWEEP_EVENTS[ptr++] = blue[blueOffset+iend]\n    SWEEP_EVENTS[ptr++] = idx|1\n  }\n\n  //process events from left->right\n  var n = ptr >>> 1\n  isort(SWEEP_EVENTS, n)\n  \n  var redActive    = 0\n  var blueActive   = 0\n  var commonActive = 0\n  for(var i=0; i<n; ++i) {\n    var e     = SWEEP_EVENTS[2*i+1]|0\n    var color = e&1\n    if(i < n-1 && (e>>1) === (SWEEP_EVENTS[2*i+3]>>1)) {\n      color = 2\n      i += 1\n    }\n    \n    if(e < 0) {\n      //Create event\n      var id = -(e>>1) - 1\n\n      //Intersect with common\n      for(var j=0; j<commonActive; ++j) {\n        var retval = visit(COMMON_SWEEP_QUEUE[j], id)\n        if(retval !== void 0) {\n          return retval\n        }\n      }\n\n      if(color !== 0) {\n        //Intersect with red\n        for(var j=0; j<redActive; ++j) {\n          var retval = visit(RED_SWEEP_QUEUE[j], id)\n          if(retval !== void 0) {\n            return retval\n          }\n        }\n      }\n\n      if(color !== 1) {\n        //Intersect with blue\n        for(var j=0; j<blueActive; ++j) {\n          var retval = visit(BLUE_SWEEP_QUEUE[j], id)\n          if(retval !== void 0) {\n            return retval\n          }\n        }\n      }\n\n      if(color === 0) {\n        //Red\n        sqPush(RED_SWEEP_QUEUE, RED_SWEEP_INDEX, redActive++, id)\n      } else if(color === 1) {\n        //Blue\n        sqPush(BLUE_SWEEP_QUEUE, BLUE_SWEEP_INDEX, blueActive++, id)\n      } else if(color === 2) {\n        //Both\n        sqPush(COMMON_SWEEP_QUEUE, COMMON_SWEEP_INDEX, commonActive++, id)\n      }\n    } else {\n      //Destroy event\n      var id = (e>>1) - 1\n      if(color === 0) {\n        //Red\n        sqPop(RED_SWEEP_QUEUE, RED_SWEEP_INDEX, redActive--, id)\n      } else if(color === 1) {\n        //Blue\n        sqPop(BLUE_SWEEP_QUEUE, BLUE_SWEEP_INDEX, blueActive--, id)\n      } else if(color === 2) {\n        //Both\n        sqPop(COMMON_SWEEP_QUEUE, COMMON_SWEEP_INDEX, commonActive--, id)\n      }\n    }\n  }\n}\n\n//Sweep and prune/scanline algorithm:\n//  Scan along axis, detect intersections\n//  Brute force all boxes along axis\nfunction scanBipartite(\n  d, axis, visit, flip,\n  redStart,  redEnd, red, redIndex,\n  blueStart, blueEnd, blue, blueIndex) {\n  \n  var ptr      = 0\n  var elemSize = 2*d\n  var istart   = axis\n  var iend     = axis+d\n\n  var redShift  = 1\n  var blueShift = 1\n  if(flip) {\n    blueShift = BLUE_FLAG\n  } else {\n    redShift  = BLUE_FLAG\n  }\n\n  for(var i=redStart; i<redEnd; ++i) {\n    var idx = i + redShift\n    var redOffset = elemSize*i\n    SWEEP_EVENTS[ptr++] = red[redOffset+istart]\n    SWEEP_EVENTS[ptr++] = -idx\n    SWEEP_EVENTS[ptr++] = red[redOffset+iend]\n    SWEEP_EVENTS[ptr++] = idx\n  }\n  for(var i=blueStart; i<blueEnd; ++i) {\n    var idx = i + blueShift\n    var blueOffset = elemSize*i\n    SWEEP_EVENTS[ptr++] = blue[blueOffset+istart]\n    SWEEP_EVENTS[ptr++] = -idx\n  }\n\n  //process events from left->right\n  var n = ptr >>> 1\n  isort(SWEEP_EVENTS, n)\n  \n  var redActive    = 0\n  for(var i=0; i<n; ++i) {\n    var e = SWEEP_EVENTS[2*i+1]|0\n    if(e < 0) {\n      var idx   = -e\n      var isRed = false\n      if(idx >= BLUE_FLAG) {\n        isRed = !flip\n        idx -= BLUE_FLAG \n      } else {\n        isRed = !!flip\n        idx -= 1\n      }\n      if(isRed) {\n        sqPush(RED_SWEEP_QUEUE, RED_SWEEP_INDEX, redActive++, idx)\n      } else {\n        var blueId  = blueIndex[idx]\n        var bluePtr = elemSize * idx\n        \n        var b0 = blue[bluePtr+axis+1]\n        var b1 = blue[bluePtr+axis+1+d]\n\nred_loop:\n        for(var j=0; j<redActive; ++j) {\n          var oidx   = RED_SWEEP_QUEUE[j]\n          var redPtr = elemSize * oidx\n\n          if(b1 < red[redPtr+axis+1] || \n             red[redPtr+axis+1+d] < b0) {\n            continue\n          }\n\n          for(var k=axis+2; k<d; ++k) {\n            if(blue[bluePtr + k + d] < red[redPtr + k] || \n               red[redPtr + k + d] < blue[bluePtr + k]) {\n              continue red_loop\n            }\n          }\n\n          var redId  = redIndex[oidx]\n          var retval\n          if(flip) {\n            retval = visit(blueId, redId)\n          } else {\n            retval = visit(redId, blueId)\n          }\n          if(retval !== void 0) {\n            return retval \n          }\n        }\n      }\n    } else {\n      sqPop(RED_SWEEP_QUEUE, RED_SWEEP_INDEX, redActive--, e - redShift)\n    }\n  }\n}\n\nfunction scanComplete(\n  d, axis, visit,\n  redStart,  redEnd, red, redIndex,\n  blueStart, blueEnd, blue, blueIndex) {\n\n  var ptr      = 0\n  var elemSize = 2*d\n  var istart   = axis\n  var iend     = axis+d\n\n  for(var i=redStart; i<redEnd; ++i) {\n    var idx = i + BLUE_FLAG\n    var redOffset = elemSize*i\n    SWEEP_EVENTS[ptr++] = red[redOffset+istart]\n    SWEEP_EVENTS[ptr++] = -idx\n    SWEEP_EVENTS[ptr++] = red[redOffset+iend]\n    SWEEP_EVENTS[ptr++] = idx\n  }\n  for(var i=blueStart; i<blueEnd; ++i) {\n    var idx = i + 1\n    var blueOffset = elemSize*i\n    SWEEP_EVENTS[ptr++] = blue[blueOffset+istart]\n    SWEEP_EVENTS[ptr++] = -idx\n  }\n\n  //process events from left->right\n  var n = ptr >>> 1\n  isort(SWEEP_EVENTS, n)\n  \n  var redActive    = 0\n  for(var i=0; i<n; ++i) {\n    var e = SWEEP_EVENTS[2*i+1]|0\n    if(e < 0) {\n      var idx   = -e\n      if(idx >= BLUE_FLAG) {\n        RED_SWEEP_QUEUE[redActive++] = idx - BLUE_FLAG\n      } else {\n        idx -= 1\n        var blueId  = blueIndex[idx]\n        var bluePtr = elemSize * idx\n\n        var b0 = blue[bluePtr+axis+1]\n        var b1 = blue[bluePtr+axis+1+d]\n\nred_loop:\n        for(var j=0; j<redActive; ++j) {\n          var oidx   = RED_SWEEP_QUEUE[j]\n          var redId  = redIndex[oidx]\n\n          if(redId === blueId) {\n            break\n          }\n\n          var redPtr = elemSize * oidx\n          if(b1 < red[redPtr+axis+1] || \n            red[redPtr+axis+1+d] < b0) {\n            continue\n          }\n          for(var k=axis+2; k<d; ++k) {\n            if(blue[bluePtr + k + d] < red[redPtr + k] || \n               red[redPtr + k + d]   < blue[bluePtr + k]) {\n              continue red_loop\n            }\n          }\n\n          var retval = visit(redId, blueId)\n          if(retval !== void 0) {\n            return retval \n          }\n        }\n      }\n    } else {\n      var idx = e - BLUE_FLAG\n      for(var j=redActive-1; j>=0; --j) {\n        if(RED_SWEEP_QUEUE[j] === idx) {\n          for(var k=j+1; k<redActive; ++k) {\n            RED_SWEEP_QUEUE[k-1] = RED_SWEEP_QUEUE[k]\n          }\n          break\n        }\n      }\n      --redActive\n    }\n  }\n}","/**\n * Bit twiddling hacks for JavaScript.\n *\n * Author: Mikola Lysenko\n *\n * Ported from Stanford bit twiddling hack library:\n *    http://graphics.stanford.edu/~seander/bithacks.html\n */\n\n\"use strict\"; \"use restrict\";\n\n//Number of bits in an integer\nvar INT_BITS = 32;\n\n//Constants\nexports.INT_BITS  = INT_BITS;\nexports.INT_MAX   =  0x7fffffff;\nexports.INT_MIN   = -1<<(INT_BITS-1);\n\n//Returns -1, 0, +1 depending on sign of x\nexports.sign = function(v) {\n  return (v > 0) - (v < 0);\n}\n\n//Computes absolute value of integer\nexports.abs = function(v) {\n  var mask = v >> (INT_BITS-1);\n  return (v ^ mask) - mask;\n}\n\n//Computes minimum of integers x and y\nexports.min = function(x, y) {\n  return y ^ ((x ^ y) & -(x < y));\n}\n\n//Computes maximum of integers x and y\nexports.max = function(x, y) {\n  return x ^ ((x ^ y) & -(x < y));\n}\n\n//Checks if a number is a power of two\nexports.isPow2 = function(v) {\n  return !(v & (v-1)) && (!!v);\n}\n\n//Computes log base 2 of v\nexports.log2 = function(v) {\n  var r, shift;\n  r =     (v > 0xFFFF) << 4; v >>>= r;\n  shift = (v > 0xFF  ) << 3; v >>>= shift; r |= shift;\n  shift = (v > 0xF   ) << 2; v >>>= shift; r |= shift;\n  shift = (v > 0x3   ) << 1; v >>>= shift; r |= shift;\n  return r | (v >> 1);\n}\n\n//Computes log base 10 of v\nexports.log10 = function(v) {\n  return  (v >= 1000000000) ? 9 : (v >= 100000000) ? 8 : (v >= 10000000) ? 7 :\n          (v >= 1000000) ? 6 : (v >= 100000) ? 5 : (v >= 10000) ? 4 :\n          (v >= 1000) ? 3 : (v >= 100) ? 2 : (v >= 10) ? 1 : 0;\n}\n\n//Counts number of bits\nexports.popCount = function(v) {\n  v = v - ((v >>> 1) & 0x55555555);\n  v = (v & 0x33333333) + ((v >>> 2) & 0x33333333);\n  return ((v + (v >>> 4) & 0xF0F0F0F) * 0x1010101) >>> 24;\n}\n\n//Counts number of trailing zeros\nfunction countTrailingZeros(v) {\n  var c = 32;\n  v &= -v;\n  if (v) c--;\n  if (v & 0x0000FFFF) c -= 16;\n  if (v & 0x00FF00FF) c -= 8;\n  if (v & 0x0F0F0F0F) c -= 4;\n  if (v & 0x33333333) c -= 2;\n  if (v & 0x55555555) c -= 1;\n  return c;\n}\nexports.countTrailingZeros = countTrailingZeros;\n\n//Rounds to next power of 2\nexports.nextPow2 = function(v) {\n  v += v === 0;\n  --v;\n  v |= v >>> 1;\n  v |= v >>> 2;\n  v |= v >>> 4;\n  v |= v >>> 8;\n  v |= v >>> 16;\n  return v + 1;\n}\n\n//Rounds down to previous power of 2\nexports.prevPow2 = function(v) {\n  v |= v >>> 1;\n  v |= v >>> 2;\n  v |= v >>> 4;\n  v |= v >>> 8;\n  v |= v >>> 16;\n  return v - (v>>>1);\n}\n\n//Computes parity of word\nexports.parity = function(v) {\n  v ^= v >>> 16;\n  v ^= v >>> 8;\n  v ^= v >>> 4;\n  v &= 0xf;\n  return (0x6996 >>> v) & 1;\n}\n\nvar REVERSE_TABLE = new Array(256);\n\n(function(tab) {\n  for(var i=0; i<256; ++i) {\n    var v = i, r = i, s = 7;\n    for (v >>>= 1; v; v >>>= 1) {\n      r <<= 1;\n      r |= v & 1;\n      --s;\n    }\n    tab[i] = (r << s) & 0xff;\n  }\n})(REVERSE_TABLE);\n\n//Reverse bits in a 32 bit word\nexports.reverse = function(v) {\n  return  (REVERSE_TABLE[ v         & 0xff] << 24) |\n          (REVERSE_TABLE[(v >>> 8)  & 0xff] << 16) |\n          (REVERSE_TABLE[(v >>> 16) & 0xff] << 8)  |\n           REVERSE_TABLE[(v >>> 24) & 0xff];\n}\n\n//Interleave bits of 2 coordinates with 16 bits.  Useful for fast quadtree codes\nexports.interleave2 = function(x, y) {\n  x &= 0xFFFF;\n  x = (x | (x << 8)) & 0x00FF00FF;\n  x = (x | (x << 4)) & 0x0F0F0F0F;\n  x = (x | (x << 2)) & 0x33333333;\n  x = (x | (x << 1)) & 0x55555555;\n\n  y &= 0xFFFF;\n  y = (y | (y << 8)) & 0x00FF00FF;\n  y = (y | (y << 4)) & 0x0F0F0F0F;\n  y = (y | (y << 2)) & 0x33333333;\n  y = (y | (y << 1)) & 0x55555555;\n\n  return x | (y << 1);\n}\n\n//Extracts the nth interleaved component\nexports.deinterleave2 = function(v, n) {\n  v = (v >>> n) & 0x55555555;\n  v = (v | (v >>> 1))  & 0x33333333;\n  v = (v | (v >>> 2))  & 0x0F0F0F0F;\n  v = (v | (v >>> 4))  & 0x00FF00FF;\n  v = (v | (v >>> 16)) & 0x000FFFF;\n  return (v << 16) >> 16;\n}\n\n\n//Interleave bits of 3 coordinates, each with 10 bits.  Useful for fast octree codes\nexports.interleave3 = function(x, y, z) {\n  x &= 0x3FF;\n  x  = (x | (x<<16)) & 4278190335;\n  x  = (x | (x<<8))  & 251719695;\n  x  = (x | (x<<4))  & 3272356035;\n  x  = (x | (x<<2))  & 1227133513;\n\n  y &= 0x3FF;\n  y  = (y | (y<<16)) & 4278190335;\n  y  = (y | (y<<8))  & 251719695;\n  y  = (y | (y<<4))  & 3272356035;\n  y  = (y | (y<<2))  & 1227133513;\n  x |= (y << 1);\n  \n  z &= 0x3FF;\n  z  = (z | (z<<16)) & 4278190335;\n  z  = (z | (z<<8))  & 251719695;\n  z  = (z | (z<<4))  & 3272356035;\n  z  = (z | (z<<2))  & 1227133513;\n  \n  return x | (z << 2);\n}\n\n//Extracts nth interleaved component of a 3-tuple\nexports.deinterleave3 = function(v, n) {\n  v = (v >>> n)       & 1227133513;\n  v = (v | (v>>>2))   & 3272356035;\n  v = (v | (v>>>4))   & 251719695;\n  v = (v | (v>>>8))   & 4278190335;\n  v = (v | (v>>>16))  & 0x3FF;\n  return (v<<22)>>22;\n}\n\n//Computes next combination in colexicographic order (this is mistakenly called nextPermutation on the bit twiddling hacks page)\nexports.nextCombination = function(v) {\n  var t = v | (v - 1);\n  return (t + 1) | (((~t & -~t) - 1) >>> (countTrailingZeros(v) + 1));\n}\n\n","'use strict'\n\nmodule.exports = genPartition\n\nvar code = 'for(var j=2*a,k=j*c,l=k,m=c,n=b,o=a+b,p=c;d>p;++p,k+=j){var _;if($)if(m===p)m+=1,l+=j;else{for(var s=0;j>s;++s){var t=e[k+s];e[k+s]=e[l],e[l++]=t}var u=f[p];f[p]=f[m],f[m++]=u}}return m'\n\nfunction genPartition(predicate, args) {\n  var fargs ='abcdef'.split('').concat(args)\n  var reads = []\n  if(predicate.indexOf('lo') >= 0) {\n    reads.push('lo=e[k+n]')\n  }\n  if(predicate.indexOf('hi') >= 0) {\n    reads.push('hi=e[k+o]')\n  }\n  fargs.push(\n    code.replace('_', reads.join())\n        .replace('$', predicate))\n  return Function.apply(void 0, fargs)\n}","module.exports = clone;\n\n/**\n * Creates a new vec3 initialized with values from an existing vector\n *\n * @param {vec3} a vector to clone\n * @returns {vec3} a new 3D vector\n */\nfunction clone(a) {\n    var out = new Float32Array(3)\n    out[0] = a[0]\n    out[1] = a[1]\n    out[2] = a[2]\n    return out\n}","module.exports = angle\n\nvar fromValues = require('./fromValues')\nvar normalize = require('./normalize')\nvar dot = require('./dot')\n\n/**\n * Get the angle between two 3D vectors\n * @param {vec3} a The first operand\n * @param {vec3} b The second operand\n * @returns {Number} The angle in radians\n */\nfunction angle(a, b) {\n    var tempA = fromValues(a[0], a[1], a[2])\n    var tempB = fromValues(b[0], b[1], b[2])\n \n    normalize(tempA, tempA)\n    normalize(tempB, tempB)\n \n    var cosine = dot(tempA, tempB)\n\n    if(cosine > 1.0){\n        return 0\n    } else {\n        return Math.acos(cosine)\n    }     \n}\n","module.exports = copy;\n\n/**\n * Copy the values from one vec3 to another\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the source vector\n * @returns {vec3} out\n */\nfunction copy(out, a) {\n    out[0] = a[0]\n    out[1] = a[1]\n    out[2] = a[2]\n    return out\n}","module.exports = set;\n\n/**\n * Set the components of a vec3 to the given values\n *\n * @param {vec3} out the receiving vector\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} out\n */\nfunction set(out, x, y, z) {\n    out[0] = x\n    out[1] = y\n    out[2] = z\n    return out\n}","module.exports = equals\n\nvar EPSILON = require('./epsilon')\n\n/**\n * Returns whether or not the vectors have approximately the same elements in the same position.\n *\n * @param {vec3} a The first vector.\n * @param {vec3} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\nfunction equals(a, b) {\n  var a0 = a[0]\n  var a1 = a[1]\n  var a2 = a[2]\n  var b0 = b[0]\n  var b1 = b[1]\n  var b2 = b[2]\n  return (Math.abs(a0 - b0) <= EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) &&\n          Math.abs(a1 - b1) <= EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) &&\n          Math.abs(a2 - b2) <= EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)))\n}\n","module.exports = exactEquals\n\n/**\n * Returns whether or not the vectors exactly have the same elements in the same position (when compared with ===)\n *\n * @param {vec3} a The first vector.\n * @param {vec3} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\nfunction exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2]\n}\n","module.exports = add;\n\n/**\n * Adds two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nfunction add(out, a, b) {\n    out[0] = a[0] + b[0]\n    out[1] = a[1] + b[1]\n    out[2] = a[2] + b[2]\n    return out\n}","module.exports = require('./subtract')\n","module.exports = require('./multiply')\n","module.exports = require('./divide')\n","module.exports = min;\n\n/**\n * Returns the minimum of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nfunction min(out, a, b) {\n    out[0] = Math.min(a[0], b[0])\n    out[1] = Math.min(a[1], b[1])\n    out[2] = Math.min(a[2], b[2])\n    return out\n}","module.exports = max;\n\n/**\n * Returns the maximum of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nfunction max(out, a, b) {\n    out[0] = Math.max(a[0], b[0])\n    out[1] = Math.max(a[1], b[1])\n    out[2] = Math.max(a[2], b[2])\n    return out\n}","module.exports = floor\n\n/**\n * Math.floor the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a vector to floor\n * @returns {vec3} out\n */\nfunction floor(out, a) {\n  out[0] = Math.floor(a[0])\n  out[1] = Math.floor(a[1])\n  out[2] = Math.floor(a[2])\n  return out\n}\n","module.exports = ceil\n\n/**\n * Math.ceil the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a vector to ceil\n * @returns {vec3} out\n */\nfunction ceil(out, a) {\n  out[0] = Math.ceil(a[0])\n  out[1] = Math.ceil(a[1])\n  out[2] = Math.ceil(a[2])\n  return out\n}\n","module.exports = round\n\n/**\n * Math.round the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a vector to round\n * @returns {vec3} out\n */\nfunction round(out, a) {\n  out[0] = Math.round(a[0])\n  out[1] = Math.round(a[1])\n  out[2] = Math.round(a[2])\n  return out\n}\n","module.exports = scale;\n\n/**\n * Scales a vec3 by a scalar number\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {vec3} out\n */\nfunction scale(out, a, b) {\n    out[0] = a[0] * b\n    out[1] = a[1] * b\n    out[2] = a[2] * b\n    return out\n}","module.exports = scaleAndAdd;\n\n/**\n * Adds two vec3's after scaling the second operand by a scalar value\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @param {Number} scale the amount to scale b by before adding\n * @returns {vec3} out\n */\nfunction scaleAndAdd(out, a, b, scale) {\n    out[0] = a[0] + (b[0] * scale)\n    out[1] = a[1] + (b[1] * scale)\n    out[2] = a[2] + (b[2] * scale)\n    return out\n}","module.exports = require('./distance')\n","module.exports = require('./squaredDistance')\n","module.exports = require('./length')\n","module.exports = require('./squaredLength')\n","module.exports = negate;\n\n/**\n * Negates the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a vector to negate\n * @returns {vec3} out\n */\nfunction negate(out, a) {\n    out[0] = -a[0]\n    out[1] = -a[1]\n    out[2] = -a[2]\n    return out\n}","module.exports = inverse;\n\n/**\n * Returns the inverse of the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a vector to invert\n * @returns {vec3} out\n */\nfunction inverse(out, a) {\n  out[0] = 1.0 / a[0]\n  out[1] = 1.0 / a[1]\n  out[2] = 1.0 / a[2]\n  return out\n}","module.exports = cross;\n\n/**\n * Computes the cross product of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nfunction cross(out, a, b) {\n    var ax = a[0], ay = a[1], az = a[2],\n        bx = b[0], by = b[1], bz = b[2]\n\n    out[0] = ay * bz - az * by\n    out[1] = az * bx - ax * bz\n    out[2] = ax * by - ay * bx\n    return out\n}","module.exports = lerp;\n\n/**\n * Performs a linear interpolation between two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @param {Number} t interpolation amount between the two inputs\n * @returns {vec3} out\n */\nfunction lerp(out, a, b, t) {\n    var ax = a[0],\n        ay = a[1],\n        az = a[2]\n    out[0] = ax + t * (b[0] - ax)\n    out[1] = ay + t * (b[1] - ay)\n    out[2] = az + t * (b[2] - az)\n    return out\n}","module.exports = random;\n\n/**\n * Generates a random vector with the given scale\n *\n * @param {vec3} out the receiving vector\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\n * @returns {vec3} out\n */\nfunction random(out, scale) {\n    scale = scale || 1.0\n\n    var r = Math.random() * 2.0 * Math.PI\n    var z = (Math.random() * 2.0) - 1.0\n    var zScale = Math.sqrt(1.0-z*z) * scale\n\n    out[0] = Math.cos(r) * zScale\n    out[1] = Math.sin(r) * zScale\n    out[2] = z * scale\n    return out\n}","module.exports = transformMat4;\n\n/**\n * Transforms the vec3 with a mat4.\n * 4th vector component is implicitly '1'\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the vector to transform\n * @param {mat4} m matrix to transform with\n * @returns {vec3} out\n */\nfunction transformMat4(out, a, m) {\n    var x = a[0], y = a[1], z = a[2],\n        w = m[3] * x + m[7] * y + m[11] * z + m[15]\n    w = w || 1.0\n    out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w\n    out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w\n    out[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w\n    return out\n}","module.exports = transformMat3;\n\n/**\n * Transforms the vec3 with a mat3.\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the vector to transform\n * @param {mat4} m the 3x3 matrix to transform with\n * @returns {vec3} out\n */\nfunction transformMat3(out, a, m) {\n    var x = a[0], y = a[1], z = a[2]\n    out[0] = x * m[0] + y * m[3] + z * m[6]\n    out[1] = x * m[1] + y * m[4] + z * m[7]\n    out[2] = x * m[2] + y * m[5] + z * m[8]\n    return out\n}","module.exports = transformQuat;\n\n/**\n * Transforms the vec3 with a quat\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the vector to transform\n * @param {quat} q quaternion to transform with\n * @returns {vec3} out\n */\nfunction transformQuat(out, a, q) {\n    // benchmarks: http://jsperf.com/quaternion-transform-vec3-implementations\n\n    var x = a[0], y = a[1], z = a[2],\n        qx = q[0], qy = q[1], qz = q[2], qw = q[3],\n\n        // calculate quat * vec\n        ix = qw * x + qy * z - qz * y,\n        iy = qw * y + qz * x - qx * z,\n        iz = qw * z + qx * y - qy * x,\n        iw = -qx * x - qy * y - qz * z\n\n    // calculate result * inverse quat\n    out[0] = ix * qw + iw * -qx + iy * -qz - iz * -qy\n    out[1] = iy * qw + iw * -qy + iz * -qx - ix * -qz\n    out[2] = iz * qw + iw * -qz + ix * -qy - iy * -qx\n    return out\n}","module.exports = rotateX;\n\n/**\n * Rotate a 3D vector around the x-axis\n * @param {vec3} out The receiving vec3\n * @param {vec3} a The vec3 point to rotate\n * @param {vec3} b The origin of the rotation\n * @param {Number} c The angle of rotation\n * @returns {vec3} out\n */\nfunction rotateX(out, a, b, c){\n    var by = b[1]\n    var bz = b[2]\n\n    // Translate point to the origin\n    var py = a[1] - by\n    var pz = a[2] - bz\n\n    var sc = Math.sin(c)\n    var cc = Math.cos(c)\n\n    // perform rotation and translate to correct position\n    out[0] = a[0]\n    out[1] = by + py * cc - pz * sc\n    out[2] = bz + py * sc + pz * cc\n\n    return out\n}\n","module.exports = rotateY;\n\n/**\n * Rotate a 3D vector around the y-axis\n * @param {vec3} out The receiving vec3\n * @param {vec3} a The vec3 point to rotate\n * @param {vec3} b The origin of the rotation\n * @param {Number} c The angle of rotation\n * @returns {vec3} out\n */\nfunction rotateY(out, a, b, c){\n    var bx = b[0]\n    var bz = b[2]\n\n    // translate point to the origin\n    var px = a[0] - bx\n    var pz = a[2] - bz\n    \n    var sc = Math.sin(c)\n    var cc = Math.cos(c)\n  \n    // perform rotation and translate to correct position\n    out[0] = bx + pz * sc + px * cc\n    out[1] = a[1]\n    out[2] = bz + pz * cc - px * sc\n  \n    return out\n}\n","module.exports = rotateZ;\n\n/**\n * Rotate a 3D vector around the z-axis\n * @param {vec3} out The receiving vec3\n * @param {vec3} a The vec3 point to rotate\n * @param {vec3} b The origin of the rotation\n * @param {Number} c The angle of rotation\n * @returns {vec3} out\n */\nfunction rotateZ(out, a, b, c){\n    var bx = b[0]\n    var by = b[1]\n\n    //Translate point to the origin\n    var px = a[0] - bx\n    var py = a[1] - by\n  \n    var sc = Math.sin(c)\n    var cc = Math.cos(c)\n\n    // perform rotation and translate to correct position\n    out[0] = bx + px * cc - py * sc\n    out[1] = by + px * sc + py * cc\n    out[2] = a[2]\n  \n    return out\n}\n","module.exports = forEach;\n\nvar vec = require('./create')()\n\n/**\n * Perform some operation over an array of vec3s.\n *\n * @param {Array} a the array of vectors to iterate over\n * @param {Number} stride Number of elements between the start of each vec3. If 0 assumes tightly packed\n * @param {Number} offset Number of elements to skip at the beginning of the array\n * @param {Number} count Number of vec3s to iterate over. If 0 iterates over entire array\n * @param {Function} fn Function to call for each vector in the array\n * @param {Object} [arg] additional argument to pass to fn\n * @returns {Array} a\n * @function\n */\nfunction forEach(a, stride, offset, count, fn, arg) {\n        var i, l\n        if(!stride) {\n            stride = 3\n        }\n\n        if(!offset) {\n            offset = 0\n        }\n        \n        if(count) {\n            l = Math.min((count * stride) + offset, a.length)\n        } else {\n            l = a.length\n        }\n\n        for(i = offset; i < l; i += stride) {\n            vec[0] = a[i] \n            vec[1] = a[i+1] \n            vec[2] = a[i+2]\n            fn(vec, vec, arg)\n            a[i] = vec[0] \n            a[i+1] = vec[1] \n            a[i+2] = vec[2]\n        }\n        \n        return a\n}","/*!\n * Determine if an object is a Buffer\n *\n * @author   Feross Aboukhadijeh <https://feross.org>\n * @license  MIT\n */\n\n// The _isBuffer check is for Safari 5-7 support, because it's missing\n// Object.prototype.constructor. Remove this eventually\nmodule.exports = function (obj) {\n  return obj != null && (isBuffer(obj) || isSlowBuffer(obj) || !!obj._isBuffer)\n}\n\nfunction isBuffer (obj) {\n  return !!obj.constructor && typeof obj.constructor.isBuffer === 'function' && obj.constructor.isBuffer(obj)\n}\n\n// For Node v0.10 support. Remove this eventually.\nfunction isSlowBuffer (obj) {\n  return typeof obj.readFloatLE === 'function' && typeof obj.slice === 'function' && isBuffer(obj.slice(0, 0))\n}\n","\"use strict\"\n\nfunction traceRay_impl( getVoxel,\n\tpx, py, pz,\n\tdx, dy, dz,\n\tmax_d, hit_pos, hit_norm) {\n\t\n\t// consider raycast vector to be parametrized by t\n\t//   vec = [px,py,pz] + t * [dx,dy,dz]\n\t\n\t// algo below is as described by this paper:\n\t// http://www.cse.chalmers.se/edu/year/2010/course/TDA361/grid.pdf\n\t\n\tvar t = 0.0\n\t\t, floor = Math.floor\n\t\t, ix = floor(px) | 0\n\t\t, iy = floor(py) | 0\n\t\t, iz = floor(pz) | 0\n\n\t\t, stepx = (dx > 0) ? 1 : -1\n\t\t, stepy = (dy > 0) ? 1 : -1\n\t\t, stepz = (dz > 0) ? 1 : -1\n\t\t\n\t// dx,dy,dz are already normalized\n\t\t, txDelta = Math.abs(1 / dx)\n\t\t, tyDelta = Math.abs(1 / dy)\n\t\t, tzDelta = Math.abs(1 / dz)\n\n\t\t, xdist = (stepx > 0) ? (ix + 1 - px) : (px - ix)\n\t\t, ydist = (stepy > 0) ? (iy + 1 - py) : (py - iy)\n\t\t, zdist = (stepz > 0) ? (iz + 1 - pz) : (pz - iz)\n\t\t\n\t// location of nearest voxel boundary, in units of t \n\t\t, txMax = (txDelta < Infinity) ? txDelta * xdist : Infinity\n\t\t, tyMax = (tyDelta < Infinity) ? tyDelta * ydist : Infinity\n\t\t, tzMax = (tzDelta < Infinity) ? tzDelta * zdist : Infinity\n\n\t\t, steppedIndex = -1\n\t\n\t// main loop along raycast vector\n\twhile (t <= max_d) {\n\t\t\n\t\t// exit check\n\t\tvar b = getVoxel(ix, iy, iz)\n\t\tif (b) {\n\t\t\tif (hit_pos) {\n\t\t\t\thit_pos[0] = px + t * dx\n\t\t\t\thit_pos[1] = py + t * dy\n\t\t\t\thit_pos[2] = pz + t * dz\n\t\t\t}\n\t\t\tif (hit_norm) {\n\t\t\t\thit_norm[0] = hit_norm[1] = hit_norm[2] = 0\n\t\t\t\tif (steppedIndex === 0) hit_norm[0] = -stepx\n\t\t\t\tif (steppedIndex === 1) hit_norm[1] = -stepy\n\t\t\t\tif (steppedIndex === 2) hit_norm[2] = -stepz\n\t\t\t}\n\t\t\treturn b\n\t\t}\n\t\t\n\t\t// advance t to next nearest voxel boundary\n\t\tif (txMax < tyMax) {\n\t\t\tif (txMax < tzMax) {\n\t\t\t\tix += stepx\n\t\t\t\tt = txMax\n\t\t\t\ttxMax += txDelta\n\t\t\t\tsteppedIndex = 0\n\t\t\t} else {\n\t\t\t\tiz += stepz\n\t\t\t\tt = tzMax\n\t\t\t\ttzMax += tzDelta\n\t\t\t\tsteppedIndex = 2\n\t\t\t}\n\t\t} else {\n\t\t\tif (tyMax < tzMax) {\n\t\t\t\tiy += stepy\n\t\t\t\tt = tyMax\n\t\t\t\ttyMax += tyDelta\n\t\t\t\tsteppedIndex = 1\n\t\t\t} else {\n\t\t\t\tiz += stepz\n\t\t\t\tt = tzMax\n\t\t\t\ttzMax += tzDelta\n\t\t\t\tsteppedIndex = 2\n\t\t\t}\n\t\t}\n\n\t}\n\t\n\t// no voxel hit found\n\tif (hit_pos) {\n\t\thit_pos[0] = px + t * dx\n\t\thit_pos[1] = py + t * dy\n\t\thit_pos[2] = pz + t * dz\n\t}\n\tif (hit_norm) {\n\t\thit_norm[0] = hit_norm[1] = hit_norm[2] = 0\n\t}\n\n\treturn 0\n\n}\n\n\n// conform inputs\n\nfunction traceRay(getVoxel, origin, direction, max_d, hit_pos, hit_norm) {\n\tvar px = +origin[0]\n\t\t, py = +origin[1]\n\t\t, pz = +origin[2]\n\t\t, dx = +direction[0]\n\t\t, dy = +direction[1]\n\t\t, dz = +direction[2]\n\t\t, ds = Math.sqrt(dx * dx + dy * dy + dz * dz)\n\n\tif (ds === 0) {\n\t\tthrow new Error(\"Can't raycast along a zero vector\")\n\t}\n\n\tdx /= ds\n\tdy /= ds\n\tdz /= ds\n\tif (typeof (max_d) === \"undefined\") {\n\t\tmax_d = 64.0\n\t} else {\n\t\tmax_d = +max_d\n\t}\n\treturn traceRay_impl(getVoxel, px, py, pz, dx, dy, dz, max_d, hit_pos, hit_norm)\n}\n\nmodule.exports = traceRay","\"use strict\"\n\nvar EventEmitter = require(\"events\").EventEmitter\n  , util         = require(\"util\")\n  , domready     = require(\"domready\")\n  , vkey         = require(\"vkey\")\n  , invert       = require(\"invert-hash\")\n  , uniq         = require(\"uniq\")\n  , bsearch      = require(\"binary-search-bounds\")\n  , iota         = require(\"iota-array\")\n  , min          = Math.min\n\n//Browser compatibility hacks\nrequire(\"./lib/raf-polyfill.js\")\nvar addMouseWheel = require(\"./lib/mousewheel-polyfill.js\")\nvar hrtime = require(\"./lib/hrtime-polyfill.js\")\n\n//Remove angle braces and other useless crap\nvar filtered_vkey = (function() {\n  var result = new Array(256)\n    , i, j, k\n  for(i=0; i<256; ++i) {\n    result[i] = \"UNK\"\n  }\n  for(i in vkey) {\n    k = vkey[i]\n    if(k.charAt(0) === '<' && k.charAt(k.length-1) === '>') {\n      k = k.substring(1, k.length-1)\n    }\n    k = k.replace(/\\s/g, \"-\")\n    result[parseInt(i)] = k\n  }\n  return result\n})()\n\n//Compute minimal common set of keyboard functions\nvar keyNames = uniq(Object.keys(invert(filtered_vkey)))\n\n//Translates a virtual keycode to a normalized keycode\nfunction virtualKeyCode(key) {\n  return bsearch.eq(keyNames, key)\n}\n\n//Maps a physical keycode to a normalized keycode\nfunction physicalKeyCode(key) {\n  return virtualKeyCode(filtered_vkey[key])\n}\n\n//Game shell\nfunction GameShell() {\n  EventEmitter.call(this)\n  this._curKeyState  = new Array(keyNames.length)\n  this._pressCount   = new Array(keyNames.length)\n  this._releaseCount = new Array(keyNames.length)\n  \n  this._tickInterval = null\n  this._rafHandle = null\n  this._tickRate = 0\n  this._lastTick = hrtime()\n  this._frameTime = 0.0\n  this._paused = true\n  this._width = 0\n  this._height = 0\n  \n  this._wantFullscreen = false\n  this._wantPointerLock = false\n  this._fullscreenActive = false\n  this._pointerLockActive = false\n  \n  this._rafFunction = tickOrRender.bind(undefined, this, true)\n\n  this.preventDefaults = true\n  this.stopPropagation = false\n  \n  for(var i=0; i<keyNames.length; ++i) {\n    this._curKeyState[i] = false\n    this._pressCount[i] = this._releaseCount[i] = 0\n  }\n  \n  //Public members\n  this.element = null\n  this.bindings = {}\n  this.frameSkip = 100.0\n  this.tickCount = 0\n  this.frameCount = 0\n  this.startTime = hrtime()\n  this.tickTime = this._tickRate\n  this.frameTime = 10.0\n  this.stickyFullscreen = false\n  this.stickyPointerLock = false\n  \n  //Scroll stuff\n  this.scroll = [0,0,0]\n    \n  //Mouse state\n  this.mouseX = 0\n  this.mouseY = 0\n  this.prevMouseX = 0\n  this.prevMouseY = 0\n}\n\nutil.inherits(GameShell, EventEmitter)\n\nvar proto = GameShell.prototype\n\n//Bind keynames\nproto.keyNames = keyNames\n\n//Binds a virtual keyboard event to a physical key\nproto.bind = function(virtual_key) {\n  //Look up previous key bindings\n  var arr\n  if(virtual_key in this.bindings) {\n    arr = this.bindings[virtual_key]\n  } else {\n    arr = []\n  }\n  //Add keys to list\n  var physical_key\n  for(var i=1, n=arguments.length; i<n; ++i) {\n    physical_key = arguments[i]\n    if(virtualKeyCode(physical_key) >= 0) {\n      arr.push(physical_key)\n    } else if(physical_key in this.bindings) {\n      var keybinds = this.bindings[physical_key]\n      for(var j=0; j<keybinds.length; ++j) {\n        arr.push(keybinds[j])\n      }\n    }\n  }\n  //Remove any duplicate keys\n  arr = uniq(arr)\n  if(arr.length > 0) {\n    this.bindings[virtual_key] = arr\n  }\n  this.emit('bind', virtual_key, arr)\n}\n\n//Unbinds a virtual keyboard event\nproto.unbind = function(virtual_key) {\n  if(virtual_key in this.bindings) {\n    delete this.bindings[virtual_key]\n  }\n  this.emit('unbind', virtual_key)\n}\n\n//Checks if a key is set in a given state\nfunction lookupKey(state, bindings, key) {\n  if(key in bindings) {\n    var arr = bindings[key]\n    for(var i=0, n=arr.length; i<n; ++i) {\n      if(state[virtualKeyCode(arr[i])]) {\n        return true\n      }\n    }\n    return false\n  }\n  var kc = virtualKeyCode(key)\n  if(kc >= 0) {\n    return state[kc]\n  }\n  return false\n}\n\n//Checks if a key is set in a given state\nfunction lookupCount(state, bindings, key) {\n  if(key in bindings) {\n    var arr = bindings[key], r = 0\n    for(var i=0, n=arr.length; i<n; ++i) {\n      r += state[virtualKeyCode(arr[i])]\n    }\n    return r\n  }\n  var kc = virtualKeyCode(key)\n  if(kc >= 0) {\n    return state[kc]\n  }\n  return 0\n}\n\n//Checks if a key (either physical or virtual) is currently held down\nproto.down = function(key) {\n  return lookupKey(this._curKeyState, this.bindings, key)\n}\n\n//Checks if a key was ever down\nproto.wasDown = function(key) {\n  return this.down(key) || !!this.press(key)\n}\n\n//Opposite of down\nproto.up = function(key) {\n  return !this.down(key)\n}\n\n//Checks if a key was released during previous frame\nproto.wasUp = function(key) {\n  return this.up(key) || !!this.release(key)\n}\n\n//Returns the number of times a key was pressed since last tick\nproto.press = function(key) {\n  return lookupCount(this._pressCount, this.bindings, key)\n}\n\n//Returns the number of times a key was released since last tick\nproto.release = function(key) {\n  return lookupCount(this._releaseCount, this.bindings, key)\n}\n\n//Pause/unpause the game loop\nObject.defineProperty(proto, \"paused\", {\n  get: function() {\n    return this._paused\n  },\n  set: function(state) {\n    var ns = !!state\n    if(ns !== this._paused) {\n      if(!this._paused) {\n        this._paused = true\n        this._frameTime = min(1.0, (hrtime() - this._lastTick) / this._tickRate)\n        clearInterval(this._tickInterval)\n        //cancelAnimationFrame(this._rafHandle)\n      } else {\n        this._paused = false\n        this._lastTick = hrtime() - Math.floor(this._frameTime * this._tickRate)\n        this._tickInterval = setInterval(tickOrRender, this._tickRate, this, false)\n        this._rafHandle = requestAnimationFrame(this._rafFunction)\n      }\n    }\n  }\n})\n\n//Fullscreen state toggle\n\nfunction tryFullscreen(shell) {\n  //Request full screen\n  var elem = shell.element\n  \n  if(shell._wantFullscreen && !shell._fullscreenActive) {\n    var fs = elem.requestFullscreen ||\n             elem.requestFullScreen ||\n             elem.webkitRequestFullscreen ||\n             elem.webkitRequestFullScreen ||\n             elem.mozRequestFullscreen ||\n             elem.mozRequestFullScreen ||\n             function() {}\n    fs.call(elem)\n  }\n  if(shell._wantPointerLock && !shell._pointerLockActive) {\n    var pl =  elem.requestPointerLock ||\n              elem.webkitRequestPointerLock ||\n              elem.mozRequestPointerLock ||\n              elem.msRequestPointerLock ||\n              elem.oRequestPointerLock ||\n              function() {}\n    pl.call(elem)\n  }\n}\n\nvar cancelFullscreen = document.exitFullscreen ||\n                       document.cancelFullscreen ||  //Why can no one agree on this?\n                       document.cancelFullScreen ||\n                       document.webkitCancelFullscreen ||\n                       document.webkitCancelFullScreen ||\n                       document.mozCancelFullscreen ||\n                       document.mozCancelFullScreen ||\n                       function(){}\n\nObject.defineProperty(proto, \"fullscreen\", {\n  get: function() {\n    return this._fullscreenActive\n  },\n  set: function(state) {\n    var ns = !!state\n    if(!ns) {\n      this._wantFullscreen = false\n      var hasFS = document.fullscreen ||\n                  document.mozFullScreen ||\n                  document.webkitIsFullScreen ||\n                  false\n      if (hasFS) cancelFullscreen.call(document)\n    } else {\n      this._wantFullscreen = true\n      tryFullscreen(this)\n    }\n    return this._fullscreenActive\n  }\n})\n\nfunction handleFullscreen(shell) {\n  shell._fullscreenActive = document.fullscreen ||\n                            document.mozFullScreen ||\n                            document.webkitIsFullScreen ||\n                            false\n  if(!shell.stickyFullscreen && shell._fullscreenActive) {\n    shell._wantFullscreen = false\n  }\n}\n\n//Pointer lock state toggle\nvar exitPointerLock = document.exitPointerLock ||\n                      document.webkitExitPointerLock ||\n                      document.mozExitPointerLock ||\n                      function() {}\n\nObject.defineProperty(proto, \"pointerLock\", {\n  get: function() {\n    return this._pointerLockActive\n  },\n  set: function(state) {\n    var ns = !!state\n    if(!ns) {\n      this._wantPointerLock = false\n      exitPointerLock.call(document)\n    } else {\n      this._wantPointerLock = true\n      tryFullscreen(this)\n    }\n    return this._pointerLockActive\n  }\n})\n\nfunction handlePointerLockChange(shell, event) {\n  shell._pointerLockActive = shell.element === (\n      document.pointerLockElement ||\n      document.mozPointerLockElement ||\n      document.webkitPointerLockElement ||\n      null)\n  if(!shell.stickyPointerLock && shell._pointerLockActive) {\n    shell._wantPointerLock = false\n  }\n}\n\n//Width and height\nObject.defineProperty(proto, \"width\", {\n  get: function() {\n    return this.element.clientWidth\n  }\n})\nObject.defineProperty(proto, \"height\", {\n  get: function() {\n    return this.element.clientHeight\n  }\n})\n\n//Set key state\nfunction setKeyState(shell, key, state) {\n  var ps = shell._curKeyState[key]\n  if(ps !== state) {\n    if(state) {\n      shell._pressCount[key]++\n    } else {\n      shell._releaseCount[key]++\n    }\n    shell._curKeyState[key] = state\n  }\n}\n\nfunction tickOrRender(shell, doRender) {\n  tick(shell)\n  if (doRender) {\n    render(shell)\n  }\n}\n\n//Ticks the game state one update\nfunction tick(shell) {\n  var skip = hrtime() + shell.frameSkip\n    , pCount = shell._pressCount\n    , rCount = shell._releaseCount\n    , i, s, t\n    , tr = shell._tickRate\n    , n = keyNames.length\n  while(!shell._paused &&\n        hrtime() >= shell._lastTick + tr) {\n    \n    //Skip frames if we are over budget\n    if(hrtime() > skip) {\n      shell._lastTick = hrtime() + tr\n      return\n    }\n    \n    //Tick the game\n    s = hrtime()\n    shell.emit(\"tick\")\n    t = hrtime()\n    shell.tickTime = t - s\n    \n    //Update counters and time\n    ++shell.tickCount\n    shell._lastTick += tr\n    \n    //Shift input state\n    for(i=0; i<n; ++i) {\n      pCount[i] = rCount[i] = 0\n    }\n    if(shell._pointerLockActive) {\n      shell.prevMouseX = shell.mouseX = shell.width>>1\n      shell.prevMouseY = shell.mouseY = shell.height>>1\n    } else {\n      shell.prevMouseX = shell.mouseX\n      shell.prevMouseY = shell.mouseY\n    }\n    shell.scroll[0] = shell.scroll[1] = shell.scroll[2] = 0\n  }\n}\n\n//Render stuff\nfunction render(shell) {\n\n  //Request next frame\n  shell._rafHandle = requestAnimationFrame(shell._rafFunction)\n\n  //Compute frame time\n  var dt\n  if(shell._paused) {\n    dt = shell._frameTime\n  } else {\n    dt = min(1.0, (hrtime() - shell._lastTick) / shell._tickRate)\n  }\n  \n  //Draw a frame\n  ++shell.frameCount\n  var s = hrtime()\n  shell.emit(\"render\", dt)\n  var t = hrtime()\n  shell.frameTime = t - s\n  \n}\n\nfunction isFocused(shell) {\n  return (document.activeElement === document.body) ||\n         (document.activeElement === shell.element)\n}\n\nfunction handleEvent(shell, ev) {\n  if(shell.preventDefaults) {\n    ev.preventDefault()\n  }\n  if(shell.stopPropagation) {\n    ev.stopPropagation()\n  }\n}\n\n//Set key up\nfunction handleKeyUp(shell, ev) {\n  handleEvent(shell, ev)\n  var kc = physicalKeyCode(ev.keyCode || ev.char || ev.which || ev.charCode)\n  if(kc >= 0) {\n    setKeyState(shell, kc, false)\n  }\n}\n\n//Set key down\nfunction handleKeyDown(shell, ev) {\n  if(!isFocused(shell)) {\n    return\n  }\n  handleEvent(shell, ev)\n  if(ev.metaKey) {\n    //Hack: Clear key state when meta gets pressed to prevent keys sticking\n    handleBlur(shell, ev)\n  } else {\n    var kc = physicalKeyCode(ev.keyCode || ev.char || ev.which || ev.charCode)\n    if(kc >= 0) {\n      setKeyState(shell, kc, true)\n    }\n  }\n}\n\n//Mouse events are really annoying\nvar mouseCodes = iota(32).map(function(n) {\n  return virtualKeyCode(\"mouse-\" + (n+1))\n})\n\nfunction setMouseButtons(shell, buttons) {\n  for(var i=0; i<32; ++i) {\n    setKeyState(shell, mouseCodes[i], !!(buttons & (1<<i)))\n  }\n}\n\nfunction handleMouseMove(shell, ev) {\n  handleEvent(shell, ev)\n  if(shell._pointerLockActive) {\n    var movementX = ev.movementX       ||\n                    ev.mozMovementX    ||\n                    ev.webkitMovementX ||\n                    0,\n        movementY = ev.movementY       ||\n                    ev.mozMovementY    ||\n                    ev.webkitMovementY ||\n                    0\n    shell.mouseX += movementX\n    shell.mouseY += movementY\n  } else {\n    shell.mouseX = ev.clientX - shell.element.offsetLeft\n    shell.mouseY = ev.clientY - shell.element.offsetTop\n  }\n  return false\n}\n\nfunction handleMouseDown(shell, ev) {\n  handleEvent(shell, ev)\n  setKeyState(shell, mouseCodes[ev.button], true)\n  return false\n}\n\nfunction handleMouseUp(shell, ev) {\n  handleEvent(shell, ev)\n  setKeyState(shell, mouseCodes[ev.button], false)\n  return false\n}\n\nfunction handleMouseEnter(shell, ev) {\n  handleEvent(shell, ev)\n  if(shell._pointerLockActive) {\n    shell.prevMouseX = shell.mouseX = shell.width>>1\n    shell.prevMouseY = shell.mouseY = shell.height>>1\n  } else {\n    shell.prevMouseX = shell.mouseX = ev.clientX - shell.element.offsetLeft\n    shell.prevMouseY = shell.mouseY = ev.clientY - shell.element.offsetTop\n  }\n  return false\n}\n\nfunction handleMouseLeave(shell, ev) {\n  handleEvent(shell, ev)\n  setMouseButtons(shell, 0)\n  return false\n}\n\n//Handle mouse wheel events\nfunction handleMouseWheel(shell, ev) {\n  handleEvent(shell, ev)\n  var scale = 1\n  switch(ev.deltaMode) {\n    case 0: //Pixel\n      scale = 1\n    break\n    case 1: //Line\n      scale = 12\n    break\n    case 2: //Page\n       scale = shell.height\n    break\n  }\n  //Add scroll\n  shell.scroll[0] +=  ev.deltaX * scale\n  shell.scroll[1] +=  ev.deltaY * scale\n  shell.scroll[2] += (ev.deltaZ * scale)||0.0\n  return false\n}\n\nfunction handleContexMenu(shell, ev) {\n  handleEvent(shell, ev)\n  return false\n}\n\nfunction handleBlur(shell, ev) {\n  var n = keyNames.length\n    , c = shell._curKeyState\n    , r = shell._releaseCount\n    , i\n  for(i=0; i<n; ++i) {\n    if(c[i]) {\n      ++r[i]\n    }\n    c[i] = false\n  }\n  return false\n}\n\nfunction handleResizeElement(shell, ev) {\n  var w = shell.element.clientWidth|0\n  var h = shell.element.clientHeight|0\n  if((w !== shell._width) || (h !== shell._height)) {\n    shell._width = w\n    shell._height = h\n    shell.emit(\"resize\", w, h)\n  }\n}\n\nfunction makeDefaultContainer() {\n  var container = document.createElement(\"div\")\n  container.tabindex = 1\n  container.style.position = \"absolute\"\n  container.style.left = \"0px\"\n  container.style.right = \"0px\"\n  container.style.top = \"0px\"\n  container.style.bottom = \"0px\"\n  container.style.height = \"100%\"\n  container.style.overflow = \"hidden\"\n  document.body.appendChild(container)\n  document.body.style.overflow = \"hidden\" //Prevent bounce\n  document.body.style.height = \"100%\"\n  return container\n}\n\nfunction createShell(options) {\n  options = options || {}\n  \n  //Check fullscreen and pointer lock flags\n  var useFullscreen = !!options.fullscreen\n  var usePointerLock = useFullscreen\n  if(typeof options.pointerLock !== undefined) {\n    usePointerLock = !!options.pointerLock\n  }\n  \n  //Create initial shell\n  var shell = new GameShell()\n  shell._tickRate = options.tickRate || 30\n  shell.frameSkip = options.frameSkip || (shell._tickRate+5) * 5\n  shell.stickyFullscreen = !!options.stickyFullscreen || !!options.sticky\n  shell.stickyPointerLock = !!options.stickyPointerLock || !!options.sticky\n  \n  //Set bindings\n  if(options.bindings) {\n    shell.bindings = options.bindings\n  }\n  \n  //Wait for dom to intiailize\n  setTimeout(function() { domready(function initGameShell() {\n    \n    //Retrieve element\n    var element = options.element\n    if(typeof element === \"string\") {\n      var e = document.querySelector(element)\n      if(!e) {\n        e = document.getElementById(element)\n      }\n      if(!e) {\n        e = document.getElementByClass(element)[0]\n      }\n      if(!e) {\n        e = makeDefaultContainer()\n      }\n      shell.element = e\n    } else if(typeof element === \"object\" && !!element) {\n      shell.element = element\n    } else if(typeof element === \"function\") {\n      shell.element = element()\n    } else {\n      shell.element = makeDefaultContainer()\n    }\n    \n    //Disable user-select\n    if(shell.element.style) {\n      shell.element.style[\"-webkit-touch-callout\"] = \"none\"\n      shell.element.style[\"-webkit-user-select\"] = \"none\"\n      shell.element.style[\"-khtml-user-select\"] = \"none\"\n      shell.element.style[\"-moz-user-select\"] = \"none\"\n      shell.element.style[\"-ms-user-select\"] = \"none\"\n      shell.element.style[\"user-select\"] = \"none\"\n    }\n    \n    //Hook resize handler\n    shell._width = shell.element.clientWidth\n    shell._height = shell.element.clientHeight\n    var handleResize = handleResizeElement.bind(undefined, shell)\n    if(typeof MutationObserver !== \"undefined\") {\n      var observer = new MutationObserver(handleResize)\n      observer.observe(shell.element, {\n        attributes: true,\n        subtree: true\n      })\n    } else {\n      shell.element.addEventListener(\"DOMSubtreeModified\", handleResize, false)\n    }\n    window.addEventListener(\"resize\", handleResize, false)\n    \n    //Hook keyboard listener\n    window.addEventListener(\"keydown\", handleKeyDown.bind(undefined, shell), false)\n    window.addEventListener(\"keyup\", handleKeyUp.bind(undefined, shell), false)\n    \n    //Disable right click\n    shell.element.oncontextmenu = handleContexMenu.bind(undefined, shell)\n    \n    //Hook mouse listeners\n    shell.element.addEventListener(\"mousedown\", handleMouseDown.bind(undefined, shell), false)\n    shell.element.addEventListener(\"mouseup\", handleMouseUp.bind(undefined, shell), false)\n    shell.element.addEventListener(\"mousemove\", handleMouseMove.bind(undefined, shell), false)\n    shell.element.addEventListener(\"mouseenter\", handleMouseEnter.bind(undefined, shell), false)\n    \n    //Mouse leave\n    var leave = handleMouseLeave.bind(undefined, shell)\n    shell.element.addEventListener(\"mouseleave\", leave, false)\n    shell.element.addEventListener(\"mouseout\", leave, false)\n    window.addEventListener(\"mouseleave\", leave, false)\n    window.addEventListener(\"mouseout\", leave, false)\n    \n    //Blur event \n    var blur = handleBlur.bind(undefined, shell)\n    shell.element.addEventListener(\"blur\", blur, false)\n    shell.element.addEventListener(\"focusout\", blur, false)\n    shell.element.addEventListener(\"focus\", blur, false)\n    window.addEventListener(\"blur\", blur, false)\n    window.addEventListener(\"focusout\", blur, false)\n    window.addEventListener(\"focus\", blur, false)\n\n    //Mouse wheel handler\n    addMouseWheel(shell.element, handleMouseWheel.bind(undefined, shell), false)\n\n    //Fullscreen handler\n    var fullscreenChange = handleFullscreen.bind(undefined, shell)\n    document.addEventListener(\"fullscreenchange\", fullscreenChange, false)\n    document.addEventListener(\"mozfullscreenchange\", fullscreenChange, false)\n    document.addEventListener(\"webkitfullscreenchange\", fullscreenChange, false)\n\n    //Stupid fullscreen hack\n    shell.element.addEventListener(\"click\", tryFullscreen.bind(undefined, shell), false)\n\n    //Pointer lock change handler\n    var pointerLockChange = handlePointerLockChange.bind(undefined, shell)\n    document.addEventListener(\"pointerlockchange\", pointerLockChange, false)\n    document.addEventListener(\"mozpointerlockchange\", pointerLockChange, false)\n    document.addEventListener(\"webkitpointerlockchange\", pointerLockChange, false)\n    document.addEventListener(\"pointerlocklost\", pointerLockChange, false)\n    document.addEventListener(\"webkitpointerlocklost\", pointerLockChange, false)\n    document.addEventListener(\"mozpointerlocklost\", pointerLockChange, false)\n    \n    //Update flags\n    shell.fullscreen = useFullscreen\n    shell.pointerLock = usePointerLock\n  \n    //Default mouse button aliases\n    shell.bind(\"mouse-left\",   \"mouse-1\")\n    shell.bind(\"mouse-right\",  \"mouse-3\")\n    shell.bind(\"mouse-middle\", \"mouse-2\")\n    \n    //Initialize tick counter\n    shell._lastTick = hrtime()\n    shell.startTime = hrtime()\n\n    //Unpause shell\n    shell.paused = false\n    \n    //Emit initialize event\n    shell.emit(\"init\")\n  })}, 0)\n  \n  return shell\n}\n\nmodule.exports = createShell\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nvar getOwnPropertyDescriptors = Object.getOwnPropertyDescriptors ||\n  function getOwnPropertyDescriptors(obj) {\n    var keys = Object.keys(obj);\n    var descriptors = {};\n    for (var i = 0; i < keys.length; i++) {\n      descriptors[keys[i]] = Object.getOwnPropertyDescriptor(obj, keys[i]);\n    }\n    return descriptors;\n  };\n\nvar formatRegExp = /%[sdj%]/g;\nexports.format = function(f) {\n  if (!isString(f)) {\n    var objects = [];\n    for (var i = 0; i < arguments.length; i++) {\n      objects.push(inspect(arguments[i]));\n    }\n    return objects.join(' ');\n  }\n\n  var i = 1;\n  var args = arguments;\n  var len = args.length;\n  var str = String(f).replace(formatRegExp, function(x) {\n    if (x === '%%') return '%';\n    if (i >= len) return x;\n    switch (x) {\n      case '%s': return String(args[i++]);\n      case '%d': return Number(args[i++]);\n      case '%j':\n        try {\n          return JSON.stringify(args[i++]);\n        } catch (_) {\n          return '[Circular]';\n        }\n      default:\n        return x;\n    }\n  });\n  for (var x = args[i]; i < len; x = args[++i]) {\n    if (isNull(x) || !isObject(x)) {\n      str += ' ' + x;\n    } else {\n      str += ' ' + inspect(x);\n    }\n  }\n  return str;\n};\n\n\n// Mark that a method should not be used.\n// Returns a modified function which warns once by default.\n// If --no-deprecation is set, then it is a no-op.\nexports.deprecate = function(fn, msg) {\n  if (typeof process !== 'undefined' && process.noDeprecation === true) {\n    return fn;\n  }\n\n  // Allow for deprecating things in the process of starting up.\n  if (typeof process === 'undefined') {\n    return function() {\n      return exports.deprecate(fn, msg).apply(this, arguments);\n    };\n  }\n\n  var warned = false;\n  function deprecated() {\n    if (!warned) {\n      if (process.throwDeprecation) {\n        throw new Error(msg);\n      } else if (process.traceDeprecation) {\n        console.trace(msg);\n      } else {\n        console.error(msg);\n      }\n      warned = true;\n    }\n    return fn.apply(this, arguments);\n  }\n\n  return deprecated;\n};\n\n\nvar debugs = {};\nvar debugEnviron;\nexports.debuglog = function(set) {\n  if (isUndefined(debugEnviron))\n    debugEnviron = process.env.NODE_DEBUG || '';\n  set = set.toUpperCase();\n  if (!debugs[set]) {\n    if (new RegExp('\\\\b' + set + '\\\\b', 'i').test(debugEnviron)) {\n      var pid = process.pid;\n      debugs[set] = function() {\n        var msg = exports.format.apply(exports, arguments);\n        console.error('%s %d: %s', set, pid, msg);\n      };\n    } else {\n      debugs[set] = function() {};\n    }\n  }\n  return debugs[set];\n};\n\n\n/**\n * Echos the value of a value. Trys to print the value out\n * in the best way possible given the different types.\n *\n * @param {Object} obj The object to print out.\n * @param {Object} opts Optional options object that alters the output.\n */\n/* legacy: obj, showHidden, depth, colors*/\nfunction inspect(obj, opts) {\n  // default options\n  var ctx = {\n    seen: [],\n    stylize: stylizeNoColor\n  };\n  // legacy...\n  if (arguments.length >= 3) ctx.depth = arguments[2];\n  if (arguments.length >= 4) ctx.colors = arguments[3];\n  if (isBoolean(opts)) {\n    // legacy...\n    ctx.showHidden = opts;\n  } else if (opts) {\n    // got an \"options\" object\n    exports._extend(ctx, opts);\n  }\n  // set default options\n  if (isUndefined(ctx.showHidden)) ctx.showHidden = false;\n  if (isUndefined(ctx.depth)) ctx.depth = 2;\n  if (isUndefined(ctx.colors)) ctx.colors = false;\n  if (isUndefined(ctx.customInspect)) ctx.customInspect = true;\n  if (ctx.colors) ctx.stylize = stylizeWithColor;\n  return formatValue(ctx, obj, ctx.depth);\n}\nexports.inspect = inspect;\n\n\n// http://en.wikipedia.org/wiki/ANSI_escape_code#graphics\ninspect.colors = {\n  'bold' : [1, 22],\n  'italic' : [3, 23],\n  'underline' : [4, 24],\n  'inverse' : [7, 27],\n  'white' : [37, 39],\n  'grey' : [90, 39],\n  'black' : [30, 39],\n  'blue' : [34, 39],\n  'cyan' : [36, 39],\n  'green' : [32, 39],\n  'magenta' : [35, 39],\n  'red' : [31, 39],\n  'yellow' : [33, 39]\n};\n\n// Don't use 'blue' not visible on cmd.exe\ninspect.styles = {\n  'special': 'cyan',\n  'number': 'yellow',\n  'boolean': 'yellow',\n  'undefined': 'grey',\n  'null': 'bold',\n  'string': 'green',\n  'date': 'magenta',\n  // \"name\": intentionally not styling\n  'regexp': 'red'\n};\n\n\nfunction stylizeWithColor(str, styleType) {\n  var style = inspect.styles[styleType];\n\n  if (style) {\n    return '\\u001b[' + inspect.colors[style][0] + 'm' + str +\n           '\\u001b[' + inspect.colors[style][1] + 'm';\n  } else {\n    return str;\n  }\n}\n\n\nfunction stylizeNoColor(str, styleType) {\n  return str;\n}\n\n\nfunction arrayToHash(array) {\n  var hash = {};\n\n  array.forEach(function(val, idx) {\n    hash[val] = true;\n  });\n\n  return hash;\n}\n\n\nfunction formatValue(ctx, value, recurseTimes) {\n  // Provide a hook for user-specified inspect functions.\n  // Check that value is an object with an inspect function on it\n  if (ctx.customInspect &&\n      value &&\n      isFunction(value.inspect) &&\n      // Filter out the util module, it's inspect function is special\n      value.inspect !== exports.inspect &&\n      // Also filter out any prototype objects using the circular check.\n      !(value.constructor && value.constructor.prototype === value)) {\n    var ret = value.inspect(recurseTimes, ctx);\n    if (!isString(ret)) {\n      ret = formatValue(ctx, ret, recurseTimes);\n    }\n    return ret;\n  }\n\n  // Primitive types cannot have properties\n  var primitive = formatPrimitive(ctx, value);\n  if (primitive) {\n    return primitive;\n  }\n\n  // Look up the keys of the object.\n  var keys = Object.keys(value);\n  var visibleKeys = arrayToHash(keys);\n\n  if (ctx.showHidden) {\n    keys = Object.getOwnPropertyNames(value);\n  }\n\n  // IE doesn't make error fields non-enumerable\n  // http://msdn.microsoft.com/en-us/library/ie/dww52sbt(v=vs.94).aspx\n  if (isError(value)\n      && (keys.indexOf('message') >= 0 || keys.indexOf('description') >= 0)) {\n    return formatError(value);\n  }\n\n  // Some type of object without properties can be shortcutted.\n  if (keys.length === 0) {\n    if (isFunction(value)) {\n      var name = value.name ? ': ' + value.name : '';\n      return ctx.stylize('[Function' + name + ']', 'special');\n    }\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    }\n    if (isDate(value)) {\n      return ctx.stylize(Date.prototype.toString.call(value), 'date');\n    }\n    if (isError(value)) {\n      return formatError(value);\n    }\n  }\n\n  var base = '', array = false, braces = ['{', '}'];\n\n  // Make Array say that they are Array\n  if (isArray(value)) {\n    array = true;\n    braces = ['[', ']'];\n  }\n\n  // Make functions say that they are functions\n  if (isFunction(value)) {\n    var n = value.name ? ': ' + value.name : '';\n    base = ' [Function' + n + ']';\n  }\n\n  // Make RegExps say that they are RegExps\n  if (isRegExp(value)) {\n    base = ' ' + RegExp.prototype.toString.call(value);\n  }\n\n  // Make dates with properties first say the date\n  if (isDate(value)) {\n    base = ' ' + Date.prototype.toUTCString.call(value);\n  }\n\n  // Make error with message first say the error\n  if (isError(value)) {\n    base = ' ' + formatError(value);\n  }\n\n  if (keys.length === 0 && (!array || value.length == 0)) {\n    return braces[0] + base + braces[1];\n  }\n\n  if (recurseTimes < 0) {\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    } else {\n      return ctx.stylize('[Object]', 'special');\n    }\n  }\n\n  ctx.seen.push(value);\n\n  var output;\n  if (array) {\n    output = formatArray(ctx, value, recurseTimes, visibleKeys, keys);\n  } else {\n    output = keys.map(function(key) {\n      return formatProperty(ctx, value, recurseTimes, visibleKeys, key, array);\n    });\n  }\n\n  ctx.seen.pop();\n\n  return reduceToSingleString(output, base, braces);\n}\n\n\nfunction formatPrimitive(ctx, value) {\n  if (isUndefined(value))\n    return ctx.stylize('undefined', 'undefined');\n  if (isString(value)) {\n    var simple = '\\'' + JSON.stringify(value).replace(/^\"|\"$/g, '')\n                                             .replace(/'/g, \"\\\\'\")\n                                             .replace(/\\\\\"/g, '\"') + '\\'';\n    return ctx.stylize(simple, 'string');\n  }\n  if (isNumber(value))\n    return ctx.stylize('' + value, 'number');\n  if (isBoolean(value))\n    return ctx.stylize('' + value, 'boolean');\n  // For some reason typeof null is \"object\", so special case here.\n  if (isNull(value))\n    return ctx.stylize('null', 'null');\n}\n\n\nfunction formatError(value) {\n  return '[' + Error.prototype.toString.call(value) + ']';\n}\n\n\nfunction formatArray(ctx, value, recurseTimes, visibleKeys, keys) {\n  var output = [];\n  for (var i = 0, l = value.length; i < l; ++i) {\n    if (hasOwnProperty(value, String(i))) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          String(i), true));\n    } else {\n      output.push('');\n    }\n  }\n  keys.forEach(function(key) {\n    if (!key.match(/^\\d+$/)) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          key, true));\n    }\n  });\n  return output;\n}\n\n\nfunction formatProperty(ctx, value, recurseTimes, visibleKeys, key, array) {\n  var name, str, desc;\n  desc = Object.getOwnPropertyDescriptor(value, key) || { value: value[key] };\n  if (desc.get) {\n    if (desc.set) {\n      str = ctx.stylize('[Getter/Setter]', 'special');\n    } else {\n      str = ctx.stylize('[Getter]', 'special');\n    }\n  } else {\n    if (desc.set) {\n      str = ctx.stylize('[Setter]', 'special');\n    }\n  }\n  if (!hasOwnProperty(visibleKeys, key)) {\n    name = '[' + key + ']';\n  }\n  if (!str) {\n    if (ctx.seen.indexOf(desc.value) < 0) {\n      if (isNull(recurseTimes)) {\n        str = formatValue(ctx, desc.value, null);\n      } else {\n        str = formatValue(ctx, desc.value, recurseTimes - 1);\n      }\n      if (str.indexOf('\\n') > -1) {\n        if (array) {\n          str = str.split('\\n').map(function(line) {\n            return '  ' + line;\n          }).join('\\n').substr(2);\n        } else {\n          str = '\\n' + str.split('\\n').map(function(line) {\n            return '   ' + line;\n          }).join('\\n');\n        }\n      }\n    } else {\n      str = ctx.stylize('[Circular]', 'special');\n    }\n  }\n  if (isUndefined(name)) {\n    if (array && key.match(/^\\d+$/)) {\n      return str;\n    }\n    name = JSON.stringify('' + key);\n    if (name.match(/^\"([a-zA-Z_][a-zA-Z_0-9]*)\"$/)) {\n      name = name.substr(1, name.length - 2);\n      name = ctx.stylize(name, 'name');\n    } else {\n      name = name.replace(/'/g, \"\\\\'\")\n                 .replace(/\\\\\"/g, '\"')\n                 .replace(/(^\"|\"$)/g, \"'\");\n      name = ctx.stylize(name, 'string');\n    }\n  }\n\n  return name + ': ' + str;\n}\n\n\nfunction reduceToSingleString(output, base, braces) {\n  var numLinesEst = 0;\n  var length = output.reduce(function(prev, cur) {\n    numLinesEst++;\n    if (cur.indexOf('\\n') >= 0) numLinesEst++;\n    return prev + cur.replace(/\\u001b\\[\\d\\d?m/g, '').length + 1;\n  }, 0);\n\n  if (length > 60) {\n    return braces[0] +\n           (base === '' ? '' : base + '\\n ') +\n           ' ' +\n           output.join(',\\n  ') +\n           ' ' +\n           braces[1];\n  }\n\n  return braces[0] + base + ' ' + output.join(', ') + ' ' + braces[1];\n}\n\n\n// NOTE: These type checking functions intentionally don't use `instanceof`\n// because it is fragile and can be easily faked with `Object.create()`.\nfunction isArray(ar) {\n  return Array.isArray(ar);\n}\nexports.isArray = isArray;\n\nfunction isBoolean(arg) {\n  return typeof arg === 'boolean';\n}\nexports.isBoolean = isBoolean;\n\nfunction isNull(arg) {\n  return arg === null;\n}\nexports.isNull = isNull;\n\nfunction isNullOrUndefined(arg) {\n  return arg == null;\n}\nexports.isNullOrUndefined = isNullOrUndefined;\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\nexports.isNumber = isNumber;\n\nfunction isString(arg) {\n  return typeof arg === 'string';\n}\nexports.isString = isString;\n\nfunction isSymbol(arg) {\n  return typeof arg === 'symbol';\n}\nexports.isSymbol = isSymbol;\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\nexports.isUndefined = isUndefined;\n\nfunction isRegExp(re) {\n  return isObject(re) && objectToString(re) === '[object RegExp]';\n}\nexports.isRegExp = isRegExp;\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\nexports.isObject = isObject;\n\nfunction isDate(d) {\n  return isObject(d) && objectToString(d) === '[object Date]';\n}\nexports.isDate = isDate;\n\nfunction isError(e) {\n  return isObject(e) &&\n      (objectToString(e) === '[object Error]' || e instanceof Error);\n}\nexports.isError = isError;\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\nexports.isFunction = isFunction;\n\nfunction isPrimitive(arg) {\n  return arg === null ||\n         typeof arg === 'boolean' ||\n         typeof arg === 'number' ||\n         typeof arg === 'string' ||\n         typeof arg === 'symbol' ||  // ES6 symbol\n         typeof arg === 'undefined';\n}\nexports.isPrimitive = isPrimitive;\n\nexports.isBuffer = require('./support/isBuffer');\n\nfunction objectToString(o) {\n  return Object.prototype.toString.call(o);\n}\n\n\nfunction pad(n) {\n  return n < 10 ? '0' + n.toString(10) : n.toString(10);\n}\n\n\nvar months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep',\n              'Oct', 'Nov', 'Dec'];\n\n// 26 Feb 16:19:34\nfunction timestamp() {\n  var d = new Date();\n  var time = [pad(d.getHours()),\n              pad(d.getMinutes()),\n              pad(d.getSeconds())].join(':');\n  return [d.getDate(), months[d.getMonth()], time].join(' ');\n}\n\n\n// log is just a thin wrapper to console.log that prepends a timestamp\nexports.log = function() {\n  console.log('%s - %s', timestamp(), exports.format.apply(exports, arguments));\n};\n\n\n/**\n * Inherit the prototype methods from one constructor into another.\n *\n * The Function.prototype.inherits from lang.js rewritten as a standalone\n * function (not on Function.prototype). NOTE: If this file is to be loaded\n * during bootstrapping this function needs to be rewritten using some native\n * functions as prototype setup using normal JavaScript does not work as\n * expected during bootstrapping (see mirror.js in r114903).\n *\n * @param {function} ctor Constructor function which needs to inherit the\n *     prototype.\n * @param {function} superCtor Constructor function to inherit prototype from.\n */\nexports.inherits = require('inherits');\n\nexports._extend = function(origin, add) {\n  // Don't do anything if add isn't an object\n  if (!add || !isObject(add)) return origin;\n\n  var keys = Object.keys(add);\n  var i = keys.length;\n  while (i--) {\n    origin[keys[i]] = add[keys[i]];\n  }\n  return origin;\n};\n\nfunction hasOwnProperty(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\nvar kCustomPromisifiedSymbol = typeof Symbol !== 'undefined' ? Symbol('util.promisify.custom') : undefined;\n\nexports.promisify = function promisify(original) {\n  if (typeof original !== 'function')\n    throw new TypeError('The \"original\" argument must be of type Function');\n\n  if (kCustomPromisifiedSymbol && original[kCustomPromisifiedSymbol]) {\n    var fn = original[kCustomPromisifiedSymbol];\n    if (typeof fn !== 'function') {\n      throw new TypeError('The \"util.promisify.custom\" argument must be of type Function');\n    }\n    Object.defineProperty(fn, kCustomPromisifiedSymbol, {\n      value: fn, enumerable: false, writable: false, configurable: true\n    });\n    return fn;\n  }\n\n  function fn() {\n    var promiseResolve, promiseReject;\n    var promise = new Promise(function (resolve, reject) {\n      promiseResolve = resolve;\n      promiseReject = reject;\n    });\n\n    var args = [];\n    for (var i = 0; i < arguments.length; i++) {\n      args.push(arguments[i]);\n    }\n    args.push(function (err, value) {\n      if (err) {\n        promiseReject(err);\n      } else {\n        promiseResolve(value);\n      }\n    });\n\n    try {\n      original.apply(this, args);\n    } catch (err) {\n      promiseReject(err);\n    }\n\n    return promise;\n  }\n\n  Object.setPrototypeOf(fn, Object.getPrototypeOf(original));\n\n  if (kCustomPromisifiedSymbol) Object.defineProperty(fn, kCustomPromisifiedSymbol, {\n    value: fn, enumerable: false, writable: false, configurable: true\n  });\n  return Object.defineProperties(\n    fn,\n    getOwnPropertyDescriptors(original)\n  );\n}\n\nexports.promisify.custom = kCustomPromisifiedSymbol\n\nfunction callbackifyOnRejected(reason, cb) {\n  // `!reason` guard inspired by bluebird (Ref: https://goo.gl/t5IS6M).\n  // Because `null` is a special error value in callbacks which means \"no error\n  // occurred\", we error-wrap so the callback consumer can distinguish between\n  // \"the promise rejected with null\" or \"the promise fulfilled with undefined\".\n  if (!reason) {\n    var newReason = new Error('Promise was rejected with a falsy value');\n    newReason.reason = reason;\n    reason = newReason;\n  }\n  return cb(reason);\n}\n\nfunction callbackify(original) {\n  if (typeof original !== 'function') {\n    throw new TypeError('The \"original\" argument must be of type Function');\n  }\n\n  // We DO NOT return the promise as it gives the user a false sense that\n  // the promise is actually somehow related to the callback's execution\n  // and that the callback throwing will reject the promise.\n  function callbackified() {\n    var args = [];\n    for (var i = 0; i < arguments.length; i++) {\n      args.push(arguments[i]);\n    }\n\n    var maybeCb = args.pop();\n    if (typeof maybeCb !== 'function') {\n      throw new TypeError('The last argument must be of type Function');\n    }\n    var self = this;\n    var cb = function() {\n      return maybeCb.apply(self, arguments);\n    };\n    // In true node style we process the callback on `nextTick` with all the\n    // implications (stack, `uncaughtException`, `async_hooks`)\n    original.apply(this, args)\n      .then(function(ret) { process.nextTick(cb, null, ret) },\n            function(rej) { process.nextTick(callbackifyOnRejected, rej, cb) });\n  }\n\n  Object.setPrototypeOf(callbackified, Object.getPrototypeOf(original));\n  Object.defineProperties(callbackified,\n                          getOwnPropertyDescriptors(original));\n  return callbackified;\n}\nexports.callbackify = callbackify;\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","module.exports = function isBuffer(arg) {\n  return arg && typeof arg === 'object'\n    && typeof arg.copy === 'function'\n    && typeof arg.fill === 'function'\n    && typeof arg.readUInt8 === 'function';\n}","if (typeof Object.create === 'function') {\n  // implementation from standard node.js 'util' module\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    ctor.prototype = Object.create(superCtor.prototype, {\n      constructor: {\n        value: ctor,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n  };\n} else {\n  // old school shim for old browsers\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    var TempCtor = function () {}\n    TempCtor.prototype = superCtor.prototype\n    ctor.prototype = new TempCtor()\n    ctor.prototype.constructor = ctor\n  }\n}\n","/*!\n  * domready (c) Dustin Diaz 2014 - License MIT\n  */\n!function (name, definition) {\n\n  if (typeof module != 'undefined') module.exports = definition()\n  else if (typeof define == 'function' && typeof define.amd == 'object') define(definition)\n  else this[name] = definition()\n\n}('domready', function () {\n\n  var fns = [], listener\n    , doc = document\n    , hack = doc.documentElement.doScroll\n    , domContentLoaded = 'DOMContentLoaded'\n    , loaded = (hack ? /^loaded|^c/ : /^loaded|^i|^c/).test(doc.readyState)\n\n\n  if (!loaded)\n  doc.addEventListener(domContentLoaded, listener = function () {\n    doc.removeEventListener(domContentLoaded, listener)\n    loaded = 1\n    while (listener = fns.shift()) listener()\n  })\n\n  return function (fn) {\n    loaded ? setTimeout(fn, 0) : fns.push(fn)\n  }\n\n});\n","var ua = typeof window !== 'undefined' ? window.navigator.userAgent : ''\n  , isOSX = /OS X/.test(ua)\n  , isOpera = /Opera/.test(ua)\n  , maybeFirefox = !/like Gecko/.test(ua) && !isOpera\n\nvar i, output = module.exports = {\n  0:  isOSX ? '<menu>' : '<UNK>'\n, 1:  '<mouse 1>'\n, 2:  '<mouse 2>'\n, 3:  '<break>'\n, 4:  '<mouse 3>'\n, 5:  '<mouse 4>'\n, 6:  '<mouse 5>'\n, 8:  '<backspace>'\n, 9:  '<tab>'\n, 12: '<clear>'\n, 13: '<enter>'\n, 16: '<shift>'\n, 17: '<control>'\n, 18: '<alt>'\n, 19: '<pause>'\n, 20: '<caps-lock>'\n, 21: '<ime-hangul>'\n, 23: '<ime-junja>'\n, 24: '<ime-final>'\n, 25: '<ime-kanji>'\n, 27: '<escape>'\n, 28: '<ime-convert>'\n, 29: '<ime-nonconvert>'\n, 30: '<ime-accept>'\n, 31: '<ime-mode-change>'\n, 27: '<escape>'\n, 32: '<space>'\n, 33: '<page-up>'\n, 34: '<page-down>'\n, 35: '<end>'\n, 36: '<home>'\n, 37: '<left>'\n, 38: '<up>'\n, 39: '<right>'\n, 40: '<down>'\n, 41: '<select>'\n, 42: '<print>'\n, 43: '<execute>'\n, 44: '<snapshot>'\n, 45: '<insert>'\n, 46: '<delete>'\n, 47: '<help>'\n, 91: '<meta>'  // meta-left -- no one handles left and right properly, so we coerce into one.\n, 92: '<meta>'  // meta-right\n, 93: isOSX ? '<meta>' : '<menu>'      // chrome,opera,safari all report this for meta-right (osx mbp).\n, 95: '<sleep>'\n, 106: '<num-*>'\n, 107: '<num-+>'\n, 108: '<num-enter>'\n, 109: '<num-->'\n, 110: '<num-.>'\n, 111: '<num-/>'\n, 144: '<num-lock>'\n, 145: '<scroll-lock>'\n, 160: '<shift-left>'\n, 161: '<shift-right>'\n, 162: '<control-left>'\n, 163: '<control-right>'\n, 164: '<alt-left>'\n, 165: '<alt-right>'\n, 166: '<browser-back>'\n, 167: '<browser-forward>'\n, 168: '<browser-refresh>'\n, 169: '<browser-stop>'\n, 170: '<browser-search>'\n, 171: '<browser-favorites>'\n, 172: '<browser-home>'\n\n  // ff/osx reports '<volume-mute>' for '-'\n, 173: isOSX && maybeFirefox ? '-' : '<volume-mute>'\n, 174: '<volume-down>'\n, 175: '<volume-up>'\n, 176: '<next-track>'\n, 177: '<prev-track>'\n, 178: '<stop>'\n, 179: '<play-pause>'\n, 180: '<launch-mail>'\n, 181: '<launch-media-select>'\n, 182: '<launch-app 1>'\n, 183: '<launch-app 2>'\n, 186: ';'\n, 187: '='\n, 188: ','\n, 189: '-'\n, 190: '.'\n, 191: '/'\n, 192: '`'\n, 219: '['\n, 220: '\\\\'\n, 221: ']'\n, 222: \"'\"\n, 223: '<meta>'\n, 224: '<meta>'       // firefox reports meta here.\n, 226: '<alt-gr>'\n, 229: '<ime-process>'\n, 231: isOpera ? '`' : '<unicode>'\n, 246: '<attention>'\n, 247: '<crsel>'\n, 248: '<exsel>'\n, 249: '<erase-eof>'\n, 250: '<play>'\n, 251: '<zoom>'\n, 252: '<no-name>'\n, 253: '<pa-1>'\n, 254: '<clear>'\n}\n\nfor(i = 58; i < 65; ++i) {\n  output[i] = String.fromCharCode(i)\n}\n\n// 0-9\nfor(i = 48; i < 58; ++i) {\n  output[i] = (i - 48)+''\n}\n\n// A-Z\nfor(i = 65; i < 91; ++i) {\n  output[i] = String.fromCharCode(i)\n}\n\n// num0-9\nfor(i = 96; i < 106; ++i) {\n  output[i] = '<num-'+(i - 96)+'>'\n}\n\n// F1-F24\nfor(i = 112; i < 136; ++i) {\n  output[i] = 'F'+(i-111)\n}\n","\"use strict\"\n\nfunction invert(hash) {\n  var result = {}\n  for(var i in hash) {\n    if(hash.hasOwnProperty(i)) {\n      result[hash[i]] = i\n    }\n  }\n  return result\n}\n\nmodule.exports = invert","\"use strict\"\n\nfunction unique_pred(list, compare) {\n  var ptr = 1\n    , len = list.length\n    , a=list[0], b=list[0]\n  for(var i=1; i<len; ++i) {\n    b = a\n    a = list[i]\n    if(compare(a, b)) {\n      if(i === ptr) {\n        ptr++\n        continue\n      }\n      list[ptr++] = a\n    }\n  }\n  list.length = ptr\n  return list\n}\n\nfunction unique_eq(list) {\n  var ptr = 1\n    , len = list.length\n    , a=list[0], b = list[0]\n  for(var i=1; i<len; ++i, b=a) {\n    b = a\n    a = list[i]\n    if(a !== b) {\n      if(i === ptr) {\n        ptr++\n        continue\n      }\n      list[ptr++] = a\n    }\n  }\n  list.length = ptr\n  return list\n}\n\nfunction unique(list, compare, sorted) {\n  if(list.length === 0) {\n    return list\n  }\n  if(compare) {\n    if(!sorted) {\n      list.sort(compare)\n    }\n    return unique_pred(list, compare)\n  }\n  if(!sorted) {\n    list.sort()\n  }\n  return unique_eq(list)\n}\n\nmodule.exports = unique\n","\"use strict\"\n\nfunction compileSearch(funcName, predicate, reversed, extraArgs, useNdarray, earlyOut) {\n  var code = [\n    \"function \", funcName, \"(a,l,h,\", extraArgs.join(\",\"),  \"){\",\nearlyOut ? \"\" : \"var i=\", (reversed ? \"l-1\" : \"h+1\"),\n\";while(l<=h){\\\nvar m=(l+h)>>>1,x=a\", useNdarray ? \".get(m)\" : \"[m]\"]\n  if(earlyOut) {\n    if(predicate.indexOf(\"c\") < 0) {\n      code.push(\";if(x===y){return m}else if(x<=y){\")\n    } else {\n      code.push(\";var p=c(x,y);if(p===0){return m}else if(p<=0){\")\n    }\n  } else {\n    code.push(\";if(\", predicate, \"){i=m;\")\n  }\n  if(reversed) {\n    code.push(\"l=m+1}else{h=m-1}\")\n  } else {\n    code.push(\"h=m-1}else{l=m+1}\")\n  }\n  code.push(\"}\")\n  if(earlyOut) {\n    code.push(\"return -1};\")\n  } else {\n    code.push(\"return i};\")\n  }\n  return code.join(\"\")\n}\n\nfunction compileBoundsSearch(predicate, reversed, suffix, earlyOut) {\n  var result = new Function([\n  compileSearch(\"A\", \"x\" + predicate + \"y\", reversed, [\"y\"], false, earlyOut),\n  compileSearch(\"B\", \"x\" + predicate + \"y\", reversed, [\"y\"], true, earlyOut),\n  compileSearch(\"P\", \"c(x,y)\" + predicate + \"0\", reversed, [\"y\", \"c\"], false, earlyOut),\n  compileSearch(\"Q\", \"c(x,y)\" + predicate + \"0\", reversed, [\"y\", \"c\"], true, earlyOut),\n\"function dispatchBsearch\", suffix, \"(a,y,c,l,h){\\\nif(a.shape){\\\nif(typeof(c)==='function'){\\\nreturn Q(a,(l===undefined)?0:l|0,(h===undefined)?a.shape[0]-1:h|0,y,c)\\\n}else{\\\nreturn B(a,(c===undefined)?0:c|0,(l===undefined)?a.shape[0]-1:l|0,y)\\\n}}else{\\\nif(typeof(c)==='function'){\\\nreturn P(a,(l===undefined)?0:l|0,(h===undefined)?a.length-1:h|0,y,c)\\\n}else{\\\nreturn A(a,(c===undefined)?0:c|0,(l===undefined)?a.length-1:l|0,y)\\\n}}}\\\nreturn dispatchBsearch\", suffix].join(\"\"))\n  return result()\n}\n\nmodule.exports = {\n  ge: compileBoundsSearch(\">=\", false, \"GE\"),\n  gt: compileBoundsSearch(\">\", false, \"GT\"),\n  lt: compileBoundsSearch(\"<\", true, \"LT\"),\n  le: compileBoundsSearch(\"<=\", true, \"LE\"),\n  eq: compileBoundsSearch(\"-\", true, \"EQ\", true)\n}\n","// http://paulirish.com/2011/requestanimationframe-for-smart-animating/\n// http://my.opera.com/emoller/blog/2011/12/20/requestanimationframe-for-smart-er-animating\n \n// requestAnimationFrame polyfill by Erik Möller. fixes from Paul Irish and Tino Zijdel\n \n// MIT license\nvar lastTime = 0;\nvar vendors = ['ms', 'moz', 'webkit', 'o'];\nfor(var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {\n    window.requestAnimationFrame = window[vendors[x]+'RequestAnimationFrame'];\n    window.cancelAnimationFrame = window[vendors[x]+'CancelAnimationFrame'] \n                               || window[vendors[x]+'CancelRequestAnimationFrame'];\n}\n\nif (!window.requestAnimationFrame)\n    window.requestAnimationFrame = function(callback, element) {\n        var currTime = new Date().getTime();\n        var timeToCall = Math.max(0, 16 - (currTime - lastTime));\n        var id = window.setTimeout(function() { callback(currTime + timeToCall); }, \n          timeToCall);\n        lastTime = currTime + timeToCall;\n        return id;\n    };\n\nif (!window.cancelAnimationFrame)\n    window.cancelAnimationFrame = function(id) {\n        clearTimeout(id);\n    };\n","//Adapted from here: https://developer.mozilla.org/en-US/docs/Web/Reference/Events/wheel?redirectlocale=en-US&redirectslug=DOM%2FMozilla_event_reference%2Fwheel\n\nvar prefix = \"\", _addEventListener, onwheel, support;\n\n// detect event model\nif ( window.addEventListener ) {\n  _addEventListener = \"addEventListener\";\n} else {\n  _addEventListener = \"attachEvent\";\n  prefix = \"on\";\n}\n\n// detect available wheel event\nsupport = \"onwheel\" in document.createElement(\"div\") ? \"wheel\" : // Modern browsers support \"wheel\"\n          document.onmousewheel !== undefined ? \"mousewheel\" : // Webkit and IE support at least \"mousewheel\"\n          \"DOMMouseScroll\"; // let's assume that remaining browsers are older Firefox\n\nfunction _addWheelListener( elem, eventName, callback, useCapture ) {\n  elem[ _addEventListener ]( prefix + eventName, support == \"wheel\" ? callback : function( originalEvent ) {\n    !originalEvent && ( originalEvent = window.event );\n\n    // create a normalized event object\n    var event = {\n      // keep a ref to the original event object\n      originalEvent: originalEvent,\n      target: originalEvent.target || originalEvent.srcElement,\n      type: \"wheel\",\n      deltaMode: originalEvent.type == \"MozMousePixelScroll\" ? 0 : 1,\n      deltaX: 0,\n      delatZ: 0,\n      preventDefault: function() {\n        originalEvent.preventDefault ?\n          originalEvent.preventDefault() :\n          originalEvent.returnValue = false;\n      }\n    };\n    \n    // calculate deltaY (and deltaX) according to the event\n    if ( support == \"mousewheel\" ) {\n      event.deltaY = - 1/40 * originalEvent.wheelDelta;\n      // Webkit also support wheelDeltaX\n      originalEvent.wheelDeltaX && ( event.deltaX = - 1/40 * originalEvent.wheelDeltaX );\n    } else {\n      event.deltaY = originalEvent.detail;\n    }\n\n    // it's time to fire the callback\n    return callback( event );\n  }, useCapture || false );\n}\n\nmodule.exports = function( elem, callback, useCapture ) {\n  _addWheelListener( elem, support, callback, useCapture );\n\n  // handle MozMousePixelScroll in older Firefox\n  if( support == \"DOMMouseScroll\" ) {\n    _addWheelListener( elem, \"MozMousePixelScroll\", callback, useCapture );\n  }\n};","if(typeof window.performance === \"object\") {\n  if(window.performance.now) {\n    module.exports = function() { return window.performance.now() }\n  } else if(window.performance.webkitNow) {\n    module.exports = function() { return window.performance.webkitNow() }\n  }\n} else if(Date.now) {\n  module.exports = Date.now\n} else {\n  module.exports = function() { return (new Date()).getTime() }\n}\n","\nvar vkey = require('vkey')\nvar EventEmitter = require('events').EventEmitter\n// mousewheel polyfill borrowed directly from game-shell\nvar addMouseWheel = require(\"./lib/mousewheel-polyfill.js\")\n\nmodule.exports = function (domElement, options) {\n    return new Inputs(domElement, options)\n}\n\n\n/*\n *   Simple inputs manager to abstract key/mouse inputs.\n *        Inspired by (and where applicable stealing code from) \n *        game-shell: https://github.com/mikolalysenko/game-shell\n *  \n *  inputs.bind( 'move-right', 'D', '<right>' )\n *  inputs.bind( 'move-left',  'A' )\n *  inputs.unbind( 'move-left' )\n *  \n *  inputs.down.on( 'move-right',  function( binding, event ) {})\n *  inputs.up.on(   'move-right',  function( binding, event ) {})\n *\n *  inputs.state['move-right']  // true when corresponding keys are down\n *  inputs.state.dx             // mouse x movement since tick() was last called\n *  inputs.getBindings()        // [ 'move-right', 'move-left', ... ]\n*/\n\n\nfunction Inputs(element, opts) {\n\n    // settings\n    this.element = element || document\n    opts = opts || {}\n    this.preventDefaults = !!opts.preventDefaults\n    this.stopPropagation = !!opts.stopPropagation\n    this.allowContextMenu = !!opts.allowContextMenu\n    this.disabled = !!opts.disabled\n\n    // emitters\n    this.down = new EventEmitter()\n    this.up = new EventEmitter()\n\n    // state object to be queried\n    this.state = {\n        dx: 0, dy: 0,\n        scrollx: 0, scrolly: 0, scrollz: 0\n    }\n\n    // internal state\n    this._keybindmap = {}       // { 'vkeycode' : [ 'binding', 'binding2' ] }\n    this._keyStates = {}        // { 'vkeycode' : boolean }\n    this._bindPressCounts = {}  // { 'binding' : int }\n\n    // needed to work around a bug in Mac Chrome 75\n    // https://bugs.chromium.org/p/chromium/issues/detail?id=977093\n    this._ignoreMousemoveOnce = false\n\n    // register for dom events\n    this.initEvents()\n}\n\n\n/*\n *\n *   PUBLIC API \n *\n*/\n\nInputs.prototype.initEvents = function () {\n    // keys\n    window.addEventListener('keydown', onKeyEvent.bind(undefined, this, true), false)\n    window.addEventListener('keyup', onKeyEvent.bind(undefined, this, false), false)\n    // mouse buttons\n    this.element.addEventListener(\"mousedown\", onMouseEvent.bind(undefined, this, true), false)\n    this.element.addEventListener(\"mouseup\", onMouseEvent.bind(undefined, this, false), false)\n    this.element.oncontextmenu = onContextMenu.bind(undefined, this)\n    // treat dragstart like mouseup - idiotically, mouseup doesn't fire after a drag starts (!)\n    this.element.addEventListener(\"dragstart\", onMouseEvent.bind(undefined, this, false), false)\n    // touch/mouse movement\n    this.element.addEventListener(\"mousemove\", onMouseMove.bind(undefined, this), false)\n    this.element.addEventListener(\"touchmove\", onMouseMove.bind(undefined, this), false)\n    this.element.addEventListener(\"touchstart\", onTouchStart.bind(undefined, this), false)\n    // scroll/mousewheel\n    addMouseWheel(this.element, onMouseWheel.bind(undefined, this), false)\n    // temp bug workaround, see above\n    document.addEventListener(\"pointerlockchange\", onLockChange.bind(undefined, this), false)\n    document.addEventListener(\"mozpointerlockchange\", onLockChange.bind(undefined, this), false)\n}\n\n\n// Usage:  bind( bindingName, vkeyCode, vkeyCode.. )\n//    Note that inputs._keybindmap maps vkey codes to binding names\n//    e.g. this._keybindmap['a'] = 'move-left'\nInputs.prototype.bind = function (binding) {\n    for (var i = 1; i < arguments.length; ++i) {\n        var vkeyCode = arguments[i]\n        var arr = this._keybindmap[vkeyCode] || []\n        if (arr.indexOf(binding) == -1) {\n            arr.push(binding)\n        }\n        this._keybindmap[vkeyCode] = arr\n    }\n    this.state[binding] = !!this.state[binding]\n}\n\n// search out and remove all keycodes bound to a given binding\nInputs.prototype.unbind = function (binding) {\n    for (var b in this._keybindmap) {\n        var arr = this._keybindmap[b]\n        var i = arr.indexOf(binding)\n        if (i > -1) { arr.splice(i, 1) }\n    }\n}\n\n// tick function - clears out cumulative mouse movement state variables\nInputs.prototype.tick = function () {\n    this.state.dx = this.state.dy = 0\n    this.state.scrollx = this.state.scrolly = this.state.scrollz = 0\n}\n\n\n\nInputs.prototype.getBoundKeys = function () {\n    var arr = []\n    for (var b in this._keybindmap) { arr.push(b) }\n    return arr\n}\n\n\n\n/*\n *\n *\n *      INTERNALS - DOM EVENT HANDLERS\n *\n *\n*/\n\n\nfunction onKeyEvent(inputs, wasDown, ev) {\n    handleKeyEvent(ev.keyCode, vkey[ev.keyCode], wasDown, inputs, ev)\n}\n\nfunction onMouseEvent(inputs, wasDown, ev) {\n    // simulate a code out of range of vkey\n    var keycode = -1 - ev.button\n    var vkeycode = '<mouse ' + (ev.button + 1) + '>'\n    handleKeyEvent(keycode, vkeycode, wasDown, inputs, ev)\n    return false\n}\n\nfunction onContextMenu(inputs) {\n    if (!inputs.allowContextMenu) return false\n}\n\nfunction onMouseMove(inputs, ev) {\n    // bug workaround, see top of file\n    if (inputs._ignoreMousemoveOnce) {\n        inputs._ignoreMousemoveOnce = false\n        return\n    }\n    // for now, just populate the state object with mouse movement\n    var dx = ev.movementX || ev.mozMovementX || 0,\n        dy = ev.movementY || ev.mozMovementY || 0\n    // ad-hoc experimental touch support\n    if (ev.touches && (dx | dy) === 0) {\n        var xy = getTouchMovement(ev)\n        dx = xy[0]\n        dy = xy[1]\n    }\n    inputs.state.dx += dx\n    inputs.state.dy += dy\n}\n\n// experimental - for touch events, extract useful dx/dy\nvar lastTouchX = 0\nvar lastTouchY = 0\nvar lastTouchID = null\n\nfunction onTouchStart(inputs, ev) {\n    var touch = ev.changedTouches[0]\n    lastTouchX = touch.clientX\n    lastTouchY = touch.clientY\n    lastTouchID = touch.identifier\n}\n\nfunction getTouchMovement(ev) {\n    var touch\n    var touches = ev.changedTouches\n    for (var i = 0; i < touches.length; ++i) {\n        if (touches[i].identifier == lastTouchID) touch = touches[i]\n    }\n    if (!touch) return [0, 0]\n    var res = [touch.clientX - lastTouchX, touch.clientY - lastTouchY]\n    lastTouchX = touch.clientX\n    lastTouchY = touch.clientY\n    return res\n}\n\nfunction onMouseWheel(inputs, ev) {\n    // basically borrowed from game-shell\n    var scale = 1\n    switch (ev.deltaMode) {\n        case 0: scale = 1; break  // Pixel\n        case 1: scale = 12; break  // Line\n        case 2:  // page\n            // TODO: investigate when this happens, what correct handling is\n            scale = inputs.element.clientHeight || window.innerHeight\n            break\n    }\n    // accumulate state\n    inputs.state.scrollx += ev.deltaX * scale\n    inputs.state.scrolly += ev.deltaY * scale\n    inputs.state.scrollz += (ev.deltaZ * scale) || 0\n    return false\n}\n\nfunction onLockChange(inputs, ev) {\n    var locked = document.pointerLockElement\n        || document.mozPointerLockElement\n        || null\n    if (locked) inputs._ignoreMousemoveOnce = true\n}\n\n\n\n\n/*\n *\n *\n *   KEY BIND HANDLING\n *\n *\n*/\n\n\nfunction handleKeyEvent(keycode, vcode, wasDown, inputs, ev) {\n    var arr = inputs._keybindmap[vcode]\n    // don't prevent defaults if there's no binding\n    if (!arr) { return }\n    if (inputs.preventDefaults) ev.preventDefault()\n    if (inputs.stopPropagation) ev.stopPropagation()\n\n    // if the key's state has changed, handle an event for all bindings\n    var currstate = inputs._keyStates[keycode]\n    if (XOR(currstate, wasDown)) {\n        // for each binding: emit an event, and update cached state information\n        for (var i = 0; i < arr.length; ++i) {\n            handleBindingEvent(arr[i], wasDown, inputs, ev)\n        }\n    }\n    inputs._keyStates[keycode] = wasDown\n}\n\n\nfunction handleBindingEvent(binding, wasDown, inputs, ev) {\n    // keep count of presses mapped by binding\n    // (to handle two keys with the same binding pressed at once)\n    var ct = inputs._bindPressCounts[binding] || 0\n    ct += wasDown ? 1 : -1\n    if (ct < 0) { ct = 0 } // shouldn't happen\n    inputs._bindPressCounts[binding] = ct\n\n    // emit event if binding's state has changed\n    var currstate = inputs.state[binding]\n    if (XOR(currstate, ct)) {\n        var emitter = wasDown ? inputs.down : inputs.up\n        if (!inputs.disabled) emitter.emit(binding, ev)\n    }\n    inputs.state[binding] = !!ct\n}\n\n\n\n\n/*\n *\n *\n *    HELPERS\n *\n *\n*/\n\n\n// how is this not part of Javascript?\nfunction XOR(a, b) {\n    return a ? !b : b\n}\n\n\n\n\n","'use strict'\n\nvar ua = typeof window !== 'undefined' ? window.navigator.userAgent : ''\n  , isOSX = /OS X/.test(ua)\n  , isOpera = /Opera/.test(ua)\n  , maybeFirefox = !/like Gecko/.test(ua) && !isOpera\n\nvar i, output = module.exports = {\n  0:  isOSX ? '<menu>' : '<UNK>'\n, 1:  '<mouse 1>'\n, 2:  '<mouse 2>'\n, 3:  '<break>'\n, 4:  '<mouse 3>'\n, 5:  '<mouse 4>'\n, 6:  '<mouse 5>'\n, 8:  '<backspace>'\n, 9:  '<tab>'\n, 12: '<clear>'\n, 13: '<enter>'\n, 16: '<shift>'\n, 17: '<control>'\n, 18: '<alt>'\n, 19: '<pause>'\n, 20: '<caps-lock>'\n, 21: '<ime-hangul>'\n, 23: '<ime-junja>'\n, 24: '<ime-final>'\n, 25: '<ime-kanji>'\n, 27: '<escape>'\n, 28: '<ime-convert>'\n, 29: '<ime-nonconvert>'\n, 30: '<ime-accept>'\n, 31: '<ime-mode-change>'\n, 32: '<space>'\n, 33: '<page-up>'\n, 34: '<page-down>'\n, 35: '<end>'\n, 36: '<home>'\n, 37: '<left>'\n, 38: '<up>'\n, 39: '<right>'\n, 40: '<down>'\n, 41: '<select>'\n, 42: '<print>'\n, 43: '<execute>'\n, 44: '<snapshot>'\n, 45: '<insert>'\n, 46: '<delete>'\n, 47: '<help>'\n, 91: '<meta>'  // meta-left -- no one handles left and right properly, so we coerce into one.\n, 92: '<meta>'  // meta-right\n, 93: isOSX ? '<meta>' : '<menu>'      // chrome,opera,safari all report this for meta-right (osx mbp).\n, 95: '<sleep>'\n, 106: '<num-*>'\n, 107: '<num-+>'\n, 108: '<num-enter>'\n, 109: '<num-->'\n, 110: '<num-.>'\n, 111: '<num-/>'\n, 144: '<num-lock>'\n, 145: '<scroll-lock>'\n, 160: '<shift-left>'\n, 161: '<shift-right>'\n, 162: '<control-left>'\n, 163: '<control-right>'\n, 164: '<alt-left>'\n, 165: '<alt-right>'\n, 166: '<browser-back>'\n, 167: '<browser-forward>'\n, 168: '<browser-refresh>'\n, 169: '<browser-stop>'\n, 170: '<browser-search>'\n, 171: '<browser-favorites>'\n, 172: '<browser-home>'\n\n  // ff/osx reports '<volume-mute>' for '-'\n, 173: isOSX && maybeFirefox ? '-' : '<volume-mute>'\n, 174: '<volume-down>'\n, 175: '<volume-up>'\n, 176: '<next-track>'\n, 177: '<prev-track>'\n, 178: '<stop>'\n, 179: '<play-pause>'\n, 180: '<launch-mail>'\n, 181: '<launch-media-select>'\n, 182: '<launch-app 1>'\n, 183: '<launch-app 2>'\n, 186: ';'\n, 187: '='\n, 188: ','\n, 189: '-'\n, 190: '.'\n, 191: '/'\n, 192: '`'\n, 219: '['\n, 220: '\\\\'\n, 221: ']'\n, 222: \"'\"\n, 223: '<meta>'\n, 224: '<meta>'       // firefox reports meta here.\n, 226: '<alt-gr>'\n, 229: '<ime-process>'\n, 231: isOpera ? '`' : '<unicode>'\n, 246: '<attention>'\n, 247: '<crsel>'\n, 248: '<exsel>'\n, 249: '<erase-eof>'\n, 250: '<play>'\n, 251: '<zoom>'\n, 252: '<no-name>'\n, 253: '<pa-1>'\n, 254: '<clear>'\n}\n\nfor(i = 58; i < 65; ++i) {\n  output[i] = String.fromCharCode(i)\n}\n\n// 0-9\nfor(i = 48; i < 58; ++i) {\n  output[i] = (i - 48)+''\n}\n\n// A-Z\nfor(i = 65; i < 91; ++i) {\n  output[i] = String.fromCharCode(i)\n}\n\n// num0-9\nfor(i = 96; i < 106; ++i) {\n  output[i] = '<num-'+(i - 96)+'>'\n}\n\n// F1-F24\nfor(i = 112; i < 136; ++i) {\n  output[i] = 'F'+(i-111)\n}\n","//Adapted from here: https://developer.mozilla.org/en-US/docs/Web/Reference/Events/wheel?redirectlocale=en-US&redirectslug=DOM%2FMozilla_event_reference%2Fwheel\n\nvar prefix = \"\", _addEventListener, onwheel, support;\n\n// detect event model\nif ( window.addEventListener ) {\n  _addEventListener = \"addEventListener\";\n} else {\n  _addEventListener = \"attachEvent\";\n  prefix = \"on\";\n}\n\n// detect available wheel event\nsupport = \"onwheel\" in document.createElement(\"div\") ? \"wheel\" : // Modern browsers support \"wheel\"\n          document.onmousewheel !== undefined ? \"mousewheel\" : // Webkit and IE support at least \"mousewheel\"\n          \"DOMMouseScroll\"; // let's assume that remaining browsers are older Firefox\n\nfunction _addWheelListener( elem, eventName, callback, useCapture ) {\n  elem[ _addEventListener ]( prefix + eventName, support == \"wheel\" ? callback : function( originalEvent ) {\n    !originalEvent && ( originalEvent = window.event );\n\n    // create a normalized event object\n    var event = {\n      // keep a ref to the original event object\n      originalEvent: originalEvent,\n      target: originalEvent.target || originalEvent.srcElement,\n      type: \"wheel\",\n      deltaMode: originalEvent.type == \"MozMousePixelScroll\" ? 0 : 1,\n      deltaX: 0,\n      delatZ: 0,\n      preventDefault: function() {\n        originalEvent.preventDefault ?\n          originalEvent.preventDefault() :\n          originalEvent.returnValue = false;\n      }\n    };\n    \n    // calculate deltaY (and deltaX) according to the event\n    if ( support == \"mousewheel\" ) {\n      event.deltaY = - 1/40 * originalEvent.wheelDelta;\n      // Webkit also support wheelDeltaX\n      originalEvent.wheelDeltaX && ( event.deltaX = - 1/40 * originalEvent.wheelDeltaX );\n    } else {\n      event.deltaY = originalEvent.detail;\n    }\n\n    // it's time to fire the callback\n    return callback( event );\n  }, useCapture || false );\n}\n\nmodule.exports = function( elem, callback, useCapture ) {\n  _addWheelListener( elem, support, callback, useCapture );\n\n  // handle MozMousePixelScroll in older Firefox\n  if( support == \"DOMMouseScroll\" ) {\n    _addWheelListener( elem, \"MozMousePixelScroll\", callback, useCapture );\n  }\n};","'use strict'\n\nvar aabb = require('aabb-3d')\nvar vec3 = require('gl-vec3')\nvar sweep = require('voxel-aabb-sweep')\nvar RigidBody = require('./rigidBody')\n\n\nvar DEBUG = 0\n\n\nmodule.exports = function (opts, testSolid, testFluid) {\n    return new Physics(opts, testSolid, testFluid)\n}\n\nvar defaults = {\n    gravity: [0, -10, 0],\n    minBounceImpulse: .5, // lowest collision impulse that bounces\n    airDrag: 0.1,\n    fluidDrag: 0.4,\n    fluidDensity: 2.0,\n}\n\n\n/* \n *    CONSTRUCTOR - represents a world of rigid bodies.\n * \n *  Takes testSolid(x,y,z) function to query block solidity\n *  Takes testFluid(x,y,z) function to query if a block is a fluid\n*/\nfunction Physics(opts, testSolid, testFluid) {\n    opts = Object.assign({}, defaults, opts)\n\n    this.gravity = opts.gravity\n    this.airDrag = opts.airDrag\n    this.fluidDensity = opts.fluidDensity\n    this.fluidDrag = opts.fluidDrag\n    this.minBounceImpulse = opts.minBounceImpulse\n    this.bodies = []\n\n    // collision function - TODO: abstract this into a setter?\n    this.testSolid = testSolid\n    this.testFluid = testFluid\n}\n\n\n/*\n *    ADDING AND REMOVING RIGID BODIES\n*/\n\nPhysics.prototype.addBody = function (_aabb, mass, friction,\n    restitution, gravMult, onCollide) {\n    _aabb = _aabb || new aabb([0, 0, 0], [1, 1, 1])\n    if (typeof mass == 'undefined') mass = 1\n    if (typeof friction == 'undefined') friction = 1\n    if (typeof restitution == 'undefined') restitution = 0\n    if (typeof gravMult == 'undefined') gravMult = 1\n    var b = new RigidBody(_aabb, mass, friction, restitution, gravMult, onCollide)\n    this.bodies.push(b)\n    return b\n}\n\nPhysics.prototype.removeBody = function (b) {\n    var i = this.bodies.indexOf(b)\n    if (i < 0) return undefined\n    this.bodies.splice(i, 1)\n    b.aabb = b.onCollide = null\n}\n\n\n\n\n/*\n *    PHYSICS AND COLLISIONS\n*/\n\nvar a = vec3.create()\nvar dv = vec3.create()\nvar dx = vec3.create()\nvar impacts = vec3.create()\nvar oldResting = vec3.create()\n\n\n/*\n *    TICK HANDLER\n*/\nPhysics.prototype.tick = function (dt) {\n    // convert dt to seconds\n    dt = dt / 1000\n    var noGravity = equals(0, vec3.squaredLength(this.gravity))\n\n    this.bodies.forEach(b => iterateBody(this, b, dt, noGravity))\n}\n\n\n\n/*\n *    PER-BODY MAIN PHYSICS ROUTINE\n*/\n\nfunction iterateBody(self, b, dt, noGravity) {\n    vec3.copy(oldResting, b.resting)\n\n    // treat bodies with <= mass as static\n    if (b.mass <= 0) {\n        vec3.set(b.velocity, 0, 0, 0)\n        vec3.set(b._forces, 0, 0, 0)\n        vec3.set(b._impulses, 0, 0, 0)\n        return\n    }\n\n    // skip bodies if static or no velocity/forces/impulses\n    var localNoGrav = noGravity || (b.gravityMultiplier === 0)\n    if (bodyAsleep(self, b, dt, localNoGrav)) return\n    b._sleepFrameCount--\n\n    // check if under water, if so apply buoyancy and drag forces\n    applyFluidForces(self, b)\n\n    // debug hooks\n    sanityCheck(b._forces)\n    sanityCheck(b._impulses)\n    sanityCheck(b.velocity)\n    sanityCheck(b.resting)\n\n    // semi-implicit Euler integration\n\n    // a = f/m + gravity*gravityMultiplier\n    vec3.scale(a, b._forces, 1 / b.mass)\n    vec3.scaleAndAdd(a, a, self.gravity, b.gravityMultiplier)\n\n    // dv = i/m + a*dt\n    // v1 = v0 + dv\n    vec3.scale(dv, b._impulses, 1 / b.mass)\n    vec3.scaleAndAdd(dv, dv, a, dt)\n    vec3.add(b.velocity, b.velocity, dv)\n\n    // apply friction based on change in velocity this frame\n    if (b.friction) {\n        applyFrictionByAxis(0, b, dv)\n        applyFrictionByAxis(1, b, dv)\n        applyFrictionByAxis(2, b, dv)\n    }\n\n    // linear air or fluid friction - effectively v *= drag\n    // body settings override global settings\n    var drag = (b.airDrag >= 0) ? b.airDrag : self.airDrag\n    if (b.inFluid) {\n        drag = (b.fluidDrag >= 0) ? b.fluidDrag : self.fluidDrag\n        drag *= 1 - (1 - b.ratioInFluid) ** 2\n    }\n    var mult = Math.max(1 - drag * dt / b.mass, 0)\n    vec3.scale(b.velocity, b.velocity, mult)\n\n    // x1-x0 = v1*dt\n    vec3.scale(dx, b.velocity, dt)\n\n    // clear forces and impulses for next timestep\n    vec3.set(b._forces, 0, 0, 0)\n    vec3.set(b._impulses, 0, 0, 0)\n\n    // cache old position for use in autostepping\n    if (b.autoStep) {\n        cloneAABB(tmpBox, b.aabb)\n    }\n\n    // sweeps aabb along dx and accounts for collisions\n    processCollisions(self, b.aabb, dx, b.resting)\n\n    // if autostep, and on ground, run collisions again with stepped up aabb\n    if (b.autoStep) {\n        tryAutoStepping(self, b, tmpBox, dx)\n    }\n\n    // Collision impacts. b.resting shows which axes had collisions:\n    for (var i = 0; i < 3; ++i) {\n        impacts[i] = 0\n        if (b.resting[i]) {\n            // count impact only if wasn't collided last frame\n            if (!oldResting[i]) impacts[i] = -b.velocity[i]\n            b.velocity[i] = 0\n        }\n    }\n    var mag = vec3.length(impacts)\n    if (mag > .001) { // epsilon\n        // send collision event - allows client to optionally change\n        // body's restitution depending on what terrain it hit\n        // event argument is impulse J = m * dv\n        vec3.scale(impacts, impacts, b.mass)\n        if (b.onCollide) b.onCollide(impacts)\n\n        // bounce depending on restitution and minBounceImpulse\n        if (b.restitution > 0 && mag > self.minBounceImpulse) {\n            vec3.scale(impacts, impacts, b.restitution)\n            b.applyImpulse(impacts)\n        }\n    }\n\n\n    // sleep check\n    var vsq = vec3.squaredLength(b.velocity)\n    if (vsq > 1e-5) b._markActive()\n}\n\n\n\n\n\n\n\n\n/*\n *    FLUIDS\n*/\n\nfunction applyFluidForces(self, body) {\n    // First pass at handling fluids. Assumes fluids are settled\n    //   thus, only check at corner of body, and only from bottom up\n    var box = body.aabb\n    var cx = Math.floor(box.base[0])\n    var cz = Math.floor(box.base[2])\n    var y0 = Math.floor(box.base[1])\n    var y1 = Math.floor(box.max[1])\n\n    if (!self.testFluid(cx, y0, cz)) {\n        body.inFluid = false\n        body.ratioInFluid = 0\n        return\n    }\n\n    // body is in a fluid - find out how much of body is submerged\n    var submerged = 1\n    var cy = y0 + 1\n    while (cy <= y1 && self.testFluid(cx, cy, cz)) {\n        submerged++\n        cy++\n    }\n    var fluidLevel = y0 + submerged\n    var heightInFluid = fluidLevel - box.base[1]\n    var ratioInFluid = heightInFluid / box.vec[1]\n    if (ratioInFluid > 1) ratioInFluid = 1\n    var vol = box.vec[0] * box.vec[1] * box.vec[2]\n    var displaced = vol * ratioInFluid\n    // bouyant force = -gravity * fluidDensity * volumeDisplaced\n    var f = _fluidVec\n    vec3.scale(f, self.gravity, -self.fluidDensity * displaced)\n    body.applyForce(f)\n\n    body.inFluid = true\n    body.ratioInFluid = ratioInFluid\n}\n\nvar _fluidVec = vec3.create()\n\n\n\n\n\n/*\n *    FRICTION\n*/\n\n\nfunction applyFrictionByAxis(axis, body, dvel) {\n    // friction applies only if moving into a touched surface\n    var restDir = body.resting[axis]\n    var vNormal = dvel[axis]\n    if (restDir === 0) return\n    if (restDir * vNormal <= 0) return\n\n    // current vel lateral to friction axis\n    vec3.copy(lateralVel, body.velocity)\n    lateralVel[axis] = 0\n    var vCurr = vec3.length(lateralVel)\n    if (equals(vCurr, 0)) return\n\n    // treat current change in velocity as the result of a pseudoforce\n    //        Fpseudo = m*dv/dt\n    // Base friction force on normal component of the pseudoforce\n    //        Ff = u * Fnormal\n    //        Ff = u * m * dvnormal / dt\n    // change in velocity due to friction force\n    //        dvF = dt * Ff / m\n    //            = dt * (u * m * dvnormal / dt) / m\n    //            = u * dvnormal\n    var dvMax = Math.abs(body.friction * vNormal)\n\n    // decrease lateral vel by dvMax (or clamp to zero)\n    var scaler = (vCurr > dvMax) ? (vCurr - dvMax) / vCurr : 0\n    body.velocity[(axis + 1) % 3] *= scaler\n    body.velocity[(axis + 2) % 3] *= scaler\n}\nvar lateralVel = vec3.create()\n\n\n\n\n\n\n/*\n *    COLLISION HANDLER\n*/\n\n// sweep aabb along velocity vector and set resting vector\nfunction processCollisions(self, box, velocity, resting) {\n    vec3.set(resting, 0, 0, 0)\n    return sweep(self.testSolid, box, velocity, function (dist, axis, dir, vec) {\n        resting[axis] = dir\n        vec[axis] = 0\n    })\n}\n\n\n\n\n\n/*\n *    AUTO-STEPPING\n*/\n\nvar tmpBox = new aabb([], [])\nvar tmpResting = vec3.create()\nvar targetPos = vec3.create()\nvar upvec = vec3.create()\nvar leftover = vec3.create()\n\nfunction tryAutoStepping(self, b, oldBox, dx) {\n    if (b.resting[1] >= 0 && !b.inFluid) return\n\n    // // direction movement was blocked before trying a step\n    var xBlocked = (b.resting[0] !== 0)\n    var zBlocked = (b.resting[2] !== 0)\n    if (!(xBlocked || zBlocked)) return\n\n    // continue autostepping only if headed sufficiently into obstruction\n    var ratio = Math.abs(dx[0] / dx[2])\n    var cutoff = 4\n    if (!xBlocked && ratio > cutoff) return\n    if (!zBlocked && ratio < 1 / cutoff) return\n\n    // original target position before being obstructed\n    vec3.add(targetPos, oldBox.base, dx)\n\n    // move towards the target until the first X/Z collision\n    var getVoxels = self.testSolid\n    sweep(getVoxels, oldBox, dx, function (dist, axis, dir, vec) {\n        if (axis === 1) vec[axis] = 0\n        else return true\n    })\n\n    var y = b.aabb.base[1]\n    var ydist = Math.floor(y + 1.001) - y\n    vec3.set(upvec, 0, ydist, 0)\n    var collided = false\n    // sweep up, bailing on any obstruction\n    sweep(getVoxels, oldBox, upvec, function (dist, axis, dir, vec) {\n        collided = true\n        return true\n    })\n    if (collided) return // could't move upwards\n\n    // now move in X/Z however far was left over before hitting the obstruction\n    vec3.subtract(leftover, targetPos, oldBox.base)\n    leftover[1] = 0\n    processCollisions(self, oldBox, leftover, tmpResting)\n\n    // bail if no movement happened in the originally blocked direction\n    if (xBlocked && !equals(oldBox.base[0], targetPos[0])) return\n    if (zBlocked && !equals(oldBox.base[2], targetPos[2])) return\n\n    // done - oldBox is now at the target autostepped position\n    cloneAABB(b.aabb, oldBox)\n    b.resting[0] = tmpResting[0]\n    b.resting[2] = tmpResting[2]\n    if (b.onStep) b.onStep()\n}\n\n\n\n\n\n/*\n *    SLEEP CHECK\n*/\n\nfunction bodyAsleep(self, body, dt, noGravity) {\n    if (body._sleepFrameCount > 0) return false\n    // without gravity bodies stay asleep until a force/impulse wakes them up\n    if (noGravity) return true\n    // otherwise check body is resting against something\n    // i.e. sweep along by distance d = 1/2 g*t^2\n    // and check there's still a collision\n    var isResting = false\n    var gmult = 0.5 * dt * dt * body.gravityMultiplier\n    vec3.scale(sleepVec, self.gravity, gmult)\n    sweep(self.testSolid, body.aabb, sleepVec, function () {\n        isResting = true\n        return true\n    }, true)\n    return isResting\n}\nvar sleepVec = vec3.create()\n\n\n\n\n\nfunction equals(a, b) { return Math.abs(a - b) < 1e-5 }\n\nfunction cloneAABB(tgt, src) {\n    for (var i = 0; i < 3; i++) {\n        tgt.base[i] = src.base[i]\n        tgt.max[i] = src.max[i]\n        tgt.vec[i] = src.vec[i]\n    }\n}\n\n\n\nvar sanityCheck = function () { }\nif (DEBUG) sanityCheck = function (v) {\n    if (isNaN(vec3.length(v))) throw 'Vector with NAN: ', v\n}\n","'use strict'\n\nvar aabb = require('aabb-3d')\nvar vec3 = require('gl-vec3')\n\n\nvar DEBUG = 0\n\n\nmodule.exports = RigidBody\n\n\n\n/*\n *    RIGID BODY - internal data structure\n *  Only AABB bodies right now. Someday will likely need spheres?\n*/\n\nfunction RigidBody(_aabb, mass, friction, restitution, gravMult, onCollide, autoStep) {\n    this.aabb = new aabb(_aabb.base, _aabb.vec) // clone\n    this.mass = mass\n    this.friction = friction\n    this.restitution = restitution\n    this.gravityMultiplier = gravMult\n    this.onCollide = onCollide\n    this.autoStep = !!autoStep\n    this.airDrag = -1   // overrides global airDrag when >= 0\n    this.fluidDrag = -1 // overrides global fluidDrag when >= 0\n    this.onStep = null\n    \n    // internals\n    this.velocity = vec3.create()\n    this.resting = [0, 0, 0]\n    this.inFluid = false\n    this._ratioInFluid = 0\n    this._forces = vec3.create()\n    this._impulses = vec3.create()\n    this._sleepFrameCount = 10 | 0\n}\n\nRigidBody.prototype.setPosition = function (p) {\n    sanityCheck(p)\n    vec3.subtract(p, p, this.aabb.base)\n    this.aabb.translate(p)\n    this._markActive()\n}\nRigidBody.prototype.getPosition = function () {\n    return vec3.clone(this.aabb.base)\n}\nRigidBody.prototype.applyForce = function (f) {\n    sanityCheck(f)\n    vec3.add(this._forces, this._forces, f)\n    this._markActive()\n}\nRigidBody.prototype.applyImpulse = function (i) {\n    sanityCheck(i)\n    vec3.add(this._impulses, this._impulses, i)\n    this._markActive()\n}\nRigidBody.prototype._markActive = function () {\n    this._sleepFrameCount = 10 | 0\n}\n\n\n\n// temp\nRigidBody.prototype.atRestX = function () { return this.resting[0] }\nRigidBody.prototype.atRestY = function () { return this.resting[1] }\nRigidBody.prototype.atRestZ = function () { return this.resting[2] }\n\n\n\n\n\nvar sanityCheck = function () { }\nif (DEBUG) sanityCheck = function (v) {\n    if (isNaN(vec3.length(v))) throw 'Vector with NAN: ', v\n}\n","'use strict'\n\nmodule.exports = ECS\nvar DataStore = require('./dataStore')\n\n\n\n/*!\n * ent-comp: a light, *fast* Entity Component System in JS\n * @url      github.com/andyhall/ent-comp\n * @author   Andy Hall <andy@fenomas.com>\n * @license  MIT\n*/\n\n\n\n/**\n * Constructor for a new entity-component-system manager.\n * \n * ```js\n * var ECS = require('ent-comp')\n * var ecs = new ECS()\n * ```\n * @class\n * @constructor\n * @exports ECS\n * @typicalname ecs\n*/\n\nfunction ECS() {\n\tvar self = this\n\n\t/** \n\t * Hash of component definitions. Also aliased to `comps`.\n\t * \n\t * ```js\n\t * var comp = { name: 'foo' }\n\t * ecs.createComponent(comp)\n\t * ecs.components['foo'] === comp // true\n\t * ecs.comps['foo']               // same\n\t * ```\n\t*/\n\tthis.components = {}\n\tthis.comps = this.components\n\n\n\n\t/*\n\t * \n\t * \t\tinternal properties:\n\t * \n\t*/\n\n\tvar components = this.components\n\n\t// counter for entity IDs\n\tvar UID = 1\n\n\t// Storage for all component state data:\n\t// storage['component-name'] = { hash:{}, list:[] }\n\tvar storage = {}\n\n\t// flat arrays of names of components with systems\n\tvar systems = []\n\tvar renderSystems = []\n\n\t// queues for deferred operations\n\tvar deferredEntityRemovals = []\n\tvar deferredCompRemovals = []\n\tvar deferredMultiCompRemovals = []\n\n\n\t// add references to internals, for debugging/hacking\n\tthis._storage = storage\n\tthis._systems = systems\n\tthis._renderSystems = renderSystems\n\n\n\t/*\n\t * \n\t * \n\t * \t\t\t\tPublic API\n\t * \n\t * \n\t*/\n\n\n\n\n\t/**\n\t * Creates a new entity id (currently just an incrementing integer).\n\t * \n\t * Optionally takes a list of component names to add to the entity (with default state data).\n\t * \n\t * ```js\n\t * var id1 = ecs.createEntity()\n\t * var id2 = ecs.createEntity([ 'some-component', 'other-component' ])\n\t * ```\n\t*/\n\tthis.createEntity = function (compList) {\n\t\tvar id = UID++\n\t\tif (compList && compList.length) {\n\t\t\tcompList.forEach(compName => self.addComponent(id, compName))\n\t\t}\n\t\treturn id\n\t}\n\n\n\n\t/**\n\t * Deletes an entity, which in practice just means removing all its components.\n\t * By default the actual removal is deferred (since entities often\n\t * delete themselves from their system function, etc).\n\t * Pass a truthy second parameter to force immediate removal.\n\t * \n\t * ```js\n\t * ecs.deleteEntity(id)\n\t * ecs.deleteEntity(id2, true) // deletes immediately\n\t * ```\n\t*/\n\tthis.deleteEntity = function (entID, immediately) {\n\t\tif (immediately) {\n\t\t\tdeleteEntityNow(entID)\n\t\t} else {\n\t\t\tdeferredEntityRemovals.push(entID)\n\t\t\tmakeDeferralTimeout()\n\t\t}\n\t\treturn self\n\t}\n\n\n\n\n\n\n\n\t/**\n\t * Creates a new component from a definition object. \n\t * The definition must have a `name`; all other properties are optional.\n\t * \n\t * Returns the component name, to make it easy to grab when the component\n\t * is being `require`d from a module.\n\t * \n\t * ```js\n\t * var comp = {\n\t * \t name: 'some-unique-string',\n\t * \t state: {},\n\t * \t order: 99,\n\t * \t onAdd:        function(id, state){ },\n\t * \t onRemove:     function(id, state){ },\n\t * \t system:       function(dt, states){ },\n\t * \t renderSystem: function(dt, states){ },\n\t * \t multi: false,\n\t * }\n\t * \n\t * var name = ecs.createComponent( comp )\n\t * // name == 'some-unique-string'\n\t * ```\n\t * \n\t * Note the `multi` flag - for components where this is true, a given \n\t * entity can have multiple state objects for that component.\n\t * For multi-components, APIs that would normally return a state object \n\t * (like `getState`) will instead return an array of them.\n\t*/\n\tthis.createComponent = function (compDefn) {\n\t\tif (!compDefn) throw 'Missing component definition'\n\t\tvar name = compDefn.name\n\t\tif (!name) throw 'Component definition must have a name property.'\n\t\tif (typeof name !== 'string') throw 'Component name must be a string.'\n\t\tif (name === '') throw 'Component name must be a non-empty string.'\n\t\tif (storage[name]) throw `Component ${name} already exists.`\n\n\t\t// rebuild definition object for monomorphism\n\t\tvar internalDef = {}\n\t\tinternalDef.name = name\n\t\tinternalDef.order = isNaN(compDefn.order) ? 99 : compDefn.order\n\t\tinternalDef.state = compDefn.state || {}\n\t\tinternalDef.onAdd = compDefn.onAdd || null\n\t\tinternalDef.onRemove = compDefn.onRemove || null\n\t\tinternalDef.system = compDefn.system || null\n\t\tinternalDef.renderSystem = compDefn.renderSystem || null\n\t\tinternalDef.multi = !!compDefn.multi\n\n\t\tcomponents[name] = internalDef\n\t\tstorage[name] = DataStore.create()\n\n\t\tif (internalDef.system) {\n\t\t\tsystems.push(name)\n\t\t\tsystems.sort((a, b) => components[a].order - components[b].order)\n\t\t}\n\t\tif (internalDef.renderSystem) {\n\t\t\trenderSystems.push(name)\n\t\t\trenderSystems.sort((a, b) => components[a].order - components[b].order)\n\t\t}\n\n\t\treturn name\n\t}\n\n\n\n\n\n\t/**\n\t * Deletes the component definition with the given name. \n\t * First removes the component from all entities that have it.\n\t * \n\t * (This probably shouldn't be called in real-world usage - \n\t * better to define all components when you begin and leave them be - \n\t * but it's here if you need it.)\n\t * \n\t * ```js\n\t * ecs.deleteComponent( comp.name )\n\t * ```\n\t*/\n\tthis.deleteComponent = function (compName) {\n\t\tvar data = storage[compName]\n\t\tif (!data) throw `Unknown component: ${compName}`\n\n\t\tdata.list.forEach(obj => {\n\t\t\tvar id = obj.__id || obj[0].__id\n\t\t\tself.removeComponent(id, compName, true)\n\t\t})\n\n\t\tvar i = systems.indexOf(compName)\n\t\tvar j = renderSystems.indexOf(compName)\n\t\tif (i > -1) systems.splice(i, 1)\n\t\tif (j > -1) renderSystems.splice(j, 1)\n\n\t\tdelete components[compName]\n\t\tdelete storage[compName]\n\n\t\treturn self\n\t}\n\n\n\n\n\t/**\n\t * Adds a component to an entity, optionally initializing the state object.\n\t * \n\t * ```js\n\t * ecs.createComponent({\n\t * \tname: 'foo',\n\t * \tstate: { val: 0 }\n\t * })\n\t * ecs.addComponent(id, 'foo', {val:20})\n\t * ecs.getState(id, 'foo').val // 20\n\t * ```\n\t*/\n\tthis.addComponent = function (entID, compName, state) {\n\t\tvar def = components[compName]\n\t\tvar data = storage[compName]\n\t\tif (!data) throw `Unknown component: ${compName}.`\n\n\t\t// if the component is pending removal, remove it so it can be readded\n\t\tvar pendingRemoval = false\n\t\tdeferredCompRemovals.forEach(obj => {\n\t\t\tif (obj.id === entID && obj.compName === compName) pendingRemoval = true\n\t\t})\n\t\tif (pendingRemoval) doDeferredComponentRemovals()\n\n\t\tif (data.hash[entID] && !def.multi) throw `Entity ${entID} already has component: ${compName}.`\n\n\t\t// create new component state object for this entity\n\t\tvar newState = Object.assign({}, { __id: entID }, def.state, state)\n\n\t\t// just in case passed-in state object had an __id property\n\t\tnewState.__id = entID\n\n\t\t// add to dataStore - for multi components, may already be present\n\t\tif (def.multi) {\n\t\t\tvar statesArr = data.hash[entID]\n\t\t\tif (!statesArr) {\n\t\t\t\tstatesArr = []\n\t\t\t\tDataStore.add(data, entID, statesArr)\n\t\t\t}\n\t\t\tstatesArr.push(newState)\n\t\t} else {\n\t\t\tDataStore.add(data, entID, newState)\n\t\t}\n\n\t\t// call handler and return\n\t\tif (def.onAdd) def.onAdd(entID, newState)\n\n\t\treturn this\n\t}\n\n\n\n\t/**\n\t * Checks if an entity has a component.\n\t * \n\t * ```js\n\t * ecs.addComponent(id, 'comp-name')\n\t * ecs.hasComponent(id, 'comp-name') // true\n\t * ```\n\t*/\n\n\tthis.hasComponent = function (entID, compName) {\n\t\tvar data = storage[compName]\n\t\tif (!data) throw `Unknown component: ${compName}.`\n\t\treturn (data.hash[entID] !== undefined)\n\t}\n\n\n\n\n\n\t/**\n\t * Removes a component from an entity, deleting any state data.\n\t * \n\t * ```js\n\t * ecs.removeComponent(id, 'foo', true) // final arg means \"immediately\"\n\t * ecs.hasComponent(id, 'foo')          // false\n\t * ecs.removeComponent(id, 'bar')\n\t * ecs.hasComponent(id, 'bar')          // true, removal is deferred by default\n\t * ```\n\t*/\n\tthis.removeComponent = function (entID, compName, immediately) {\n\t\tvar def = components[compName]\n\t\tvar data = storage[compName]\n\t\tif (!data) throw `Unknown component: ${compName}.`\n\n\t\t// if comp isn't present, fail silently for multi or throw otherwise\n\t\tif (!data.hash[entID]) {\n\t\t\tif (def.multi) return self\n\t\t\telse throw `Entity ${entID} does not have component: ${compName} to remove.`\n\t\t}\n\n\t\t// defer or remove\n\t\tif (immediately) {\n\t\t\tremoveComponentNow(entID, compName)\n\t\t} else {\n\t\t\tdeferredCompRemovals.push({\n\t\t\t\tid: entID,\n\t\t\t\tcompName: compName,\n\t\t\t})\n\t\t\tmakeDeferralTimeout()\n\t\t}\n\n\t\treturn self\n\t}\n\n\n\n\n\n\t/**\n\t * Get the component state for a given entity.\n\t * It will automatically have an `__id` property for the entity id.\n\t * \n\t * ```js\n\t * ecs.createComponent({\n\t * \tname: 'foo',\n\t * \tstate: { val: 0 }\n\t * })\n\t * ecs.addComponent(id, 'foo')\n\t * ecs.getState(id, 'foo').val   // 0\n\t * ecs.getState(id, 'foo').__id  // equals id\n\t * ```\n\t*/\n\n\tthis.getState = function (entID, compName) {\n\t\tvar data = storage[compName]\n\t\tif (!data) throw `Unknown component: ${compName}.`\n\t\treturn data.hash[entID]\n\t}\n\n\n\n\n\t/**\n\t * Get an array of state objects for every entity with the given component. \n\t * Each one will have an `__id` property for the entity id it refers to.\n\t * Don't add or remove elements from the returned list!\n\t * \n\t * ```js\n\t * var arr = ecs.getStatesList('foo')\n\t * // returns something shaped like:\n\t * //   [ {__id:0, x:1}, \n\t * //     {__id:7, x:2}  ]\n\t * ```  \n\t*/\n\n\tECS.prototype.getStatesList = function (compName) {\n\t\tvar data = storage[compName]\n\t\tif (!data) throw `Unknown component: ${compName}.`\n\t\treturn data.list\n\t}\n\n\n\n\n\t/**\n\t * Returns a `getState`-like accessor bound to a given component name. \n\t * The accessor is faster than `getState`, so you may want to create \n\t * an accessor for any component you'll be accessing a lot.\n\t * \n\t * ```js\n\t * ecs.createComponent({\n\t * \tname: 'size',\n\t * \tstate: { val: 0 }\n\t * })\n\t * ecs.addComponent(id, 'size')\n\t * var getSize = ecs.getStateAccessor('size')\n\t * getSize(id).val // 0\n\t * ```  \n\t*/\n\n\tthis.getStateAccessor = function (compName) {\n\t\tif (!storage[compName]) throw `Unknown component: ${compName}.`\n\t\tvar hash = storage[compName].hash\n\t\treturn function (entID) {\n\t\t\treturn hash[entID]\n\t\t}\n\t}\n\n\n\n\n\t/**\n\t * Returns a `hasComponent`-like accessor function bound to a given component name. \n\t * The accessor is much faster than `hasComponent`.\n\t * \n\t * ```js\n\t * ecs.createComponent({\n\t * \tname: 'foo',\n\t * })\n\t * ecs.addComponent(id, 'foo')\n\t * var hasFoo = ecs.getComponentAccessor('foo')\n\t * hasFoo(id) // true\n\t * ```  \n\t*/\n\n\tthis.getComponentAccessor = function (compName) {\n\t\tif (!storage[compName]) throw `Unknown component: ${compName}.`\n\t\tvar hash = storage[compName].hash\n\t\treturn function (entID) {\n\t\t\treturn (hash[entID] !== undefined) // TODO\n\t\t}\n\t}\n\n\n\n\n\n\t/**\n\t * Tells the ECS that a game tick has occurred, causing component \n\t * `system` functions to get called.\n\t * \n\t * The optional parameter simply gets passed to the system functions. \n\t * It's meant to be a timestep, but can be used (or not used) as you like.    \n\t * \n\t * If components have an `order` property, they'll get called in that order\n\t * (lowest to highest). Component order defaults to `99`.\n\t * ```js\n\t * ecs.createComponent({\n\t * \tname: foo,\n\t * \torder: 1,\n\t * \tsystem: function(dt, states) {\n\t * \t\t// states is the same array you'd get from #getStatesList()\n\t * \t\tstates.forEach(state => {\n\t * \t\t\tconsole.log('Entity ID: ', state.__id)\n\t * \t\t})\n\t * \t}\n\t * })\n\t * ecs.tick(30) // triggers log statements\n\t * ```\n\t*/\n\n\tthis.tick = function (dt) {\n\t\trunAllDeferredRemovals()\n\t\tsystems.forEach(compName => {\n\t\t\tvar list = storage[compName].list\n\t\t\tvar comp = components[compName]\n\t\t\tcomp.system(dt, list)\n\t\t})\n\t\trunAllDeferredRemovals()\n\t\treturn self\n\t}\n\n\n\n\t/**\n\t * Functions exactly like `tick`, but calls `renderSystem` functions.\n\t * this effectively gives you a second set of systems that are \n\t * called with separate timing, in case you want to \n\t * [tick and render in separate loops](http://gafferongames.com/game-physics/fix-your-timestep/)\n\t * (which you should!).\n\t * \n\t * ```js\n\t * ecs.createComponent({\n\t * \tname: foo,\n\t * \torder: 5,\n\t * \trenderSystem: function(dt, states) {\n\t * \t\t// states is the same array you'd get from #getStatesList()\n\t * \t}\n\t * })\n\t * ecs.render(1000/60)\n\t * ```\n\t*/\n\n\tthis.render = function (dt) {\n\t\trunAllDeferredRemovals()\n\t\trenderSystems.forEach(compName => {\n\t\t\tvar list = storage[compName].list\n\t\t\tvar comp = components[compName]\n\t\t\tcomp.renderSystem(dt, list)\n\t\t})\n\t\trunAllDeferredRemovals()\n\t\treturn self\n\t}\n\n\n\n\n\t/**\n\t * Removes a particular state instance of a multi-component.\n\t * Pass a final truthy argument to make this happen synchronously - \n\t * but be careful, that will splice an element out of the multi-component array,\n\t * changing the indexes of subsequent elements.\n\t * \n\t * ```js\n\t * ecs.getState(id, 'foo')   // [ state1, state2, state3 ]\n\t * ecs.removeMultiComponent(id, 'foo', 1, true)  // true means: immediately\n\t * ecs.getState(id, 'foo')   // [ state1, state3 ]\n\t * ```\n\t */\n\tthis.removeMultiComponent = function (entID, compName, index, immediately) {\n\t\tvar def = components[compName]\n\t\tvar data = storage[compName]\n\t\tif (!data) throw `Unknown component: ${compName}.`\n\t\tif (!def.multi) throw 'removeMultiComponent called on non-multi component'\n\n\t\t// throw if comp isn't present, or multicomp isn't present at index\n\t\tvar statesArr = data.hash[entID]\n\t\tif (!statesArr || !statesArr[index]) {\n\t\t\tthrow `Multicomponent ${compName} instance not found at index ${index}`\n\t\t}\n\n\t\t// index removals by object, in case indexes change later\n\t\tvar stateToRemove = statesArr[index]\n\t\tif (immediately) {\n\t\t\tremoveMultiCompNow(entID, compName, stateToRemove)\n\t\t} else {\n\t\t\tdeferredMultiCompRemovals.push({\n\t\t\t\tid: entID,\n\t\t\t\tcompName: compName,\n\t\t\t\tstate: stateToRemove,\n\t\t\t})\n\t\t}\n\n\t\treturn self\n\t}\n\n\n\n\n\n\n\n\n\t/*\n\t * \n\t * \n\t *\t\tinternal implementation of various delete operations\n\t * \n\t * \n\t*/\n\n\n\t// delete entity - meaning simply remove all its components\n\tfunction deleteEntityNow(entID) {\n\t\t// For now loop over all components\n\t\t// Could speed this up by keeping a hash of components held by each entity?\n\t\tObject.keys(storage).forEach(compName => {\n\t\t\tvar data = storage[compName]\n\t\t\tif (data.hash[entID]) removeComponentNow(entID, compName)\n\t\t})\n\t}\n\n\n\t// remove given component from an entity\n\tfunction removeComponentNow(entID, compName) {\n\t\tvar def = components[compName]\n\t\tvar data = storage[compName]\n\t\tif (!data) return\n\t\tif (!data.hash[entID]) return // probably got removed twice during deferral\n\n\t\t// call onRemove handler - on each instance for multi components\n\t\tif (def.onRemove) {\n\t\t\tif (def.multi) {\n\t\t\t\tdata.hash[entID].forEach(state => {\n\t\t\t\t\tdef.onRemove(entID, state)\n\t\t\t\t})\n\t\t\t} else {\n\t\t\t\tdef.onRemove(entID, data.hash[entID])\n\t\t\t}\n\t\t}\n\n\t\t// if multi, kill the states array to hopefully free the objects\n\t\tif (def.multi) data.hash[entID].length = 0\n\n\t\t// actual removal from data store\n\t\tDataStore.remove(data, entID)\n\t}\n\n\n\n\t// remove one state from a multi component\n\tfunction removeMultiCompNow(entID, compName, stateObj) {\n\t\tvar def = components[compName]\n\t\tvar data = storage[compName]\n\t\tvar statesArr = data.hash[entID]\n\t\tif (!statesArr) return\n\n\t\tvar i = statesArr.indexOf(stateObj)\n\t\tif (i < 0) return\n\t\tif (def.onRemove) {\n\t\t\tdef.onRemove(entID, stateObj)\n\t\t}\n\t\tstatesArr.splice(i, 1)\n\n\t\t// if this leaves the states list empty, remove the whole component\n\t\tif (statesArr.length === 0) {\n\t\t\tremoveComponentNow(entID, compName)\n\t\t}\n\t}\n\n\n\n\n\n\n\t/*\n\t * \n\t * \n\t *\t\tinternals for handling deferrals\n\t * \n\t * \n\t*/\n\n\n\n\t// debouncer - called whenever a deferral is queued\n\tfunction makeDeferralTimeout() {\n\t\tif (deferralTimeoutPending) return\n\t\tdeferralTimeoutPending = true\n\t\tsetTimeout(function () {\n\t\t\tdeferralTimeoutPending = false\n\t\t\trunAllDeferredRemovals()\n\t\t}, 1)\n\t}\n\tvar deferralTimeoutPending = false\n\n\n\t// Ping all removal queues. \n\t// called before and after tick/render, and after deferrals are queued\n\tfunction runAllDeferredRemovals() {\n\t\tdoDeferredComponentRemovals()\n\t\tdoDeferredMultiComponentRemovals()\n\t\tdoDeferredEntityRemovals()\n\t}\n\n\n\t// entities - queue of entity IDs\n\tfunction doDeferredEntityRemovals() {\n\t\twhile (deferredEntityRemovals.length) {\n\t\t\tvar entID = deferredEntityRemovals.pop()\n\t\t\tdeleteEntityNow(entID)\n\t\t}\n\t}\n\n\n\t// components - queue of { id, compName }\n\tfunction doDeferredComponentRemovals() {\n\t\twhile (deferredCompRemovals.length) {\n\t\t\tvar obj = deferredCompRemovals.pop()\n\t\t\tremoveComponentNow(obj.id, obj.compName)\n\t\t}\n\t}\n\n\n\t// multi components - queue of { id, compName, state }\n\tfunction doDeferredMultiComponentRemovals(ecs) {\n\t\twhile (deferredMultiCompRemovals.length) {\n\t\t\tvar obj = deferredMultiCompRemovals.pop()\n\t\t\tremoveMultiCompNow(obj.id, obj.compName, obj.state)\n\t\t\tobj.state = null\n\t\t}\n\t}\n\n\n\n}\n\n","'use strict'\n\n\n/*\n * \n *      Encapsulates (mostly) a collection of objects, \n *      exposed both as a hash and as an array\n *      _map maps hash id to list index\n * \n *      Note this is a dumb store, it doesn't check any inputs at all.\n *      It also assumes every stored data object is stored like:\n *          DataStore.add(data, 37, {__id:37} )\n * \n*/\n\n\nmodule.exports = {\n\n    create: function () {\n        return {\n            list: [],\n            hash: {},\n            _map: {},\n        }\n    },\n\n\n    add: function (data, id, object) {\n        data.list.push(object)\n        data.hash[id] = object\n        data._map[id] = data.list.length - 1\n    },\n\n\n    remove: function (data, id) {\n        // splice out of list\n        var index = data._map[id]\n        if (index === data.list.length - 1) {\n            data.list.pop()\n        } else {\n            // replace element to be spliced with element from end\n            var movedItem = data.list.pop()\n            data.list[index] = movedItem\n            // watch out, this bit breaks encapsulation by assuming object's contents\n            // alternative would be to look through map for movedID's index\n            var movedID = movedItem.__id || movedItem[0].__id\n            data._map[movedID] = index\n        }\n        // finish\n        delete data.hash[id]\n        delete data._map[id]\n    },\n\n\n}\n\n\n","var map = {\n\t\"./collideEntities.js\": 256,\n\t\"./collideTerrain.js\": 268,\n\t\"./fadeOnZoom.js\": 269,\n\t\"./followsEntity.js\": 270,\n\t\"./mesh.js\": 271,\n\t\"./movement.js\": 272,\n\t\"./physics.js\": 95,\n\t\"./position.js\": 94,\n\t\"./receivesInputs.js\": 273,\n\t\"./shadow.js\": 274,\n\t\"./smoothCamera.js\": 275\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 255;","\nvar boxIntersect = require('box-intersect')\n\n\n/*\n * \tEvery frame, entities with this component will get mutually checked for colliions\n * \n *   * cylinder: flag for checking collisions as a vertical cylindar (rather than AABB)\n *   * collideBits: category for this entity\n *   * collideMask: categories this entity collides with\n *   * callback: function(other_id) - called when `own.collideBits & other.collideMask` is true\n * \n * \n * \t\tNotes:\n * \tSet collideBits=0 for entities like bullets, which can collide with things \n * \t\tbut are never the target of a collision.\n * \tSet collideMask=0 for things with no callback - things that get collided with,\n * \t\tbut don't themselves instigate collisions.\n * \n */\n\n\n\nexport default function (noa) {\n\n    var intervals = []\n\n    return {\n\n        name: 'collideEntities',\n\n        order: 70,\n\n        state: {\n            cylinder: false,\n            collideBits: 1 | 0,\n            collideMask: 1 | 0,\n            callback: null,\n        },\n\n        onAdd: null,\n\n        onRemove: null,\n\n\n        system: function entityCollider(dt, states) {\n            var ents = noa.ents\n\n            // data struct that boxIntersect looks for\n            // - array of [lo, lo, lo, hi, hi, hi] extents\n            for (var i = 0; i < states.length; i++) {\n                var id = states[i].__id\n                var dat = ents.getPositionData(id)\n                intervals[i] = dat._extents\n            }\n            intervals.length = states.length\n\n            // run the intersect library\n            boxIntersect(intervals, function (a, b) {\n                var stateA = states[a]\n                var stateB = states[b]\n                var intervalA = intervals[a]\n                var intervalB = intervals[b]\n                if (cylindricalHitTest(stateA, stateB, intervalA, intervalB)) {\n                    handleCollision(noa, stateA, stateB)\n                }\n            })\n\n        }\n    }\n\n\n\n    /*\n     * \n     * \t\tIMPLEMENTATION\n     * \n     */\n\n\n    function handleCollision(noa, stateA, stateB) {\n        var idA = stateA.__id\n        var idB = stateB.__id\n\n        // entities really do overlap, so check masks and call event handlers\n        if (stateA.collideMask & stateB.collideBits) {\n            if (stateA.callback) stateA.callback(idB)\n        }\n        if (stateB.collideMask & stateA.collideBits) {\n            if (stateB.callback) stateB.callback(idA)\n        }\n\n        // general pairwise handler\n        noa.ents.onPairwiseEntityCollision(idA, idB)\n    }\n\n\n\n    // For entities whose extents overlap, \n    // test if collision still happens when taking cylinder flags into account\n\n    function cylindricalHitTest(stateA, stateB, intervalA, intervalB) {\n        if (stateA.cylinder) {\n            if (stateB.cylinder) {\n                return cylinderCylinderTest(intervalA, intervalB)\n            } else {\n                return cylinderBoxTest(intervalA, intervalB)\n            }\n        } else if (stateB.cylinder) {\n            return cylinderBoxTest(intervalB, intervalA)\n        }\n        return true\n    }\n\n\n\n\n    // Cylinder-cylinder hit test (AABBs are known to overlap)\n    // given their extent arrays [lo, lo, lo, hi, hi, hi]\n\n    function cylinderCylinderTest(a, b) {\n        // distance between cylinder centers\n        var rada = (a[3] - a[0]) / 2\n        var radb = (b[3] - b[0]) / 2\n        var dx = a[0] + rada - (b[0] + radb)\n        var dz = a[2] + rada - (b[2] + radb)\n        // collide if dist <= sum of radii\n        var distsq = dx * dx + dz * dz\n        var radsum = rada + radb\n        return (distsq <= radsum * radsum)\n    }\n\n\n\n\n    // Cylinder-Box hit test (AABBs are known to overlap)\n    // given their extent arrays [lo, lo, lo, hi, hi, hi]\n\n    function cylinderBoxTest(cyl, cube) {\n        // X-z center of cylinder\n        var rad = (cyl[3] - cyl[0]) / 2\n        var cx = cyl[0] + rad\n        var cz = cyl[2] + rad\n        // point in X-Z square closest to cylinder\n        var px = clamp(cx, cube[0], cube[3])\n        var pz = clamp(cz, cube[2], cube[5])\n        // collision if distance from that point to circle <= cylinder radius\n        var dx = px - cx\n        var dz = pz - cz\n        var distsq = dx * dx + dz * dz\n        return (distsq <= rad * rad)\n    }\n\n    function clamp(val, lo, hi) {\n        return (val < lo) ? lo : (val > hi) ? hi : val\n    }\n\n\n\n\n}\n","'use strict'\n\nmodule.exports = boxIntersectWrapper\n\nvar pool = require('typedarray-pool')\nvar sweep = require('./lib/sweep')\nvar boxIntersectIter = require('./lib/intersect')\n\nfunction boxEmpty(d, box) {\n  for(var j=0; j<d; ++j) {\n    if(!(box[j] <= box[j+d])) {\n      return true\n    }\n  }\n  return false\n}\n\n//Unpack boxes into a flat typed array, remove empty boxes\nfunction convertBoxes(boxes, d, data, ids) {\n  var ptr = 0\n  var count = 0\n  for(var i=0, n=boxes.length; i<n; ++i) {\n    var b = boxes[i]\n    if(boxEmpty(d, b)) {\n      continue\n    }\n    for(var j=0; j<2*d; ++j) {\n      data[ptr++] = b[j]\n    }\n    ids[count++] = i\n  }\n  return count\n}\n\n//Perform type conversions, check bounds\nfunction boxIntersect(red, blue, visit, full) {\n  var n = red.length\n  var m = blue.length\n\n  //If either array is empty, then we can skip this whole thing\n  if(n <= 0 || m <= 0) {\n    return\n  }\n\n  //Compute dimension, if it is 0 then we skip\n  var d = (red[0].length)>>>1\n  if(d <= 0) {\n    return\n  }\n\n  var retval\n\n  //Convert red boxes\n  var redList  = pool.mallocDouble(2*d*n)\n  var redIds   = pool.mallocInt32(n)\n  n = convertBoxes(red, d, redList, redIds)\n\n  if(n > 0) {\n    if(d === 1 && full) {\n      //Special case: 1d complete\n      sweep.init(n)\n      retval = sweep.sweepComplete(\n        d, visit, \n        0, n, redList, redIds,\n        0, n, redList, redIds)\n    } else {\n\n      //Convert blue boxes\n      var blueList = pool.mallocDouble(2*d*m)\n      var blueIds  = pool.mallocInt32(m)\n      m = convertBoxes(blue, d, blueList, blueIds)\n\n      if(m > 0) {\n        sweep.init(n+m)\n\n        if(d === 1) {\n          //Special case: 1d bipartite\n          retval = sweep.sweepBipartite(\n            d, visit, \n            0, n, redList,  redIds,\n            0, m, blueList, blueIds)\n        } else {\n          //General case:  d>1\n          retval = boxIntersectIter(\n            d, visit,    full,\n            n, redList,  redIds,\n            m, blueList, blueIds)\n        }\n\n        pool.free(blueList)\n        pool.free(blueIds)\n      }\n    }\n\n    pool.free(redList)\n    pool.free(redIds)\n  }\n\n  return retval\n}\n\n\nvar RESULT\n\nfunction appendItem(i,j) {\n  RESULT.push([i,j])\n}\n\nfunction intersectFullArray(x) {\n  RESULT = []\n  boxIntersect(x, x, appendItem, true)\n  return RESULT\n}\n\nfunction intersectBipartiteArray(x, y) {\n  RESULT = []\n  boxIntersect(x, y, appendItem, false)\n  return RESULT\n}\n\n//User-friendly wrapper, handle full input and no-visitor cases\nfunction boxIntersectWrapper(arg0, arg1, arg2) {\n  var result\n  switch(arguments.length) {\n    case 1:\n      return intersectFullArray(arg0)\n    case 2:\n      if(typeof arg1 === 'function') {\n        return boxIntersect(arg0, arg0, arg1, true)\n      } else {\n        return intersectBipartiteArray(arg0, arg1)\n      }\n    case 3:\n      return boxIntersect(arg0, arg1, arg2, false)\n    default:\n      throw new Error('box-intersect: Invalid arguments')\n  }\n}","/**\n * Bit twiddling hacks for JavaScript.\n *\n * Author: Mikola Lysenko\n *\n * Ported from Stanford bit twiddling hack library:\n *    http://graphics.stanford.edu/~seander/bithacks.html\n */\n\n\"use strict\"; \"use restrict\";\n\n//Number of bits in an integer\nvar INT_BITS = 32;\n\n//Constants\nexports.INT_BITS  = INT_BITS;\nexports.INT_MAX   =  0x7fffffff;\nexports.INT_MIN   = -1<<(INT_BITS-1);\n\n//Returns -1, 0, +1 depending on sign of x\nexports.sign = function(v) {\n  return (v > 0) - (v < 0);\n}\n\n//Computes absolute value of integer\nexports.abs = function(v) {\n  var mask = v >> (INT_BITS-1);\n  return (v ^ mask) - mask;\n}\n\n//Computes minimum of integers x and y\nexports.min = function(x, y) {\n  return y ^ ((x ^ y) & -(x < y));\n}\n\n//Computes maximum of integers x and y\nexports.max = function(x, y) {\n  return x ^ ((x ^ y) & -(x < y));\n}\n\n//Checks if a number is a power of two\nexports.isPow2 = function(v) {\n  return !(v & (v-1)) && (!!v);\n}\n\n//Computes log base 2 of v\nexports.log2 = function(v) {\n  var r, shift;\n  r =     (v > 0xFFFF) << 4; v >>>= r;\n  shift = (v > 0xFF  ) << 3; v >>>= shift; r |= shift;\n  shift = (v > 0xF   ) << 2; v >>>= shift; r |= shift;\n  shift = (v > 0x3   ) << 1; v >>>= shift; r |= shift;\n  return r | (v >> 1);\n}\n\n//Computes log base 10 of v\nexports.log10 = function(v) {\n  return  (v >= 1000000000) ? 9 : (v >= 100000000) ? 8 : (v >= 10000000) ? 7 :\n          (v >= 1000000) ? 6 : (v >= 100000) ? 5 : (v >= 10000) ? 4 :\n          (v >= 1000) ? 3 : (v >= 100) ? 2 : (v >= 10) ? 1 : 0;\n}\n\n//Counts number of bits\nexports.popCount = function(v) {\n  v = v - ((v >>> 1) & 0x55555555);\n  v = (v & 0x33333333) + ((v >>> 2) & 0x33333333);\n  return ((v + (v >>> 4) & 0xF0F0F0F) * 0x1010101) >>> 24;\n}\n\n//Counts number of trailing zeros\nfunction countTrailingZeros(v) {\n  var c = 32;\n  v &= -v;\n  if (v) c--;\n  if (v & 0x0000FFFF) c -= 16;\n  if (v & 0x00FF00FF) c -= 8;\n  if (v & 0x0F0F0F0F) c -= 4;\n  if (v & 0x33333333) c -= 2;\n  if (v & 0x55555555) c -= 1;\n  return c;\n}\nexports.countTrailingZeros = countTrailingZeros;\n\n//Rounds to next power of 2\nexports.nextPow2 = function(v) {\n  v += v === 0;\n  --v;\n  v |= v >>> 1;\n  v |= v >>> 2;\n  v |= v >>> 4;\n  v |= v >>> 8;\n  v |= v >>> 16;\n  return v + 1;\n}\n\n//Rounds down to previous power of 2\nexports.prevPow2 = function(v) {\n  v |= v >>> 1;\n  v |= v >>> 2;\n  v |= v >>> 4;\n  v |= v >>> 8;\n  v |= v >>> 16;\n  return v - (v>>>1);\n}\n\n//Computes parity of word\nexports.parity = function(v) {\n  v ^= v >>> 16;\n  v ^= v >>> 8;\n  v ^= v >>> 4;\n  v &= 0xf;\n  return (0x6996 >>> v) & 1;\n}\n\nvar REVERSE_TABLE = new Array(256);\n\n(function(tab) {\n  for(var i=0; i<256; ++i) {\n    var v = i, r = i, s = 7;\n    for (v >>>= 1; v; v >>>= 1) {\n      r <<= 1;\n      r |= v & 1;\n      --s;\n    }\n    tab[i] = (r << s) & 0xff;\n  }\n})(REVERSE_TABLE);\n\n//Reverse bits in a 32 bit word\nexports.reverse = function(v) {\n  return  (REVERSE_TABLE[ v         & 0xff] << 24) |\n          (REVERSE_TABLE[(v >>> 8)  & 0xff] << 16) |\n          (REVERSE_TABLE[(v >>> 16) & 0xff] << 8)  |\n           REVERSE_TABLE[(v >>> 24) & 0xff];\n}\n\n//Interleave bits of 2 coordinates with 16 bits.  Useful for fast quadtree codes\nexports.interleave2 = function(x, y) {\n  x &= 0xFFFF;\n  x = (x | (x << 8)) & 0x00FF00FF;\n  x = (x | (x << 4)) & 0x0F0F0F0F;\n  x = (x | (x << 2)) & 0x33333333;\n  x = (x | (x << 1)) & 0x55555555;\n\n  y &= 0xFFFF;\n  y = (y | (y << 8)) & 0x00FF00FF;\n  y = (y | (y << 4)) & 0x0F0F0F0F;\n  y = (y | (y << 2)) & 0x33333333;\n  y = (y | (y << 1)) & 0x55555555;\n\n  return x | (y << 1);\n}\n\n//Extracts the nth interleaved component\nexports.deinterleave2 = function(v, n) {\n  v = (v >>> n) & 0x55555555;\n  v = (v | (v >>> 1))  & 0x33333333;\n  v = (v | (v >>> 2))  & 0x0F0F0F0F;\n  v = (v | (v >>> 4))  & 0x00FF00FF;\n  v = (v | (v >>> 16)) & 0x000FFFF;\n  return (v << 16) >> 16;\n}\n\n\n//Interleave bits of 3 coordinates, each with 10 bits.  Useful for fast octree codes\nexports.interleave3 = function(x, y, z) {\n  x &= 0x3FF;\n  x  = (x | (x<<16)) & 4278190335;\n  x  = (x | (x<<8))  & 251719695;\n  x  = (x | (x<<4))  & 3272356035;\n  x  = (x | (x<<2))  & 1227133513;\n\n  y &= 0x3FF;\n  y  = (y | (y<<16)) & 4278190335;\n  y  = (y | (y<<8))  & 251719695;\n  y  = (y | (y<<4))  & 3272356035;\n  y  = (y | (y<<2))  & 1227133513;\n  x |= (y << 1);\n  \n  z &= 0x3FF;\n  z  = (z | (z<<16)) & 4278190335;\n  z  = (z | (z<<8))  & 251719695;\n  z  = (z | (z<<4))  & 3272356035;\n  z  = (z | (z<<2))  & 1227133513;\n  \n  return x | (z << 2);\n}\n\n//Extracts nth interleaved component of a 3-tuple\nexports.deinterleave3 = function(v, n) {\n  v = (v >>> n)       & 1227133513;\n  v = (v | (v>>>2))   & 3272356035;\n  v = (v | (v>>>4))   & 251719695;\n  v = (v | (v>>>8))   & 4278190335;\n  v = (v | (v>>>16))  & 0x3FF;\n  return (v<<22)>>22;\n}\n\n//Computes next combination in colexicographic order (this is mistakenly called nextPermutation on the bit twiddling hacks page)\nexports.nextCombination = function(v) {\n  var t = v | (v - 1);\n  return (t + 1) | (((~t & -~t) - 1) >>> (countTrailingZeros(v) + 1));\n}\n\n","\"use strict\"\n\nfunction dupe_array(count, value, i) {\n  var c = count[i]|0\n  if(c <= 0) {\n    return []\n  }\n  var result = new Array(c), j\n  if(i === count.length-1) {\n    for(j=0; j<c; ++j) {\n      result[j] = value\n    }\n  } else {\n    for(j=0; j<c; ++j) {\n      result[j] = dupe_array(count, value, i+1)\n    }\n  }\n  return result\n}\n\nfunction dupe_number(count, value) {\n  var result, i\n  result = new Array(count)\n  for(i=0; i<count; ++i) {\n    result[i] = value\n  }\n  return result\n}\n\nfunction dupe(count, value) {\n  if(typeof value === \"undefined\") {\n    value = 0\n  }\n  switch(typeof count) {\n    case \"number\":\n      if(count > 0) {\n        return dupe_number(count|0, value)\n      }\n    break\n    case \"object\":\n      if(typeof (count.length) === \"number\") {\n        return dupe_array(count, value, 0)\n      }\n    break\n  }\n  return []\n}\n\nmodule.exports = dupe","/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <http://feross.org>\n * @license  MIT\n */\n/* eslint-disable no-proto */\n\n'use strict'\n\nvar base64 = require('base64-js')\nvar ieee754 = require('ieee754')\nvar isArray = require('isarray')\n\nexports.Buffer = Buffer\nexports.SlowBuffer = SlowBuffer\nexports.INSPECT_MAX_BYTES = 50\n\n/**\n * If `Buffer.TYPED_ARRAY_SUPPORT`:\n *   === true    Use Uint8Array implementation (fastest)\n *   === false   Use Object implementation (most compatible, even IE6)\n *\n * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,\n * Opera 11.6+, iOS 4.2+.\n *\n * Due to various browser bugs, sometimes the Object implementation will be used even\n * when the browser supports typed arrays.\n *\n * Note:\n *\n *   - Firefox 4-29 lacks support for adding new properties to `Uint8Array` instances,\n *     See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.\n *\n *   - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.\n *\n *   - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of\n *     incorrect length in some situations.\n\n * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they\n * get the Object implementation, which is slower but behaves correctly.\n */\nBuffer.TYPED_ARRAY_SUPPORT = global.TYPED_ARRAY_SUPPORT !== undefined\n  ? global.TYPED_ARRAY_SUPPORT\n  : typedArraySupport()\n\n/*\n * Export kMaxLength after typed array support is determined.\n */\nexports.kMaxLength = kMaxLength()\n\nfunction typedArraySupport () {\n  try {\n    var arr = new Uint8Array(1)\n    arr.__proto__ = {__proto__: Uint8Array.prototype, foo: function () { return 42 }}\n    return arr.foo() === 42 && // typed array instances can be augmented\n        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`\n        arr.subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`\n  } catch (e) {\n    return false\n  }\n}\n\nfunction kMaxLength () {\n  return Buffer.TYPED_ARRAY_SUPPORT\n    ? 0x7fffffff\n    : 0x3fffffff\n}\n\nfunction createBuffer (that, length) {\n  if (kMaxLength() < length) {\n    throw new RangeError('Invalid typed array length')\n  }\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = new Uint8Array(length)\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    if (that === null) {\n      that = new Buffer(length)\n    }\n    that.length = length\n  }\n\n  return that\n}\n\n/**\n * The Buffer constructor returns instances of `Uint8Array` that have their\n * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of\n * `Uint8Array`, so the returned instances will have all the node `Buffer` methods\n * and the `Uint8Array` methods. Square bracket notation works as expected -- it\n * returns a single octet.\n *\n * The `Uint8Array` prototype remains unmodified.\n */\n\nfunction Buffer (arg, encodingOrOffset, length) {\n  if (!Buffer.TYPED_ARRAY_SUPPORT && !(this instanceof Buffer)) {\n    return new Buffer(arg, encodingOrOffset, length)\n  }\n\n  // Common case.\n  if (typeof arg === 'number') {\n    if (typeof encodingOrOffset === 'string') {\n      throw new Error(\n        'If encoding is specified then the first argument must be a string'\n      )\n    }\n    return allocUnsafe(this, arg)\n  }\n  return from(this, arg, encodingOrOffset, length)\n}\n\nBuffer.poolSize = 8192 // not used by this implementation\n\n// TODO: Legacy, not needed anymore. Remove in next major version.\nBuffer._augment = function (arr) {\n  arr.__proto__ = Buffer.prototype\n  return arr\n}\n\nfunction from (that, value, encodingOrOffset, length) {\n  if (typeof value === 'number') {\n    throw new TypeError('\"value\" argument must not be a number')\n  }\n\n  if (typeof ArrayBuffer !== 'undefined' && value instanceof ArrayBuffer) {\n    return fromArrayBuffer(that, value, encodingOrOffset, length)\n  }\n\n  if (typeof value === 'string') {\n    return fromString(that, value, encodingOrOffset)\n  }\n\n  return fromObject(that, value)\n}\n\n/**\n * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError\n * if value is a number.\n * Buffer.from(str[, encoding])\n * Buffer.from(array)\n * Buffer.from(buffer)\n * Buffer.from(arrayBuffer[, byteOffset[, length]])\n **/\nBuffer.from = function (value, encodingOrOffset, length) {\n  return from(null, value, encodingOrOffset, length)\n}\n\nif (Buffer.TYPED_ARRAY_SUPPORT) {\n  Buffer.prototype.__proto__ = Uint8Array.prototype\n  Buffer.__proto__ = Uint8Array\n  if (typeof Symbol !== 'undefined' && Symbol.species &&\n      Buffer[Symbol.species] === Buffer) {\n    // Fix subarray() in ES2016. See: https://github.com/feross/buffer/pull/97\n    Object.defineProperty(Buffer, Symbol.species, {\n      value: null,\n      configurable: true\n    })\n  }\n}\n\nfunction assertSize (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('\"size\" argument must be a number')\n  } else if (size < 0) {\n    throw new RangeError('\"size\" argument must not be negative')\n  }\n}\n\nfunction alloc (that, size, fill, encoding) {\n  assertSize(size)\n  if (size <= 0) {\n    return createBuffer(that, size)\n  }\n  if (fill !== undefined) {\n    // Only pay attention to encoding if it's a string. This\n    // prevents accidentally sending in a number that would\n    // be interpretted as a start offset.\n    return typeof encoding === 'string'\n      ? createBuffer(that, size).fill(fill, encoding)\n      : createBuffer(that, size).fill(fill)\n  }\n  return createBuffer(that, size)\n}\n\n/**\n * Creates a new filled Buffer instance.\n * alloc(size[, fill[, encoding]])\n **/\nBuffer.alloc = function (size, fill, encoding) {\n  return alloc(null, size, fill, encoding)\n}\n\nfunction allocUnsafe (that, size) {\n  assertSize(size)\n  that = createBuffer(that, size < 0 ? 0 : checked(size) | 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) {\n    for (var i = 0; i < size; ++i) {\n      that[i] = 0\n    }\n  }\n  return that\n}\n\n/**\n * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.\n * */\nBuffer.allocUnsafe = function (size) {\n  return allocUnsafe(null, size)\n}\n/**\n * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.\n */\nBuffer.allocUnsafeSlow = function (size) {\n  return allocUnsafe(null, size)\n}\n\nfunction fromString (that, string, encoding) {\n  if (typeof encoding !== 'string' || encoding === '') {\n    encoding = 'utf8'\n  }\n\n  if (!Buffer.isEncoding(encoding)) {\n    throw new TypeError('\"encoding\" must be a valid string encoding')\n  }\n\n  var length = byteLength(string, encoding) | 0\n  that = createBuffer(that, length)\n\n  var actual = that.write(string, encoding)\n\n  if (actual !== length) {\n    // Writing a hex string, for example, that contains invalid characters will\n    // cause everything after the first invalid character to be ignored. (e.g.\n    // 'abxxcd' will be treated as 'ab')\n    that = that.slice(0, actual)\n  }\n\n  return that\n}\n\nfunction fromArrayLike (that, array) {\n  var length = array.length < 0 ? 0 : checked(array.length) | 0\n  that = createBuffer(that, length)\n  for (var i = 0; i < length; i += 1) {\n    that[i] = array[i] & 255\n  }\n  return that\n}\n\nfunction fromArrayBuffer (that, array, byteOffset, length) {\n  array.byteLength // this throws if `array` is not a valid ArrayBuffer\n\n  if (byteOffset < 0 || array.byteLength < byteOffset) {\n    throw new RangeError('\\'offset\\' is out of bounds')\n  }\n\n  if (array.byteLength < byteOffset + (length || 0)) {\n    throw new RangeError('\\'length\\' is out of bounds')\n  }\n\n  if (byteOffset === undefined && length === undefined) {\n    array = new Uint8Array(array)\n  } else if (length === undefined) {\n    array = new Uint8Array(array, byteOffset)\n  } else {\n    array = new Uint8Array(array, byteOffset, length)\n  }\n\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = array\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    that = fromArrayLike(that, array)\n  }\n  return that\n}\n\nfunction fromObject (that, obj) {\n  if (Buffer.isBuffer(obj)) {\n    var len = checked(obj.length) | 0\n    that = createBuffer(that, len)\n\n    if (that.length === 0) {\n      return that\n    }\n\n    obj.copy(that, 0, 0, len)\n    return that\n  }\n\n  if (obj) {\n    if ((typeof ArrayBuffer !== 'undefined' &&\n        obj.buffer instanceof ArrayBuffer) || 'length' in obj) {\n      if (typeof obj.length !== 'number' || isnan(obj.length)) {\n        return createBuffer(that, 0)\n      }\n      return fromArrayLike(that, obj)\n    }\n\n    if (obj.type === 'Buffer' && isArray(obj.data)) {\n      return fromArrayLike(that, obj.data)\n    }\n  }\n\n  throw new TypeError('First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.')\n}\n\nfunction checked (length) {\n  // Note: cannot use `length < kMaxLength()` here because that fails when\n  // length is NaN (which is otherwise coerced to zero.)\n  if (length >= kMaxLength()) {\n    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +\n                         'size: 0x' + kMaxLength().toString(16) + ' bytes')\n  }\n  return length | 0\n}\n\nfunction SlowBuffer (length) {\n  if (+length != length) { // eslint-disable-line eqeqeq\n    length = 0\n  }\n  return Buffer.alloc(+length)\n}\n\nBuffer.isBuffer = function isBuffer (b) {\n  return !!(b != null && b._isBuffer)\n}\n\nBuffer.compare = function compare (a, b) {\n  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {\n    throw new TypeError('Arguments must be Buffers')\n  }\n\n  if (a === b) return 0\n\n  var x = a.length\n  var y = b.length\n\n  for (var i = 0, len = Math.min(x, y); i < len; ++i) {\n    if (a[i] !== b[i]) {\n      x = a[i]\n      y = b[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\nBuffer.isEncoding = function isEncoding (encoding) {\n  switch (String(encoding).toLowerCase()) {\n    case 'hex':\n    case 'utf8':\n    case 'utf-8':\n    case 'ascii':\n    case 'latin1':\n    case 'binary':\n    case 'base64':\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      return true\n    default:\n      return false\n  }\n}\n\nBuffer.concat = function concat (list, length) {\n  if (!isArray(list)) {\n    throw new TypeError('\"list\" argument must be an Array of Buffers')\n  }\n\n  if (list.length === 0) {\n    return Buffer.alloc(0)\n  }\n\n  var i\n  if (length === undefined) {\n    length = 0\n    for (i = 0; i < list.length; ++i) {\n      length += list[i].length\n    }\n  }\n\n  var buffer = Buffer.allocUnsafe(length)\n  var pos = 0\n  for (i = 0; i < list.length; ++i) {\n    var buf = list[i]\n    if (!Buffer.isBuffer(buf)) {\n      throw new TypeError('\"list\" argument must be an Array of Buffers')\n    }\n    buf.copy(buffer, pos)\n    pos += buf.length\n  }\n  return buffer\n}\n\nfunction byteLength (string, encoding) {\n  if (Buffer.isBuffer(string)) {\n    return string.length\n  }\n  if (typeof ArrayBuffer !== 'undefined' && typeof ArrayBuffer.isView === 'function' &&\n      (ArrayBuffer.isView(string) || string instanceof ArrayBuffer)) {\n    return string.byteLength\n  }\n  if (typeof string !== 'string') {\n    string = '' + string\n  }\n\n  var len = string.length\n  if (len === 0) return 0\n\n  // Use a for loop to avoid recursion\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'ascii':\n      case 'latin1':\n      case 'binary':\n        return len\n      case 'utf8':\n      case 'utf-8':\n      case undefined:\n        return utf8ToBytes(string).length\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return len * 2\n      case 'hex':\n        return len >>> 1\n      case 'base64':\n        return base64ToBytes(string).length\n      default:\n        if (loweredCase) return utf8ToBytes(string).length // assume utf8\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\nBuffer.byteLength = byteLength\n\nfunction slowToString (encoding, start, end) {\n  var loweredCase = false\n\n  // No need to verify that \"this.length <= MAX_UINT32\" since it's a read-only\n  // property of a typed array.\n\n  // This behaves neither like String nor Uint8Array in that we set start/end\n  // to their upper/lower bounds if the value passed is out of range.\n  // undefined is handled specially as per ECMA-262 6th Edition,\n  // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.\n  if (start === undefined || start < 0) {\n    start = 0\n  }\n  // Return early if start > this.length. Done here to prevent potential uint32\n  // coercion fail below.\n  if (start > this.length) {\n    return ''\n  }\n\n  if (end === undefined || end > this.length) {\n    end = this.length\n  }\n\n  if (end <= 0) {\n    return ''\n  }\n\n  // Force coersion to uint32. This will also coerce falsey/NaN values to 0.\n  end >>>= 0\n  start >>>= 0\n\n  if (end <= start) {\n    return ''\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  while (true) {\n    switch (encoding) {\n      case 'hex':\n        return hexSlice(this, start, end)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Slice(this, start, end)\n\n      case 'ascii':\n        return asciiSlice(this, start, end)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Slice(this, start, end)\n\n      case 'base64':\n        return base64Slice(this, start, end)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return utf16leSlice(this, start, end)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = (encoding + '').toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\n// The property is used by `Buffer.isBuffer` and `is-buffer` (in Safari 5-7) to detect\n// Buffer instances.\nBuffer.prototype._isBuffer = true\n\nfunction swap (b, n, m) {\n  var i = b[n]\n  b[n] = b[m]\n  b[m] = i\n}\n\nBuffer.prototype.swap16 = function swap16 () {\n  var len = this.length\n  if (len % 2 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 16-bits')\n  }\n  for (var i = 0; i < len; i += 2) {\n    swap(this, i, i + 1)\n  }\n  return this\n}\n\nBuffer.prototype.swap32 = function swap32 () {\n  var len = this.length\n  if (len % 4 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 32-bits')\n  }\n  for (var i = 0; i < len; i += 4) {\n    swap(this, i, i + 3)\n    swap(this, i + 1, i + 2)\n  }\n  return this\n}\n\nBuffer.prototype.swap64 = function swap64 () {\n  var len = this.length\n  if (len % 8 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 64-bits')\n  }\n  for (var i = 0; i < len; i += 8) {\n    swap(this, i, i + 7)\n    swap(this, i + 1, i + 6)\n    swap(this, i + 2, i + 5)\n    swap(this, i + 3, i + 4)\n  }\n  return this\n}\n\nBuffer.prototype.toString = function toString () {\n  var length = this.length | 0\n  if (length === 0) return ''\n  if (arguments.length === 0) return utf8Slice(this, 0, length)\n  return slowToString.apply(this, arguments)\n}\n\nBuffer.prototype.equals = function equals (b) {\n  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')\n  if (this === b) return true\n  return Buffer.compare(this, b) === 0\n}\n\nBuffer.prototype.inspect = function inspect () {\n  var str = ''\n  var max = exports.INSPECT_MAX_BYTES\n  if (this.length > 0) {\n    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')\n    if (this.length > max) str += ' ... '\n  }\n  return '<Buffer ' + str + '>'\n}\n\nBuffer.prototype.compare = function compare (target, start, end, thisStart, thisEnd) {\n  if (!Buffer.isBuffer(target)) {\n    throw new TypeError('Argument must be a Buffer')\n  }\n\n  if (start === undefined) {\n    start = 0\n  }\n  if (end === undefined) {\n    end = target ? target.length : 0\n  }\n  if (thisStart === undefined) {\n    thisStart = 0\n  }\n  if (thisEnd === undefined) {\n    thisEnd = this.length\n  }\n\n  if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {\n    throw new RangeError('out of range index')\n  }\n\n  if (thisStart >= thisEnd && start >= end) {\n    return 0\n  }\n  if (thisStart >= thisEnd) {\n    return -1\n  }\n  if (start >= end) {\n    return 1\n  }\n\n  start >>>= 0\n  end >>>= 0\n  thisStart >>>= 0\n  thisEnd >>>= 0\n\n  if (this === target) return 0\n\n  var x = thisEnd - thisStart\n  var y = end - start\n  var len = Math.min(x, y)\n\n  var thisCopy = this.slice(thisStart, thisEnd)\n  var targetCopy = target.slice(start, end)\n\n  for (var i = 0; i < len; ++i) {\n    if (thisCopy[i] !== targetCopy[i]) {\n      x = thisCopy[i]\n      y = targetCopy[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\n// Finds either the first index of `val` in `buffer` at offset >= `byteOffset`,\n// OR the last index of `val` in `buffer` at offset <= `byteOffset`.\n//\n// Arguments:\n// - buffer - a Buffer to search\n// - val - a string, Buffer, or number\n// - byteOffset - an index into `buffer`; will be clamped to an int32\n// - encoding - an optional encoding, relevant is val is a string\n// - dir - true for indexOf, false for lastIndexOf\nfunction bidirectionalIndexOf (buffer, val, byteOffset, encoding, dir) {\n  // Empty buffer means no match\n  if (buffer.length === 0) return -1\n\n  // Normalize byteOffset\n  if (typeof byteOffset === 'string') {\n    encoding = byteOffset\n    byteOffset = 0\n  } else if (byteOffset > 0x7fffffff) {\n    byteOffset = 0x7fffffff\n  } else if (byteOffset < -0x80000000) {\n    byteOffset = -0x80000000\n  }\n  byteOffset = +byteOffset  // Coerce to Number.\n  if (isNaN(byteOffset)) {\n    // byteOffset: it it's undefined, null, NaN, \"foo\", etc, search whole buffer\n    byteOffset = dir ? 0 : (buffer.length - 1)\n  }\n\n  // Normalize byteOffset: negative offsets start from the end of the buffer\n  if (byteOffset < 0) byteOffset = buffer.length + byteOffset\n  if (byteOffset >= buffer.length) {\n    if (dir) return -1\n    else byteOffset = buffer.length - 1\n  } else if (byteOffset < 0) {\n    if (dir) byteOffset = 0\n    else return -1\n  }\n\n  // Normalize val\n  if (typeof val === 'string') {\n    val = Buffer.from(val, encoding)\n  }\n\n  // Finally, search either indexOf (if dir is true) or lastIndexOf\n  if (Buffer.isBuffer(val)) {\n    // Special case: looking for empty string/buffer always fails\n    if (val.length === 0) {\n      return -1\n    }\n    return arrayIndexOf(buffer, val, byteOffset, encoding, dir)\n  } else if (typeof val === 'number') {\n    val = val & 0xFF // Search for a byte value [0-255]\n    if (Buffer.TYPED_ARRAY_SUPPORT &&\n        typeof Uint8Array.prototype.indexOf === 'function') {\n      if (dir) {\n        return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset)\n      } else {\n        return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset)\n      }\n    }\n    return arrayIndexOf(buffer, [ val ], byteOffset, encoding, dir)\n  }\n\n  throw new TypeError('val must be string, number or Buffer')\n}\n\nfunction arrayIndexOf (arr, val, byteOffset, encoding, dir) {\n  var indexSize = 1\n  var arrLength = arr.length\n  var valLength = val.length\n\n  if (encoding !== undefined) {\n    encoding = String(encoding).toLowerCase()\n    if (encoding === 'ucs2' || encoding === 'ucs-2' ||\n        encoding === 'utf16le' || encoding === 'utf-16le') {\n      if (arr.length < 2 || val.length < 2) {\n        return -1\n      }\n      indexSize = 2\n      arrLength /= 2\n      valLength /= 2\n      byteOffset /= 2\n    }\n  }\n\n  function read (buf, i) {\n    if (indexSize === 1) {\n      return buf[i]\n    } else {\n      return buf.readUInt16BE(i * indexSize)\n    }\n  }\n\n  var i\n  if (dir) {\n    var foundIndex = -1\n    for (i = byteOffset; i < arrLength; i++) {\n      if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {\n        if (foundIndex === -1) foundIndex = i\n        if (i - foundIndex + 1 === valLength) return foundIndex * indexSize\n      } else {\n        if (foundIndex !== -1) i -= i - foundIndex\n        foundIndex = -1\n      }\n    }\n  } else {\n    if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength\n    for (i = byteOffset; i >= 0; i--) {\n      var found = true\n      for (var j = 0; j < valLength; j++) {\n        if (read(arr, i + j) !== read(val, j)) {\n          found = false\n          break\n        }\n      }\n      if (found) return i\n    }\n  }\n\n  return -1\n}\n\nBuffer.prototype.includes = function includes (val, byteOffset, encoding) {\n  return this.indexOf(val, byteOffset, encoding) !== -1\n}\n\nBuffer.prototype.indexOf = function indexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, true)\n}\n\nBuffer.prototype.lastIndexOf = function lastIndexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, false)\n}\n\nfunction hexWrite (buf, string, offset, length) {\n  offset = Number(offset) || 0\n  var remaining = buf.length - offset\n  if (!length) {\n    length = remaining\n  } else {\n    length = Number(length)\n    if (length > remaining) {\n      length = remaining\n    }\n  }\n\n  // must be an even number of digits\n  var strLen = string.length\n  if (strLen % 2 !== 0) throw new TypeError('Invalid hex string')\n\n  if (length > strLen / 2) {\n    length = strLen / 2\n  }\n  for (var i = 0; i < length; ++i) {\n    var parsed = parseInt(string.substr(i * 2, 2), 16)\n    if (isNaN(parsed)) return i\n    buf[offset + i] = parsed\n  }\n  return i\n}\n\nfunction utf8Write (buf, string, offset, length) {\n  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nfunction asciiWrite (buf, string, offset, length) {\n  return blitBuffer(asciiToBytes(string), buf, offset, length)\n}\n\nfunction latin1Write (buf, string, offset, length) {\n  return asciiWrite(buf, string, offset, length)\n}\n\nfunction base64Write (buf, string, offset, length) {\n  return blitBuffer(base64ToBytes(string), buf, offset, length)\n}\n\nfunction ucs2Write (buf, string, offset, length) {\n  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nBuffer.prototype.write = function write (string, offset, length, encoding) {\n  // Buffer#write(string)\n  if (offset === undefined) {\n    encoding = 'utf8'\n    length = this.length\n    offset = 0\n  // Buffer#write(string, encoding)\n  } else if (length === undefined && typeof offset === 'string') {\n    encoding = offset\n    length = this.length\n    offset = 0\n  // Buffer#write(string, offset[, length][, encoding])\n  } else if (isFinite(offset)) {\n    offset = offset | 0\n    if (isFinite(length)) {\n      length = length | 0\n      if (encoding === undefined) encoding = 'utf8'\n    } else {\n      encoding = length\n      length = undefined\n    }\n  // legacy write(string, encoding, offset, length) - remove in v0.13\n  } else {\n    throw new Error(\n      'Buffer.write(string, encoding, offset[, length]) is no longer supported'\n    )\n  }\n\n  var remaining = this.length - offset\n  if (length === undefined || length > remaining) length = remaining\n\n  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {\n    throw new RangeError('Attempt to write outside buffer bounds')\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'hex':\n        return hexWrite(this, string, offset, length)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Write(this, string, offset, length)\n\n      case 'ascii':\n        return asciiWrite(this, string, offset, length)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Write(this, string, offset, length)\n\n      case 'base64':\n        // Warning: maxLength not taken into account in base64Write\n        return base64Write(this, string, offset, length)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return ucs2Write(this, string, offset, length)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\nBuffer.prototype.toJSON = function toJSON () {\n  return {\n    type: 'Buffer',\n    data: Array.prototype.slice.call(this._arr || this, 0)\n  }\n}\n\nfunction base64Slice (buf, start, end) {\n  if (start === 0 && end === buf.length) {\n    return base64.fromByteArray(buf)\n  } else {\n    return base64.fromByteArray(buf.slice(start, end))\n  }\n}\n\nfunction utf8Slice (buf, start, end) {\n  end = Math.min(buf.length, end)\n  var res = []\n\n  var i = start\n  while (i < end) {\n    var firstByte = buf[i]\n    var codePoint = null\n    var bytesPerSequence = (firstByte > 0xEF) ? 4\n      : (firstByte > 0xDF) ? 3\n      : (firstByte > 0xBF) ? 2\n      : 1\n\n    if (i + bytesPerSequence <= end) {\n      var secondByte, thirdByte, fourthByte, tempCodePoint\n\n      switch (bytesPerSequence) {\n        case 1:\n          if (firstByte < 0x80) {\n            codePoint = firstByte\n          }\n          break\n        case 2:\n          secondByte = buf[i + 1]\n          if ((secondByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)\n            if (tempCodePoint > 0x7F) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 3:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)\n            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 4:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          fourthByte = buf[i + 3]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)\n            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {\n              codePoint = tempCodePoint\n            }\n          }\n      }\n    }\n\n    if (codePoint === null) {\n      // we did not generate a valid codePoint so insert a\n      // replacement char (U+FFFD) and advance only 1 byte\n      codePoint = 0xFFFD\n      bytesPerSequence = 1\n    } else if (codePoint > 0xFFFF) {\n      // encode to utf16 (surrogate pair dance)\n      codePoint -= 0x10000\n      res.push(codePoint >>> 10 & 0x3FF | 0xD800)\n      codePoint = 0xDC00 | codePoint & 0x3FF\n    }\n\n    res.push(codePoint)\n    i += bytesPerSequence\n  }\n\n  return decodeCodePointsArray(res)\n}\n\n// Based on http://stackoverflow.com/a/22747272/680742, the browser with\n// the lowest limit is Chrome, with 0x10000 args.\n// We go 1 magnitude less, for safety\nvar MAX_ARGUMENTS_LENGTH = 0x1000\n\nfunction decodeCodePointsArray (codePoints) {\n  var len = codePoints.length\n  if (len <= MAX_ARGUMENTS_LENGTH) {\n    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()\n  }\n\n  // Decode in chunks to avoid \"call stack size exceeded\".\n  var res = ''\n  var i = 0\n  while (i < len) {\n    res += String.fromCharCode.apply(\n      String,\n      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)\n    )\n  }\n  return res\n}\n\nfunction asciiSlice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i] & 0x7F)\n  }\n  return ret\n}\n\nfunction latin1Slice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i])\n  }\n  return ret\n}\n\nfunction hexSlice (buf, start, end) {\n  var len = buf.length\n\n  if (!start || start < 0) start = 0\n  if (!end || end < 0 || end > len) end = len\n\n  var out = ''\n  for (var i = start; i < end; ++i) {\n    out += toHex(buf[i])\n  }\n  return out\n}\n\nfunction utf16leSlice (buf, start, end) {\n  var bytes = buf.slice(start, end)\n  var res = ''\n  for (var i = 0; i < bytes.length; i += 2) {\n    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)\n  }\n  return res\n}\n\nBuffer.prototype.slice = function slice (start, end) {\n  var len = this.length\n  start = ~~start\n  end = end === undefined ? len : ~~end\n\n  if (start < 0) {\n    start += len\n    if (start < 0) start = 0\n  } else if (start > len) {\n    start = len\n  }\n\n  if (end < 0) {\n    end += len\n    if (end < 0) end = 0\n  } else if (end > len) {\n    end = len\n  }\n\n  if (end < start) end = start\n\n  var newBuf\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    newBuf = this.subarray(start, end)\n    newBuf.__proto__ = Buffer.prototype\n  } else {\n    var sliceLen = end - start\n    newBuf = new Buffer(sliceLen, undefined)\n    for (var i = 0; i < sliceLen; ++i) {\n      newBuf[i] = this[i + start]\n    }\n  }\n\n  return newBuf\n}\n\n/*\n * Need to make sure that buffer isn't trying to write out of bounds.\n */\nfunction checkOffset (offset, ext, length) {\n  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')\n  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')\n}\n\nBuffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    checkOffset(offset, byteLength, this.length)\n  }\n\n  var val = this[offset + --byteLength]\n  var mul = 1\n  while (byteLength > 0 && (mul *= 0x100)) {\n    val += this[offset + --byteLength] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  return this[offset]\n}\n\nBuffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return this[offset] | (this[offset + 1] << 8)\n}\n\nBuffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return (this[offset] << 8) | this[offset + 1]\n}\n\nBuffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return ((this[offset]) |\n      (this[offset + 1] << 8) |\n      (this[offset + 2] << 16)) +\n      (this[offset + 3] * 0x1000000)\n}\n\nBuffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] * 0x1000000) +\n    ((this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    this[offset + 3])\n}\n\nBuffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var i = byteLength\n  var mul = 1\n  var val = this[offset + --i]\n  while (i > 0 && (mul *= 0x100)) {\n    val += this[offset + --i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readInt8 = function readInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  if (!(this[offset] & 0x80)) return (this[offset])\n  return ((0xff - this[offset] + 1) * -1)\n}\n\nBuffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset] | (this[offset + 1] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset + 1] | (this[offset] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset]) |\n    (this[offset + 1] << 8) |\n    (this[offset + 2] << 16) |\n    (this[offset + 3] << 24)\n}\n\nBuffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] << 24) |\n    (this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    (this[offset + 3])\n}\n\nBuffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, true, 23, 4)\n}\n\nBuffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, false, 23, 4)\n}\n\nBuffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, true, 52, 8)\n}\n\nBuffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, false, 52, 8)\n}\n\nfunction checkInt (buf, value, offset, ext, max, min) {\n  if (!Buffer.isBuffer(buf)) throw new TypeError('\"buffer\" argument must be a Buffer instance')\n  if (value > max || value < min) throw new RangeError('\"value\" argument is out of bounds')\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n}\n\nBuffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var mul = 1\n  var i = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nfunction objectWriteUInt16 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; ++i) {\n    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>\n      (littleEndian ? i : 1 - i) * 8\n  }\n}\n\nBuffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nfunction objectWriteUInt32 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffffffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; ++i) {\n    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff\n  }\n}\n\nBuffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset + 3] = (value >>> 24)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 1] = (value >>> 8)\n    this[offset] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = 0\n  var mul = 1\n  var sub = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  var sub = 0\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  if (value < 0) value = 0xff + value + 1\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nBuffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 3] = (value >>> 24)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (value < 0) value = 0xffffffff + value + 1\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nfunction checkIEEE754 (buf, value, offset, ext, max, min) {\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n  if (offset < 0) throw new RangeError('Index out of range')\n}\n\nfunction writeFloat (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 23, 4)\n  return offset + 4\n}\n\nBuffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, false, noAssert)\n}\n\nfunction writeDouble (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 52, 8)\n  return offset + 8\n}\n\nBuffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, false, noAssert)\n}\n\n// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)\nBuffer.prototype.copy = function copy (target, targetStart, start, end) {\n  if (!start) start = 0\n  if (!end && end !== 0) end = this.length\n  if (targetStart >= target.length) targetStart = target.length\n  if (!targetStart) targetStart = 0\n  if (end > 0 && end < start) end = start\n\n  // Copy 0 bytes; we're done\n  if (end === start) return 0\n  if (target.length === 0 || this.length === 0) return 0\n\n  // Fatal error conditions\n  if (targetStart < 0) {\n    throw new RangeError('targetStart out of bounds')\n  }\n  if (start < 0 || start >= this.length) throw new RangeError('sourceStart out of bounds')\n  if (end < 0) throw new RangeError('sourceEnd out of bounds')\n\n  // Are we oob?\n  if (end > this.length) end = this.length\n  if (target.length - targetStart < end - start) {\n    end = target.length - targetStart + start\n  }\n\n  var len = end - start\n  var i\n\n  if (this === target && start < targetStart && targetStart < end) {\n    // descending copy from end\n    for (i = len - 1; i >= 0; --i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else if (len < 1000 || !Buffer.TYPED_ARRAY_SUPPORT) {\n    // ascending copy from start\n    for (i = 0; i < len; ++i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else {\n    Uint8Array.prototype.set.call(\n      target,\n      this.subarray(start, start + len),\n      targetStart\n    )\n  }\n\n  return len\n}\n\n// Usage:\n//    buffer.fill(number[, offset[, end]])\n//    buffer.fill(buffer[, offset[, end]])\n//    buffer.fill(string[, offset[, end]][, encoding])\nBuffer.prototype.fill = function fill (val, start, end, encoding) {\n  // Handle string cases:\n  if (typeof val === 'string') {\n    if (typeof start === 'string') {\n      encoding = start\n      start = 0\n      end = this.length\n    } else if (typeof end === 'string') {\n      encoding = end\n      end = this.length\n    }\n    if (val.length === 1) {\n      var code = val.charCodeAt(0)\n      if (code < 256) {\n        val = code\n      }\n    }\n    if (encoding !== undefined && typeof encoding !== 'string') {\n      throw new TypeError('encoding must be a string')\n    }\n    if (typeof encoding === 'string' && !Buffer.isEncoding(encoding)) {\n      throw new TypeError('Unknown encoding: ' + encoding)\n    }\n  } else if (typeof val === 'number') {\n    val = val & 255\n  }\n\n  // Invalid ranges are not set to a default, so can range check early.\n  if (start < 0 || this.length < start || this.length < end) {\n    throw new RangeError('Out of range index')\n  }\n\n  if (end <= start) {\n    return this\n  }\n\n  start = start >>> 0\n  end = end === undefined ? this.length : end >>> 0\n\n  if (!val) val = 0\n\n  var i\n  if (typeof val === 'number') {\n    for (i = start; i < end; ++i) {\n      this[i] = val\n    }\n  } else {\n    var bytes = Buffer.isBuffer(val)\n      ? val\n      : utf8ToBytes(new Buffer(val, encoding).toString())\n    var len = bytes.length\n    for (i = 0; i < end - start; ++i) {\n      this[i + start] = bytes[i % len]\n    }\n  }\n\n  return this\n}\n\n// HELPER FUNCTIONS\n// ================\n\nvar INVALID_BASE64_RE = /[^+\\/0-9A-Za-z-_]/g\n\nfunction base64clean (str) {\n  // Node strips out invalid characters like \\n and \\t from the string, base64-js does not\n  str = stringtrim(str).replace(INVALID_BASE64_RE, '')\n  // Node converts strings with length < 2 to ''\n  if (str.length < 2) return ''\n  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not\n  while (str.length % 4 !== 0) {\n    str = str + '='\n  }\n  return str\n}\n\nfunction stringtrim (str) {\n  if (str.trim) return str.trim()\n  return str.replace(/^\\s+|\\s+$/g, '')\n}\n\nfunction toHex (n) {\n  if (n < 16) return '0' + n.toString(16)\n  return n.toString(16)\n}\n\nfunction utf8ToBytes (string, units) {\n  units = units || Infinity\n  var codePoint\n  var length = string.length\n  var leadSurrogate = null\n  var bytes = []\n\n  for (var i = 0; i < length; ++i) {\n    codePoint = string.charCodeAt(i)\n\n    // is surrogate component\n    if (codePoint > 0xD7FF && codePoint < 0xE000) {\n      // last char was a lead\n      if (!leadSurrogate) {\n        // no lead yet\n        if (codePoint > 0xDBFF) {\n          // unexpected trail\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        } else if (i + 1 === length) {\n          // unpaired lead\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        }\n\n        // valid lead\n        leadSurrogate = codePoint\n\n        continue\n      }\n\n      // 2 leads in a row\n      if (codePoint < 0xDC00) {\n        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n        leadSurrogate = codePoint\n        continue\n      }\n\n      // valid surrogate pair\n      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000\n    } else if (leadSurrogate) {\n      // valid bmp char, but last char was a lead\n      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n    }\n\n    leadSurrogate = null\n\n    // encode utf8\n    if (codePoint < 0x80) {\n      if ((units -= 1) < 0) break\n      bytes.push(codePoint)\n    } else if (codePoint < 0x800) {\n      if ((units -= 2) < 0) break\n      bytes.push(\n        codePoint >> 0x6 | 0xC0,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x10000) {\n      if ((units -= 3) < 0) break\n      bytes.push(\n        codePoint >> 0xC | 0xE0,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x110000) {\n      if ((units -= 4) < 0) break\n      bytes.push(\n        codePoint >> 0x12 | 0xF0,\n        codePoint >> 0xC & 0x3F | 0x80,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else {\n      throw new Error('Invalid code point')\n    }\n  }\n\n  return bytes\n}\n\nfunction asciiToBytes (str) {\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    // Node's code seems to be doing this and not & 0x7F..\n    byteArray.push(str.charCodeAt(i) & 0xFF)\n  }\n  return byteArray\n}\n\nfunction utf16leToBytes (str, units) {\n  var c, hi, lo\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    if ((units -= 2) < 0) break\n\n    c = str.charCodeAt(i)\n    hi = c >> 8\n    lo = c % 256\n    byteArray.push(lo)\n    byteArray.push(hi)\n  }\n\n  return byteArray\n}\n\nfunction base64ToBytes (str) {\n  return base64.toByteArray(base64clean(str))\n}\n\nfunction blitBuffer (src, dst, offset, length) {\n  for (var i = 0; i < length; ++i) {\n    if ((i + offset >= dst.length) || (i >= src.length)) break\n    dst[i + offset] = src[i]\n  }\n  return i\n}\n\nfunction isnan (val) {\n  return val !== val // eslint-disable-line no-self-compare\n}\n","'use strict'\n\nexports.byteLength = byteLength\nexports.toByteArray = toByteArray\nexports.fromByteArray = fromByteArray\n\nvar lookup = []\nvar revLookup = []\nvar Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array\n\nvar code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\nfor (var i = 0, len = code.length; i < len; ++i) {\n  lookup[i] = code[i]\n  revLookup[code.charCodeAt(i)] = i\n}\n\n// Support decoding URL-safe base64 strings, as Node.js does.\n// See: https://en.wikipedia.org/wiki/Base64#URL_applications\nrevLookup['-'.charCodeAt(0)] = 62\nrevLookup['_'.charCodeAt(0)] = 63\n\nfunction getLens (b64) {\n  var len = b64.length\n\n  if (len % 4 > 0) {\n    throw new Error('Invalid string. Length must be a multiple of 4')\n  }\n\n  // Trim off extra bytes after placeholder bytes are found\n  // See: https://github.com/beatgammit/base64-js/issues/42\n  var validLen = b64.indexOf('=')\n  if (validLen === -1) validLen = len\n\n  var placeHoldersLen = validLen === len\n    ? 0\n    : 4 - (validLen % 4)\n\n  return [validLen, placeHoldersLen]\n}\n\n// base64 is 4/3 + up to two characters of the original data\nfunction byteLength (b64) {\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction _byteLength (b64, validLen, placeHoldersLen) {\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction toByteArray (b64) {\n  var tmp\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n\n  var arr = new Arr(_byteLength(b64, validLen, placeHoldersLen))\n\n  var curByte = 0\n\n  // if there are placeholders, only get up to the last complete 4 chars\n  var len = placeHoldersLen > 0\n    ? validLen - 4\n    : validLen\n\n  var i\n  for (i = 0; i < len; i += 4) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 18) |\n      (revLookup[b64.charCodeAt(i + 1)] << 12) |\n      (revLookup[b64.charCodeAt(i + 2)] << 6) |\n      revLookup[b64.charCodeAt(i + 3)]\n    arr[curByte++] = (tmp >> 16) & 0xFF\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 2) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 2) |\n      (revLookup[b64.charCodeAt(i + 1)] >> 4)\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 1) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 10) |\n      (revLookup[b64.charCodeAt(i + 1)] << 4) |\n      (revLookup[b64.charCodeAt(i + 2)] >> 2)\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  return arr\n}\n\nfunction tripletToBase64 (num) {\n  return lookup[num >> 18 & 0x3F] +\n    lookup[num >> 12 & 0x3F] +\n    lookup[num >> 6 & 0x3F] +\n    lookup[num & 0x3F]\n}\n\nfunction encodeChunk (uint8, start, end) {\n  var tmp\n  var output = []\n  for (var i = start; i < end; i += 3) {\n    tmp =\n      ((uint8[i] << 16) & 0xFF0000) +\n      ((uint8[i + 1] << 8) & 0xFF00) +\n      (uint8[i + 2] & 0xFF)\n    output.push(tripletToBase64(tmp))\n  }\n  return output.join('')\n}\n\nfunction fromByteArray (uint8) {\n  var tmp\n  var len = uint8.length\n  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes\n  var parts = []\n  var maxChunkLength = 16383 // must be multiple of 3\n\n  // go through the array every three bytes, we'll deal with trailing stuff later\n  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {\n    parts.push(encodeChunk(\n      uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)\n    ))\n  }\n\n  // pad the end with zeros, but make sure to not forget the extra bytes\n  if (extraBytes === 1) {\n    tmp = uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 2] +\n      lookup[(tmp << 4) & 0x3F] +\n      '=='\n    )\n  } else if (extraBytes === 2) {\n    tmp = (uint8[len - 2] << 8) + uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 10] +\n      lookup[(tmp >> 4) & 0x3F] +\n      lookup[(tmp << 2) & 0x3F] +\n      '='\n    )\n  }\n\n  return parts.join('')\n}\n","exports.read = function (buffer, offset, isLE, mLen, nBytes) {\n  var e, m\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var nBits = -7\n  var i = isLE ? (nBytes - 1) : 0\n  var d = isLE ? -1 : 1\n  var s = buffer[offset + i]\n\n  i += d\n\n  e = s & ((1 << (-nBits)) - 1)\n  s >>= (-nBits)\n  nBits += eLen\n  for (; nBits > 0; e = (e * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  m = e & ((1 << (-nBits)) - 1)\n  e >>= (-nBits)\n  nBits += mLen\n  for (; nBits > 0; m = (m * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  if (e === 0) {\n    e = 1 - eBias\n  } else if (e === eMax) {\n    return m ? NaN : ((s ? -1 : 1) * Infinity)\n  } else {\n    m = m + Math.pow(2, mLen)\n    e = e - eBias\n  }\n  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)\n}\n\nexports.write = function (buffer, value, offset, isLE, mLen, nBytes) {\n  var e, m, c\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)\n  var i = isLE ? 0 : (nBytes - 1)\n  var d = isLE ? 1 : -1\n  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0\n\n  value = Math.abs(value)\n\n  if (isNaN(value) || value === Infinity) {\n    m = isNaN(value) ? 1 : 0\n    e = eMax\n  } else {\n    e = Math.floor(Math.log(value) / Math.LN2)\n    if (value * (c = Math.pow(2, -e)) < 1) {\n      e--\n      c *= 2\n    }\n    if (e + eBias >= 1) {\n      value += rt / c\n    } else {\n      value += rt * Math.pow(2, 1 - eBias)\n    }\n    if (value * c >= 2) {\n      e++\n      c /= 2\n    }\n\n    if (e + eBias >= eMax) {\n      m = 0\n      e = eMax\n    } else if (e + eBias >= 1) {\n      m = ((value * c) - 1) * Math.pow(2, mLen)\n      e = e + eBias\n    } else {\n      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)\n      e = 0\n    }\n  }\n\n  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}\n\n  e = (e << mLen) | m\n  eLen += mLen\n  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}\n\n  buffer[offset + i - d] |= s * 128\n}\n","var toString = {}.toString;\n\nmodule.exports = Array.isArray || function (arr) {\n  return toString.call(arr) == '[object Array]';\n};\n","'use strict';\n\n//This code is extracted from ndarray-sort\n//It is inlined here as a temporary workaround\n\nmodule.exports = wrapper;\n\nvar INSERT_SORT_CUTOFF = 32\n\nfunction wrapper(data, n0) {\n  if (n0 <= 4*INSERT_SORT_CUTOFF) {\n    insertionSort(0, n0 - 1, data);\n  } else {\n    quickSort(0, n0 - 1, data);\n  }\n}\n\nfunction insertionSort(left, right, data) {\n  var ptr = 2*(left+1)\n  for(var i=left+1; i<=right; ++i) {\n    var a = data[ptr++]\n    var b = data[ptr++]\n    var j = i\n    var jptr = ptr-2\n    while(j-- > left) {\n      var x = data[jptr-2]\n      var y = data[jptr-1]\n      if(x < a) {\n        break\n      } else if(x === a && y < b) {\n        break\n      }\n      data[jptr]   = x\n      data[jptr+1] = y\n      jptr -= 2\n    }\n    data[jptr]   = a\n    data[jptr+1] = b\n  }\n}\n\nfunction swap(i, j, data) {\n  i *= 2\n  j *= 2\n  var x = data[i]\n  var y = data[i+1]\n  data[i] = data[j]\n  data[i+1] = data[j+1]\n  data[j] = x\n  data[j+1] = y\n}\n\nfunction move(i, j, data) {\n  i *= 2\n  j *= 2\n  data[i] = data[j]\n  data[i+1] = data[j+1]\n}\n\nfunction rotate(i, j, k, data) {\n  i *= 2\n  j *= 2\n  k *= 2\n  var x = data[i]\n  var y = data[i+1]\n  data[i] = data[j]\n  data[i+1] = data[j+1]\n  data[j] = data[k]\n  data[j+1] = data[k+1]\n  data[k] = x\n  data[k+1] = y\n}\n\nfunction shufflePivot(i, j, px, py, data) {\n  i *= 2\n  j *= 2\n  data[i] = data[j]\n  data[j] = px\n  data[i+1] = data[j+1]\n  data[j+1] = py\n}\n\nfunction compare(i, j, data) {\n  i *= 2\n  j *= 2\n  var x = data[i],\n      y = data[j]\n  if(x < y) {\n    return false\n  } else if(x === y) {\n    return data[i+1] > data[j+1]\n  }\n  return true\n}\n\nfunction comparePivot(i, y, b, data) {\n  i *= 2\n  var x = data[i]\n  if(x < y) {\n    return true\n  } else if(x === y) {\n    return data[i+1] < b\n  }\n  return false\n}\n\nfunction quickSort(left, right, data) {\n  var sixth = (right - left + 1) / 6 | 0, \n      index1 = left + sixth, \n      index5 = right - sixth, \n      index3 = left + right >> 1, \n      index2 = index3 - sixth, \n      index4 = index3 + sixth, \n      el1 = index1, \n      el2 = index2, \n      el3 = index3, \n      el4 = index4, \n      el5 = index5, \n      less = left + 1, \n      great = right - 1, \n      tmp = 0\n  if(compare(el1, el2, data)) {\n    tmp = el1\n    el1 = el2\n    el2 = tmp\n  }\n  if(compare(el4, el5, data)) {\n    tmp = el4\n    el4 = el5\n    el5 = tmp\n  }\n  if(compare(el1, el3, data)) {\n    tmp = el1\n    el1 = el3\n    el3 = tmp\n  }\n  if(compare(el2, el3, data)) {\n    tmp = el2\n    el2 = el3\n    el3 = tmp\n  }\n  if(compare(el1, el4, data)) {\n    tmp = el1\n    el1 = el4\n    el4 = tmp\n  }\n  if(compare(el3, el4, data)) {\n    tmp = el3\n    el3 = el4\n    el4 = tmp\n  }\n  if(compare(el2, el5, data)) {\n    tmp = el2\n    el2 = el5\n    el5 = tmp\n  }\n  if(compare(el2, el3, data)) {\n    tmp = el2\n    el2 = el3\n    el3 = tmp\n  }\n  if(compare(el4, el5, data)) {\n    tmp = el4\n    el4 = el5\n    el5 = tmp\n  }\n\n  var pivot1X = data[2*el2]\n  var pivot1Y = data[2*el2+1]\n  var pivot2X = data[2*el4]\n  var pivot2Y = data[2*el4+1]\n\n  var ptr0 = 2 * el1;\n  var ptr2 = 2 * el3;\n  var ptr4 = 2 * el5;\n  var ptr5 = 2 * index1;\n  var ptr6 = 2 * index3;\n  var ptr7 = 2 * index5;\n  for (var i1 = 0; i1 < 2; ++i1) {\n    var x = data[ptr0+i1];\n    var y = data[ptr2+i1];\n    var z = data[ptr4+i1];\n    data[ptr5+i1] = x;\n    data[ptr6+i1] = y;\n    data[ptr7+i1] = z;\n  }\n\n  move(index2, left, data)\n  move(index4, right, data)\n  for (var k = less; k <= great; ++k) {\n    if (comparePivot(k, pivot1X, pivot1Y, data)) {\n      if (k !== less) {\n        swap(k, less, data)\n      }\n      ++less;\n    } else {\n      if (!comparePivot(k, pivot2X, pivot2Y, data)) {\n        while (true) {\n          if (!comparePivot(great, pivot2X, pivot2Y, data)) {\n            if (--great < k) {\n              break;\n            }\n            continue;\n          } else {\n            if (comparePivot(great, pivot1X, pivot1Y, data)) {\n              rotate(k, less, great, data)\n              ++less;\n              --great;\n            } else {\n              swap(k, great, data)\n              --great;\n            }\n            break;\n          }\n        }\n      }\n    }\n  }\n  shufflePivot(left, less-1, pivot1X, pivot1Y, data)\n  shufflePivot(right, great+1, pivot2X, pivot2Y, data)\n  if (less - 2 - left <= INSERT_SORT_CUTOFF) {\n    insertionSort(left, less - 2, data);\n  } else {\n    quickSort(left, less - 2, data);\n  }\n  if (right - (great + 2) <= INSERT_SORT_CUTOFF) {\n    insertionSort(great + 2, right, data);\n  } else {\n    quickSort(great + 2, right, data);\n  }\n  if (great - less <= INSERT_SORT_CUTOFF) {\n    insertionSort(less, great, data);\n  } else {\n    quickSort(less, great, data);\n  }\n}","'use strict'\n\nmodule.exports = boxIntersectIter\n\nvar pool = require('typedarray-pool')\nvar bits = require('bit-twiddle')\nvar bruteForce = require('./brute')\nvar bruteForcePartial = bruteForce.partial\nvar bruteForceFull = bruteForce.full\nvar sweep = require('./sweep')\nvar findMedian = require('./median')\nvar genPartition = require('./partition')\n\n//Twiddle parameters\nvar BRUTE_FORCE_CUTOFF    = 128       //Cut off for brute force search\nvar SCAN_CUTOFF           = (1<<22)   //Cut off for two way scan\nvar SCAN_COMPLETE_CUTOFF  = (1<<22)  \n\n//Partition functions\nvar partitionInteriorContainsInterval = genPartition(\n  '!(lo>=p0)&&!(p1>=hi)', \n  ['p0', 'p1'])\n\nvar partitionStartEqual = genPartition(\n  'lo===p0',\n  ['p0'])\n\nvar partitionStartLessThan = genPartition(\n  'lo<p0',\n  ['p0'])\n\nvar partitionEndLessThanEqual = genPartition(\n  'hi<=p0',\n  ['p0'])\n\nvar partitionContainsPoint = genPartition(\n  'lo<=p0&&p0<=hi',\n  ['p0'])\n\nvar partitionContainsPointProper = genPartition(\n  'lo<p0&&p0<=hi',\n  ['p0'])\n\n//Frame size for iterative loop\nvar IFRAME_SIZE = 6\nvar DFRAME_SIZE = 2\n\n//Data for box statck\nvar INIT_CAPACITY = 1024\nvar BOX_ISTACK  = pool.mallocInt32(INIT_CAPACITY)\nvar BOX_DSTACK  = pool.mallocDouble(INIT_CAPACITY)\n\n//Initialize iterative loop queue\nfunction iterInit(d, count) {\n  var levels = (8 * bits.log2(count+1) * (d+1))|0\n  var maxInts = bits.nextPow2(IFRAME_SIZE*levels)\n  if(BOX_ISTACK.length < maxInts) {\n    pool.free(BOX_ISTACK)\n    BOX_ISTACK = pool.mallocInt32(maxInts)\n  }\n  var maxDoubles = bits.nextPow2(DFRAME_SIZE*levels)\n  if(BOX_DSTACK.length < maxDoubles) {\n    pool.free(BOX_DSTACK)\n    BOX_DSTACK = pool.mallocDouble(maxDoubles)\n  }\n}\n\n//Append item to queue\nfunction iterPush(ptr,\n  axis, \n  redStart, redEnd, \n  blueStart, blueEnd, \n  state, \n  lo, hi) {\n\n  var iptr = IFRAME_SIZE * ptr\n  BOX_ISTACK[iptr]   = axis\n  BOX_ISTACK[iptr+1] = redStart\n  BOX_ISTACK[iptr+2] = redEnd\n  BOX_ISTACK[iptr+3] = blueStart\n  BOX_ISTACK[iptr+4] = blueEnd\n  BOX_ISTACK[iptr+5] = state\n\n  var dptr = DFRAME_SIZE * ptr\n  BOX_DSTACK[dptr]   = lo\n  BOX_DSTACK[dptr+1] = hi\n}\n\n//Special case:  Intersect single point with list of intervals\nfunction onePointPartial(\n  d, axis, visit, flip,\n  redStart, redEnd, red, redIndex,\n  blueOffset, blue, blueId) {\n\n  var elemSize = 2 * d\n  var bluePtr  = blueOffset * elemSize\n  var blueX    = blue[bluePtr + axis]\n\nred_loop:\n  for(var i=redStart, redPtr=redStart*elemSize; i<redEnd; ++i, redPtr+=elemSize) {\n    var r0 = red[redPtr+axis]\n    var r1 = red[redPtr+axis+d]\n    if(blueX < r0 || r1 < blueX) {\n      continue\n    }\n    if(flip && blueX === r0) {\n      continue\n    }\n    var redId = redIndex[i]\n    for(var j=axis+1; j<d; ++j) {\n      var r0 = red[redPtr+j]\n      var r1 = red[redPtr+j+d]\n      var b0 = blue[bluePtr+j]\n      var b1 = blue[bluePtr+j+d]\n      if(r1 < b0 || b1 < r0) {\n        continue red_loop\n      }\n    }\n    var retval\n    if(flip) {\n      retval = visit(blueId, redId)\n    } else {\n      retval = visit(redId, blueId)\n    }\n    if(retval !== void 0) {\n      return retval\n    }\n  }\n}\n\n//Special case:  Intersect one point with list of intervals\nfunction onePointFull(\n  d, axis, visit,\n  redStart, redEnd, red, redIndex,\n  blueOffset, blue, blueId) {\n\n  var elemSize = 2 * d\n  var bluePtr  = blueOffset * elemSize\n  var blueX    = blue[bluePtr + axis]\n\nred_loop:\n  for(var i=redStart, redPtr=redStart*elemSize; i<redEnd; ++i, redPtr+=elemSize) {\n    var redId = redIndex[i]\n    if(redId === blueId) {\n      continue\n    }\n    var r0 = red[redPtr+axis]\n    var r1 = red[redPtr+axis+d]\n    if(blueX < r0 || r1 < blueX) {\n      continue\n    }\n    for(var j=axis+1; j<d; ++j) {\n      var r0 = red[redPtr+j]\n      var r1 = red[redPtr+j+d]\n      var b0 = blue[bluePtr+j]\n      var b1 = blue[bluePtr+j+d]\n      if(r1 < b0 || b1 < r0) {\n        continue red_loop\n      }\n    }\n    var retval = visit(redId, blueId)\n    if(retval !== void 0) {\n      return retval\n    }\n  }\n}\n\n//The main box intersection routine\nfunction boxIntersectIter(\n  d, visit, initFull,\n  xSize, xBoxes, xIndex,\n  ySize, yBoxes, yIndex) {\n\n  //Reserve memory for stack\n  iterInit(d, xSize + ySize)\n\n  var top  = 0\n  var elemSize = 2 * d\n  var retval\n\n  iterPush(top++,\n      0,\n      0, xSize,\n      0, ySize,\n      initFull ? 16 : 0, \n      -Infinity, Infinity)\n  if(!initFull) {\n    iterPush(top++,\n      0,\n      0, ySize,\n      0, xSize,\n      1, \n      -Infinity, Infinity)\n  }\n\n  while(top > 0) {\n    top  -= 1\n\n    var iptr = top * IFRAME_SIZE\n    var axis      = BOX_ISTACK[iptr]\n    var redStart  = BOX_ISTACK[iptr+1]\n    var redEnd    = BOX_ISTACK[iptr+2]\n    var blueStart = BOX_ISTACK[iptr+3]\n    var blueEnd   = BOX_ISTACK[iptr+4]\n    var state     = BOX_ISTACK[iptr+5]\n\n    var dptr = top * DFRAME_SIZE\n    var lo        = BOX_DSTACK[dptr]\n    var hi        = BOX_DSTACK[dptr+1]\n\n    //Unpack state info\n    var flip      = (state & 1)\n    var full      = !!(state & 16)\n\n    //Unpack indices\n    var red       = xBoxes\n    var redIndex  = xIndex\n    var blue      = yBoxes\n    var blueIndex = yIndex\n    if(flip) {\n      red         = yBoxes\n      redIndex    = yIndex\n      blue        = xBoxes\n      blueIndex   = xIndex\n    }\n\n    if(state & 2) {\n      redEnd = partitionStartLessThan(\n        d, axis,\n        redStart, redEnd, red, redIndex,\n        hi)\n      if(redStart >= redEnd) {\n        continue\n      }\n    }\n    if(state & 4) {\n      redStart = partitionEndLessThanEqual(\n        d, axis,\n        redStart, redEnd, red, redIndex,\n        lo)\n      if(redStart >= redEnd) {\n        continue\n      }\n    }\n    \n    var redCount  = redEnd  - redStart\n    var blueCount = blueEnd - blueStart\n\n    if(full) {\n      if(d * redCount * (redCount + blueCount) < SCAN_COMPLETE_CUTOFF) {\n        retval = sweep.scanComplete(\n          d, axis, visit, \n          redStart, redEnd, red, redIndex,\n          blueStart, blueEnd, blue, blueIndex)\n        if(retval !== void 0) {\n          return retval\n        }\n        continue\n      }\n    } else {\n      if(d * Math.min(redCount, blueCount) < BRUTE_FORCE_CUTOFF) {\n        //If input small, then use brute force\n        retval = bruteForcePartial(\n            d, axis, visit, flip,\n            redStart,  redEnd,  red,  redIndex,\n            blueStart, blueEnd, blue, blueIndex)\n        if(retval !== void 0) {\n          return retval\n        }\n        continue\n      } else if(d * redCount * blueCount < SCAN_CUTOFF) {\n        //If input medium sized, then use sweep and prune\n        retval = sweep.scanBipartite(\n          d, axis, visit, flip, \n          redStart, redEnd, red, redIndex,\n          blueStart, blueEnd, blue, blueIndex)\n        if(retval !== void 0) {\n          return retval\n        }\n        continue\n      }\n    }\n    \n    //First, find all red intervals whose interior contains (lo,hi)\n    var red0 = partitionInteriorContainsInterval(\n      d, axis, \n      redStart, redEnd, red, redIndex,\n      lo, hi)\n\n    //Lower dimensional case\n    if(redStart < red0) {\n\n      if(d * (red0 - redStart) < BRUTE_FORCE_CUTOFF) {\n        //Special case for small inputs: use brute force\n        retval = bruteForceFull(\n          d, axis+1, visit,\n          redStart, red0, red, redIndex,\n          blueStart, blueEnd, blue, blueIndex)\n        if(retval !== void 0) {\n          return retval\n        }\n      } else if(axis === d-2) {\n        if(flip) {\n          retval = sweep.sweepBipartite(\n            d, visit,\n            blueStart, blueEnd, blue, blueIndex,\n            redStart, red0, red, redIndex)\n        } else {\n          retval = sweep.sweepBipartite(\n            d, visit,\n            redStart, red0, red, redIndex,\n            blueStart, blueEnd, blue, blueIndex)\n        }\n        if(retval !== void 0) {\n          return retval\n        }\n      } else {\n        iterPush(top++,\n          axis+1,\n          redStart, red0,\n          blueStart, blueEnd,\n          flip,\n          -Infinity, Infinity)\n        iterPush(top++,\n          axis+1,\n          blueStart, blueEnd,\n          redStart, red0,\n          flip^1,\n          -Infinity, Infinity)\n      }\n    }\n\n    //Divide and conquer phase\n    if(red0 < redEnd) {\n\n      //Cut blue into 3 parts:\n      //\n      //  Points < mid point\n      //  Points = mid point\n      //  Points > mid point\n      //\n      var blue0 = findMedian(\n        d, axis, \n        blueStart, blueEnd, blue, blueIndex)\n      var mid = blue[elemSize * blue0 + axis]\n      var blue1 = partitionStartEqual(\n        d, axis,\n        blue0, blueEnd, blue, blueIndex,\n        mid)\n\n      //Right case\n      if(blue1 < blueEnd) {\n        iterPush(top++,\n          axis,\n          red0, redEnd,\n          blue1, blueEnd,\n          (flip|4) + (full ? 16 : 0),\n          mid, hi)\n      }\n\n      //Left case\n      if(blueStart < blue0) {\n        iterPush(top++,\n          axis,\n          red0, redEnd,\n          blueStart, blue0,\n          (flip|2) + (full ? 16 : 0),\n          lo, mid)\n      }\n\n      //Center case (the hard part)\n      if(blue0 + 1 === blue1) {\n        //Optimization: Range with exactly 1 point, use a brute force scan\n        if(full) {\n          retval = onePointFull(\n            d, axis, visit,\n            red0, redEnd, red, redIndex,\n            blue0, blue, blueIndex[blue0])\n        } else {\n          retval = onePointPartial(\n            d, axis, visit, flip,\n            red0, redEnd, red, redIndex,\n            blue0, blue, blueIndex[blue0])\n        }\n        if(retval !== void 0) {\n          return retval\n        }\n      } else if(blue0 < blue1) {\n        var red1\n        if(full) {\n          //If full intersection, need to handle special case\n          red1 = partitionContainsPoint(\n            d, axis,\n            red0, redEnd, red, redIndex,\n            mid)\n          if(red0 < red1) {\n            var redX = partitionStartEqual(\n              d, axis,\n              red0, red1, red, redIndex,\n              mid)\n            if(axis === d-2) {\n              //Degenerate sweep intersection:\n              //  [red0, redX] with [blue0, blue1]\n              if(red0 < redX) {\n                retval = sweep.sweepComplete(\n                  d, visit,\n                  red0, redX, red, redIndex,\n                  blue0, blue1, blue, blueIndex)\n                if(retval !== void 0) {\n                  return retval\n                }\n              }\n\n              //Normal sweep intersection:\n              //  [redX, red1] with [blue0, blue1]\n              if(redX < red1) {\n                retval = sweep.sweepBipartite(\n                  d, visit,\n                  redX, red1, red, redIndex,\n                  blue0, blue1, blue, blueIndex)\n                if(retval !== void 0) {\n                  return retval\n                }\n              }\n            } else {\n              if(red0 < redX) {\n                iterPush(top++,\n                  axis+1,\n                  red0, redX,\n                  blue0, blue1,\n                  16,\n                  -Infinity, Infinity)\n              }\n              if(redX < red1) {\n                iterPush(top++,\n                  axis+1,\n                  redX, red1,\n                  blue0, blue1,\n                  0,\n                  -Infinity, Infinity)\n                iterPush(top++,\n                  axis+1,\n                  blue0, blue1,\n                  redX, red1,\n                  1,\n                  -Infinity, Infinity)\n              }\n            }\n          }\n        } else {\n          if(flip) {\n            red1 = partitionContainsPointProper(\n              d, axis,\n              red0, redEnd, red, redIndex,\n              mid)\n          } else {\n            red1 = partitionContainsPoint(\n              d, axis,\n              red0, redEnd, red, redIndex,\n              mid)\n          }\n          if(red0 < red1) {\n            if(axis === d-2) {\n              if(flip) {\n                retval = sweep.sweepBipartite(\n                  d, visit,\n                  blue0, blue1, blue, blueIndex,\n                  red0, red1, red, redIndex)\n              } else {\n                retval = sweep.sweepBipartite(\n                  d, visit,\n                  red0, red1, red, redIndex,\n                  blue0, blue1, blue, blueIndex)\n              }\n            } else {\n              iterPush(top++,\n                axis+1,\n                red0, red1,\n                blue0, blue1,\n                flip,\n                -Infinity, Infinity)\n              iterPush(top++,\n                axis+1,\n                blue0, blue1,\n                red0, red1,\n                flip^1,\n                -Infinity, Infinity)\n            }\n          }\n        }\n      }\n    }\n  }\n}","'use strict'\n\nvar DIMENSION   = 'd'\nvar AXIS        = 'ax'\nvar VISIT       = 'vv'\nvar FLIP        = 'fp'\n\nvar ELEM_SIZE   = 'es'\n\nvar RED_START   = 'rs'\nvar RED_END     = 're'\nvar RED_BOXES   = 'rb'\nvar RED_INDEX   = 'ri'\nvar RED_PTR     = 'rp'\n\nvar BLUE_START  = 'bs'\nvar BLUE_END    = 'be'\nvar BLUE_BOXES  = 'bb'\nvar BLUE_INDEX  = 'bi'\nvar BLUE_PTR    = 'bp'\n\nvar RETVAL      = 'rv'\n\nvar INNER_LABEL = 'Q'\n\nvar ARGS = [\n  DIMENSION,\n  AXIS,\n  VISIT,\n  RED_START,\n  RED_END,\n  RED_BOXES,\n  RED_INDEX,\n  BLUE_START,\n  BLUE_END,\n  BLUE_BOXES,\n  BLUE_INDEX\n]\n\nfunction generateBruteForce(redMajor, flip, full) {\n  var funcName = 'bruteForce' + \n    (redMajor ? 'Red' : 'Blue') + \n    (flip ? 'Flip' : '') +\n    (full ? 'Full' : '')\n\n  var code = ['function ', funcName, '(', ARGS.join(), '){',\n    'var ', ELEM_SIZE, '=2*', DIMENSION, ';']\n\n  var redLoop = \n    'for(var i=' + RED_START + ',' + RED_PTR + '=' + ELEM_SIZE + '*' + RED_START + ';' +\n        'i<' + RED_END +';' +\n        '++i,' + RED_PTR + '+=' + ELEM_SIZE + '){' +\n        'var x0=' + RED_BOXES + '[' + AXIS + '+' + RED_PTR + '],' +\n            'x1=' + RED_BOXES + '[' + AXIS + '+' + RED_PTR + '+' + DIMENSION + '],' +\n            'xi=' + RED_INDEX + '[i];'\n\n  var blueLoop = \n    'for(var j=' + BLUE_START + ',' + BLUE_PTR + '=' + ELEM_SIZE + '*' + BLUE_START + ';' +\n        'j<' + BLUE_END + ';' +\n        '++j,' + BLUE_PTR + '+=' + ELEM_SIZE + '){' +\n        'var y0=' + BLUE_BOXES + '[' + AXIS + '+' + BLUE_PTR + '],' +\n            (full ? 'y1=' + BLUE_BOXES + '[' + AXIS + '+' + BLUE_PTR + '+' + DIMENSION + '],' : '') +\n            'yi=' + BLUE_INDEX + '[j];'\n\n  if(redMajor) {\n    code.push(redLoop, INNER_LABEL, ':', blueLoop)\n  } else {\n    code.push(blueLoop, INNER_LABEL, ':', redLoop)\n  }\n\n  if(full) {\n    code.push('if(y1<x0||x1<y0)continue;')\n  } else if(flip) {\n    code.push('if(y0<=x0||x1<y0)continue;')\n  } else {\n    code.push('if(y0<x0||x1<y0)continue;')\n  }\n\n  code.push('for(var k='+AXIS+'+1;k<'+DIMENSION+';++k){'+\n    'var r0='+RED_BOXES+'[k+'+RED_PTR+'],'+\n        'r1='+RED_BOXES+'[k+'+DIMENSION+'+'+RED_PTR+'],'+\n        'b0='+BLUE_BOXES+'[k+'+BLUE_PTR+'],'+\n        'b1='+BLUE_BOXES+'[k+'+DIMENSION+'+'+BLUE_PTR+'];'+\n      'if(r1<b0||b1<r0)continue ' + INNER_LABEL + ';}' +\n      'var ' + RETVAL + '=' + VISIT + '(')\n\n  if(flip) {\n    code.push('yi,xi')\n  } else {\n    code.push('xi,yi')\n  }\n\n  code.push(');if(' + RETVAL + '!==void 0)return ' + RETVAL + ';}}}')\n\n  return {\n    name: funcName, \n    code: code.join('')\n  }\n}\n\nfunction bruteForcePlanner(full) {\n  var funcName = 'bruteForce' + (full ? 'Full' : 'Partial')\n  var prefix = []\n  var fargs = ARGS.slice()\n  if(!full) {\n    fargs.splice(3, 0, FLIP)\n  }\n\n  var code = ['function ' + funcName + '(' + fargs.join() + '){']\n\n  function invoke(redMajor, flip) {\n    var res = generateBruteForce(redMajor, flip, full)\n    prefix.push(res.code)\n    code.push('return ' + res.name + '(' + ARGS.join() + ');')\n  }\n\n  code.push('if(' + RED_END + '-' + RED_START + '>' +\n                    BLUE_END + '-' + BLUE_START + '){')\n\n  if(full) {\n    invoke(true, false)\n    code.push('}else{')\n    invoke(false, false)\n  } else {\n    code.push('if(' + FLIP + '){')\n    invoke(true, true)\n    code.push('}else{')\n    invoke(true, false)\n    code.push('}}else{if(' + FLIP + '){')\n    invoke(false, true)\n    code.push('}else{')\n    invoke(false, false)\n    code.push('}')\n  }\n  code.push('}}return ' + funcName)\n\n  var codeStr = prefix.join('') + code.join('')\n  var proc = new Function(codeStr)\n  return proc()\n}\n\n\nexports.partial = bruteForcePlanner(false)\nexports.full    = bruteForcePlanner(true)","'use strict'\n\nmodule.exports = findMedian\n\nvar genPartition = require('./partition')\n\nvar partitionStartLessThan = genPartition('lo<p0', ['p0'])\n\nvar PARTITION_THRESHOLD = 8   //Cut off for using insertion sort in findMedian\n\n//Base case for median finding:  Use insertion sort\nfunction insertionSort(d, axis, start, end, boxes, ids) {\n  var elemSize = 2 * d\n  var boxPtr = elemSize * (start+1) + axis\n  for(var i=start+1; i<end; ++i, boxPtr+=elemSize) {\n    var x = boxes[boxPtr]\n    for(var j=i, ptr=elemSize*(i-1); \n        j>start && boxes[ptr+axis] > x; \n        --j, ptr-=elemSize) {\n      //Swap\n      var aPtr = ptr\n      var bPtr = ptr+elemSize\n      for(var k=0; k<elemSize; ++k, ++aPtr, ++bPtr) {\n        var y = boxes[aPtr]\n        boxes[aPtr] = boxes[bPtr]\n        boxes[bPtr] = y\n      }\n      var tmp = ids[j]\n      ids[j] = ids[j-1]\n      ids[j-1] = tmp\n    }\n  }\n}\n\n//Find median using quick select algorithm\n//  takes O(n) time with high probability\nfunction findMedian(d, axis, start, end, boxes, ids) {\n  if(end <= start+1) {\n    return start\n  }\n\n  var lo       = start\n  var hi       = end\n  var mid      = ((end + start) >>> 1)\n  var elemSize = 2*d\n  var pivot    = mid\n  var value    = boxes[elemSize*mid+axis]\n  \n  while(lo < hi) {\n    if(hi - lo < PARTITION_THRESHOLD) {\n      insertionSort(d, axis, lo, hi, boxes, ids)\n      value = boxes[elemSize*mid+axis]\n      break\n    }\n    \n    //Select pivot using median-of-3\n    var count  = hi - lo\n    var pivot0 = (Math.random()*count+lo)|0\n    var value0 = boxes[elemSize*pivot0 + axis]\n    var pivot1 = (Math.random()*count+lo)|0\n    var value1 = boxes[elemSize*pivot1 + axis]\n    var pivot2 = (Math.random()*count+lo)|0\n    var value2 = boxes[elemSize*pivot2 + axis]\n    if(value0 <= value1) {\n      if(value2 >= value1) {\n        pivot = pivot1\n        value = value1\n      } else if(value0 >= value2) {\n        pivot = pivot0\n        value = value0\n      } else {\n        pivot = pivot2\n        value = value2\n      }\n    } else {\n      if(value1 >= value2) {\n        pivot = pivot1\n        value = value1\n      } else if(value2 >= value0) {\n        pivot = pivot0\n        value = value0\n      } else {\n        pivot = pivot2\n        value = value2\n      }\n    }\n\n    //Swap pivot to end of array\n    var aPtr = elemSize * (hi-1)\n    var bPtr = elemSize * pivot\n    for(var i=0; i<elemSize; ++i, ++aPtr, ++bPtr) {\n      var x = boxes[aPtr]\n      boxes[aPtr] = boxes[bPtr]\n      boxes[bPtr] = x\n    }\n    var y = ids[hi-1]\n    ids[hi-1] = ids[pivot]\n    ids[pivot] = y\n\n    //Partition using pivot\n    pivot = partitionStartLessThan(\n      d, axis, \n      lo, hi-1, boxes, ids,\n      value)\n\n    //Swap pivot back\n    var aPtr = elemSize * (hi-1)\n    var bPtr = elemSize * pivot\n    for(var i=0; i<elemSize; ++i, ++aPtr, ++bPtr) {\n      var x = boxes[aPtr]\n      boxes[aPtr] = boxes[bPtr]\n      boxes[bPtr] = x\n    }\n    var y = ids[hi-1]\n    ids[hi-1] = ids[pivot]\n    ids[pivot] = y\n\n    //Swap pivot to last pivot\n    if(mid < pivot) {\n      hi = pivot-1\n      while(lo < hi && \n        boxes[elemSize*(hi-1)+axis] === value) {\n        hi -= 1\n      }\n      hi += 1\n    } else if(pivot < mid) {\n      lo = pivot + 1\n      while(lo < hi &&\n        boxes[elemSize*lo+axis] === value) {\n        lo += 1\n      }\n    } else {\n      break\n    }\n  }\n\n  //Make sure pivot is at start\n  return partitionStartLessThan(\n    d, axis, \n    start, mid, boxes, ids,\n    boxes[elemSize*mid+axis])\n}","\n\nexport default function (noa) {\n    return {\n\n        name: 'collideTerrain',\n\n        order: 0,\n\n        state: {\n            callback: null\n        },\n\n        onAdd: function (eid, state) {\n            // add collide handler for physics engine to call\n            var ents = noa.entities\n            if (ents.hasPhysics(eid)) {\n                var body = ents.getPhysicsBody(eid)\n                body.onCollide = function bodyOnCollide(impulse) {\n                    var cb = noa.ents.getCollideTerrain(eid).callback\n                    if (cb) cb(impulse, eid)\n                }\n            }\n        },\n\n        onRemove: function (eid, state) {\n            var ents = noa.entities\n            if (ents.hasPhysics(eid)) {\n                ents.getPhysicsBody(eid).onCollide = null\n            }\n        },\n\n\n\n    }\n}\n","\n/**\n * Component for the player entity, when active hides the player's mesh \n * when camera zoom is less than a certain amount\n */\n\nexport default function (noa) {\n    return {\n\n        name: 'fadeOnZoom',\n\n        order: 99,\n\n        state: {\n            cutoff: 1.5,\n            _showing: true\n        },\n\n        onAdd: null,\n\n        onRemove: null,\n\n        system: function fadeOnZoomProc(dt, states) {\n            var zoom = noa.camera.currentZoom\n            var ents = noa.entities\n            states.forEach(state => {\n                checkZoom(state, state.__id, zoom, ents)\n            })\n        }\n    }\n}\n\n\nfunction checkZoom(state, id, zoom, ents) {\n    if (!ents.hasMesh(id)) return\n\n    if (state._showing && zoom < state.cutoff || !state._showing && zoom > state.cutoff) {\n        var mesh = ents.getMeshData(id).mesh\n        mesh.visibility = state._showing = (zoom > state.cutoff)\n    }\n}\n","var vec3 = require('gl-vec3')\n\n\n/*\n * Indicates that an entity should be moved to another entity's position each tick,\n * possibly by a fixed offset, and the same for renderPositions each render\n */\n\nexport default function (noa) {\n\n    return {\n\n        name: 'followsEntity',\n\n        order: 50,\n\n        state: {\n            entity: 0 | 0,\n            offset: null,\n        },\n\n        onAdd: function (eid, state) {\n            var off = vec3.create()\n            state.offset = (state.offset) ? vec3.copy(off, state.offset) : off\n            updatePosition(state)\n            updateRenderPosition(state)\n        },\n\n        onRemove: null,\n\n\n        // on tick, copy over regular positions\n        system: function followEntity(dt, states) {\n            states.forEach(state => updatePosition(state))\n        },\n\n\n        // on render, copy over render positions\n        renderSystem: function followEntityMesh(dt, states) {\n            states.forEach(state => updateRenderPosition(state))\n        }\n    }\n\n\n\n    function updatePosition(state) {\n        var id = state.__id\n        var self = noa.ents.getPositionData(id)\n        var other = noa.ents.getPositionData(state.entity)\n        if (!other) {\n            return noa.ents.removeComponent(id, noa.ents.names.followsEntity)\n        }\n        vec3.add(self._localPosition, other._localPosition, state.offset)\n    }\n    \n    function updateRenderPosition(state) {\n        var id = state.__id\n        var self = noa.ents.getPositionData(id)\n        var other = noa.ents.getPositionData(state.entity)\n        if (!other) {\n            return noa.ents.removeComponent(id, noa.ents.names.followsEntity)\n        }\n        vec3.add(self._renderPosition, other._renderPosition, state.offset)\n    }\n\n}\n","\nvar vec3 = require('gl-vec3')\n\n\nexport default function (noa) {\n    return {\n\n        name: 'mesh',\n\n        order: 100,\n\n        state: {\n            mesh: null,\n            offset: null\n        },\n\n\n        onAdd: function (eid, state) {\n            // implicitly assume there's already a position component\n            var posDat = noa.ents.getPositionData(eid)\n            if (state.mesh) {\n                noa.rendering.addMeshToScene(state.mesh, false, posDat.position)\n            } else {\n                throw new Error('Mesh component added without a mesh - probably a bug!')\n            }\n            if (!state.offset) state.offset = new vec3.create()\n\n            // set mesh to correct position\n            var rpos = posDat._renderPosition\n            state.mesh.position.copyFromFloats(\n                rpos[0] + state.offset[0],\n                rpos[1] + state.offset[1],\n                rpos[2] + state.offset[2])\n        },\n\n\n        onRemove: function (eid, state) {\n            state.mesh.dispose()\n        },\n\n\n\n        renderSystem: function (dt, states) {\n            // before render move each mesh to its render position, \n            // set by the physics engine or driving logic\n\n            states.forEach(state => {\n                var id = state.__id\n\n                var rpos = noa.ents.getPositionData(id)._renderPosition\n                state.mesh.position.copyFromFloats(\n                    rpos[0] + state.offset[0],\n                    rpos[1] + state.offset[1],\n                    rpos[2] + state.offset[2])\n            })\n        }\n\n\n    }\n}\n","var vec3 = require('gl-vec3')\n\n/**\n * \n * Movement component. State stores settings like jump height, etc.,\n * as well as current state (running, jumping, heading angle).\n * Processor checks state and applies movement/friction/jump forces\n * to the entity's physics body. \n * \n */\n\nexport default function (noa) {\n    return {\n\n        name: 'movement',\n\n        order: 30,\n\n        state: {\n            // current state\n            heading: 0, // radians\n            running: false,\n            jumping: false,\n\n            // options:\n            maxSpeed: 10,\n            moveForce: 30,\n            responsiveness: 15,\n            runningFriction: 0,\n            standingFriction: 2,\n\n            airMoveMult: 0.5,\n            jumpImpulse: 10,\n            jumpForce: 12,\n            jumpTime: 500, // ms\n            airJumps: 1,\n\n            // internal state\n            _jumpCount: 0,\n            _isJumping: 0,\n            _currjumptime: 0,\n        },\n\n        onAdd: null,\n\n        onRemove: null,\n\n\n        system: function movementProcessor(dt, states) {\n            var ents = noa.entities\n\n            states.forEach(state => {\n                var body = ents.getPhysicsBody(state.__id)\n                applyMovementPhysics(dt, state, body)\n            })\n\n        }\n\n\n    }\n}\n\n\nvar tempvec = vec3.create()\nvar tempvec2 = vec3.create()\nvar zeroVec = vec3.create()\n\n\nfunction applyMovementPhysics(dt, state, body) {\n    // move implementation originally written as external module\n    //   see https://github.com/andyhall/voxel-fps-controller\n    //   for original code\n\n    // jumping\n    var onGround = (body.atRestY() < 0)\n    var canjump = (onGround || state._jumpCount < state.airJumps)\n    if (onGround) {\n        state._isJumping = false\n        state._jumpCount = 0\n    }\n\n    // process jump input\n    if (state.jumping) {\n        if (state._isJumping) { // continue previous jump\n            if (state._currjumptime > 0) {\n                var jf = state.jumpForce\n                if (state._currjumptime < dt) jf *= state._currjumptime / dt\n                body.applyForce([0, jf, 0])\n                state._currjumptime -= dt\n            }\n        } else if (canjump) { // start new jump\n            state._isJumping = true\n            if (!onGround) state._jumpCount++\n            state._currjumptime = state.jumpTime\n            body.applyImpulse([0, state.jumpImpulse, 0])\n            // clear downward velocity on airjump\n            if (!onGround && body.velocity[1] < 0) body.velocity[1] = 0\n        }\n    } else {\n        state._isJumping = false\n    }\n\n    // apply movement forces if entity is moving, otherwise just friction\n    var m = tempvec\n    var push = tempvec2\n    if (state.running) {\n\n        var speed = state.maxSpeed\n        // todo: add crouch/sprint modifiers if needed\n        // if (state.sprint) speed *= state.sprintMoveMult\n        // if (state.crouch) speed *= state.crouchMoveMult\n        vec3.set(m, 0, 0, speed)\n\n        // rotate move vector to entity's heading\n        vec3.rotateY(m, m, zeroVec, state.heading)\n\n        // push vector to achieve desired speed & dir\n        // following code to adjust 2D velocity to desired amount is patterned on Quake: \n        // https://github.com/id-Software/Quake-III-Arena/blob/master/code/game/bg_pmove.c#L275\n        vec3.subtract(push, m, body.velocity)\n        push[1] = 0\n        var pushLen = vec3.length(push)\n        vec3.normalize(push, push)\n\n        if (pushLen > 0) {\n            // pushing force vector\n            var canPush = state.moveForce\n            if (!onGround) canPush *= state.airMoveMult\n\n            // apply final force\n            var pushAmt = state.responsiveness * pushLen\n            if (canPush > pushAmt) canPush = pushAmt\n\n            vec3.scale(push, push, canPush)\n            body.applyForce(push)\n        }\n\n        // different friction when not moving\n        // idea from Sonic: http://info.sonicretro.org/SPG:Running\n        body.friction = state.runningFriction\n    } else {\n        body.friction = state.standingFriction\n    }\n\n\n\n}\n","\n/**\n * \n * Input processing component - gets (key) input state and  \n * applies it to receiving entities by updating their movement \n * component state (heading, movespeed, jumping, etc.)\n * \n */\n\nexport default function (noa) {\n    return {\n\n        name: 'receivesInputs',\n\n        order: 20,\n\n        state: {},\n\n        onAdd: null,\n\n        onRemove: null,\n\n        system: function inputProcessor(dt, states) {\n            var ents = noa.entities\n            var inputState = noa.inputs.state\n            var camHeading = noa.camera.heading\n\n            states.forEach(state => {\n                var moveState = ents.getMovement(state.__id)\n                setMovementState(moveState, inputState, camHeading)\n            })\n        }\n\n    }\n}\n\n\n\nfunction setMovementState(state, inputs, camHeading) {\n    state.jumping = !!inputs.jump\n\n    var fb = inputs.forward ? (inputs.backward ? 0 : 1) : (inputs.backward ? -1 : 0)\n    var rl = inputs.right ? (inputs.left ? 0 : 1) : (inputs.left ? -1 : 0)\n\n    if ((fb | rl) === 0) {\n        state.running = false\n    } else {\n        state.running = true\n        if (fb) {\n            if (fb == -1) camHeading += Math.PI\n            if (rl) {\n                camHeading += Math.PI / 4 * fb * rl // didn't plan this but it works!\n            }\n        } else {\n            camHeading += rl * Math.PI / 2\n        }\n        state.heading = camHeading\n    }\n\n}\n","\nimport { Mesh } from '@babylonjs/core/Meshes/mesh'\nimport { Color3 } from '@babylonjs/core/Maths/math'\nvar vec3 = require('gl-vec3')\n\n\nexport default function (noa, dist) {\n\n    var shadowDist = dist\n\n    // create a mesh to re-use for shadows\n    var scene = noa.rendering.getScene()\n    var disc = Mesh.CreateDisc('shadow', 0.75, 30, scene)\n    disc.rotation.x = Math.PI / 2\n    disc.material = noa.rendering.makeStandardMaterial('shadowMat')\n    disc.material.diffuseColor = Color3.Black()\n    disc.material.ambientColor = Color3.Black()\n    disc.material.alpha = 0.5\n    disc.setEnabled(false)\n\n    // source mesh needn't be in the scene graph\n    scene.removeMesh(disc)\n\n\n    return {\n\n        name: 'shadow',\n\n        order: 80,\n\n        state: {\n            size: 0.5,\n            _mesh: null,\n        },\n\n\n        onAdd: function (eid, state) {\n            var mesh = disc.createInstance('shadow_instance')\n            noa.rendering.addMeshToScene(mesh)\n            mesh.setEnabled(false)\n            state._mesh = mesh\n        },\n\n\n        onRemove: function (eid, state) {\n            state._mesh.dispose()\n        },\n\n\n        system: function shadowSystem(dt, states) {\n            var cpos = noa.camera._localGetPosition()\n            var dist = shadowDist\n            states.forEach(state => {\n                var posState = noa.ents.getPositionData(state.__id)\n                var physState = noa.ents.getPhysics(state.__id)\n                updateShadowHeight(noa, posState, physState, state._mesh, state.size, dist, cpos)\n            })\n        },\n\n\n        renderSystem: function (dt, states) {\n            // before render adjust shadow x/z to render positions\n            states.forEach(state => {\n                var rpos = noa.ents.getPositionData(state.__id)._renderPosition\n                var spos = state._mesh.position\n                spos.x = rpos[0]\n                spos.z = rpos[2]\n            })\n        }\n\n\n\n\n    }\n}\n\nvar shadowPos = vec3.fromValues(0, 0, 0)\nvar down = vec3.fromValues(0, -1, 0)\n\nfunction updateShadowHeight(noa, posDat, physDat, mesh, size, shadowDist, camPos) {\n\n    // local Y ground position - from physics or raycast\n    var localY\n    if (physDat && physDat.body.resting[1] < 0) {\n        localY = posDat._localPosition[1]\n    } else {\n        var res = noa._localPick(posDat._localPosition, down, shadowDist)\n        if (!res) {\n            mesh.setEnabled(false)\n            return\n        }\n        localY = res.position[1] - noa.worldOriginOffset[1]\n    }\n\n    // round Y pos and offset upwards slightly to avoid z-fighting\n    localY = Math.round(localY) \n    vec3.copy(shadowPos, posDat._localPosition)\n    shadowPos[1] = localY\n    var sqdist = vec3.squaredDistance(camPos, shadowPos)\n    // offset ~ 0.01 for nearby shadows, up to 0.1 at distance of ~40\n    var offset = 0.01 + 0.1 * (sqdist / 1600)\n    if (offset > 0.1) offset = 0.1\n    mesh.position.y = localY + offset\n    // set shadow scale\n    var dist = posDat._localPosition[1] - localY\n    var scale = size * 0.7 * (1 - dist / shadowDist)\n    mesh.scaling.copyFromFloats(scale, scale, scale)\n    mesh.setEnabled(true)\n}\n","\n\nexport default function (noa) {\n    return {\n\n        name: 'smooth-camera',\n\n        order: 99,\n\n        state: {\n            time: 100.1\n        },\n\n        onAdd: null,\n\n        onRemove: null,\n\n        system: function (dt, states) {\n            // remove self after time elapses\n            states.forEach(state => {\n                state.time -= dt\n                if (state.time < 0) noa.ents.removeComponent(state.__id, 'smooth-camera')\n            })\n        },\n\n    }\n}\n","var bits = require(\"bit-twiddle\")\n\nfunction size(chunk) {\n  var count = 0\n  var chunk_len = chunk.length\n  var i = 0, v, l\n  while(i<chunk.length) {\n    v = chunk[i]\n    l = 0\n    while(i < chunk_len && chunk[i] === v) {\n      ++i\n      ++l\n    }\n    count += (bits.log2(l) / 7)|0\n    count += (bits.log2(v>>>0) / 7)|0\n    count += 2\n  }\n  return count\n}\nexports.size = size\n\nfunction encode(chunk, runs) {\n  if(!runs) {\n    runs = new Uint8Array(size(chunk))\n  }\n  var rptr = 0, nruns = runs.length\n  var i = 0, v, l\n  while(i<chunk.length) {\n    v = chunk[i]\n    l = 0\n    while(i < chunk.length && chunk[i] === v) {\n      ++i\n      ++l\n    }\n    while(rptr < nruns && l >= 128) {\n      runs[rptr++] = 128 + (l&0x7f)\n      l >>>= 7\n    }\n    if(rptr >= nruns) {\n      throw new Error(\"RLE buffer overflow\")\n    }\n    runs[rptr++] = l\n    v >>>= 0\n    while(rptr < nruns && v >= 128) {\n      runs[rptr++] = 128 + (v&0x7f)\n      v >>>= 7\n    }\n    if(rptr >= nruns) {\n      throw new Error(\"RLE buffer overflow\")\n    }\n    runs[rptr++] = v\n  }\n  return runs\n}\nexports.encode = encode\n\nfunction decode(runs, chunk) {\n  var buf_len = chunk.length\n  var nruns = runs.length\n  var cptr = 0\n  var ptr = 0\n  var l, s, v, i\n  while(ptr < nruns) {\n    l = 0\n    s = 0\n    while(ptr < nruns && runs[ptr] >= 128) {\n      l += (runs[ptr++]&0x7f) << s\n      s += 7\n    }\n    l += runs[ptr++] << s\n    if(ptr >= nruns) {\n      throw new Error(\"RLE buffer underrun\")\n    }\n    if(cptr + l > buf_len) {\n      throw new Error(\"Chunk buffer overflow\")\n    }\n    v = 0\n    s = 0\n    while(ptr < nruns && runs[ptr] >= 128) {\n      v += (runs[ptr++]&0x7f) << s\n      s += 7\n    }\n    if(ptr >= nruns) {\n      throw new Error(\"RLE buffer underrun\")\n    }\n    v += runs[ptr++] << s\n    for(i=0; i<l; ++i) {\n      chunk[cptr++] = v\n    }\n  }\n  return chunk\n}\nexports.decode = decode\n","/**\n * Bit twiddling hacks for JavaScript.\n *\n * Author: Mikola Lysenko\n *\n * Ported from Stanford bit twiddling hack library:\n *    http://graphics.stanford.edu/~seander/bithacks.html\n */\n\n\"use strict\"; \"use restrict\";\n\n//Number of bits in an integer\nvar INT_BITS = 32;\n\n//Constants\nexports.INT_BITS  = INT_BITS;\nexports.INT_MAX   =  0x7fffffff;\nexports.INT_MIN   = -1<<(INT_BITS-1);\n\n//Returns -1, 0, +1 depending on sign of x\nexports.sign = function(v) {\n  return (v > 0) - (v < 0);\n}\n\n//Computes absolute value of integer\nexports.abs = function(v) {\n  var mask = v >> (INT_BITS-1);\n  return (v ^ mask) - mask;\n}\n\n//Computes minimum of integers x and y\nexports.min = function(x, y) {\n  return y ^ ((x ^ y) & -(x < y));\n}\n\n//Computes maximum of integers x and y\nexports.max = function(x, y) {\n  return x ^ ((x ^ y) & -(x < y));\n}\n\n//Checks if a number is a power of two\nexports.isPow2 = function(v) {\n  return !(v & (v-1)) && (!!v);\n}\n\n//Computes log base 2 of v\nexports.log2 = function(v) {\n  var r, shift;\n  r =     (v > 0xFFFF) << 4; v >>>= r;\n  shift = (v > 0xFF  ) << 3; v >>>= shift; r |= shift;\n  shift = (v > 0xF   ) << 2; v >>>= shift; r |= shift;\n  shift = (v > 0x3   ) << 1; v >>>= shift; r |= shift;\n  return r | (v >> 1);\n}\n\n//Computes log base 10 of v\nexports.log10 = function(v) {\n  return  (v >= 1000000000) ? 9 : (v >= 100000000) ? 8 : (v >= 10000000) ? 7 :\n          (v >= 1000000) ? 6 : (v >= 100000) ? 5 : (v >= 10000) ? 4 :\n          (v >= 1000) ? 3 : (v >= 100) ? 2 : (v >= 10) ? 1 : 0;\n}\n\n//Counts number of bits\nexports.popCount = function(v) {\n  v = v - ((v >>> 1) & 0x55555555);\n  v = (v & 0x33333333) + ((v >>> 2) & 0x33333333);\n  return ((v + (v >>> 4) & 0xF0F0F0F) * 0x1010101) >>> 24;\n}\n\n//Counts number of trailing zeros\nfunction countTrailingZeros(v) {\n  var c = 32;\n  v &= -v;\n  if (v) c--;\n  if (v & 0x0000FFFF) c -= 16;\n  if (v & 0x00FF00FF) c -= 8;\n  if (v & 0x0F0F0F0F) c -= 4;\n  if (v & 0x33333333) c -= 2;\n  if (v & 0x55555555) c -= 1;\n  return c;\n}\nexports.countTrailingZeros = countTrailingZeros;\n\n//Rounds to next power of 2\nexports.nextPow2 = function(v) {\n  v += v === 0;\n  --v;\n  v |= v >>> 1;\n  v |= v >>> 2;\n  v |= v >>> 4;\n  v |= v >>> 8;\n  v |= v >>> 16;\n  return v + 1;\n}\n\n//Rounds down to previous power of 2\nexports.prevPow2 = function(v) {\n  v |= v >>> 1;\n  v |= v >>> 2;\n  v |= v >>> 4;\n  v |= v >>> 8;\n  v |= v >>> 16;\n  return v - (v>>>1);\n}\n\n//Computes parity of word\nexports.parity = function(v) {\n  v ^= v >>> 16;\n  v ^= v >>> 8;\n  v ^= v >>> 4;\n  v &= 0xf;\n  return (0x6996 >>> v) & 1;\n}\n\nvar REVERSE_TABLE = new Array(256);\n\n(function(tab) {\n  for(var i=0; i<256; ++i) {\n    var v = i, r = i, s = 7;\n    for (v >>>= 1; v; v >>>= 1) {\n      r <<= 1;\n      r |= v & 1;\n      --s;\n    }\n    tab[i] = (r << s) & 0xff;\n  }\n})(REVERSE_TABLE);\n\n//Reverse bits in a 32 bit word\nexports.reverse = function(v) {\n  return  (REVERSE_TABLE[ v         & 0xff] << 24) |\n          (REVERSE_TABLE[(v >>> 8)  & 0xff] << 16) |\n          (REVERSE_TABLE[(v >>> 16) & 0xff] << 8)  |\n           REVERSE_TABLE[(v >>> 24) & 0xff];\n}\n\n//Interleave bits of 2 coordinates with 16 bits.  Useful for fast quadtree codes\nexports.interleave2 = function(x, y) {\n  x &= 0xFFFF;\n  x = (x | (x << 8)) & 0x00FF00FF;\n  x = (x | (x << 4)) & 0x0F0F0F0F;\n  x = (x | (x << 2)) & 0x33333333;\n  x = (x | (x << 1)) & 0x55555555;\n\n  y &= 0xFFFF;\n  y = (y | (y << 8)) & 0x00FF00FF;\n  y = (y | (y << 4)) & 0x0F0F0F0F;\n  y = (y | (y << 2)) & 0x33333333;\n  y = (y | (y << 1)) & 0x55555555;\n\n  return x | (y << 1);\n}\n\n//Extracts the nth interleaved component\nexports.deinterleave2 = function(v, n) {\n  v = (v >>> n) & 0x55555555;\n  v = (v | (v >>> 1))  & 0x33333333;\n  v = (v | (v >>> 2))  & 0x0F0F0F0F;\n  v = (v | (v >>> 4))  & 0x00FF00FF;\n  v = (v | (v >>> 16)) & 0x000FFFF;\n  return (v << 16) >> 16;\n}\n\n\n//Interleave bits of 3 coordinates, each with 10 bits.  Useful for fast octree codes\nexports.interleave3 = function(x, y, z) {\n  x &= 0x3FF;\n  x  = (x | (x<<16)) & 4278190335;\n  x  = (x | (x<<8))  & 251719695;\n  x  = (x | (x<<4))  & 3272356035;\n  x  = (x | (x<<2))  & 1227133513;\n\n  y &= 0x3FF;\n  y  = (y | (y<<16)) & 4278190335;\n  y  = (y | (y<<8))  & 251719695;\n  y  = (y | (y<<4))  & 3272356035;\n  y  = (y | (y<<2))  & 1227133513;\n  x |= (y << 1);\n  \n  z &= 0x3FF;\n  z  = (z | (z<<16)) & 4278190335;\n  z  = (z | (z<<8))  & 251719695;\n  z  = (z | (z<<4))  & 3272356035;\n  z  = (z | (z<<2))  & 1227133513;\n  \n  return x | (z << 2);\n}\n\n//Extracts nth interleaved component of a 3-tuple\nexports.deinterleave3 = function(v, n) {\n  v = (v >>> n)       & 1227133513;\n  v = (v | (v>>>2))   & 3272356035;\n  v = (v | (v>>>4))   & 251719695;\n  v = (v | (v>>>8))   & 4278190335;\n  v = (v | (v>>>16))  & 0x3FF;\n  return (v<<22)>>22;\n}\n\n//Computes next combination in colexicographic order (this is mistakenly called nextPermutation on the bit twiddling hacks page)\nexports.nextCombination = function(v) {\n  var t = v | (v - 1);\n  return (t + 1) | (((~t & -~t) - 1) >>> (countTrailingZeros(v) + 1));\n}\n\n","\nvar createGameShell = require('game-shell')\n// var createGameShell = require('../../../../npm-modules/game-shell')\nvar EventEmitter = require('events').EventEmitter\n\n\nexport default function (noa, opts) {\n    return new Container(noa, opts)\n}\n\n/**\n * @class\n * @typicalname noa.container\n * @emits DOMready\n * @classdesc Wraps `game-shell` module \n * and manages HTML container, canvas, etc.\n */\n\nfunction Container(noa, opts) {\n    opts = opts || {}\n    this._noa = noa\n    this.element = opts.domElement || createContainerDiv()\n    this.canvas = getOrCreateCanvas(this.element)\n    this._shell = createShell(this.canvas, opts)\n\n    // mouse state/feature detection\n    this.hasPointerLock = false\n    this.supportsPointerLock = false\n    this.pointerInGame = false\n    this.isFocused = document.hasFocus()\n\n    // basic listeners\n    var self = this\n    var lockChange = function (ev) { onLockChange(self, ev) }\n    document.addEventListener(\"pointerlockchange\", lockChange, false)\n    document.addEventListener(\"mozpointerlockchange\", lockChange, false)\n    document.addEventListener(\"webkitpointerlockchange\", lockChange, false)\n    detectPointerLock(self)\n\n    self.element.addEventListener('mouseenter', function () { self.pointerInGame = true })\n    self.element.addEventListener('mouseleave', function () { self.pointerInGame = false })\n\n    window.addEventListener('focus', function () { self.isFocused = true })\n    window.addEventListener('blur', function () { self.isFocused = false })\n\n    // get shell events after it's initialized\n    this._shell.on('init', onShellInit.bind(null, this))\n}\n\nContainer.prototype = Object.create(EventEmitter.prototype)\n\n\n\n/*\n *   SHELL EVENTS\n */\n\nfunction onShellInit(self) {\n    // create shell listeners that drive engine functions\n    var noa = self._noa\n    var shell = self._shell\n    shell.on('tick', function onTick(n) { noa.tick(n) })\n    shell.on('render', function onRender(n) { noa.render(n) })\n    shell.on('resize', noa.rendering.resize.bind(noa.rendering))\n\n    // let other components know DOM is ready\n    self.emit('DOMready')\n}\n\n\n\n/*\n *   PUBLIC API \n */\n\nContainer.prototype.appendTo = function (htmlElement) {\n    this.element.appendChild(htmlElement)\n}\n\n\n\nContainer.prototype.setPointerLock = function (lock) {\n    // not sure if this will work robustly\n    this._shell.pointerLock = !!lock\n}\n\n\n\n\n\n/*\n *   INTERNALS\n */\n\n\n\nfunction createContainerDiv() {\n    // based on github.com/mikolalysenko/game-shell - makeDefaultContainer()\n    var container = document.createElement(\"div\")\n    container.tabindex = 1\n    container.style.position = \"fixed\"\n    container.style.left = \"0px\"\n    container.style.right = \"0px\"\n    container.style.top = \"0px\"\n    container.style.bottom = \"0px\"\n    container.style.height = \"100%\"\n    container.style.overflow = \"hidden\"\n    document.body.appendChild(container)\n    document.body.style.overflow = \"hidden\" //Prevent bounce\n    document.body.style.height = \"100%\"\n    container.id = 'noa-container'\n    return container\n}\n\n\nfunction createShell(canvas, opts) {\n    var shellDefaults = {\n        pointerLock: true,\n        preventDefaults: false\n    }\n    opts = Object.assign(shellDefaults, opts)\n    opts.element = canvas\n    var shell = createGameShell(opts)\n    shell.preventDefaults = opts.preventDefaults\n    return shell\n}\n\nfunction getOrCreateCanvas(el) {\n    // based on github.com/stackgl/gl-now - default canvas\n    var canvas = el.querySelector('canvas')\n    if (!canvas) {\n        canvas = document.createElement('canvas')\n        canvas.style.position = \"absolute\"\n        canvas.style.left = \"0px\"\n        canvas.style.top = \"0px\"\n        canvas.style.height = \"100%\"\n        canvas.style.width = \"100%\"\n        canvas.id = 'noa-canvas'\n        el.insertBefore(canvas, el.firstChild)\n    }\n    return canvas\n}\n\n\n// track changes in Pointer Lock state\nfunction onLockChange(self, ev) {\n    var el = document.pointerLockElement ||\n        document.mozPointerLockElement ||\n        document.webkitPointerLockElement\n    if (el) {\n        self.hasPointerLock = true\n        self.emit('gainedPointerLock')\n    } else {\n        self.hasPointerLock = false\n        self.emit('lostPointerLock')\n    }\n    // this works around a Firefox bug where no mouse-in event \n    // gets issued after starting pointerlock\n    if (el) {\n        // act as if pointer is in game window while pointerLock is true\n        self.pointerInGame = true\n    }\n}\n\n\n// set up stuff to detect pointer lock support.\n// Needlessly complex because Chrome/Android claims to support but doesn't.\n// For now, just feature detect, but assume no support if a touch event occurs\n// TODO: see if this makes sense on hybrid touch/mouse devices\nfunction detectPointerLock(self) {\n    var lockElementExists =\n        ('pointerLockElement' in document) ||\n        ('mozPointerLockElement' in document) ||\n        ('webkitPointerLockElement' in document)\n    if (lockElementExists) {\n        self.supportsPointerLock = true\n        var listener = function (e) {\n            self.supportsPointerLock = false\n            document.removeEventListener(e.type, listener)\n        }\n        document.addEventListener('touchmove', listener)\n    }\n}\n","\n\n// helper to swap item to end and pop(), instead of splice()ing\nexport function removeUnorderedListItem(list, item) {\n    var i = list.indexOf(item)\n    if (i < 0) return\n    if (i === list.length - 1) {\n        list.pop()\n    } else {\n        list[i] = list.pop()\n    }\n}\n\n\n\n// loop over a function for a few ms, or until it returns true\nexport function loopForTime(maxTimeInMS, callback, startTime) {\n    var cutoff = (startTime || performance.now()) + maxTimeInMS\n    var maxIter = 1000 // sanity check\n    for (var i = 0; i < maxIter; i++) {\n        var res = callback()\n        if (res || performance.now() > cutoff) return\n    }\n}\n\n\n\n\n\n// ....\nexport function numberOfVoxelsInSphere(rad) {\n    if (rad === prevRad) return prevAnswer\n    var ext = Math.ceil(rad), ct = 0, rsq = rad * rad\n    for (var i = -ext; i <= ext; ++i) {\n        for (var j = -ext; j <= ext; ++j) {\n            for (var k = -ext; k <= ext; ++k) {\n                var dsq = i * i + j * j + k * k\n                if (dsq < rsq) ct++\n            }\n        }\n    }\n    prevRad = rad\n    prevAnswer = ct\n    return ct\n}\nvar prevRad = 0, prevAnswer = 0\n\n\n\n\n\n// partly \"unrolled\" loops to copy contents of ndarrays\n// when there's no source, zeroes out the array instead\nexport function copyNdarrayContents(src, tgt, pos, size, tgtPos) {\n    if (src) {\n        doNdarrayCopy(src, tgt, pos[0], pos[1], pos[2],\n            size[0], size[1], size[2], tgtPos[0], tgtPos[1], tgtPos[2])\n    } else {\n        doNdarrayZero(tgt, tgtPos[0], tgtPos[1], tgtPos[2],\n            size[0], size[1], size[2])\n    }\n}\nfunction doNdarrayCopy(src, tgt, i0, j0, k0, si, sj, sk, ti, tj, tk) {\n    for (var i = 0; i < si; i++) {\n        for (var j = 0; j < sj; j++) {\n            var six = src.index(i0 + i, j0 + j, k0)\n            var tix = tgt.index(ti + i, tj + j, tk)\n            for (var k = 0; k < sk; k++) {\n                tgt.data[tix] = src.data[six]\n                six += src.stride[2]\n                tix += tgt.stride[2]\n            }\n        }\n    }\n}\n\nfunction doNdarrayZero(tgt, i0, j0, k0, si, sj, sk) {\n    for (var i = 0; i < si; i++) {\n        for (var j = 0; j < sj; j++) {\n            var ix = tgt.index(i0 + i, j0 + j, k0)\n            for (var k = 0; k < sk; k++) {\n                tgt.data[ix] = 0\n                ix += tgt.stride[2]\n            }\n        }\n    }\n}\n\n\n\n\n\n\n\n/*\n * \n *      strList - internal data structure for lists of chunk IDs\n * \n*/\n\nexport function StringList() {\n    this.arr = []\n    this.hash = {}\n}\nStringList.prototype.includes = function (key) {\n    return this.hash[key]\n}\nStringList.prototype.add = function (key) {\n    if (this.hash[key]) return\n    this.arr.push(key)\n    this.hash[key] = true\n}\nStringList.prototype.remove = function (key) {\n    if (!this.hash[key]) return\n    this.arr.splice(this.arr.indexOf(key), 1)\n    delete this.hash[key]\n}\nStringList.prototype.count = function () { return this.arr.length }\nStringList.prototype.forEach = function (a, b) { return this.arr.forEach(a, b) }\nStringList.prototype.slice = function (a, b) { return this.arr.slice(a, b) }\nStringList.prototype.isEmpty = function () { return (this.arr.length === 0) }\nStringList.prototype.empty = function () {\n    this.arr.length = 0\n    this.hash = {}\n}\nStringList.prototype.pop = function () {\n    var key = this.arr.pop()\n    delete this.hash[key]\n    return key\n}\nStringList.prototype.sort = function (keyToDistanceFn) {\n    var mapping = {}\n    this.arr.forEach(key => { mapping[key] = keyToDistanceFn(key) })\n    this.arr.sort((a, b) => mapping[b] - mapping[a]) // DESCENDING!\n}\nStringList.prototype.copyFrom = function (list) {\n    this.arr = list.arr.slice()\n    this.hash = Object.assign({}, list.hash)\n}\n\n\n\n\n\n\n\n\n\n\n\n// simple thing for reporting time split up between several activities\nexport function makeProfileHook(_every, _title) {\n    var title = _title || ''\n    var every = _every || 1\n    var times = []\n    var names = []\n    var started = 0\n    var last = 0\n    var iter = 0\n    var total = 0\n    var clearNext = true\n\n    var start = function () {\n        if (clearNext) {\n            times.length = names.length = 0\n            clearNext = false\n        }\n        started = last = performance.now()\n        iter++\n    }\n    var add = function (name) {\n        var t = performance.now()\n        if (names.indexOf(name) < 0) names.push(name)\n        var i = names.indexOf(name)\n        if (!times[i]) times[i] = 0\n        times[i] += t - last\n        last = t\n    }\n    var report = function () {\n        total += performance.now() - started\n        if (iter === every) {\n            var head = title + ' total ' + (total / every).toFixed(2) + 'ms (avg, ' + every + ' runs)    '\n            console.log(head, names.map(function (name, i) {\n                return name + ': ' + (times[i] / every).toFixed(2) + 'ms    '\n            }).join(''))\n            clearNext = true\n            iter = 0\n            total = 0\n        }\n    }\n    return function profile_hook(state) {\n        if (state === 'start') start()\n        else if (state === 'end') report()\n        else add(state)\n    }\n}\n\n\n\n\n// simple thing for reporting time actions/sec\nexport function makeThroughputHook(_every, _title) {\n    var title = _title || ''\n    var every = _every || 1\n    var counts = {}\n    var started = performance.now()\n    var iter = 0\n    return function profile_hook(state) {\n        if (state === 'start') return\n        if (state === 'end') {\n            if (++iter < every) return\n            var t = performance.now()\n            console.log(title + '   ' + Object.keys(counts).map(k => {\n                var through = counts[k] / (t - started) * 1000\n                counts[k] = 0\n                return k + ':' + through.toFixed(2) + '   '\n            }).join(''))\n            started = t\n            iter = 0\n        } else {\n            if (!counts[state]) counts[state] = 0\n            counts[state]++\n        }\n    }\n}\n","var glvec3 = require('gl-vec3')\nimport { removeUnorderedListItem } from './util'\n\nimport { Scene } from '@babylonjs/core/scene'\nimport { FreeCamera } from '@babylonjs/core/Cameras/freeCamera'\nimport { Octree } from '@babylonjs/core/Culling/Octrees/octree'\nimport { OctreeBlock } from '@babylonjs/core/Culling/Octrees/octreeBlock'\nimport { Engine } from '@babylonjs/core/Engines/engine'\nimport { HemisphericLight } from '@babylonjs/core/Lights/hemisphericLight'\nimport { StandardMaterial } from '@babylonjs/core/Materials/standardMaterial'\nimport { Vector3, Color3 } from '@babylonjs/core/Maths/math'\nimport { Mesh } from '@babylonjs/core/Meshes/mesh'\nimport { OctreeSceneComponent } from '@babylonjs/core/Culling/Octrees/'\nimport '@babylonjs/core/Meshes/meshBuilder'\n\n\n\nexport default function (noa, opts, canvas) {\n    return new Rendering(noa, opts, canvas)\n}\n\n\n\n// profiling flag\nvar PROFILE = 0\n\n\n\nvar defaults = {\n    showFPS: false,\n    antiAlias: true,\n    clearColor: [0.8, 0.9, 1],\n    ambientColor: [1, 1, 1],\n    lightDiffuse: [1, 1, 1],\n    lightSpecular: [1, 1, 1],\n    groundLightColor: [0.5, 0.5, 0.5],\n    useAO: true,\n    AOmultipliers: [0.93, 0.8, 0.5],\n    reverseAOmultiplier: 1.0,\n    preserveDrawingBuffer: true,\n}\n\n\n\n/**\n * @class\n * @typicalname noa.rendering\n * @classdesc Manages all rendering, and the BABYLON scene, materials, etc.\n */\n\nfunction Rendering(noa, opts, canvas) {\n    this.noa = noa\n\n    /**\n     * `noa.rendering` uses the following options (from the root `noa(opts)` options):\n     * ```js\n     * {\n     *   showFPS: false,\n     *   antiAlias: true,\n     *   clearColor: [0.8, 0.9, 1],\n     *   ambientColor: [1, 1, 1],\n     *   lightDiffuse: [1, 1, 1],\n     *   lightSpecular: [1, 1, 1],\n     *   groundLightColor: [0.5, 0.5, 0.5],\n     *   useAO: true,\n     *   AOmultipliers: [0.93, 0.8, 0.5],\n     *   reverseAOmultiplier: 1.0,\n     *   preserveDrawingBuffer: true,\n     * }\n     * ```\n     */\n    opts = Object.assign({}, defaults, opts)\n\n    // internals\n    this.useAO = !!opts.useAO\n    this.aoVals = opts.AOmultipliers\n    this.revAoVal = opts.reverseAOmultiplier\n    this.meshingCutoffTime = 6 // ms\n    this._resizeDebounce = 250 // ms\n\n    // set up babylon scene\n    initScene(this, canvas, opts)\n\n    // for debugging\n    if (opts.showFPS) setUpFPS()\n}\n\n\n// Constructor helper - set up the Babylon.js scene and basic components\nfunction initScene(self, canvas, opts) {\n\n    // init internal properties\n    self._engine = new Engine(canvas, opts.antiAlias, {\n        preserveDrawingBuffer: opts.preserveDrawingBuffer,\n    })\n    self._scene = new Scene(self._engine)\n    var scene = self._scene\n    // remove built-in listeners\n    scene.detachControl()\n\n    // octree setup\n    scene._addComponent(new OctreeSceneComponent(scene))\n    self._octree = new Octree($ => { })\n    self._octree.blocks = []\n    scene._selectionOctree = self._octree\n\n    // camera, and empty mesh to hold it, and one to accumulate rotations\n    self._cameraHolder = new Mesh('camHolder', scene)\n    self._camera = new FreeCamera('camera', new Vector3(0, 0, 0), scene)\n    self._camera.parent = self._cameraHolder\n    self._camera.minZ = .01\n    self._cameraHolder.visibility = false\n\n    // plane obscuring the camera - for overlaying an effect on the whole view\n    self._camScreen = Mesh.CreatePlane('camScreen', 10, scene)\n    self.addMeshToScene(self._camScreen)\n    self._camScreen.position.z = .1\n    self._camScreen.parent = self._camera\n    self._camScreenMat = self.makeStandardMaterial('camscreenmat')\n    self._camScreen.material = self._camScreenMat\n    self._camScreen.setEnabled(false)\n    self._camLocBlock = 0\n\n    // apply some defaults\n    var lightVec = new Vector3(0.1, 1, 0.3)\n    self._light = new HemisphericLight('light', lightVec, scene)\n\n    function arrToColor(a) { return new Color3(a[0], a[1], a[2]) }\n    scene.clearColor = arrToColor(opts.clearColor)\n    scene.ambientColor = arrToColor(opts.ambientColor)\n    self._light.diffuse = arrToColor(opts.lightDiffuse)\n    self._light.specular = arrToColor(opts.lightSpecular)\n    self._light.groundColor = arrToColor(opts.groundLightColor)\n\n    // make a default flat material (used or clone by terrain, etc)\n    self.flatMaterial = self.makeStandardMaterial('flatmat')\n\n}\n\n\n\n/*\n *   PUBLIC API \n */\n\n\n/**\n * The Babylon `scene` object representing the game world.\n * @member\n */\nRendering.prototype.getScene = function () {\n    return this._scene\n}\n\n// per-tick listener for rendering-related stuff\nRendering.prototype.tick = function (dt) {\n    // nothing here at the moment\n}\n\n\n\n\n\nRendering.prototype.render = function (dt) {\n    profile_hook('start')\n    updateCameraForRender(this)\n    profile_hook('updateCamera')\n    this._engine.beginFrame()\n    profile_hook('beginFrame')\n    this._scene.render()\n    profile_hook('render')\n    fps_hook()\n    this._engine.endFrame()\n    profile_hook('endFrame')\n    profile_hook('end')\n}\n\n\n\nRendering.prototype.resize = function (e) {\n    if (!pendingResize) {\n        pendingResize = true\n        setTimeout(() => {\n            this._engine.resize()\n            pendingResize = false\n        }, this._resizeDebounce)\n    }\n}\nvar pendingResize = false\n\n\n\nRendering.prototype.highlightBlockFace = function (show, posArr, normArr) {\n    var m = getHighlightMesh(this)\n    if (show) {\n        // floored local coords for highlight mesh\n        this.noa.globalToLocal(posArr, null, hlpos)\n        // offset to avoid z-fighting, bigger when camera is far away\n        var dist = glvec3.dist(this.noa.camera._localGetPosition(), hlpos)\n        var slop = 0.001 + 0.001 * dist\n        for (var i = 0; i < 3; i++) {\n            if (normArr[i] === 0) {\n                hlpos[i] += 0.5\n            } else {\n                hlpos[i] += (normArr[i] > 0) ? 1 + slop : -slop\n            }\n        }\n        m.position.copyFromFloats(hlpos[0], hlpos[1], hlpos[2])\n        m.rotation.x = (normArr[1]) ? Math.PI / 2 : 0\n        m.rotation.y = (normArr[0]) ? Math.PI / 2 : 0\n    }\n    m.setEnabled(show)\n}\nvar hlpos = []\n\n\n\n\n/**\n * Add a mesh to the scene's octree setup so that it renders. \n * \n * @param mesh: the mesh to add to the scene\n * @param isStatic: pass in true if mesh never moves (i.e. change octree blocks)\n * @param position: (optional) global position where the mesh should be\n * @param chunk: (optional) chunk to which the mesh is statically bound\n * @method\n */\nRendering.prototype.addMeshToScene = function (mesh, isStatic, pos, _containingChunk) {\n    // exit silently if mesh has already been added and not removed\n    if (mesh._noaContainingChunk) return\n    if (this._octree.dynamicContent.includes(mesh)) return\n\n    // find local position for mesh and move it there (unless it's parented)\n    if (!mesh.parent) {\n        if (!pos) pos = [mesh.position.x, mesh.position.y, mesh.position.z]\n        var lpos = []\n        this.noa.globalToLocal(pos, null, lpos)\n        mesh.position.copyFromFloats(lpos[0], lpos[1], lpos[2])\n    }\n\n    // statically tie to a chunk's octree, or treat as dynamic?\n    var addToOctree = false\n    if (isStatic) {\n        var chunk = _containingChunk ||\n            this.noa.world._getChunkByCoords(pos[0], pos[1], pos[2])\n        addToOctree = !!(chunk && chunk.octreeBlock)\n    }\n\n    if (addToOctree) {\n        chunk.octreeBlock.entries.push(mesh)\n        mesh._noaContainingChunk = chunk\n    } else {\n        this._octree.dynamicContent.push(mesh)\n    }\n\n    if (isStatic) {\n        mesh.freezeWorldMatrix()\n        mesh.freezeNormals()\n    }\n\n    // add dispose event to undo everything done here\n    var remover = this.removeMeshFromScene.bind(this, mesh)\n    mesh.onDisposeObservable.add(remover)\n}\n\n\n\n/**  Undoes everything `addMeshToScene` does\n * @method\n */\nRendering.prototype.removeMeshFromScene = function (mesh) {\n    if (mesh._noaContainingChunk && mesh._noaContainingChunk.octreeBlock) {\n        removeUnorderedListItem(mesh._noaContainingChunk.octreeBlock.entries, mesh)\n    }\n    mesh._noaContainingChunk = null\n    removeUnorderedListItem(this._octree.dynamicContent, mesh)\n}\n\n\n\n\n\n\n\n\n\n// Create a default standardMaterial:\n//      flat, nonspecular, fully reflects diffuse and ambient light\nRendering.prototype.makeStandardMaterial = function (name) {\n    var mat = new StandardMaterial(name, this._scene)\n    mat.specularColor.copyFromFloats(0, 0, 0)\n    mat.ambientColor.copyFromFloats(1, 1, 1)\n    mat.diffuseColor.copyFromFloats(1, 1, 1)\n    return mat\n}\n\n\n\n\n\n\n\n/*\n *\n * \n *   ACCESSORS FOR CHUNK ADD/REMOVAL/MESHING\n *\n * \n */\n\nRendering.prototype.prepareChunkForRendering = function (chunk) {\n    var cs = chunk.size\n    var loc = []\n    this.noa.globalToLocal([chunk.x, chunk.y, chunk.z], null, loc)\n    var min = new Vector3(loc[0], loc[1], loc[2])\n    var max = new Vector3(loc[0] + cs, loc[1] + cs, loc[2] + cs)\n    chunk.octreeBlock = new OctreeBlock(min, max, undefined, undefined, undefined, $ => { })\n    this._octree.blocks.push(chunk.octreeBlock)\n}\n\nRendering.prototype.disposeChunkForRendering = function (chunk) {\n    if (!chunk.octreeBlock) return\n    removeUnorderedListItem(this._octree.blocks, chunk.octreeBlock)\n    chunk.octreeBlock.entries.length = 0\n    chunk.octreeBlock = null\n}\n\n\n\n\n\n\n\n\n\n/*\n *\n *   INTERNALS\n *\n */\n\n\n\n// change world origin offset, and rebase everything with a position\n\nRendering.prototype._rebaseOrigin = function (delta) {\n    var dvec = new Vector3(delta[0], delta[1], delta[2])\n\n    this._scene.meshes.forEach(mesh => {\n        // parented meshes don't live in the world coord system\n        if (mesh.parent) return\n\n        // move each mesh by delta (even though most are managed by components)\n        mesh.position.subtractInPlace(dvec)\n\n        if (mesh._isWorldMatrixFrozen) mesh.markAsDirty()\n    })\n\n    // update octree block extents\n    this._octree.blocks.forEach(octreeBlock => {\n        octreeBlock.minPoint.subtractInPlace(dvec)\n        octreeBlock.maxPoint.subtractInPlace(dvec)\n        octreeBlock._boundingVectors.forEach(v => {\n            v.subtractInPlace(dvec)\n        })\n    })\n}\n\n\n\n\n\n// updates camera position/rotation to match settings from noa.camera\n\nfunction updateCameraForRender(self) {\n    var cam = self.noa.camera\n    var tgtLoc = cam._localGetTargetPosition()\n    self._cameraHolder.position.copyFromFloats(tgtLoc[0], tgtLoc[1], tgtLoc[2])\n    self._cameraHolder.rotation.x = cam.pitch\n    self._cameraHolder.rotation.y = cam.heading\n    self._camera.position.z = -cam.currentZoom\n\n    // applies screen effect when camera is inside a transparent voxel\n    var cloc = cam._localGetPosition()\n    var off = self.noa.worldOriginOffset\n    var cx = Math.floor(cloc[0] + off[0])\n    var cy = Math.floor(cloc[1] + off[1])\n    var cz = Math.floor(cloc[2] + off[2])\n    var id = self.noa.getBlock(cx, cy, cz)\n    checkCameraEffect(self, id)\n}\n\n\n\n//  If camera's current location block id has alpha color (e.g. water), apply/remove an effect\n\nfunction checkCameraEffect(self, id) {\n    if (id === self._camLocBlock) return\n    if (id === 0) {\n        self._camScreen.setEnabled(false)\n    } else {\n        var matId = self.noa.registry.getBlockFaceMaterial(id, 0)\n        if (matId) {\n            var matData = self.noa.registry.getMaterialData(matId)\n            var col = matData.color\n            var alpha = matData.alpha\n            if (col && alpha && alpha < 1) {\n                self._camScreenMat.diffuseColor.set(0, 0, 0)\n                self._camScreenMat.ambientColor.set(col[0], col[1], col[2])\n                self._camScreenMat.alpha = alpha\n                self._camScreen.setEnabled(true)\n            }\n        }\n    }\n    self._camLocBlock = id\n}\n\n\n\n\n\n\n// make or get a mesh for highlighting active voxel\nfunction getHighlightMesh(rendering) {\n    var mesh = rendering._highlightMesh\n    if (!mesh) {\n        mesh = Mesh.CreatePlane(\"highlight\", 1.0, rendering._scene)\n        var hlm = rendering.makeStandardMaterial('highlightMat')\n        hlm.backFaceCulling = false\n        hlm.emissiveColor = new Color3(1, 1, 1)\n        hlm.alpha = 0.2\n        mesh.material = hlm\n\n        // outline\n        var s = 0.5\n        var lines = Mesh.CreateLines(\"hightlightLines\", [\n            new Vector3(s, s, 0),\n            new Vector3(s, -s, 0),\n            new Vector3(-s, -s, 0),\n            new Vector3(-s, s, 0),\n            new Vector3(s, s, 0)\n        ], rendering._scene)\n        lines.color = new Color3(1, 1, 1)\n        lines.parent = mesh\n\n        rendering.addMeshToScene(mesh)\n        rendering.addMeshToScene(lines)\n        rendering._highlightMesh = mesh\n    }\n    return mesh\n}\n\n\n\n\n\n\n\n\n\n/*\n * \n *      sanity checks:\n * \n */\n\nRendering.prototype.debug_SceneCheck = function () {\n    var meshes = this._scene.meshes\n    var dyns = this._octree.dynamicContent\n    var octs = []\n    var numOcts = 0\n    var numSubs = 0\n    var mats = this._scene.materials\n    var allmats = []\n    mats.forEach(mat => {\n        if (mat.subMaterials) mat.subMaterials.forEach(mat => allmats.push(mat))\n        else allmats.push(mat)\n    })\n    this._octree.blocks.forEach(function (block) {\n        numOcts++\n        block.entries.forEach(m => octs.push(m))\n    })\n    meshes.forEach(function (m) {\n        if (m._isDisposed) warn(m, 'disposed mesh in scene')\n        if (empty(m)) return\n        if (missing(m, dyns, octs)) warn(m, 'non-empty mesh missing from octree')\n        if (!m.material) { warn(m, 'non-empty scene mesh with no material'); return }\n        numSubs += (m.subMeshes) ? m.subMeshes.length : 1\n        var mats = m.material.subMaterials || [m.material]\n        mats.forEach(function (mat) {\n            if (missing(mat, mats)) warn(mat, 'mesh material not in scene')\n        })\n    })\n    var unusedMats = []\n    allmats.forEach(mat => {\n        var used = false\n        meshes.forEach(mesh => {\n            if (mesh.material === mat) used = true\n            if (!mesh.material || !mesh.material.subMaterials) return\n            if (mesh.material.subMaterials.includes(mat)) used = true\n        })\n        if (!used) unusedMats.push(mat.name)\n    })\n    if (unusedMats.length) {\n        console.warn('Materials unused by any mesh: ', unusedMats.join(', '))\n    }\n    dyns.forEach(function (m) {\n        if (missing(m, meshes)) warn(m, 'octree/dynamic mesh not in scene')\n    })\n    octs.forEach(function (m) {\n        if (missing(m, meshes)) warn(m, 'octree block mesh not in scene')\n    })\n    var avgPerOct = Math.round(10 * octs.length / numOcts) / 10\n    console.log('meshes - octree:', octs.length, '  dynamic:', dyns.length,\n        '   subMeshes:', numSubs,\n        '   avg meshes/octreeBlock:', avgPerOct)\n\n    function warn(obj, msg) { console.warn(obj.name + ' --- ' + msg) }\n\n    function empty(mesh) { return (mesh.getIndices().length === 0) }\n\n    function missing(obj, list1, list2) {\n        if (!obj) return false\n        if (list1.includes(obj)) return false\n        if (list2 && list2.includes(obj)) return false\n        return true\n    }\n    return 'done.'\n}\n\nRendering.prototype.debug_MeshCount = function () {\n    var ct = {}\n    this._scene.meshes.forEach(m => {\n        var n = m.name || ''\n        n = n.replace(/-\\d+.*/, '#')\n        n = n.replace(/\\d+.*/, '#')\n        n = n.replace(/(rotHolder|camHolder|camScreen)/, 'rendering use')\n        n = n.replace(/atlas sprite .*/, 'atlas sprites')\n        ct[n] = ct[n] || 0\n        ct[n]++\n    })\n    for (var s in ct) console.log('   ' + (ct[s] + '       ').substr(0, 7) + s)\n}\n\n\n\n\n\n\n\nimport { makeProfileHook } from './util'\nvar profile_hook = (PROFILE) ?\n    makeProfileHook(200, 'render internals') : () => { }\n\n\n\nvar fps_hook = function () { }\n\nfunction setUpFPS() {\n    var div = document.createElement('div')\n    div.id = 'noa_fps'\n    var style = 'position:absolute; top:0; right:0; z-index:0;'\n    style += 'color:white; background-color:rgba(0,0,0,0.5);'\n    style += 'font:14px monospace; text-align:center;'\n    style += 'min-width:2em; margin:4px;'\n    div.style = style\n    document.body.appendChild(div)\n    var every = 1000\n    var ct = 0\n    var longest = 0\n    var start = performance.now()\n    var last = start\n    fps_hook = function () {\n        ct++\n        var nt = performance.now()\n        if (nt - last > longest) longest = nt - last\n        last = nt\n        if (nt - start < every) return\n        var fps = Math.round(ct / (nt - start) * 1000)\n        var min = Math.round(1 / longest * 1000)\n        div.innerHTML = fps + '<br>' + min\n        ct = 0\n        longest = 0\n        start = nt\n    }\n}\n","\n/* \n *  Internal voxel data representation\n *\n *  Each voxel is stored as a Uint16.\n *  Voxel id is stored in lowest bits, and flags stored in upper bits for fast retrieval\n *  \n *  Stores, from right to left:\n *     9 bits of voxel ID\n *     4 bits of variation (e.g. orientation)  --- Not yet being used!\n *     1 bit solidity (i.e. physics-wise)\n *     1 bit opacity (whether voxel obscures neighboring faces)\n *     1 bit object marker (marks non-terrain blocks with custom meshes)\n */\n\n\nvar ID_BITS = 9\nvar ID_MASK = (1 << ID_BITS) - 1\n\nvar VAR_BITS = 4\nvar VAR_OFFSET = ID_BITS\nvar VAR_MASK = ((1 << VAR_BITS) - 1) << VAR_OFFSET\n\nvar n = ID_BITS + VAR_BITS\nvar SOLID_BIT = 1 << n++\nvar OPAQUE_BIT = 1 << n++\nvar OBJECT_BIT = 1 << n++\n\n// exports\n\nexport var constants = {}\n\nconstants.ID_MASK = ID_MASK\nconstants.VAR_MASK = VAR_MASK\nconstants.SOLID_BIT = SOLID_BIT\nconstants.OPAQUE_BIT = OPAQUE_BIT\nconstants.OBJECT_BIT = OBJECT_BIT\n\n","\nimport ndarray from 'ndarray'\nimport { Mesh } from '@babylonjs/core/Meshes/mesh'\nimport { SubMesh } from '@babylonjs/core/Meshes/subMesh'\nimport { VertexData } from '@babylonjs/core/Meshes/mesh.vertexData'\nimport { MultiMaterial } from '@babylonjs/core/Materials/multiMaterial'\nimport { Texture } from '@babylonjs/core/Materials/Textures/texture'\nimport '@babylonjs/core/Meshes/meshBuilder'\n\nimport { constants } from './constants'\nimport { copyNdarrayContents } from './util'\n\nexport default new TerrainMesher()\n\n\n\n\n// enable for profiling..\nvar PROFILE_EVERY = 0 // 100\n\n\n\n\n/*\n * \n *          TERRAIN MESHER!!\n * \n */\n\n\nfunction TerrainMesher() {\n\n    var greedyMesher = new GreedyMesher()\n    var meshBuilder = new MeshBuilder()\n\n\n    /*\n     * \n     * Entry point and high-level flow\n     * \n     */\n\n    this.meshChunk = function (chunk, matGetter, colGetter, ignoreMaterials, useAO, aoVals, revAoVal) {\n        profile_hook('start')\n        var noa = chunk.noa\n\n        // args\n        var mats = matGetter || noa.registry.getBlockFaceMaterial\n        var cols = colGetter || noa.registry._getMaterialVertexColor\n        var ao = (useAO === undefined) ? noa.rendering.useAO : useAO\n        var vals = aoVals || noa.rendering.aoVals\n        var rev = isNaN(revAoVal) ? noa.rendering.revAoVal : revAoVal\n\n        // copy voxel data into array padded with neighbor values\n        var voxels = buildPaddedVoxelArray(chunk)\n        profile_hook('copy')\n\n        // greedy mesher creates an array of Submesh structs\n        var edgesOnly = chunk.isFull || chunk.isEmpty\n        var subMeshes = greedyMesher.mesh(voxels, mats, cols, ao, vals, rev, edgesOnly)\n\n        // builds the babylon mesh that will be added to the scene\n        var mesh\n        if (subMeshes.length) {\n            mesh = meshBuilder.build(chunk, subMeshes, ignoreMaterials)\n            profile_hook('terrain')\n        }\n\n        profile_hook('end')\n        return mesh || null\n    }\n}\n\n\n\n\n\n\n\n\n\n/*\n * \n *      Padded voxel data assembler\n * \n * Takes the chunk of size n, and copies its data into center of an (n+2) ndarray\n * Then copies in edge data from neighbors, or if not available zeroes it out\n * Actual mesher will then run on the padded ndarray\n * \n*/\n\nfunction buildPaddedVoxelArray(chunk) {\n    var src = chunk.voxels\n    var cs = src.shape[0]\n    var tgt = cachedPadded\n\n    // embiggen cached target array\n    if (cs + 2 !== tgt.shape[0]) {\n        var s2 = cs + 2\n        tgt = new ndarray(new Uint16Array(s2 * s2 * s2), [s2, s2, s2])\n        cachedPadded = tgt\n    }\n\n    // loop through neighbors (neighbor(0,0,0) is the chunk itself)\n    // copying or zeroing voxel body/edge data into padded target array\n    var loc = _vecs[0]\n    var pos = _vecs[1]\n    var size = _vecs[2]\n    var tgtPos = _vecs[3]\n    var posValues = _vecs[4]\n    var sizeValues = _vecs[5]\n    var tgtPosValues = _vecs[6]\n    if (cs !== _cachedVecSize) {\n        _cachedVecSize = cs\n        allocateVectors(cs, posValues, sizeValues, tgtPosValues)\n    }\n\n    for (var i = 0; i < 3; i++) {\n        loc[0] = i\n        for (var j = 0; j < 3; j++) {\n            loc[1] = j\n            for (var k = 0; k < 3; k++) {\n                loc[2] = k\n                for (var n = 0; n < 3; n++) {\n                    var coord = loc[n]\n                    pos[n] = posValues[coord]\n                    size[n] = sizeValues[coord]\n                    tgtPos[n] = tgtPosValues[coord]\n                }\n                var nab = chunk._neighbors.get(i - 1, j - 1, k - 1)\n                var nsrc = (nab) ? nab.voxels : null\n                copyNdarrayContents(nsrc, tgt, pos, size, tgtPos)\n            }\n        }\n    }\n    return tgt\n}\nvar cachedPadded = new ndarray(new Uint16Array(27), [3, 3, 3])\nvar _vecs = Array.from(Array(10)).map(n => [0, 0, 0])\nvar _cachedVecSize\nfunction allocateVectors(size, posValues, sizeValues, tgtPosValues) {\n    for (var i = 0; i < 3; i++) {\n        posValues[i] = [size - 1, 0, 0][i]\n        sizeValues[i] = [1, size, 1][i]\n        tgtPosValues[i] = [0, 1, size + 1][i]\n    }\n}\n\n\n\n\n\n\n\n\n/*\n * \n *  Submesh - holds one submesh worth of greedy-meshed data\n * \n *  Basically, the greedy mesher builds these and the mesh builder consumes them\n * \n */\n\nfunction Submesh(id) {\n    this.id = id | 0\n    this.positions = []\n    this.indices = []\n    this.normals = []\n    this.colors = []\n    this.uvs = []\n    this.mergeable = false      // flag used during terrain meshing\n}\n\nSubmesh.prototype.dispose = function () {\n    this.positions = null\n    this.indices = null\n    this.normals = null\n    this.colors = null\n    this.uvs = null\n}\n\n\n\n\n\n\n\n\n/*\n * \n *  Mesh Builder - turns an array of Submesh data into a \n *  Babylon.js mesh/submeshes, ready to be added to the scene\n * \n */\n\nfunction MeshBuilder() {\n\n    var noa\n\n    // core\n    this.build = function (chunk, meshDataList, ignoreMaterials) {\n        noa = chunk.noa\n\n        // flag and merge submesh data that can share the default terrain material\n        var numMergeable = 0\n        for (var i = 0; i < meshDataList.length; i++) {\n            var mdat = meshDataList[i]\n            if (ignoreMaterials) {\n                mdat.mergeable = true\n            } else {\n                var url = noa.registry.getMaterialTexture(mdat.id)\n                var matData = noa.registry.getMaterialData(mdat.id)\n                mdat.mergeable = (!url)\n                    && (matData.alpha === 1)\n                    && (!matData.renderMat)\n            }\n            if (mdat.mergeable) numMergeable++\n        }\n        if (numMergeable > 1) mergeSubmeshes(meshDataList, false)\n\n        // now merge everything, keeping track of vertices/indices/materials\n        var results = mergeSubmeshes(meshDataList, true)\n\n        // merge sole remaining submesh instance into a babylon mesh\n        var merged = meshDataList[0]\n        var name = 'chunk_' + chunk.id\n        var mats = results.matIDs.map(id => getTerrainMaterial(id, ignoreMaterials))\n        var mesh = buildMeshFromSubmesh(merged, name, mats, results.vertices, results.indices)\n\n        // done, mesh will be positioned later when added to the scene\n        return mesh\n    }\n\n\n\n    // given a set of submesh objects, merge some or all of them\n    //      while tracking vertex/index offsets for each material ID\n    // Note: modifies meshDataList in place!\n    function mergeSubmeshes(meshDataList, mergeAll) {\n        var vertices = []\n        var indices = []\n        var matIDs = []\n\n        var target = null\n        for (var i = 0; i < meshDataList.length; ++i) {\n            var mdat = meshDataList[i]\n            if (!(mergeAll || mdat.mergeable)) continue\n\n            vertices.push(mdat.positions.length)\n            indices.push(mdat.indices.length)\n            matIDs.push(mdat.id)\n\n            if (!target) {\n                target = mdat\n\n            } else {\n                var indexOffset = target.positions.length / 3\n                // merge data in \"mdat\" onto \"target\"\n                mergeArrays(target.positions, mdat.positions)\n                mergeArrays(target.normals, mdat.normals)\n                mergeArrays(target.colors, mdat.colors)\n                mergeArrays(target.uvs, mdat.uvs)\n                // indices must be offset relative to data being merged onto\n                for (var j = 0, len = mdat.indices.length; j < len; ++j) {\n                    target.indices.push(mdat.indices[j] + indexOffset)\n                }\n                // get rid of entry that's been merged\n                meshDataList.splice(i, 1)\n                mdat.dispose()\n                i--\n            }\n        }\n\n        return {\n            vertices: vertices,\n            indices: indices,\n            matIDs: matIDs,\n        }\n    }\n\n    function mergeArrays(tgt, src) {\n        for (var i = 0; i < src.length; i++) tgt.push(src[i])\n    }\n\n\n    function buildMeshFromSubmesh(submesh, name, mats, verts, inds) {\n\n        // base mesh and vertexData object\n        var scene = noa.rendering.getScene()\n        var mesh = new Mesh(name, scene)\n        var vdat = new VertexData()\n        vdat.positions = submesh.positions\n        vdat.indices = submesh.indices\n        vdat.normals = submesh.normals\n        vdat.colors = submesh.colors\n        vdat.uvs = submesh.uvs\n        vdat.applyToMesh(mesh)\n        submesh.dispose()\n\n        if (mats.length === 1) {\n            // if only one material ID, assign as a regular mesh and return\n            mesh.material = mats[0]\n\n        } else {\n            // else we need to make a multimaterial and define (babylon) submeshes\n            var multiMat = new MultiMaterial('multimat ' + name, scene)\n            mesh.subMeshes = []\n            // var totalVerts = vdat.positions.length\n            // var totalInds = vdat.indices.length\n            var vertStart = 0\n            var indStart = 0\n            for (var i = 0; i < mats.length; i++) {\n                multiMat.subMaterials[i] = mats[i]\n                var sub = new SubMesh(i, vertStart, verts[i], indStart, inds[i], mesh)\n                mesh.subMeshes[i] = sub\n                vertStart += verts[i]\n                indStart += inds[i]\n            }\n            mesh.material = multiMat\n        }\n\n        return mesh\n    }\n\n\n\n\n    //                         Material wrangling\n\n\n    var materialCache = {}\n\n    // manage materials/textures to avoid duplicating them\n    function getTerrainMaterial(matID, ignore) {\n        if (ignore) return noa.rendering.flatMaterial\n        var name = 'terrain mat ' + matID\n        if (!materialCache[name]) materialCache[name] = makeTerrainMaterial(matID)\n        return materialCache[name]\n    }\n\n\n    // canonical function to make a terrain material\n    function makeTerrainMaterial(id) {\n        // if user-specified render material is defined, use it\n        var matData = noa.registry.getMaterialData(id)\n        if (matData.renderMat) return matData.renderMat\n        // otherwise determine which built-in material to use\n        var url = noa.registry.getMaterialTexture(id)\n        var alpha = matData.alpha\n        if (!url && alpha == 1) {\n            // base material is fine for non-textured case, if no alpha\n            return noa.rendering.flatMaterial\n        }\n        var mat = noa.rendering.flatMaterial.clone('terrain' + id)\n        if (url) {\n            var scene = noa.rendering.getScene()\n            var tex = new Texture(url, scene, true, false, Texture.NEAREST_SAMPLINGMODE)\n            if (matData.textureAlpha) tex.hasAlpha = true\n            mat.diffuseTexture = tex\n        }\n        if (matData.alpha < 1) {\n            mat.alpha = matData.alpha\n        }\n        return mat\n    }\n}\n\n\n\n\n\n\n\n\n/*\n *    Greedy voxel meshing algorithm\n *        based initially on algo by Mikola Lysenko:\n *          http://0fps.net/2012/07/07/meshing-minecraft-part-2/\n *          but evolved quite a bit since then\n *        AO handling by me, stitched together out of cobwebs and dreams\n *    \n *    Arguments:\n *        arr: 3D ndarray of dimensions X,Y,Z\n *             packed with solidity/opacity booleans in higher bits\n *        getMaterial: function( blockID, dir )\n *             returns a material ID based on block id and which cube face it is\n *             (assume for now that each mat ID should get its own mesh)\n *        getColor: function( materialID )\n *             looks up a color (3-array) by material ID\n *             TODO: replace this with a lookup array?\n *        doAO: whether or not to bake ambient occlusion into vertex colors\n *        aoValues: array[3] of color multipliers for AO (least to most occluded)\n *        revAoVal: \"reverse ao\" - color multiplier for unoccluded exposed edges\n *\n *    Return object: array of mesh objects keyed by material ID\n *        arr[id] = {\n *          id:       material id for mesh\n *          vertices: ints, range 0 .. X/Y/Z\n *          indices:  ints\n *          normals:  ints,   -1 .. 1\n *          colors:   floats,  0 .. 1\n *          uvs:      floats,  0 .. X/Y/Z\n *        }\n */\n\nfunction GreedyMesher() {\n\n    var ID_MASK = constants.ID_MASK\n    var SOLID_BIT = constants.SOLID_BIT\n    var OPAQUE_BIT = constants.OPAQUE_BIT\n    // var VAR_MASK = constants.VAR_MASK // NYI\n    // var OBJECT_BIT = constants.OBJECT_BIT // not needed here\n\n\n    var maskCache = new Int16Array(16)\n    var aomaskCache = new Uint16Array(16)\n\n\n\n\n    this.mesh = function (voxels, getMaterial, getColor, doAO, aoValues, revAoVal, edgesOnly) {\n\n        // hash of Submeshes, keyed by material ID\n        var subMeshes = {}\n\n        // precalc how to apply AO packing in first masking function\n        var skipReverseAO = (doAO && (revAoVal === aoValues[0]))\n        var aoPackFcn\n        if (doAO) aoPackFcn = (skipReverseAO) ? packAOMaskNoReverse : packAOMask\n\n\n        //Sweep over each axis, mapping axes to [d,u,v]\n        for (var d = 0; d < 3; ++d) {\n            var u = (d + 1) % 3\n            var v = (d + 2) % 3\n\n            // make transposed ndarray so index i is the axis we're sweeping\n            var shape = voxels.shape\n            var arrT = voxels.transpose(d, u, v).lo(1, 1, 1).hi(shape[d] - 2, shape[u] - 2, shape[v] - 2)\n\n            // shorten len0 by 1 so faces at edges don't get drawn in both chunks\n            var len0 = arrT.shape[0] - 1\n            var len1 = arrT.shape[1]\n            var len2 = arrT.shape[2]\n\n            // embiggen mask arrays as needed\n            if (maskCache.length < len1 * len2) {\n                maskCache = new Int16Array(len1 * len2)\n                aomaskCache = new Uint16Array(len1 * len2)\n            }\n\n            // iterate along current major axis..\n            for (var i = 0; i <= len0; ++i) {\n\n                // fills mask and aomask arrays with values\n                constructMeshMasks(i, d, arrT, getMaterial, aoPackFcn)\n                profile_hook('masks')\n\n                // parses the masks to do greedy meshing\n                constructMeshDataFromMasks(i, d, u, v, len1, len2,\n                    doAO, subMeshes, getColor, aoValues, revAoVal)\n\n                // process edges only by jumping to other edge\n                if (edgesOnly) i += (len0 - 1)\n\n                profile_hook('submeshes')\n            }\n        }\n\n        // done, return hash of subMeshes as an array\n        return Object.keys(subMeshes).map(k => subMeshes[k])\n    }\n\n\n\n\n\n\n\n    //      Greedy meshing inner loop one\n    //\n    // iterating across ith 2d plane, with n being index into masks\n\n    function constructMeshMasks(i, d, arrT, getMaterial, aoPackFcn) {\n        var len = arrT.shape[1]\n        var mask = maskCache\n        var aomask = aomaskCache\n        // set up for quick array traversals\n        var n = 0\n        var materialDir = d * 2\n        var data = arrT.data\n        var dbase = arrT.index(i - 1, 0, 0)\n        var istride = arrT.stride[0]\n        var jstride = arrT.stride[1]\n        var kstride = arrT.stride[2]\n\n        for (var k = 0; k < len; ++k) {\n            var d0 = dbase\n            dbase += kstride\n            for (var j = 0; j < len; j++, n++, d0 += jstride) {\n\n                // mask[n] will represent the face needed between i-1,j,k and i,j,k\n                // for now, assume we never have two faces in both directions\n\n                // note that mesher zeroes out the mask as it goes, so there's \n                // no need to zero it here when no face is needed\n\n                // IDs at i-1,j,k  and  i,j,k\n                var id0 = data[d0]\n                var id1 = data[d0 + istride]\n\n                // most common case: never a face between same voxel IDs, \n                // so skip out early\n                if (id0 === id1) continue\n\n                var faceDir = getFaceDir(id0, id1, getMaterial, materialDir)\n                if (faceDir) {\n                    // set regular mask value to material ID, sign indicating direction\n                    mask[n] = (faceDir > 0) ?\n                        getMaterial(id0 & ID_MASK, materialDir) :\n                        -getMaterial(id1 & ID_MASK, materialDir + 1)\n\n                    // if doing AO, precalculate AO level for each face into second mask\n                    if (aoPackFcn) {\n                        // i values in direction face is/isn't pointing{\n                        aomask[n] = (faceDir > 0) ?\n                            aoPackFcn(arrT, i, i - 1, j, k) :\n                            aoPackFcn(arrT, i - 1, i, j, k)\n                    }\n                }\n            }\n        }\n    }\n\n\n\n    function getFaceDir(id0, id1, getMaterial, materialDir) {\n        // no face if both blocks are opaque\n        var op0 = id0 & OPAQUE_BIT\n        var op1 = id1 & OPAQUE_BIT\n        if (op0 && op1) return 0\n        // if either block is opaque draw a face for it\n        if (op0) return 1\n        if (op1) return -1\n        // can't tell from block IDs, so compare block materials of each face\n        var m0 = getMaterial(id0 & ID_MASK, materialDir)\n        var m1 = getMaterial(id1 & ID_MASK, materialDir + 1)\n        // if same material, draw no face. If one is missing, draw the other\n        if (m0 === m1) { return 0 }\n        else if (m0 === 0) { return -1 }\n        else if (m1 === 0) { return 1 }\n        // remaining case is two different non-opaque block materials\n        // facing each other. for now, draw neither..\n        return 0\n    }\n\n\n\n\n\n\n\n    //      Greedy meshing inner loop two\n    //\n    // construct data for mesh using the masks\n\n    function constructMeshDataFromMasks(i, d, u, v, len1, len2,\n        doAO, submeshes, getColor, aoValues, revAoVal) {\n        var n = 0\n        var mask = maskCache\n        var aomask = aomaskCache\n\n        // some logic is broken into helper functions for AO and non-AO\n        // this fixes deopts in Chrome (for reasons unknown)\n        var maskCompareFcn = (doAO) ? maskCompare : maskCompare_noAO\n        var meshColorFcn = (doAO) ? pushMeshColors : pushMeshColors_noAO\n\n        for (var k = 0; k < len2; ++k) {\n            var w = 1\n            var h = 1\n            for (var j = 0; j < len1; j += w, n += w) {\n\n                var maskVal = mask[n] | 0\n                if (!maskVal) {\n                    w = 1\n                    continue\n                }\n                var ao = aomask[n] | 0\n\n                // Compute width and height of area with same mask/aomask values\n                for (w = 1; w < len1 - j; ++w) {\n                    if (!maskCompareFcn(n + w, mask, maskVal, aomask, ao)) break\n                }\n\n                OUTER:\n                for (h = 1; h < len2 - k; ++h) {\n                    for (var m = 0; m < w; ++m) {\n                        var ix = n + m + h * len1\n                        if (!maskCompareFcn(ix, mask, maskVal, aomask, ao)) break OUTER\n                    }\n                }\n\n                // for testing: doing the following will disable greediness\n                //w=h=1\n\n                // material and mesh for this face\n                var matID = Math.abs(maskVal)\n                if (!submeshes[matID]) submeshes[matID] = new Submesh(matID)\n                var mesh = submeshes[matID]\n                var colors = mesh.colors\n                var c = getColor(matID)\n\n                // colors are pushed in helper function - avoids deopts\n                // tridir is boolean for which way to split the quad into triangles\n\n                var triDir = meshColorFcn(colors, c, ao, aoValues, revAoVal)\n\n\n                //Add quad, vertices = x -> x+du -> x+du+dv -> x+dv\n                var x = [0, 0, 0]\n                x[d] = i\n                x[u] = j\n                x[v] = k\n                var du = [0, 0, 0]\n                var dv = [0, 0, 0]\n                du[u] = w\n                dv[v] = h\n\n                var pos = mesh.positions\n                pos.push(\n                    x[0], x[1], x[2],\n                    x[0] + du[0], x[1] + du[1], x[2] + du[2],\n                    x[0] + du[0] + dv[0], x[1] + du[1] + dv[1], x[2] + du[2] + dv[2],\n                    x[0] + dv[0], x[1] + dv[1], x[2] + dv[2])\n\n\n                // add uv values, with the order and sign depending on \n                // axis and direction so as to avoid mirror-image textures\n                var dir = (maskVal > 0) ? 1 : -1\n\n                if (d === 2) {\n                    mesh.uvs.push(\n                        0, h,\n                        -dir * w, h,\n                        -dir * w, 0,\n                        0, 0)\n                } else {\n                    mesh.uvs.push(\n                        0, w,\n                        0, 0,\n                        dir * h, 0,\n                        dir * h, w)\n                }\n\n\n                // Add indexes, ordered clockwise for the facing direction;\n\n                var vs = pos.length / 3 - 4\n\n                if (maskVal < 0) {\n                    if (triDir) {\n                        mesh.indices.push(vs, vs + 1, vs + 2, vs, vs + 2, vs + 3)\n                    } else {\n                        mesh.indices.push(vs + 1, vs + 2, vs + 3, vs, vs + 1, vs + 3)\n                    }\n                } else {\n                    if (triDir) {\n                        mesh.indices.push(vs, vs + 2, vs + 1, vs, vs + 3, vs + 2)\n                    } else {\n                        mesh.indices.push(vs + 3, vs + 1, vs, vs + 3, vs + 2, vs + 1)\n                    }\n                }\n\n\n                // norms depend on which direction the mask was solid in..\n                var norm0 = d === 0 ? dir : 0\n                var norm1 = d === 1 ? dir : 0\n                var norm2 = d === 2 ? dir : 0\n\n                // same norm for all vertices\n                mesh.normals.push(\n                    norm0, norm1, norm2,\n                    norm0, norm1, norm2,\n                    norm0, norm1, norm2,\n                    norm0, norm1, norm2)\n\n\n                //Zero-out mask\n                for (var hx = 0; hx < h; ++hx) {\n                    for (var wx = 0; wx < w; ++wx) {\n                        mask[n + wx + hx * len1] = 0\n                    }\n                }\n\n            }\n        }\n    }\n\n\n\n    // Two helper functions with AO and non-AO implementations:\n\n    function maskCompare(index, mask, maskVal, aomask, aoVal) {\n        if (maskVal !== mask[index]) return false\n        if (aoVal !== aomask[index]) return false\n        return true\n    }\n\n    function maskCompare_noAO(index, mask, maskVal, aomask, aoVal) {\n        if (maskVal !== mask[index]) return false\n        return true\n    }\n\n    function pushMeshColors_noAO(colors, c, ao, aoValues, revAoVal) {\n        colors.push(c[0], c[1], c[2], 1)\n        colors.push(c[0], c[1], c[2], 1)\n        colors.push(c[0], c[1], c[2], 1)\n        colors.push(c[0], c[1], c[2], 1)\n        return true // triangle direction doesn't matter for non-AO\n    }\n\n    function pushMeshColors(colors, c, ao, aoValues, revAoVal) {\n        var ao00 = unpackAOMask(ao, 0, 0)\n        var ao10 = unpackAOMask(ao, 1, 0)\n        var ao11 = unpackAOMask(ao, 1, 1)\n        var ao01 = unpackAOMask(ao, 0, 1)\n        pushAOColor(colors, c, ao00, aoValues, revAoVal)\n        pushAOColor(colors, c, ao10, aoValues, revAoVal)\n        pushAOColor(colors, c, ao11, aoValues, revAoVal)\n        pushAOColor(colors, c, ao01, aoValues, revAoVal)\n\n        // this bit is pretty magical..\n        var triDir = true\n        if (ao00 === ao11) {\n            triDir = (ao01 === ao10) ? (ao01 == 2) : true\n        } else {\n            triDir = (ao01 === ao10) ? false : (ao00 + ao11 > ao01 + ao10)\n        }\n        return triDir\n    }\n\n\n\n\n\n    /* \n     *  packAOMask:\n     *\n     *    For a given face, find occlusion levels for each vertex, then\n     *    pack 4 such (2-bit) values into one Uint8 value\n     * \n     *  Occlusion levels:\n     *    1 is flat ground, 2 is partial occlusion, 3 is max (corners)\n     *    0 is \"reverse occlusion\" - an unoccluded exposed edge \n     *  Packing order var(bit offset):\n     *      a01(2)  -   a11(6)   ^  K\n     *        -     -            +> J\n     *      a00(0)  -   a10(4)\n     */\n\n    // when skipping reverse AO, uses this simpler version of the function:\n\n    function packAOMaskNoReverse(data, ipos, ineg, j, k) {\n        var a00 = 1\n        var a01 = 1\n        var a10 = 1\n        var a11 = 1\n        var solidBit = SOLID_BIT\n\n        // facing into a solid (non-opaque) block?\n        var facingSolid = (solidBit & data.get(ipos, j, k))\n\n        // inc occlusion of vertex next to obstructed side\n        if (data.get(ipos, j + 1, k) & solidBit) { ++a10; ++a11 }\n        if (data.get(ipos, j - 1, k) & solidBit) { ++a00; ++a01 }\n        if (data.get(ipos, j, k + 1) & solidBit) { ++a01; ++a11 }\n        if (data.get(ipos, j, k - 1) & solidBit) { ++a00; ++a10 }\n\n        // treat corners differently based when facing a solid block\n        if (facingSolid) {\n            // always 2, or 3 in corners\n            a11 = (a11 == 3 || data.get(ipos, j + 1, k + 1) & solidBit) ? 3 : 2\n            a01 = (a01 == 3 || data.get(ipos, j - 1, k + 1) & solidBit) ? 3 : 2\n            a10 = (a10 == 3 || data.get(ipos, j + 1, k - 1) & solidBit) ? 3 : 2\n            a00 = (a00 == 3 || data.get(ipos, j - 1, k - 1) & solidBit) ? 3 : 2\n        } else {\n            // treat corner as occlusion 3 only if not occluded already\n            if (a11 === 1 && (data.get(ipos, j + 1, k + 1) & solidBit)) { a11 = 2 }\n            if (a01 === 1 && (data.get(ipos, j - 1, k + 1) & solidBit)) { a01 = 2 }\n            if (a10 === 1 && (data.get(ipos, j + 1, k - 1) & solidBit)) { a10 = 2 }\n            if (a00 === 1 && (data.get(ipos, j - 1, k - 1) & solidBit)) { a00 = 2 }\n        }\n\n        return a11 << 6 | a10 << 4 | a01 << 2 | a00\n    }\n\n    // more complicated AO packing when doing reverse AO on corners\n\n    function packAOMask(data, ipos, ineg, j, k) {\n        var a00 = 1\n        var a01 = 1\n        var a10 = 1\n        var a11 = 1\n        var solidBit = SOLID_BIT\n\n        // facing into a solid (non-opaque) block?\n        var facingSolid = (solidBit & data.get(ipos, j, k))\n\n        // inc occlusion of vertex next to obstructed side\n        if (data.get(ipos, j + 1, k) & solidBit) { ++a10; ++a11 }\n        if (data.get(ipos, j - 1, k) & solidBit) { ++a00; ++a01 }\n        if (data.get(ipos, j, k + 1) & solidBit) { ++a01; ++a11 }\n        if (data.get(ipos, j, k - 1) & solidBit) { ++a00; ++a10 }\n\n        if (facingSolid) {\n            // always 2, or 3 in corners\n            a11 = (a11 == 3 || data.get(ipos, j + 1, k + 1) & solidBit) ? 3 : 2\n            a01 = (a01 == 3 || data.get(ipos, j - 1, k + 1) & solidBit) ? 3 : 2\n            a10 = (a10 == 3 || data.get(ipos, j + 1, k - 1) & solidBit) ? 3 : 2\n            a00 = (a00 == 3 || data.get(ipos, j - 1, k - 1) & solidBit) ? 3 : 2\n        } else {\n\n            // check each corner, and if not present do reverse AO\n            if (a11 === 1) {\n                if (data.get(ipos, j + 1, k + 1) & solidBit) {\n                    a11 = 2\n                } else if (!(data.get(ineg, j, k + 1) & solidBit) ||\n                    !(data.get(ineg, j + 1, k) & solidBit) ||\n                    !(data.get(ineg, j + 1, k + 1) & solidBit)) {\n                    a11 = 0\n                }\n            }\n\n            if (a10 === 1) {\n                if (data.get(ipos, j + 1, k - 1) & solidBit) {\n                    a10 = 2\n                } else if (!(data.get(ineg, j, k - 1) & solidBit) ||\n                    !(data.get(ineg, j + 1, k) & solidBit) ||\n                    !(data.get(ineg, j + 1, k - 1) & solidBit)) {\n                    a10 = 0\n                }\n            }\n\n            if (a01 === 1) {\n                if (data.get(ipos, j - 1, k + 1) & solidBit) {\n                    a01 = 2\n                } else if (!(data.get(ineg, j, k + 1) & solidBit) ||\n                    !(data.get(ineg, j - 1, k) & solidBit) ||\n                    !(data.get(ineg, j - 1, k + 1) & solidBit)) {\n                    a01 = 0\n                }\n            }\n\n            if (a00 === 1) {\n                if (data.get(ipos, j - 1, k - 1) & solidBit) {\n                    a00 = 2\n                } else if (!(data.get(ineg, j, k - 1) & solidBit) ||\n                    !(data.get(ineg, j - 1, k) & solidBit) ||\n                    !(data.get(ineg, j - 1, k - 1) & solidBit)) {\n                    a00 = 0\n                }\n            }\n        }\n\n        return a11 << 6 | a10 << 4 | a01 << 2 | a00\n    }\n\n\n\n    // unpack (2 bit) ao value from ao mask\n    // see above for details\n    function unpackAOMask(aomask, jpos, kpos) {\n        var offset = jpos ? (kpos ? 6 : 4) : (kpos ? 2 : 0)\n        return aomask >> offset & 3\n    }\n\n\n    // premultiply vertex colors by value depending on AO level\n    // then push them into color array\n    function pushAOColor(colors, baseCol, ao, aoVals, revAoVal) {\n        var mult = (ao === 0) ? revAoVal : aoVals[ao - 1]\n        colors.push(baseCol[0] * mult, baseCol[1] * mult, baseCol[2] * mult, 1)\n    }\n\n}\n\n\n\n\n\n\n\nimport { makeProfileHook } from './util'\nvar profile_hook = (PROFILE_EVERY) ?\n    makeProfileHook(PROFILE_EVERY, 'Terrain meshing') : () => { }\n","import { SolidParticleSystem } from '@babylonjs/core/Particles/solidParticleSystem'\n\n\nexport default new ObjectMesher()\n\n\n// enable for profiling..\nvar PROFILE = 0\n\n\n\n\n// helper class to hold data about a single object mesh\nfunction ObjMeshDat(id, x, y, z) {\n    this.id = id | 0\n    this.x = x | 0\n    this.y = y | 0\n    this.z = z | 0\n}\n\n\n\n\n\n\n\n/*\n * \n * \n *          Object meshing\n *  Per-chunk handling of the creation/disposal of voxels with static meshes\n * \n * \n */\n\n\nfunction ObjectMesher() {\n\n\n    // adds properties to the new chunk that will be used when processing\n    this.initChunk = function (chunk) {\n        chunk._objectBlocks = {}\n        chunk._objectSystems = []\n    }\n\n    this.disposeChunk = function (chunk) {\n        this.removeObjectMeshes(chunk)\n        chunk._objectBlocks = null\n    }\n\n\n\n\n    // accessors for the chunk to regester as object voxels are set/unset\n    this.addObjectBlock = function (chunk, id, x, y, z) {\n        var key = x + '|' + y + '|' + z\n        chunk._objectBlocks[key] = new ObjMeshDat(id, x, y, z, null)\n    }\n\n    this.removeObjectBlock = function (chunk, x, y, z) {\n        var key = x + '|' + y + '|' + z\n        if (chunk._objectBlocks[key]) delete chunk._objectBlocks[key]\n    }\n\n\n\n\n    /*\n     * \n     *    main implementation - remove / rebuild all needed object mesh instances\n     * \n     */\n\n    this.removeObjectMeshes = function (chunk) {\n        // remove the current (if any) sps/mesh\n        var systems = chunk._objectSystems || []\n        while (systems.length) {\n            var sps = systems.pop()\n            if (sps.mesh) sps.mesh.dispose()\n            sps.dispose()\n        }\n    }\n\n    this.buildObjectMeshes = function (chunk) {\n        profile_hook('start')\n\n        var scene = chunk.noa.rendering.getScene()\n        var objectMeshLookup = chunk.noa.registry._blockMeshLookup\n\n        // preprocess everything to build lists of object block keys\n        // hashed by material ID and then by block ID\n        var matIndexes = {}\n        for (var key in chunk._objectBlocks) {\n            var blockDat = chunk._objectBlocks[key]\n            var blockID = blockDat.id\n            var mat = objectMeshLookup[blockID].material\n            var matIndex = (mat) ? scene.materials.indexOf(mat) : -1\n            if (!matIndexes[matIndex]) matIndexes[matIndex] = {}\n            if (!matIndexes[matIndex][blockID]) matIndexes[matIndex][blockID] = []\n            matIndexes[matIndex][blockID].push(key)\n        }\n        profile_hook('preprocess')\n\n        // data structure now looks like:\n        // matIndexes = {\n        //      2: {                    // i.e. 2nd material in scene\n        //          14: {               // i.e. voxel ID 14 from registry\n        //              [ '2|3|4' ]     // key of block's local coords\n        //          }\n        //      }\n        // }\n\n        var x0 = chunk.i * chunk.size\n        var y0 = chunk.j * chunk.size\n        var z0 = chunk.k * chunk.size\n\n        // build one SPS mesh for each material\n        var meshes = []\n        for (var ix in matIndexes) {\n\n            var meshHash = matIndexes[ix]\n            var sps = buildSPSforMaterialIndex(chunk, scene, meshHash, x0, y0, z0)\n            profile_hook('made SPS')\n\n            // build SPS into the scene\n            var merged = sps.buildMesh()\n            profile_hook('built mesh')\n\n            // finish up\n            merged.material = (ix > -1) ? scene.materials[ix] : null\n            meshes.push(merged)\n            chunk._objectSystems.push(sps)\n        }\n\n        profile_hook('end')\n        return meshes\n    }\n\n\n\n\n    function buildSPSforMaterialIndex(chunk, scene, meshHash, x0, y0, z0) {\n        var blockHash = chunk._objectBlocks\n        // base sps\n        var sps = new SolidParticleSystem('object_sps_' + chunk.id, scene, {\n            updatable: false,\n        })\n\n        var blockHandlerLookup = chunk.noa.registry._blockHandlerLookup\n        var objectMeshLookup = chunk.noa.registry._blockMeshLookup\n\n        // run through mesh hash adding shapes and position functions\n        for (var blockID in meshHash) {\n            var mesh = objectMeshLookup[blockID]\n            var blockArr = meshHash[blockID]\n            var count = blockArr.length\n\n            var handlerFn\n            var handlers = blockHandlerLookup[blockID]\n            if (handlers) handlerFn = handlers.onCustomMeshCreate\n            var setShape = function (particle, partIndex, shapeIndex) {\n                var key = blockArr[shapeIndex]\n                var dat = blockHash[key]\n\n                // set (local) pos and call handler (with global coords)\n                particle.position.set(dat.x + 0.5, dat.y, dat.z + 0.5)\n                if (handlerFn) handlerFn(particle, x0 + dat.x, y0 + dat.y, z0 + dat.z)\n            }\n            sps.addShape(mesh, count, { positionFunction: setShape })\n            blockArr.length = 0\n        }\n\n        return sps\n    }\n\n\n\n\n}\n\n\n\n\n\n\n\nimport { makeProfileHook } from './util'\nvar profile_hook = (PROFILE) ?\n    makeProfileHook(50, 'Object meshing') : () => { }\n","\nvar ndarray = require('ndarray')\n\n// shared references to terrain/object meshers\nimport terrainMesher from './terrainMesher'\nimport objectMesher from './objectMesher'\nimport { constants } from './constants'\n\n\nexport default Chunk\n\n\n/* \n * \n *   Chunk\n * \n *  Stores and manages voxel ids and flags for each voxel within chunk\n *  See constants.js for internal data representation\n * \n */\n\n\n\n// data representation\nvar ID_MASK = constants.ID_MASK\n// var VAR_MASK = constants.VAR_MASK // NYI\nvar SOLID_BIT = constants.SOLID_BIT\nvar OPAQUE_BIT = constants.OPAQUE_BIT\nvar OBJECT_BIT = constants.OBJECT_BIT\n\n\n\n\n/*\n *\n *    Chunk constructor\n *\n */\n\nfunction Chunk(noa, id, i, j, k, size, dataArray) {\n    this.id = id            // id used by noa\n    this.requestID = ''     // id sent to game client\n\n    this.noa = noa\n    this.isDisposed = false\n    this.octreeBlock = null\n\n    // voxel data and properties\n    this.voxels = dataArray\n    this.i = i\n    this.j = j\n    this.k = k\n    this.size = size\n    this.x = i * size\n    this.y = j * size\n    this.z = k * size\n\n    // flags to track if things need re-meshing\n    this._terrainDirty = false\n    this._objectsDirty = false\n\n    // init references shared among all chunks\n    setBlockLookups(noa)\n\n    // makes data for terrain / object meshing\n    this._terrainMesh = null\n    this._objectBlocks = null\n    this._objectSystems = null\n    objectMesher.initChunk(this)\n\n    this.isFull = false\n    this.isEmpty = false\n\n    // references to neighboring chunks, if they exist (filled in by `world`)\n    var narr = Array.from(Array(27)).map(() => null)\n    this._neighbors = new ndarray(narr, [3, 3, 3]).lo(1, 1, 1)\n    this._neighbors.set(0, 0, 0, this)\n    this._neighborCount = 0\n    this._maxMeshedNeighbors = 0\n    this._timesMeshed = 0\n\n    // converts raw voxelID data into packed ID+solidity etc.\n    packVoxelData(this)\n}\n\n\n// expose logic internally to create and update the voxel data array\nChunk._createVoxelArray = function (size) {\n    var arr = new Uint16Array(size * size * size)\n    return new ndarray(arr, [size, size, size])\n}\n\nChunk.prototype._updateVoxelArray = function (dataArray) {\n    // dispose current object blocks\n    callAllBlockHandlers(this, 'onUnload')\n    objectMesher.disposeChunk(this)\n    this.voxels = dataArray\n    this._terrainDirty = false\n    this._objectsDirty = false\n    objectMesher.initChunk(this)\n    packVoxelData(this)\n}\n\n\n// Registry lookup references shared by all chunks\nvar solidLookup\nvar opaqueLookup\nvar objectMeshLookup\nvar blockHandlerLookup\n\nfunction setBlockLookups(noa) {\n    solidLookup = noa.registry._solidityLookup\n    opaqueLookup = noa.registry._opacityLookup\n    objectMeshLookup = noa.registry._blockMeshLookup\n    blockHandlerLookup = noa.registry._blockHandlerLookup\n}\n\n\n\n\n\n\n\n\n/*\n *\n *    Chunk API\n *\n */\n\n// get/set deal with block IDs, so that this class acts like an ndarray\n\nChunk.prototype.get = function (x, y, z) {\n    return ID_MASK & this.voxels.get(x, y, z)\n}\n\nChunk.prototype.getSolidityAt = function (x, y, z) {\n    return (SOLID_BIT & this.voxels.get(x, y, z)) ? true : false\n}\n\nChunk.prototype.set = function (x, y, z, id) {\n    var oldID = this.voxels.get(x, y, z)\n    var oldIDnum = oldID & ID_MASK\n    if (id === oldIDnum) return\n\n    // manage data\n    var newID = packID(id)\n    this.voxels.set(x, y, z, newID)\n\n    // voxel lifecycle handling\n    if (oldID & OBJECT_BIT) removeObjectBlock(this, x, y, z)\n    if (newID & OBJECT_BIT) addObjectBlock(this, id, x, y, z)\n    callBlockHandler(this, oldIDnum, 'onUnset', x, y, z)\n    callBlockHandler(this, id, 'onSet', x, y, z)\n\n    // track full/emptiness and info about terrain\n    if ((newID & OPAQUE_BIT) === 0) this.isFull = false\n    if (newID !== 0) this.isEmpty = false\n    if (affectsTerrain(newID) || affectsTerrain(oldID)) {\n        this._terrainDirty = true\n    }\n\n    if (this._terrainDirty || this._objectsDirty) {\n        this.noa.world._queueChunkForRemesh(this)\n    }\n\n    // neighbors only affected if solidity or opacity changed on an edge\n    var prevSO = oldID & (SOLID_BIT | OPAQUE_BIT)\n    var newSO = newID & (SOLID_BIT | OPAQUE_BIT)\n    if (newSO !== prevSO) {\n        var edge = this.size - 1\n        var iedge = (x === 0) ? -1 : (x < edge) ? 0 : 1\n        var jedge = (y === 0) ? -1 : (y < edge) ? 0 : 1\n        var kedge = (z === 0) ? -1 : (z < edge) ? 0 : 1\n        if (iedge | jedge | kedge) {\n            var is = (iedge) ? [0, iedge] : [0]\n            var js = (jedge) ? [0, jedge] : [0]\n            var ks = (kedge) ? [0, kedge] : [0]\n            is.forEach(i => {\n                js.forEach(j => {\n                    ks.forEach(k => {\n                        if ((i | j | k) === 0) return\n                        var nab = this._neighbors.get(i, j, k)\n                        if (!nab) return\n                        nab._terrainDirty = true\n                        this.noa.world._queueChunkForRemesh(nab)\n                    })\n                })\n            })\n        }\n    }\n}\n\n\n\n\n\n\n// helper to call handler of a given type at a particular xyz\nfunction callBlockHandler(chunk, blockID, type, x, y, z) {\n    var hobj = blockHandlerLookup[blockID]\n    if (!hobj) return\n    var handler = hobj[type]\n    if (!handler) return\n    handler(chunk.x + x, chunk.y + y, chunk.z + z)\n}\n\n\n\n// Convert chunk's voxel terrain into a babylon.js mesh\n// Used internally, but needs to be public so mesh-building hacks can call it\nChunk.prototype.mesh = function (matGetter, colGetter, useAO, aoVals, revAoVal) {\n    return terrainMesher.meshChunk(this, matGetter, colGetter, useAO, aoVals, revAoVal)\n}\n\n\n\n\n\n// gets called by World when this chunk has been queued for remeshing\nChunk.prototype.updateMeshes = function () {\n    var rendering = this.noa.rendering\n    if (this._terrainDirty) {\n        if (this._terrainMesh) this._terrainMesh.dispose()\n        var mesh = this.mesh()\n        if (mesh && mesh.getIndices().length > 0) {\n            var pos = [this.x, this.y, this.z]\n            rendering.addMeshToScene(mesh, true, pos, this)\n        }\n        this._terrainMesh = mesh || null\n        this._terrainDirty = false\n        this._timesMeshed++\n        this._maxMeshedNeighbors = Math.max(this._maxMeshedNeighbors, this._neighborCount)\n    }\n    if (this._objectsDirty) {\n        objectMesher.removeObjectMeshes(this)\n        var meshes = objectMesher.buildObjectMeshes(this)\n        var pos2 = [this.x, this.y, this.z]\n        meshes.forEach(mesh => rendering.addMeshToScene(mesh, true, pos2, this))\n        this._objectsDirty = false\n    }\n}\n\n\n\n\n\n\n\n// helpers to determine which blocks are, or can affect, terrain meshes\nfunction affectsTerrain(id) {\n    if (id === 0) return false\n    if (id & SOLID_BIT) return true\n    return ((id & OBJECT_BIT) === 0)\n}\n\n// helper to pack a block ID into the internally stored form, given lookup tables\nfunction packID(id) {\n    var newID = id\n    if (solidLookup[id]) newID |= SOLID_BIT\n    if (opaqueLookup[id]) newID |= OPAQUE_BIT\n    if (objectMeshLookup[id]) newID |= OBJECT_BIT\n    return newID\n}\n\n\n\n\n\n\n\n\n/*\n * \n *      Init\n * \n *  Converts raw voxel ID data into packed ID + solidity etc.\n * \n*/\n\nfunction packVoxelData(chunk) {\n    // flags for tracking if chunk is entirely opaque or transparent\n    var fullyOpaque = OPAQUE_BIT\n    var fullyAir = true\n    var hasObj = false\n\n    var voxels = chunk.voxels\n    var len = voxels.shape[0]\n    for (var i = 0; i < len; ++i) {\n        for (var j = 0; j < len; ++j) {\n            var index = voxels.index(i, j, 0)\n            for (var k = 0; k < len; ++k, ++index) {\n                // pull raw ID - could in principle be packed, so mask it\n                var id = voxels.data[index] & ID_MASK\n                // skip air blocks\n                if (id === 0) {\n                    fullyOpaque = 0\n                    continue\n                }\n                // store ID as packed internal representation\n                var packed = packID(id) | 0\n                voxels.data[index] = packed\n                fullyOpaque &= packed\n                fullyAir = false\n                // within unpadded view, handle object blocks and handlers\n                if (OBJECT_BIT & packed) {\n                    addObjectBlock(chunk, id, i, j, k)\n                    hasObj = true\n                }\n                callBlockHandler(chunk, id, 'onLoad', i, j, k)\n            }\n        }\n    }\n\n    chunk.isFull = !!(fullyOpaque & OPAQUE_BIT)\n    chunk.isEmpty = !!(fullyAir)\n    chunk._terrainDirty = !chunk.isEmpty\n    chunk._objectsDirty = hasObj\n}\n\n\n\n\n\n// accessors related to meshing\n\nfunction addObjectBlock(chunk, id, x, y, z) {\n    objectMesher.addObjectBlock(chunk, id, x, y, z)\n    chunk._objectsDirty = true\n}\n\nfunction removeObjectBlock(chunk, x, y, z) {\n    objectMesher.removeObjectBlock(chunk, x, y, z)\n    chunk._objectsDirty = true\n}\n\n\n\n\n\n// dispose function - just clears properties and references\n\nChunk.prototype.dispose = function () {\n    // look through the data for onUnload handlers\n    callAllBlockHandlers(this, 'onUnload')\n\n    // let meshers dispose their stuff\n    objectMesher.disposeChunk(this)\n    if (this._terrainMesh) this._terrainMesh.dispose()\n\n    // apparently there's no way to dispose typed arrays, so just null everything\n    this.voxels.data = null\n    this.voxels = null\n    this._neighbors.data = null\n    this._neighbors = null\n\n    this.isDisposed = true\n}\n\n\n// helper to call a given handler for all blocks in the chunk\nfunction callAllBlockHandlers(chunk, type) {\n    var arr = chunk.voxels\n    var size = arr.shape[0]\n    for (var i = 0; i < size; ++i) {\n        for (var j = 0; j < size; ++j) {\n            for (var k = 0; k < size; ++k) {\n                var id = ID_MASK & arr.get(i, j, k)\n                if (id > 0) callBlockHandler(chunk, id, type, i, j, k)\n            }\n        }\n    }\n}\n","\nvar EventEmitter = require('events').EventEmitter\nimport Chunk from './chunk'\nimport { StringList } from './util'\nimport { loopForTime, numberOfVoxelsInSphere } from './util'\n\nvar PROFILE = 0\nvar PROFILE_QUEUES = 0\n\n\nexport default function (noa, opts) {\n    return new World(noa, opts)\n}\n\n\n\n\nvar defaultOptions = {\n    chunkSize: 24,\n    chunkAddDistance: 3,\n    chunkRemoveDistance: 4,\n    worldGenWhilePaused: false,\n}\n\n/**\n * @class\n * @typicalname noa.world\n * @emits worldDataNeeded(id, ndarray, x, y, z, worldName)\n * @emits chunkAdded(chunk)\n * @emits chunkBeingRemoved(id, ndarray, userData)\n * @classdesc Manages the world and its chunks\n * \n * Extends `EventEmitter`\n */\n\nfunction World(noa, opts) {\n    this.noa = noa\n    opts = Object.assign({}, defaultOptions, opts)\n\n    this.playerChunkLoaded = false\n    this.Chunk = Chunk\n\n    this.chunkSize = opts.chunkSize\n    this.chunkAddDistance = opts.chunkAddDistance\n    this.chunkRemoveDistance = opts.chunkRemoveDistance\n    if (this.chunkRemoveDistance < this.chunkAddDistance) {\n        this.chunkRemoveDistance = this.chunkAddDistance\n    }\n\n    // set this higher to cause chunks not to mesh until they have some neighbors\n    this.minNeighborsToMesh = 6\n\n    // settings for tuning worldgen behavior and throughput\n    this.maxChunksPendingCreation = 10\n    this.maxChunksPendingMeshing = 10\n    this.maxProcessingPerTick = 9      // ms\n    this.maxProcessingPerRender = 5    // ms\n    this.worldGenWhilePaused = opts.worldGenWhilePaused\n\n    // set up internal state\n    this._cachedWorldName = ''\n    this._lastPlayerChunkID = ''\n    this._chunkStorage = {}\n    initChunkQueues(this)\n    initChunkStorage(this)\n\n    // instantiate coord conversion functions based on the chunk size\n    // use bit twiddling if chunk size is a power of 2\n    var cs = this.chunkSize\n    if ((cs & cs - 1) === 0) {\n        var shift = Math.log2(cs) | 0\n        var mask = (cs - 1) | 0\n        this._worldCoordToChunkCoord = coord => (coord >> shift) | 0\n        this._worldCoordToChunkIndex = coord => (coord & mask) | 0\n    } else {\n        this._worldCoordToChunkCoord = coord => Math.floor(coord / cs) | 0\n        this._worldCoordToChunkIndex = coord => (((coord % cs) + cs) % cs) | 0\n    }\n\n}\nWorld.prototype = Object.create(EventEmitter.prototype)\n\n\n\n\n\n\n/*\n *\n *\n *\n *\n *                  PUBLIC API \n *\n *\n *\n *\n*/\n\n/** @param x,y,z */\nWorld.prototype.getBlockID = function (x, y, z) {\n    var chunk = this._getChunkByCoords(x, y, z)\n    if (!chunk) return 0\n    return chunk.get(\n        this._worldCoordToChunkIndex(x),\n        this._worldCoordToChunkIndex(y),\n        this._worldCoordToChunkIndex(z))\n}\n\n/** @param x,y,z */\nWorld.prototype.getBlockSolidity = function (x, y, z) {\n    var chunk = this._getChunkByCoords(x, y, z)\n    if (!chunk) return false\n    return !!chunk.getSolidityAt(\n        this._worldCoordToChunkIndex(x),\n        this._worldCoordToChunkIndex(y),\n        this._worldCoordToChunkIndex(z))\n}\n\n/** @param x,y,z */\nWorld.prototype.getBlockOpacity = function (x, y, z) {\n    var id = this.getBlockID(x, y, z)\n    return this.noa.registry.getBlockOpacity(id)\n}\n\n/** @param x,y,z */\nWorld.prototype.getBlockFluidity = function (x, y, z) {\n    var id = this.getBlockID(x, y, z)\n    return this.noa.registry.getBlockFluidity(id)\n}\n\n/** @param x,y,z */\nWorld.prototype.getBlockProperties = function (x, y, z) {\n    var id = this.getBlockID(x, y, z)\n    return this.noa.registry.getBlockProps(id)\n}\n\n/** @param x,y,z */\nWorld.prototype.getBlockObjectMesh = function (x, y, z) {\n    var chunk = this._getChunkByCoords(x, y, z)\n    if (!chunk) return 0\n    return chunk.getObjectMeshAt(\n        this._worldCoordToChunkIndex(x),\n        this._worldCoordToChunkIndex(y),\n        this._worldCoordToChunkIndex(z))\n}\n\n\n/** @param x,y,z */\nWorld.prototype.setBlockID = function (val, x, y, z) {\n    var i = this._worldCoordToChunkCoord(x)\n    var j = this._worldCoordToChunkCoord(y)\n    var k = this._worldCoordToChunkCoord(z)\n    var ix = this._worldCoordToChunkIndex(x)\n    var iy = this._worldCoordToChunkIndex(y)\n    var iz = this._worldCoordToChunkIndex(z)\n\n    // logic inside the chunk will trigger a remesh for chunk and \n    // any neighbors that need it\n    var chunk = this._getChunk(i, j, k)\n    if (chunk) chunk.set(ix, iy, iz, val)\n}\n\n\n/** @param x,y,z */\nWorld.prototype.isBoxUnobstructed = function (box) {\n    var base = box.base\n    var max = box.max\n    for (var i = Math.floor(base[0]); i < max[0] + 1; i++) {\n        for (var j = Math.floor(base[1]); j < max[1] + 1; j++) {\n            for (var k = Math.floor(base[2]); k < max[2] + 1; k++) {\n                if (this.getBlockSolidity(i, j, k)) return false\n            }\n        }\n    }\n    return true\n}\n\n\n/** client should call this after creating a chunk's worth of data (as an ndarray)  \n * If userData is passed in it will be attached to the chunk\n * @param id\n * @param array\n * @param userData\n */\nWorld.prototype.setChunkData = function (id, array, userData) {\n    setChunkData(this, id, array, userData)\n}\n\n\n/** Tells noa to discard voxel data within a given `AABB` (e.g. because \n * the game client received updated data from a server). \n * The engine will mark all affected chunks for disposal, and will later emit \n * new `worldDataNeeded` events (if the chunk is still in draw range).\n * Note that chunks invalidated this way will not emit a `chunkBeingRemoved` event \n * for the client to save data from.\n */\nWorld.prototype.invalidateVoxelsInAABB = function (box) {\n    invalidateChunksInBox(this, box)\n}\n\n\n\n\n\n\n\n/*\n * \n * \n * \n *                  internals:\n * \n *          tick functions that process queues and trigger events\n * \n * \n * \n*/\n\n\nWorld.prototype.tick = function () {\n    var tickStartTime = performance.now()\n\n    // if world has changed, mark everything to be removed and re-requested\n    if (this._cachedWorldName !== this.noa.worldName) {\n        markAllChunksForRemoval(this)\n        this._cachedWorldName = this.noa.worldName\n    }\n\n    // current player chunk changed since last tick?\n    var pos = getPlayerChunkCoords(this)\n    var chunkID = getChunkID(pos[0], pos[1], pos[2])\n    var changedChunks = (chunkID != this._lastPlayerChunkID)\n    if (changedChunks) {\n        this.emit('playerEnteredChunk', pos[0], pos[1], pos[2])\n        this._lastPlayerChunkID = chunkID\n    }\n    profile_hook('start')\n    profile_queues_hook('start')\n\n    // possibly scan for chunks to add/remove\n    if (changedChunks) {\n        findDistantChunksToRemove(this, pos[0], pos[1], pos[2])\n        profile_hook('remQueue')\n    }\n    var numChunks = numberOfVoxelsInSphere(this.chunkAddDistance)\n    if (changedChunks || (this._chunkIDsKnown.count() < numChunks)) {\n        findNewChunksInRange(this, pos[0], pos[1], pos[2])\n        profile_hook('addQueue')\n    }\n\n    // process (create or mesh) some chunks, up to max iteration time\n    loopForTime(this.maxProcessingPerTick, () => {\n        var done = processRequestQueue(this)\n        profile_hook('requests')\n        done = done && processRemoveQueue(this)\n        profile_hook('removes')\n        done = done && processMeshingQueue(this, false)\n        profile_hook('meshes')\n        return done\n    }, tickStartTime)\n\n    // when time is left over, look for low-priority extra meshing\n    var dt = performance.now() - tickStartTime\n    if (dt + 2 < this.maxProcessingPerTick) {\n        lookForChunksToMesh(this)\n        profile_hook('looking')\n        loopForTime(this.maxProcessingPerTick, () => {\n            var done = processMeshingQueue(this, false)\n            profile_hook('meshes')\n            return done\n        }, tickStartTime, true)\n    }\n\n    // track whether the player's local chunk is loaded and ready or not\n    var pChunk = this._getChunk(pos[0], pos[1], pos[2])\n    this.playerChunkLoaded = !!pChunk\n\n    profile_queues_hook('end', this)\n    profile_hook('end')\n}\n\n\nWorld.prototype.render = function () {\n    // on render, quickly process the high-priority meshing queue\n    // to help avoid flashes of background while neighboring chunks update\n    loopForTime(this.maxProcessingPerRender, () => {\n        return processMeshingQueue(this, true)\n    })\n}\n\n\n\n\n\n\n\n\n/*\n * \n * \n * \n *              chunk IDs, storage, and lookup/retrieval\n * \n * \n * \n*/\n\nfunction getChunkID(i, j, k) {\n    // chunk coords -> canonical string ID\n    return i + '|' + j + '|' + k\n}\n\nfunction parseChunkID(id) {\n    // chunk ID -> coords\n    return id.split('|').map(s => parseInt(s))\n}\n\nfunction initChunkStorage(world) {\n    // var chunkHash = ndHash([1024, 1024, 1024])\n    world._getChunk = (i, j, k) => {\n        var id = getChunkID(i, j, k)\n        return world._chunkStorage[id] || null\n    }\n    world._setChunk = (i, j, k, value) => {\n        var id = getChunkID(i, j, k)\n        if (value) {\n            world._chunkStorage[id] = value\n        } else {\n            delete world._chunkStorage[id]\n        }\n    }\n    // chunk accessor for internal use\n    world._getChunkByCoords = function (x, y, z) {\n        var i = world._worldCoordToChunkCoord(x)\n        var j = world._worldCoordToChunkCoord(y)\n        var k = world._worldCoordToChunkCoord(z)\n        return world._getChunk(i, j, k)\n    }\n}\n\nfunction getPlayerChunkCoords(world) {\n    var pos = world.noa.entities.getPosition(world.noa.playerEntity)\n    var i = world._worldCoordToChunkCoord(pos[0])\n    var j = world._worldCoordToChunkCoord(pos[1])\n    var k = world._worldCoordToChunkCoord(pos[2])\n    return [i, j, k]\n}\n\n\n\n\n\n\n\n\n/*\n * \n * \n * \n *              chunk queues and queue processing\n * \n * \n * \n*/\n\n\nfunction initChunkQueues(world) {\n    // queue meanings:\n    //    Known:        all chunks existing in any queue\n    //    ToRequest:    needed but not yet requested from client\n    //    Pending:      requested, awaiting creation\n    //    ToMesh:       created but not yet meshed\n    //    ToMeshFirst:  priority meshing queue\n    //    ToRemove:     chunks awaiting disposal\n    world._chunkIDsKnown = new StringList()\n    world._chunkIDsToRequest = new StringList()\n    world._chunkIDsPending = new StringList()\n    world._chunkIDsToMesh = new StringList()\n    world._chunkIDsToMeshFirst = new StringList()\n    world._chunkIDsToRemove = new StringList()\n    // accessor for chunks to queue themselves for remeshing\n    world._queueChunkForRemesh = (chunk) => {\n        queueChunkForRemesh(world, chunk)\n    }\n}\n\n\n// process neighborhood chunks, add missing ones to \"toRequest\" and \"inMemory\"\nfunction findNewChunksInRange(world, ci, cj, ck) {\n    var add = Math.ceil(world.chunkAddDistance)\n    var addDistSq = world.chunkAddDistance * world.chunkAddDistance\n    var known = world._chunkIDsKnown\n    var toRequest = world._chunkIDsToRequest\n    // search all nearby chunk locations\n    for (var i = ci - add; i <= ci + add; ++i) {\n        for (var j = cj - add; j <= cj + add; ++j) {\n            for (var k = ck - add; k <= ck + add; ++k) {\n                var id = getChunkID(i, j, k)\n                if (known.includes(id)) continue\n                var di = i - ci\n                var dj = j - cj\n                var dk = k - ck\n                var distSq = di * di + dj * dj + dk * dk\n                if (distSq > addDistSq) continue\n                known.add(id)\n                toRequest.add(id)\n            }\n        }\n    }\n    sortIDListByDistanceFrom(toRequest, ci, cj, ck)\n}\n\n\n// rebuild queue of chunks to be removed from around (ci,cj,ck)\nfunction findDistantChunksToRemove(world, ci, cj, ck) {\n    var remDistSq = world.chunkRemoveDistance * world.chunkRemoveDistance\n    var toRemove = world._chunkIDsToRemove\n    world._chunkIDsKnown.forEach(id => {\n        if (toRemove.includes(id)) return\n        var loc = parseChunkID(id)\n        var di = loc[0] - ci\n        var dj = loc[1] - cj\n        var dk = loc[2] - ck\n        var distSq = di * di + dj * dj + dk * dk\n        if (distSq < remDistSq) return\n        // flag chunk for removal and remove it from work queues\n        world._chunkIDsToRemove.add(id)\n        world._chunkIDsToRequest.remove(id)\n        world._chunkIDsToMesh.remove(id)\n        world._chunkIDsToMeshFirst.remove(id)\n    })\n    sortIDListByDistanceFrom(toRemove, ci, cj, ck)\n}\n\n\n// invalidate chunks overlapping the given AABB\nfunction invalidateChunksInBox(world, box) {\n    var min = box.base.map(n => Math.floor(world._worldCoordToChunkCoord(n)))\n    var max = box.max.map(n => Math.floor(world._worldCoordToChunkCoord(n)))\n    world._chunkIDsKnown.forEach(id => {\n        var pos = parseChunkID(id)\n        for (var i = 0; i < 3; i++) {\n            if (pos[i] < min[i] || pos[i] > max[i]) return\n        }\n        if (world._chunkIDsToRemove.includes(id)) return\n        world._chunkIDsToRequest.add(id)\n    })\n}\n\n// when current world changes - empty work queues and mark all for removal\nfunction markAllChunksForRemoval(world) {\n    world._chunkIDsToRemove.copyFrom(world._chunkIDsKnown)\n    world._chunkIDsToRequest.empty()\n    world._chunkIDsToMesh.empty()\n    world._chunkIDsToMeshFirst.empty()\n    var loc = getPlayerChunkCoords(world)\n    sortIDListByDistanceFrom(world._chunkIDsToRemove, loc[0], loc[1], loc[2])\n}\n\n\n// incrementally look for chunks that could stand to be re-meshed\nfunction lookForChunksToMesh(world) {\n    var queue = world._chunkIDsKnown.arr\n    var ct = Math.min(50, queue.length)\n    var numQueued = world._chunkIDsToMesh.count() + world._chunkIDsToMeshFirst.count()\n    for (var i = 0; i < ct; i++) {\n        lookIndex = (lookIndex + 1) % queue.length\n        var id = queue[lookIndex]\n        var chunk = world._chunkStorage[id]\n        if (!chunk) continue\n        var nc = chunk._neighborCount\n        if (nc < world.minNeighborsToMesh) continue\n        if (nc <= chunk._maxMeshedNeighbors) continue\n        queueChunkForRemesh(world, chunk)\n        if (++numQueued > 10) return\n    }\n}\nvar lookIndex = -1\n\n\n\n// run through chunk tracking queues looking for work to do next\nfunction processRequestQueue(world) {\n    var toRequest = world._chunkIDsToRequest\n    if (toRequest.isEmpty()) return true\n    // skip if too many outstanding requests, or if meshing queue is full\n    var pending = world._chunkIDsPending.count()\n    var toMesh = world._chunkIDsToMesh.count()\n    if (pending >= world.maxChunksPendingCreation) return true\n    if (toMesh >= world.maxChunksPendingMeshing) return true\n    var id = toRequest.pop()\n    requestNewChunk(world, id)\n    return toRequest.isEmpty()\n}\n\n\nfunction processRemoveQueue(world) {\n    var toRemove = world._chunkIDsToRemove\n    if (toRemove.isEmpty()) return true\n    removeChunk(world, toRemove.pop())\n    return (toRemove.isEmpty())\n}\n\n\n// similar to above but for chunks waiting to be meshed\nfunction processMeshingQueue(world, firstOnly) {\n    var queue = world._chunkIDsToMeshFirst\n    if (queue.isEmpty() && !firstOnly) queue = world._chunkIDsToMesh\n    if (queue.isEmpty()) return true\n\n    var id = queue.pop()\n    if (world._chunkIDsToRemove.includes(id)) return\n    var chunk = world._chunkStorage[id]\n    if (chunk) doChunkRemesh(world, chunk)\n}\n\n\n\n\n\n\n\n\n\n/*\n * \n * \n * \n *              chunk lifecycle - create / set / remove / modify\n * \n * \n * \n*/\n\n\n// create chunk object and request voxel data from client\nfunction requestNewChunk(world, id) {\n    var pos = parseChunkID(id)\n    var i = pos[0]\n    var j = pos[1]\n    var k = pos[2]\n    var size = world.chunkSize\n    var dataArr = Chunk._createVoxelArray(world.chunkSize)\n    var worldName = world.noa.worldName\n    var requestID = [i, j, k, worldName].join('|')\n    var x = i * size\n    var y = j * size\n    var z = k * size\n    world._chunkIDsPending.add(id)\n    world.emit('worldDataNeeded', requestID, dataArr, x, y, z, worldName)\n    profile_queues_hook('request')\n}\n\n// called when client sets a chunk's voxel data\n// If userData is passed in it will be attached to the chunk\nfunction setChunkData(world, reqID, array, userData) {\n    var arr = reqID.split('|')\n    var i = parseInt(arr.shift())\n    var j = parseInt(arr.shift())\n    var k = parseInt(arr.shift())\n    var worldName = arr.join('|')\n    var id = getChunkID(i, j, k)\n    world._chunkIDsPending.remove(id)\n    // discard data if it's for a world that's no longer current\n    if (worldName !== world.noa.worldName) return\n    // discard if chunk is no longer needed\n    if (!world._chunkIDsKnown.includes(id)) return\n    if (world._chunkIDsToRemove.includes(id)) return\n    var chunk = world._chunkStorage[id]\n    if (!chunk) {\n        // if chunk doesn't exist, create and init\n        var size = world.chunkSize\n        chunk = new Chunk(world.noa, id, i, j, k, size, array)\n        world._setChunk(i, j, k, chunk)\n        chunk.requestID = reqID\n        chunk.userData = userData\n        updateNeighborsOfChunk(world, i, j, k, chunk)\n        world.noa.rendering.prepareChunkForRendering(chunk)\n        world.emit('chunkAdded', chunk)\n    } else {\n        // else we're updating data for an existing chunk\n        chunk._updateVoxelArray(array)\n        // assume neighbors need remeshing\n        var list = chunk._neighbors.data\n        list.forEach(nab => {\n            if (!nab || nab === chunk) return\n            if (nab._neighborCount > 20) queueChunkForRemesh(world, nab)\n        })\n    }\n    // chunk can now be meshed...\n    queueChunkForRemesh(world, chunk)\n    profile_queues_hook('receive')\n}\n\n\n\n// remove a chunk that wound up in the remove queue\nfunction removeChunk(world, id) {\n    var loc = parseChunkID(id)\n    var chunk = world._getChunk(loc[0], loc[1], loc[2])\n    if (chunk) {\n        world.emit('chunkBeingRemoved', chunk.requestID, chunk.voxels, chunk.userData)\n        world.noa.rendering.disposeChunkForRendering(chunk)\n        chunk.dispose()\n        profile_queues_hook('dispose')\n        updateNeighborsOfChunk(world, loc[0], loc[1], loc[2], null)\n    }\n    world._setChunk(loc[0], loc[1], loc[2], null)\n    world._chunkIDsKnown.remove(id)\n    world._chunkIDsToMesh.remove(id)\n    world._chunkIDsToMeshFirst.remove(id)\n}\n\n\nfunction queueChunkForRemesh(world, chunk) {\n    var nc = chunk._neighborCount\n    var limit = Math.min(world.minNeighborsToMesh, 26)\n    if (nc < limit) return\n    chunk._terrainDirty = true\n    var queue = (nc === 26) ?\n        world._chunkIDsToMeshFirst : world._chunkIDsToMesh\n    queue.add(chunk.id)\n}\n\n\nfunction doChunkRemesh(world, chunk) {\n    world._chunkIDsToMesh.remove(chunk.id)\n    world._chunkIDsToMeshFirst.remove(chunk.id)\n    chunk.updateMeshes()\n    profile_queues_hook('mesh')\n}\n\n\n\n\n\n\n\n\n\n\n\n\n/*\n * \n * \n * \n *          misc helpers and implementation functions\n * \n * \n * \n*/\n\n\nfunction sortIDListByDistanceFrom(list, i, j, k) {\n    list.sort(id => {\n        var pos = parseChunkID(id)\n        var dx = pos[0] - i\n        var dy = pos[1] - j\n        var dz = pos[2] - k\n        // bias towards keeping verticals together for now\n        return (dx * dx + dz * dz) + Math.abs(dy)\n    })\n}\n\n\n// keep neighbor data updated when chunk is added or removed\nfunction updateNeighborsOfChunk(world, ci, cj, ck, chunk) {\n    for (var i = -1; i <= 1; i++) {\n        for (var j = -1; j <= 1; j++) {\n            for (var k = -1; k <= 1; k++) {\n                if ((i | j | k) === 0) continue\n                var nid = getChunkID(ci + i, cj + j, ck + k)\n                var neighbor = world._chunkStorage[nid]\n                if (!neighbor) continue\n                if (chunk) {\n                    chunk._neighborCount++\n                    chunk._neighbors.set(i, j, k, neighbor)\n                    neighbor._neighborCount++\n                    neighbor._neighbors.set(-i, -j, -k, chunk)\n                    // flag for remesh when chunk gets its last neighbor\n                    if (neighbor._neighborCount === 26) {\n                        queueChunkForRemesh(world, neighbor)\n                    }\n                } else {\n                    neighbor._neighborCount--\n                    neighbor._neighbors.set(-i, -j, -k, null)\n                }\n            }\n        }\n    }\n}\n\n\n\n\n\n\n\n\n/*\n * \n * \n * \n * \n *                  debugging\n * \n * \n * \n * \n*/\n\nWorld.prototype.report = function () {\n    console.log('World report - playerChunkLoaded: ', this.playerChunkLoaded)\n    _report(this, '  known:     ', this._chunkIDsKnown.arr, true)\n    _report(this, '  to request:', this._chunkIDsToRequest.arr)\n    _report(this, '  to remove: ', this._chunkIDsToRemove.arr)\n    _report(this, '  creating:  ', this._chunkIDsPending.arr)\n    _report(this, '  to mesh:   ', this._chunkIDsToMesh.arr.concat(this._chunkIDsToMeshFirst.arr))\n}\n\nfunction _report(world, name, arr, ext) {\n    var full = 0,\n        empty = 0,\n        exist = 0,\n        surrounded = 0,\n        remeshes = []\n    arr.forEach(id => {\n        var chunk = world._chunkStorage[id]\n        if (!chunk) return\n        exist++\n        remeshes.push(chunk._timesMeshed)\n        if (chunk.isFull) full++\n        if (chunk.isEmpty) empty++\n        if (chunk._neighborCount === 26) surrounded++\n    })\n    var out = arr.length.toString().padEnd(8)\n    out += ('exist: ' + exist).padEnd(12)\n    out += ('full: ' + full).padEnd(12)\n    out += ('empty: ' + empty).padEnd(12)\n    out += ('surr: ' + surrounded).padEnd(12)\n    if (ext) {\n        var sum = remeshes.reduce((acc, val) => acc + val, 0)\n        var max = remeshes.reduce((acc, val) => Math.max(acc, val), 0)\n        var min = remeshes.reduce((acc, val) => Math.min(acc, val), 0)\n        out += 'times meshed: avg ' + (sum / exist).toFixed(2)\n        out += '  max ' + max\n        out += '  min ' + min\n    }\n    console.log(name, out)\n}\n\n\nimport { makeProfileHook } from './util'\nvar profile_hook = (PROFILE) ?\n    makeProfileHook(100, 'world ticks:') : () => { }\nvar profile_queues_hook = () => { }\nif (PROFILE_QUEUES) profile_queues_hook = ((every) => {\n    var iter = 0\n    var counts = {}\n    var queues = {}\n    var started = performance.now()\n    return function profile_queues_hook(state, world) {\n        if (state === 'start') return\n        if (state !== 'end') return counts[state] = (counts[state] || 0) + 1\n        queues.toreq = (queues.toreq || 0) + world._chunkIDsToRequest.count()\n        queues.toget = (queues.toget || 0) + world._chunkIDsPending.count()\n        queues.tomesh = (queues.tomesh || 0) + world._chunkIDsToMesh.count() + world._chunkIDsToMeshFirst.count()\n        queues.tomesh1 = (queues.tomesh1 || 0) + world._chunkIDsToMeshFirst.count()\n        queues.torem = (queues.torem || 0) + world._chunkIDsToRemove.count()\n        if (++iter < every) return\n        var t = performance.now(), dt = t - started\n        var res = {}\n        Object.keys(queues).forEach(k => {\n            var num = Math.round((queues[k] || 0) / iter)\n            res[k] = `[${num}]`.padStart(5)\n        })\n        Object.keys(counts).forEach(k => {\n            var num = Math.round((counts[k] || 0) * 1000 / dt)\n            res[k] = ('' + num).padStart(3)\n        })\n        console.log('chunk flow: ',\n            `${res.toreq}-> ${res.request} req/s  `,\n            `${res.toget}-> ${res.receive} got/s  `,\n            `${(res.tomesh)}-> ${res.mesh} mesh/s  `,\n            `${res.torem}-> ${res.dispose} rem/s  `,\n            `(meshFirst: ${res.tomesh1.trim()})`,\n        )\n        iter = 0\n        counts = {}\n        queues = {}\n        started = performance.now()\n    }\n})(100)","\nvar createInputs = require('game-inputs')\n// var createInputs = require('../../../../npm-modules/game-inputs')\n\n\nexport default function (noa, opts, element) {\n    return makeInputs(noa, opts, element)\n}\n\n\n/**\n * @class Inputs\n * @typicalname noa.inputs\n * @classdesc Abstracts key/mouse input. \n * For docs see [andyhall/game-inputs](https://github.com/andyhall/game-inputs)\n */\n\n\nvar defaultBindings = {\n    bindings: {\n        \"forward\": [\"W\", \"<up>\"],\n        \"left\": [\"A\", \"<left>\"],\n        \"backward\": [\"S\", \"<down>\"],\n        \"right\": [\"D\", \"<right>\"],\n        \"fire\": \"<mouse 1>\",\n        \"mid-fire\": [\"<mouse 2>\", \"Q\"],\n        \"alt-fire\": [\"<mouse 3>\", \"E\"],\n        \"jump\": \"<space>\",\n        \"sprint\": \"<shift>\",\n        \"crouch\": \"<control>\"\n    }\n}\n\n\nfunction makeInputs(noa, opts, element) {\n    opts = Object.assign({}, defaultBindings, opts)\n    var inputs = createInputs(element, opts)\n    var b = opts.bindings\n    for (var name in b) {\n        var arr = (Array.isArray(b[name])) ? b[name] : [b[name]]\n        arr.unshift(name)\n        inputs.bind.apply(inputs, arr)\n    }\n    return inputs\n}\n","\nvar createPhysics = require('voxel-physics-engine')\n// var createPhysics = require('../../../../npm-modules/voxel-physics-engine')\n\n\nexport default function (noa, opts) {\n    return makePhysics(noa, opts)\n}\n\n\n/**\n * @class Physics\n * @typicalname noa.physics\n * @classdesc Wrapper module for the physics engine. For docs see \n * [andyhall/voxel-physics-engine](https://github.com/andyhall/voxel-physics-engine)\n */\n\n\nvar defaults = {\n    gravity: [0, -10, 0],\n    airDrag: 0.1,\n}\n\n\nfunction makePhysics(noa, opts) {\n    opts = Object.assign({}, defaults, opts)\n    var world = noa.world\n    // physics engine runs in offset coords, so voxel getters need to match\n    var offset = noa.worldOriginOffset\n    var blockGetter = (x, y, z) => {\n        return world.getBlockSolidity(x + offset[0], y + offset[1], z + offset[2])\n    }\n    var isFluidGetter = (x, y, z) => {\n        return world.getBlockFluidity(x + offset[0], y + offset[1], z + offset[2])\n    }\n\n    var physics = createPhysics(opts, blockGetter, isFluidGetter)\n\n    return physics\n}\n","\nvar vec3 = require('gl-vec3')\nvar aabb = require('aabb-3d')\nvar sweep = require('voxel-aabb-sweep')\n\n\nexport default function (noa, opts) {\n    return new Camera(noa, opts)\n}\n\n\n\n\nvar defaults = {\n    inverseX: false,\n    inverseY: false,\n    sensitivityX: 10,\n    sensitivityY: 10,\n    initialZoom: 0,\n    zoomSpeed: 0.2,\n}\n\n\n/** \n * @class\n * @typicalname noa.camera\n * @classdesc Manages the camera, exposes camera position, direction, mouse sensitivity.\n */\n\n\nfunction Camera(noa, opts) {\n    this.noa = noa\n\n    /**\n     * `noa.camera` uses the following options (from the root `noa(opts)` options):\n     * ```js\n     * {\n     *   inverseX: false,\n     *   inverseY: false,\n     *   sensitivityX: 15,\n     *   sensitivityY: 15,\n     *   initialZoom: 0,\n     *   zoomSpeed: 0.2,\n     * }\n     * ```\n     */\n    opts = Object.assign({}, defaults, opts)\n\n    /** Horizontal mouse sensitivity. \n     * Same scale as Overwatch (typical values around `5..10`)\n     */\n    this.sensitivityX = opts.sensitivityX\n\n    /** Vertical mouse sensitivity.\n     * Same scale as Overwatch (typical values around `5..10`)\n     */\n    this.sensitivityY = opts.sensitivityY\n\n    /** Mouse look inverse (horizontal) */\n    this.inverseX = opts.inverseX\n\n    /** Mouse look inverse (vertical) */\n    this.inverseY = opts.inverseY\n\n\n    /** Camera yaw angle (read only) \n     * \n     * Returns the camera's rotation angle around the vertical axis. Range: `0..2π`\n     */\n    this.heading = 0\n\n    /** Camera pitch angle (read only)\n     * \n     * Returns the camera's up/down rotation angle. Range: `-π/2..π/2`. \n     * (The pitch angle is clamped by a small epsilon, such that \n     * the camera never quite points perfectly up or down.\n     */\n    this.pitch = 0\n\n\n    /** Entity ID of a special entity that exists for the camera to point at.\n     * \n     * By default this entity follows the player entity, so you can \n     * change the player's eye height by changing the `follow` component's offset:\n     * ```js\n     * var followState = noa.ents.getState(noa.camera.cameraTarget, 'followsEntity')\n     * followState.offset[1] = 0.9 * myPlayerHeight\n     * ```\n     * \n     * For customized camera controls you can change the follow \n     * target to some other entity, or override the behavior entirely:\n     * ```js\n     * // make cameraTarget stop following the player\n     * noa.ents.removeComponent(noa.camera.cameraTarget, 'followsEntity')\n     * // control cameraTarget position directly (or whatever..)\n     * noa.ents.setPosition(noa.camera.cameraTarget, [x,y,z])\n     * ```\n     */\n    this.cameraTarget = this.noa.ents.createEntity(['position'])\n\n    // follow component and default offset\n    var eyeOffset = 0.9 * noa.ents.getPositionData(noa.playerEntity).height\n    noa.ents.addComponent(this.cameraTarget, 'followsEntity', {\n        entity: noa.playerEntity,\n        offset: [0, eyeOffset, 0],\n    })\n\n    /** How far back the camera is zoomed from the camera target */\n    this.zoomDistance = opts.initialZoom\n\n    /** How quickly the camera moves to its `zoomDistance` (0..1) */\n    this.zoomSpeed = opts.zoomSpeed\n\n    /** Current actual zoom distance. This differs from `zoomDistance` when\n     * the camera is in the process of moving towards the desired distance, \n     * or when it's obstructed by solid terrain behind the player. */\n    this.currentZoom = opts.initialZoom\n\n    // internals\n    this._dirVector = vec3.fromValues(0, 1, 0)\n}\n\n\n/*\n * \n *  Local position functions for high precision\n * \n */\nCamera.prototype._localGetTargetPosition = function () {\n    var pdat = this.noa.ents.getPositionData(this.cameraTarget)\n    return vec3.copy(_camPos, pdat._renderPosition)\n}\n\nCamera.prototype._localGetPosition = function () {\n    var loc = this._localGetTargetPosition()\n    if (this.currentZoom === 0) return loc\n    return vec3.scaleAndAdd(loc, loc, this._dirVector, -this.currentZoom)\n}\nvar _camPos = vec3.create()\n\n\n\n\n/**\n * Camera target position (read only)\n * \n * This returns the point the camera looks at - i.e. the player's \n * eye position. When the camera is zoomed \n * all the way in, this is equivalent to `camera.getPosition()`.\n */\nCamera.prototype.getTargetPosition = function () {\n    var loc = this._localGetTargetPosition()\n    return this.noa.localToGlobal(loc, globalCamPos)\n}\nvar globalCamPos = []\n\n/**\n * Returns the current camera position (read only)\n */\nCamera.prototype.getPosition = function () {\n    var loc = this._localGetPosition()\n    return this.noa.localToGlobal(loc, globalCamPos)\n}\n\n\n\n/**\n * Returns the camera direction vector (read only)\n */\nCamera.prototype.getDirection = function () {\n    return this._dirVector\n}\n\n\n\n\n\n/*\n * \n * \n * \n *          internals below\n * \n * \n * \n */\n\n\n/*\n *  Called before render, if mouseLock etc. is applicable.\n *  Consumes input mouse events x/y, updates camera angle and zoom\n */\n\nCamera.prototype.applyInputsToCamera = function () {\n    // dx/dy from input state\n    var state = this.noa.inputs.state\n    bugFix(state) // TODO: REMOVE EVENTUALLY    \n\n    // convert to rads, using (sens * 0.0066 deg/pixel), like Overwatch\n    var conv = 0.0066 * Math.PI / 180\n    var dy = state.dy * this.sensitivityY * conv\n    var dx = state.dx * this.sensitivityX * conv\n    if (this.inverseY) dy = -dy\n    if (this.inverseX) dx = -dx\n\n    // normalize/clamp angles, update direction vector\n    var twopi = 2 * Math.PI\n    this.heading += (dx < 0) ? dx + twopi : dx\n    if (this.heading > twopi) this.heading -= twopi\n    var maxPitch = Math.PI / 2 - 0.001\n    this.pitch = Math.max(-maxPitch, Math.min(maxPitch, this.pitch + dy))\n\n    vec3.set(this._dirVector, 0, 0, 1)\n    vec3.rotateX(this._dirVector, this._dirVector, origin, this.pitch)\n    vec3.rotateY(this._dirVector, this._dirVector, origin, this.heading)\n}\nvar origin = vec3.create()\n\n\n\n/*\n *  Called before all renders, pre- and post- entity render systems\n */\n\nCamera.prototype.updateBeforeEntityRenderSystems = function () {\n    // zoom update\n    this.currentZoom += (this.zoomDistance - this.currentZoom) * this.zoomSpeed\n}\n\nCamera.prototype.updateAfterEntityRenderSystems = function () {\n    // clamp camera zoom not to clip into solid terrain\n    var maxZoom = cameraObstructionDistance(this)\n    if (this.currentZoom > maxZoom) this.currentZoom = maxZoom\n}\n\n\n\n\n\n\n/*\n *  check for obstructions behind camera by sweeping back an AABB\n */\n\nfunction cameraObstructionDistance(self) {\n    if (!_camBox) {\n        var off = self.noa.worldOriginOffset\n        _camBox = new aabb([0, 0, 0], vec3.clone(_camBoxVec))\n        _getVoxel = (x, y, z) => self.noa.world.getBlockSolidity(x + off[0], y + off[1], z + off[2])\n        vec3.scale(_camBoxVec, _camBoxVec, -0.5)\n    }\n    _camBox.setPosition(self._localGetTargetPosition())\n    _camBox.translate(_camBoxVec)\n    var dist = Math.max(self.zoomDistance, self.currentZoom) + 0.1\n    vec3.scale(_sweepVec, self.getDirection(), -dist)\n    return sweep(_getVoxel, _camBox, _sweepVec, _hitFn, true)\n}\n\nvar _camBoxVec = vec3.fromValues(0.2, 0.2, 0.2)\nvar _sweepVec = vec3.create()\nvar _camBox\nvar _getVoxel\nvar _hitFn = () => true\n\n\n\n\n\n\n// workaround for this Chrome 63 + Win10 bug\n// https://bugs.chromium.org/p/chromium/issues/detail?id=781182\nfunction bugFix(state) {\n    var dx = state.dx\n    var dy = state.dy\n    var wval = document.body.clientWidth / 6\n    var hval = document.body.clientHeight / 6\n    var badx = (Math.abs(dx) > wval && (dx / lastx) < -1)\n    var bady = (Math.abs(dy) > hval && (dy / lasty) < -1)\n    if (badx || bady) {\n        state.dx = lastx\n        state.dy = lasty\n        lastx = (dx > 0) ? 1 : -1\n        lasty = (dy > 0) ? 1 : -1\n    } else {\n        if (dx) lastx = dx\n        if (dy) lasty = dy\n    }\n}\n\nvar lastx = 0\nvar lasty = 0\n","\nimport { constants } from './constants'\n\nexport default function (noa, opts) {\n    return new Registry(noa, opts)\n}\n\n\n\n/*\n *  data structs in the registry:\n *  registry \n *      blockSolidity:     id -> boolean\n *      blockOpacity:      id -> boolean\n *      blockIsFluid:      id -> boolean\n *      blockMats:         id -> 6x matID  [-x, +x, -y, +y, -z, +z]\n *      blockProps         id -> obj of less-often accessed properties\n *      blockMeshes:       id -> obj/null (custom mesh to instantiate)\n *      blockHandlers      id -> instance of `BlockCallbackHolder` or null \n *      matIDs             matName -> matID (int)\n *      matData            matID -> { color, alpha, texture, textureAlpha }\n */\n\n\nvar defaults = {\n    texturePath: ''\n}\n\nvar blockDefaults = {\n    solid: true,\n    opaque: true,\n    fluidDensity: 1.0,\n    viscosity: 0.5,\n}\n\n\n// highest ID that fits into the bits used for voxel IDs\nvar MAX_BLOCK_ID = 0xFFFFFFFF & constants.ID_MASK\n\n\n/**\n * @class\n * @typicalname noa.registry\n * @classdesc for registering block types, materials & properties\n */\n\n\nfunction Registry(noa, opts) {\n    this.noa = noa\n    opts = Object.assign({}, defaults, opts)\n\n\n    /* \n     * \n     *      data structures\n     * \n     */\n\n    // lookup arrays for block props and flags - all keyed by blockID\n    // fill in first value for id=0, empty space\n    var blockSolidity = [false]\n    var blockOpacity = [false]\n    var blockIsFluid = [false]\n    var blockMats = [0, 0, 0, 0, 0, 0]\n    var blockProps = [null]\n    var blockMeshes = [null]\n    var blockHandlers = [null]\n\n    // material data structs\n    var matIDs = {} // mat name -> id\n    var matData = [null] // mat id -> { color, alpha, texture, textureAlpha }\n\n    // option data to save\n    var texturePath = opts.texturePath\n\n\n\n    /* \n     * \n     *      Block registration methods\n     * \n     */\n\n\n\n    /**\n     * Register (by integer ID) a block type and its parameters.\n     * \n     *  `id` param: integer, currently 1..255. This needs to be passed in by the \n     *    client because it goes into the chunk data, which someday will get serialized.\n     * \n     *  `options` param: Recognized fields for the options object:\n     * \n     *  * material: can be:\n     *      * one (String) material name\n     *      * array of 2 names: [top/bottom, sides]\n     *      * array of 3 names: [top, bottom, sides]\n     *      * array of 6 names: [-x, +x, -y, +y, -z, +z]\n     *    If not specified, terrain won't be meshed for the block type\n     *  * solid: (true) solidity for physics purposes\n     *  * opaque: (true) fully obscures neighboring blocks\n     *  * fluid: (false) whether nonsolid block is a fluid (buoyant, viscous..)\n     *  * blockMesh: (null) if specified, noa will create a copy this mesh in the voxel\n     *  * fluidDensity: (1.0) for fluid blocks\n     *  * viscosity: (0.5) for fluid blocks\n     *  * onLoad(): block event handler\n     *  * onUnload(): block event handler\n     *  * onSet(): block event handler\n     *  * onUnset(): block event handler\n     *  * onCustomMeshCreate(): block event handler\n     */\n\n    this.registerBlock = function (id, _options) {\n        _options = _options || {}\n        blockDefaults.solid = !_options.fluid\n        blockDefaults.opaque = !_options.fluid\n        var opts = Object.assign({}, blockDefaults, _options)\n\n        // console.log('register block: ', id, opts)\n        if (id < 1 || id > MAX_BLOCK_ID) throw 'Block id out of range: ' + id\n\n        // if block ID is greater than current highest ID, \n        // register fake blocks to avoid holes in lookup arrays\n        while (id > blockSolidity.length) {\n            this.registerBlock(blockSolidity.length, {})\n        }\n\n        // flags default to solid, opaque, nonfluid\n        blockSolidity[id] = !!opts.solid\n        blockOpacity[id] = !!opts.opaque\n        blockIsFluid[id] = !!opts.fluid\n\n        // store any custom mesh\n        blockMeshes[id] = opts.blockMesh || null\n\n        // parse out material parameter\n        // always store 6 material IDs per blockID, so material lookup is monomorphic\n        var mat = opts.material || null\n        var mats\n        if (!mat) {\n            mats = [null, null, null, null, null, null]\n        } else if (typeof mat == 'string') {\n            mats = [mat, mat, mat, mat, mat, mat]\n        } else if (mat.length && mat.length == 2) {\n            // interpret as [top/bottom, sides]\n            mats = [mat[1], mat[1], mat[0], mat[0], mat[1], mat[1]]\n        } else if (mat.length && mat.length == 3) {\n            // interpret as [top, bottom, sides]\n            mats = [mat[2], mat[2], mat[0], mat[1], mat[2], mat[2]]\n        } else if (mat.length && mat.length == 6) {\n            // interpret as [-x, +x, -y, +y, -z, +z]\n            mats = mat\n        } else throw 'Invalid material parameter: ' + mat\n\n        // argument is material name, but store as material id, allocating one if needed\n        for (var i = 0; i < 6; ++i) {\n            blockMats[id * 6 + i] = getMaterialId(this, matIDs, mats[i], true)\n        }\n\n        // props data object - currently only used for fluid properties\n        blockProps[id] = {}\n\n        // if block is fluid, initialize properties if needed\n        if (blockIsFluid[id]) {\n            blockProps[id].fluidDensity = opts.fluidDensity\n            blockProps[id].viscosity = opts.viscosity\n        }\n\n        // event callbacks\n        var hasHandler = opts.onLoad || opts.onUnload || opts.onSet || opts.onUnset || opts.onCustomMeshCreate\n        blockHandlers[id] = (hasHandler) ? new BlockCallbackHolder(opts) : null\n\n        return id\n    }\n\n\n\n\n    /**\n     * Register (by name) a material and its parameters.\n     * \n     * @param name\n     * @param color\n     * @param textureURL\n     * @param texHasAlpha\n     * @param renderMaterial an optional BABYLON material to be used for block faces with this block material\n     */\n\n    this.registerMaterial = function (name, color, textureURL, texHasAlpha, renderMaterial) {\n        // console.log('register mat: ', name, color, textureURL)\n        var id = matIDs[name] || matData.length\n        matIDs[name] = id\n        var alpha = 1\n        if (color && color.length == 4) {\n            alpha = color.pop()\n        }\n        matData[id] = {\n            color: color || [1, 1, 1],\n            alpha: alpha,\n            texture: textureURL ? texturePath + textureURL : '',\n            textureAlpha: !!texHasAlpha,\n            renderMat: renderMaterial || null,\n        }\n        return id\n    }\n\n\n\n    /*\n     *      quick accessors for querying block ID stuff\n     */\n\n    /** \n     * block solidity (as in physics) \n     * @param id\n     */\n    this.getBlockSolidity = function (id) {\n        return blockSolidity[id]\n    }\n\n    /**\n     * block opacity - whether it obscures the whole voxel (dirt) or \n     * can be partially seen through (like a fencepost, etc)\n     * @param id\n     */\n    this.getBlockOpacity = function (id) {\n        return blockOpacity[id]\n    }\n\n    /** \n     * block is fluid or not\n     * @param id\n     */\n    this.getBlockFluidity = function (id) {\n        return blockIsFluid[id]\n    }\n\n    /** \n     * Get block property object passed in at registration\n     * @param id\n     */\n    this.getBlockProps = function (id) {\n        return blockProps[id]\n    }\n\n    // look up a block ID's face material\n    // dir is a value 0..5: [ +x, -x, +y, -y, +z, -z ]\n    this.getBlockFaceMaterial = function (blockId, dir) {\n        return blockMats[blockId * 6 + dir]\n    }\n\n\n\n\n\n    // look up material color given ID\n    this.getMaterialColor = function (matID) {\n        return matData[matID].color\n    }\n\n    // look up material texture given ID\n    this.getMaterialTexture = function (matID) {\n        return matData[matID].texture\n    }\n\n    // look up material's properties: color, alpha, texture, textureAlpha\n    this.getMaterialData = function (matID) {\n        return matData[matID]\n    }\n\n\n\n\n\n    /*\n     * \n     *   Meant for internal use within the engine\n     * \n     */\n\n\n    // internal access to lookup arrays\n    this._solidityLookup = blockSolidity\n    this._opacityLookup = blockOpacity\n    this._blockMeshLookup = blockMeshes\n    this._blockHandlerLookup = blockHandlers\n\n\n\n\n\n\n    // look up color used for vertices of blocks of given material\n    // - i.e. white if it has a texture, color otherwise\n    this._getMaterialVertexColor = function (matID) {\n        if (matData[matID].texture) return white\n        return matData[matID].color\n    }\n    var white = [1, 1, 1]\n\n\n\n\n\n    /*\n     * \n     *      default initialization\n     * \n     */\n\n    // add a default material and set ID=1 to it\n    // note that registering new block data overwrites the old\n    this.registerMaterial('dirt', [0.4, 0.3, 0], null)\n    this.registerBlock(1, { material: 'dirt' })\n\n\n\n}\n\n\n\n/*\n * \n *          helpers\n * \n */\n\n\n\n// look up material ID given its name\n// if lazy is set, pre-register the name and return an ID\nfunction getMaterialId(reg, matIDs, name, lazyInit) {\n    if (!name) return 0\n    var id = matIDs[name]\n    if (id === undefined && lazyInit) id = reg.registerMaterial(name)\n    return id\n}\n\n\n\n// data class for holding block callback references\nfunction BlockCallbackHolder(opts) {\n    this.onLoad = opts.onLoad || null\n    this.onUnload = opts.onUnload || null\n    this.onSet = opts.onSet || null\n    this.onUnset = opts.onUnset || null\n    this.onCustomMeshCreate = opts.onCustomMeshCreate || null\n}\n","\nvar vec3 = require('gl-vec3')\nvar EntComp = require('ent-comp')\n// var EntComp = require('../../../../npm-modules/ent-comp')\n\n\nimport { updatePositionExtents } from '../components/position'\nimport { setPhysicsFromPosition } from '../components/physics'\n\n\n\nexport default function (noa, opts) {\n    return new Entities(noa, opts)\n}\n\n\n\nvar defaults = {\n    shadowDistance: 10,\n}\n\n\n/**\n * @class Entities\n * @typicalname noa.ents\n * @classdesc Wrangles entities. Aliased as `noa.ents`.\n * \n * This class is an instance of [ECS](https://github.com/andyhall/ent-comp), \n * and as such implements the usual ECS methods.\n * It's also decorated with helpers and accessor functions for getting component existence/state.\n * \n * Expects entity definitions in a specific format - see source `components` folder for examples.\n */\n\nfunction Entities(noa, opts) {\n    // inherit from the ECS library\n    EntComp.call(this)\n\n    this.noa = noa\n    opts = Object.assign({}, defaults, opts)\n\n    // properties\n    /** Hash containing the component names of built-in components. */\n    this.names = {}\n\n    // optional arguments to supply to component creation functions\n    var componentArgs = {\n        'shadow': opts.shadowDistance,\n    }\n\n    // Bundler magic to import everything in the ../components directory\n    // each component module exports a default function: (noa) => compDefinition\n    var reqContext = require.context('../components/', false, /\\.js$/)\n    reqContext.keys().forEach(name => {\n        // convert name ('./foo.js') to bare name ('foo')\n        var bareName = /\\.\\/(.*)\\.js/.exec(name)[1]\n        var arg = componentArgs[bareName] || undefined\n        var compFn = reqContext(name)\n        if (compFn.default) compFn = compFn.default\n        var compDef = compFn(noa, arg)\n        var comp = this.createComponent(compDef)\n        this.names[bareName] = comp\n    })\n\n\n    // decorate the entities object with accessor functions\n    /** @param id */\n    this.isPlayer = function (id) { return id === noa.playerEntity }\n\n    /** @param id */\n    this.hasPhysics = this.getComponentAccessor(this.names.physics)\n\n    /** @param id */\n    this.cameraSmoothed = this.getComponentAccessor(this.names.smoothCamera)\n\n    /** @param id */\n    this.hasMesh = this.getComponentAccessor(this.names.mesh)\n\n    // position functions\n    /** @param id */\n    this.hasPosition = this.getComponentAccessor(this.names.position)\n    var getPos = this.getStateAccessor(this.names.position)\n\n    /** @param id */\n    this.getPositionData = getPos\n\n    /** @param id */\n    this._localGetPosition = function (id) {\n        return getPos(id)._localPosition\n    }\n\n    /** @param id */\n    this.getPosition = function (id) {\n        return getPos(id).position\n    }\n\n    /** @param id */\n    this._localSetPosition = function (id, pos) {\n        var posDat = getPos(id)\n        vec3.copy(posDat._localPosition, pos)\n        updateDerivedPositionData(id, posDat)\n    }\n\n    /** @param id, positionArr */\n    this.setPosition = (id, pos, _yarg, _zarg) => {\n        // check if called with \"x, y, z\" args\n        if (typeof pos === 'number') pos = [pos, _yarg, _zarg]\n        // convert to local and defer impl\n        var loc = noa.globalToLocal(pos, null, [])\n        this._localSetPosition(id, loc)\n    }\n\n    /** @param id, xs, ys, zs */\n    this.setEntitySize = function (id, xs, ys, zs) {\n        var posDat = getPos(id)\n        posDat.width = (xs + zs) / 2\n        posDat.height = ys\n        updateDerivedPositionData(id, posDat)\n    }\n\n    // called when engine rebases its local coords\n    this._rebaseOrigin = function (delta) {\n        this.getStatesList(this.names.position).forEach(state => {\n            vec3.subtract(state._localPosition, state._localPosition, delta)\n            updateDerivedPositionData(state.__id, state)\n        })\n    }\n\n    // helper to update everything derived from `_localPosition`\n    function updateDerivedPositionData(id, posDat) {\n        vec3.copy(posDat._renderPosition, posDat._localPosition)\n        vec3.add(posDat.position, posDat._localPosition, noa.worldOriginOffset)\n        updatePositionExtents(posDat)\n        var physDat = getPhys(id)\n        if (physDat) setPhysicsFromPosition(physDat, posDat)\n    }\n\n\n\n    // physics\n    var getPhys = this.getStateAccessor(this.names.physics)\n    this.getPhysics = getPhys\n    this.getPhysicsBody = function (id) { return getPhys(id).body }\n\n    // misc\n    this.getMeshData = this.getStateAccessor(this.names.mesh)\n    this.getMovement = this.getStateAccessor(this.names.movement)\n    this.getCollideTerrain = this.getStateAccessor(this.names.collideTerrain)\n    this.getCollideEntities = this.getStateAccessor(this.names.collideEntities)\n\n    // pairwise collideEntities event - this is for client to override\n    this.onPairwiseEntityCollision = function (id1, id2) {}\n}\n\n// inherit from EntComp\nEntities.prototype = Object.create(EntComp.prototype)\nEntities.prototype.constructor = Entities\n\n\n\n\n/*\n *\n *    ENTITY MANAGER API\n * \n *  note most APIs are on the original ECS module (ent-comp)\n *  these are some overlaid extras for noa\n *\n */\n\n\n/** @param id,name,state */\nEntities.prototype.addComponentAgain = function (id, name, state) {\n    // removes component first if necessary\n    if (this.hasComponent(id, name)) this.removeComponent(id, name, true)\n    this.addComponent(id, name, state)\n}\n\n\n/** @param x,y,z */\nEntities.prototype.isTerrainBlocked = function (x, y, z) {\n    // checks if terrain location is blocked by entities\n    var off = this.noa.worldOriginOffset\n    var xlocal = Math.floor(x - off[0])\n    var ylocal = Math.floor(y - off[1])\n    var zlocal = Math.floor(z - off[2])\n    var blockExt = [\n        xlocal + 0.001, ylocal + 0.001, zlocal + 0.001,\n        xlocal + 0.999, ylocal + 0.999, zlocal + 0.999,\n    ]\n    var list = this.getStatesList(this.names.collideTerrain)\n    for (var i = 0; i < list.length; i++) {\n        var id = list[i].__id\n        var ext = this.getPositionData(id)._extents\n        if (extentsOverlap(blockExt, ext)) return true\n    }\n    return false\n}\n\n\n\nfunction extentsOverlap(extA, extB) {\n    if (extA[0] > extB[3]) return false\n    if (extA[1] > extB[4]) return false\n    if (extA[2] > extB[5]) return false\n    if (extA[3] < extB[0]) return false\n    if (extA[4] < extB[1]) return false\n    if (extA[5] < extB[2]) return false\n    return true\n}\n\n\n\n\n/** @param box */\nEntities.prototype.getEntitiesInAABB = function (box, withComponent) {\n    // extents to test against\n    var off = this.noa.worldOriginOffset\n    var testExtents = [\n        box.base[0] + off[0], box.base[1] + off[1], box.base[2] + off[2],\n        box.max[0] + off[0], box.max[1] + off[1], box.max[2] + off[2],\n    ]\n    // entity position state list\n    var entStates = (withComponent) ?\n        this.getStatesList(withComponent).map(state => {\n            return this.getPositionData(state.__id)\n        }) : this.getStatesList(this.names.position)\n    // run each test\n    var hits = []\n    entStates.forEach(state => {\n        if (extentsOverlap(testExtents, state._extents)) {\n            hits.push(state.__id)\n        }\n    })\n    return hits\n}\n\n\n\n/** \n * Helper to set up a general entity, and populate with some common components depending on arguments.\n * \n * Parameters: position, width, height [, mesh, meshOffset, doPhysics, shadow]\n * \n * @param position\n * @param width\n * @param height..\n */\nEntities.prototype.add = function (position, width, height, // required\n    mesh, meshOffset, doPhysics, shadow) {\n\n    var self = this\n\n    // new entity\n    var eid = this.createEntity()\n\n    // position component\n    this.addComponent(eid, this.names.position, {\n        position: position || [0, 0, 0],\n        width: width,\n        height: height\n    })\n\n    // rigid body in physics simulator\n    if (doPhysics) {\n        // body = this.noa.physics.addBody(box)\n        this.addComponent(eid, this.names.physics)\n        var body = this.getPhysicsBody(eid)\n\n        // handler for physics engine to call on auto-step\n        var smoothName = this.names.smoothCamera\n        body.onStep = function () {\n            self.addComponentAgain(eid, smoothName)\n        }\n    }\n\n    // mesh for the entity\n    if (mesh) {\n        if (!meshOffset) meshOffset = vec3.create()\n        this.addComponent(eid, this.names.mesh, {\n            mesh: mesh,\n            offset: meshOffset\n        })\n    }\n\n    // add shadow-drawing component\n    if (shadow) {\n        this.addComponent(eid, this.names.shadow, { size: width })\n    }\n\n    return eid\n}\n","/*!\n * noa: an experimental voxel game engine.\n * @url      github.com/andyhall/noa\n * @author   Andy Hall <andy@fenomas.com>\n * @license  MIT\n */\n\nvar vec3 = require('gl-vec3')\nvar ndarray = require('ndarray')\nvar raycast = require('fast-voxel-raycast')\nvar EventEmitter = require('events').EventEmitter\n\nimport createContainer from './lib/container'\nimport createRendering from './lib/rendering'\nimport createWorld from './lib/world'\nimport createInputs from './lib/inputs'\nimport createPhysics from './lib/physics'\nimport createCamera from './lib/camera'\nimport createRegistry from './lib/registry'\nimport createEntities from './lib/entities'\nimport { constants } from './lib/constants'\n\n\n\n\nexport default Engine\n\n\n// profiling flags\nvar PROFILE = 0\nvar PROFILE_RENDER = 0\n\n\n\n\nvar defaults = {\n    debug: false,\n    silent: false,\n    playerHeight: 1.8,\n    playerWidth: 0.6,\n    playerStart: [0, 10, 0],\n    playerAutoStep: false,\n    tickRate: 33, // ms per tick - not ticks per second\n    blockTestDistance: 10,\n    stickyPointerLock: true,\n    dragCameraOutsidePointerLock: true,\n    skipDefaultHighlighting: false,\n    originRebaseDistance: 25,\n}\n\n\n/**\n * Main engine object.\n * Takes a big options object full of flags and settings as a parameter.\n * \n * ```js\n * var opts = {\n *     debug: false,\n *     silent: false,\n *     playerHeight: 1.8,\n *     playerWidth: 0.6,\n *     playerStart: [0, 10, 0],\n *     playerAutoStep: false,\n *     tickRate: 33, // ms per tick - not ticks per second\n *     blockTestDistance: 10,\n *     stickyPointerLock: true,\n *     dragCameraOutsidePointerLock: true,\n *     skipDefaultHighlighting: false,\n *     originRebaseDistance: 25,\n * }\n * var NoaEngine = require('noa-engine')\n * var noa = NoaEngine(opts)\n * ```\n * \n * All option parameters are, well, optional. Note that \n * the root `opts` parameter object is also passed to \n * noa's child modules (rendering, camera, etc). \n * See docs for each module for which options they use.\n * \n * @class\n * @alias Noa\n * @typicalname noa\n * @emits tick(dt)\n * @emits beforeRender(dt)\n * @emits afterRender(dt)\n * @emits targetBlockChanged(blockDesc)\n * @classdesc Root class of the noa engine\n * \n * Extends: `EventEmitter`\n */\n\nfunction Engine(opts) {\n    if (!(this instanceof Engine)) return new Engine(opts)\n\n    /**  version string, e.g. `\"0.25.4\"` */\n    this.version = require('../package.json').version\n\n    opts = Object.assign({}, defaults, opts)\n    this._tickRate = opts.tickRate\n    this._lastRenderTime = 0\n    this._paused = false\n    this._dragOutsideLock = opts.dragCameraOutsidePointerLock\n    var self = this\n\n    if (!opts.silent) {\n        var debugstr = (opts.debug) ? ' (debug)' : ''\n        console.log(`noa-engine v${this.version}${debugstr}`)\n    }\n\n    // world origin offset, used throughout engine for origin rebasing\n    this.worldOriginOffset = [0, 0, 0]\n    this._originRebaseDistance = opts.originRebaseDistance\n\n    // vec3 library used throughout the engine\n    this.vec3 = vec3\n\n    // how far engine is into the current tick. Updated each render.\n    this.positionInCurrentTick = 0\n\n    /** String identifier for the current world. (It's safe to ignore this if\n     * your game doesn't need to swap between levels/worlds.)\n     */\n    this.worldName = 'default'\n\n    /**\n     * container (html/div) manager\n     * @type {Container}\n     */\n    this.container = createContainer(this, opts)\n\n    /**\n     * inputs manager - abstracts key/mouse input\n     * @type {Inputs}\n     */\n    this.inputs = createInputs(this, opts, this.container.element)\n\n    /**\n     * block/item property registry\n     * @type {Registry}\n     */\n    this.registry = createRegistry(this, opts)\n\n    /**\n     * world manager\n     * @type {World}\n     */\n    this.world = createWorld(this, opts)\n\n    /**\n     * Rendering manager\n     * @type {Rendering}\n     */\n    this.rendering = createRendering(this, opts, this.container.canvas)\n\n    /**\n     * physics engine - solves collisions, properties, etc.\n     * @type {Physics}\n     */\n    this.physics = createPhysics(this, opts)\n\n    /** Entity manager / Entity Component System (ECS) \n     * Aliased to `noa.ents` for convenience.\n     * @type {Entities}\n     */\n    this.entities = createEntities(this, opts)\n    this.ents = this.entities\n    var ents = this.ents\n\n    /** Entity id for the player entity */\n    this.playerEntity = ents.add(\n        opts.playerStart, // starting location\n        opts.playerWidth, opts.playerHeight,\n        null, null, // no mesh for now, no meshOffset, \n        true, true\n    )\n\n    // make player entity it collide with terrain and other entities\n    ents.addComponent(this.playerEntity, ents.names.collideTerrain)\n    ents.addComponent(this.playerEntity, ents.names.collideEntities)\n\n    // adjust default physics parameters\n    var body = ents.getPhysicsBody(this.playerEntity)\n    body.gravityMultiplier = 2 // less floaty\n    body.autoStep = opts.playerAutoStep // auto step onto blocks\n\n    // input component - sets entity's movement state from key inputs\n    ents.addComponent(this.playerEntity, ents.names.receivesInputs)\n\n    // add a component to make player mesh fade out when zooming in\n    ents.addComponent(this.playerEntity, ents.names.fadeOnZoom)\n\n    // movement component - applies movement forces\n    // todo: populate movement settings from options\n    var moveOpts = {\n        airJumps: 1\n    }\n    ents.addComponent(this.playerEntity, ents.names.movement, moveOpts)\n\n\n    /**\n     * Manages camera, view angle, etc.\n     * @type {Camera}\n     */\n    this.camera = createCamera(this, opts)\n\n\n    // set up block targeting\n    this.blockTestDistance = opts.blockTestDistance\n\n    /** function for which block IDs are targetable. \n     * Defaults to a solidity check, but can be overridden */\n    this.blockTargetIdCheck = this.registry.getBlockSolidity\n\n    /** Dynamically updated object describing the currently targeted block.\n     * Gets updated each tick, to `null` if not block is targeted, or \n     * to an object like:\n     * \n     *     {\n     *        blockID,   // voxel ID\n     *        position,  // the (solid) block being targeted\n     *        adjacent,  // the (non-solid) block adjacent to the targeted one\n     *        normal,    // e.g. [0, 1, 0] when player is targting the top face of a voxel\n     *     }\n     */\n    this.targetedBlock = null\n\n    // add a default block highlighting function\n    if (!opts.skipDefaultHighlighting) {\n        // the default listener, defined onto noa in case people want to remove it later\n        this.defaultBlockHighlightFunction = function (tgt) {\n            if (tgt) {\n                self.rendering.highlightBlockFace(true, tgt.position, tgt.normal)\n            } else {\n                self.rendering.highlightBlockFace(false)\n            }\n        }\n        this.on('targetBlockChanged', this.defaultBlockHighlightFunction)\n    }\n\n\n    // expose constants, for HACKING™\n    this._constants = constants\n\n    // temp hacks for development\n    if (opts.debug) {\n        window.noa = this\n        window.scene = this.rendering._scene\n        window.ndarray = ndarray\n        window.vec3 = vec3\n        ents.getMovement(1).airJumps = 999\n        this.setViewDistance = function (dist) {\n            var cs = this.world.chunkSize\n            this.world.chunkAddDistance = dist / cs\n            this.world.chunkRemoveDistance = dist / cs + 1\n            this.world._lastPlayerChunkID = '' // pings noa's chunk queues\n        }\n    }\n\n    // add hooks to throw helpful errors when using deprecated methods\n    deprecateStuff(this)\n}\n\nEngine.prototype = Object.create(EventEmitter.prototype)\n\n\n\n\n\n/*\n *\n *\n *   Core Engine API\n *\n *\n */\n\n\n/*\n * Tick function, called by container module at a fixed timestep. Emits #tick(dt),\n * where dt is the tick rate in ms (default 16.6)\n */\n\nEngine.prototype.tick = function () {\n    if (this._paused) {\n        if (this.world.worldGenWhilePaused) this.world.tick(dt)\n        return\n    }\n    profile_hook('start')\n    checkWorldOffset(this)\n    var dt = this._tickRate // fixed timesteps!\n    this.world.tick(dt) // chunk creation/removal\n    profile_hook('world')\n    if (!this.world.playerChunkLoaded) {\n        // when waiting on worldgen, just tick the meshing queue and exit\n        this.rendering.tick(dt)\n        return\n    }\n    this.physics.tick(dt) // iterates physics\n    profile_hook('physics')\n    this.rendering.tick(dt) // does deferred chunk meshing\n    profile_hook('rendering')\n    updateBlockTargets(this) // finds targeted blocks, and highlights one if needed\n    profile_hook('targets')\n    this.entities.tick(dt) // runs all entity systems\n    profile_hook('entities')\n    this.emit('tick', dt)\n    profile_hook('tick event')\n    profile_hook('end')\n    // clear accumulated scroll inputs (mouseMove is cleared on render)\n    var st = this.inputs.state\n    st.scrollx = st.scrolly = st.scrollz = 0\n}\n\n\n\n\n\n/*\n * Render function, called every animation frame. Emits #beforeRender(dt), #afterRender(dt) \n * where dt is the time in ms *since the last tick*.\n */\n\nEngine.prototype.render = function (framePart) {\n    // frame position - for rendering movement between ticks\n    this.positionInCurrentTick = framePart\n    // dt - actual time difference (in ms), for animating things\n    // that aren't tied to game tick rate\n    var t = performance.now()\n    var dt = t - (this._lastRenderTime || (t - 16))\n    this._lastRenderTime = t\n\n    // when paused, just optionally ping worldgen, then exit\n    if (this._paused) {\n        if (this.world.worldGenWhilePaused) this.world.render()\n        return\n    }\n\n    profile_hook_render('start')\n\n    // only move camera during pointerlock or mousedown, or if pointerlock is unsupported\n    if (this.container.hasPointerLock ||\n        !this.container.supportsPointerLock ||\n        (this._dragOutsideLock && this.inputs.state.fire)) {\n        this.camera.applyInputsToCamera()\n    }\n    profile_hook_render('init')\n\n    // brief run through meshing queue\n    this.world.render(dt)\n    profile_hook_render('meshing')\n\n    // entity render systems\n    this.camera.updateBeforeEntityRenderSystems()\n    this.entities.render(dt)\n    this.camera.updateAfterEntityRenderSystems()\n    profile_hook_render('entities')\n\n    // events and render\n    this.emit('beforeRender', dt)\n    profile_hook_render('before render')\n\n    this.rendering.render(dt)\n    profile_hook_render('render')\n\n    this.emit('afterRender', dt)\n    profile_hook_render('after render')\n    profile_hook_render('end')\n\n    // clear accumulated mouseMove inputs (scroll inputs cleared on render)\n    this.inputs.state.dx = this.inputs.state.dy = 0\n}\n\n\n\n\n\n\n\n\n\n/*\n *   Rebasing local <-> global coords\n */\n\n\n/** \n * Precisely converts a world position to the current internal \n * local frame of reference.\n * \n * See `/doc/positions.md` for more info.\n * \n * Params: \n *  * `global`: input position in global coords\n *  * `globalPrecise`: (optional) sub-voxel offset to the global position\n *  * `local`: output array which will receive the result\n */\nEngine.prototype.globalToLocal = function (global, globalPrecise, local) {\n    var off = this.worldOriginOffset\n    if (globalPrecise) {\n        for (var i = 0; i < 3; i++) {\n            var coord = global[i] - off[i]\n            coord += globalPrecise[i]\n            local[i] = coord\n        }\n        return local\n    } else {\n        return vec3.sub(local, global, off)\n    }\n}\n\n/** \n * Precisely converts a world position to the current internal \n * local frame of reference.\n * \n * See `/doc/positions.md` for more info.\n * \n * Params: \n *  * `local`: input array of local coords\n *  * `global`: output array which receives the result\n *  * `globalPrecise`: (optional) sub-voxel offset to the output global position\n * \n * If both output arrays are passed in, `global` will get int values and \n * `globalPrecise` will get fractional parts. If only one array is passed in,\n * `global` will get the whole output position.\n */\nEngine.prototype.localToGlobal = function (local, global, globalPrecise) {\n    var off = this.worldOriginOffset\n    if (globalPrecise) {\n        for (var i = 0; i < 3; i++) {\n            var floored = Math.floor(local[i])\n            global[i] = floored + off[i]\n            globalPrecise[i] = local[i] - floored\n        }\n        return global\n    } else {\n        return vec3.add(global, local, off)\n    }\n}\n\n\n\n\n/*\n * \n *   rebase world origin offset around the player if necessary\n * \n */\nfunction checkWorldOffset(noa) {\n    var lpos = noa.ents.getPositionData(noa.playerEntity)._localPosition\n    var cutoff = noa._originRebaseDistance\n    if (vec3.sqrLen(lpos) < cutoff * cutoff) return\n    var delta = []\n    for (var i = 0; i < 3; i++) {\n        var d = Math.floor(lpos[i])\n        delta[i] = d\n        noa.worldOriginOffset[i] += d\n    }\n    noa.rendering._rebaseOrigin(delta)\n    noa.entities._rebaseOrigin(delta)\n}\n\n\n\n\n\n\n/*\n *   Utility APIs\n */\n\n/** \n * Pausing the engine will also stop render/tick events, etc.\n * @param paused\n */\nEngine.prototype.setPaused = function (paused) {\n    this._paused = !!paused\n    // when unpausing, clear any built-up mouse inputs\n    if (!paused) {\n        this.inputs.state.dx = this.inputs.state.dy = 0\n    }\n}\n\n/** @param x,y,z */\nEngine.prototype.getBlock = function (x, y, z) {\n    if (x.length) {\n        return this.world.getBlockID(x[0], x[1], x[2])\n    } else {\n        return this.world.getBlockID(x, y, z)\n    }\n}\n\n/** @param x,y,z */\nEngine.prototype.setBlock = function (id, x, y, z) {\n    // skips the entity collision check\n    if (x.length) {\n        return this.world.setBlockID(id, x[0], x[1], x[2])\n    } else {\n        return this.world.setBlockID(id, x, y, z)\n    }\n}\n\n/**\n * Adds a block unless obstructed by entities \n * @param id,x,y,z */\nEngine.prototype.addBlock = function (id, x, y, z) {\n    // add a new terrain block, if nothing blocks the terrain there\n    if (x.length) {\n        if (this.entities.isTerrainBlocked(x[0], x[1], x[2])) return\n        this.world.setBlockID(id, x[0], x[1], x[2])\n        return id\n    } else {\n        if (this.entities.isTerrainBlocked(x, y, z)) return\n        this.world.setBlockID(id, x, y, z)\n        return id\n    }\n}\n\n\n\n\n\n\n\n\n/**\n * Raycast through the world, returning a result object for any non-air block\n * @param pos (default: to player eye position)\n * @param vec (default: to camera vector)\n * @param dist (default: `noa.blockTestDistance`)\n * @param blockTestFunction (default: voxel solidity)\n * \n * Returns: `null`, or an object with array properties: `position`, \n * `normal`, `_localPosition`. \n * \n * See `/doc/positions.md` for info on working with precise positions.\n */\nEngine.prototype.pick = function (pos, vec, dist, blockIdTestFunction) {\n    if (dist === 0) return null\n    // input position to local coords, if any\n    if (pos) {\n        this.globalToLocal(pos, null, _pickPos)\n        pos = _pickPos\n    }\n    return this._localPick(pos, vec, dist, blockIdTestFunction)\n}\nvar _pickPos = vec3.create()\n\n\n\n/**\n * Do a raycast in local coords. \n * See `/doc/positions.md` for more info.\n * @param pos\n * @param vec\n * @param dist\n * @param blockTestFunction\n */\n\nEngine.prototype._localPick = function (pos, vec, dist, blockIdTestFunction) {\n    // do a raycast in local coords - result obj will be in global coords\n    if (dist === 0) return null\n    var testFn = blockIdTestFunction || this.registry.getBlockSolidity\n    var world = this.world\n    var off = this.worldOriginOffset\n    var testVoxel = function (x, y, z) {\n        var id = world.getBlockID(x + off[0], y + off[1], z + off[2])\n        return testFn(id)\n    }\n    if (!pos) pos = this.camera._localGetTargetPosition()\n    vec = vec || this.camera.getDirection()\n    dist = dist || this.blockTestDistance\n    var rpos = _hitResult._localPosition\n    var rnorm = _hitResult.normal\n    var hit = raycast(testVoxel, pos, vec, dist, rpos, rnorm)\n    if (!hit) return null\n    // position is right on a voxel border - adjust it so that flooring works reliably\n    // adjust along normal direction, i.e. away from the block struck\n    vec3.scaleAndAdd(rpos, rpos, rnorm, 0.01)\n    // add global result\n    this.localToGlobal(rpos, _hitResult.position)\n    return _hitResult\n}\nvar _hitResult = {\n    _localPosition: vec3.create(),\n    position: [0, 0, 0],\n    normal: [0, 0, 0],\n}\n\n\n\n\n\n\n// Each frame, by default pick along the player's view vector \n// and tell rendering to highlight the struck block face\nfunction updateBlockTargets(noa) {\n    var newhash = ''\n    var blockIdFn = noa.blockTargetIdCheck || noa.registry.getBlockSolidity\n    var result = noa._localPick(null, null, null, blockIdFn)\n    if (result) {\n        var dat = _targetedBlockDat\n        // pick stops just shy of voxel boundary, so floored pos is the adjacent voxel\n        vec3.floor(dat.adjacent, result.position)\n        vec3.copy(dat.normal, result.normal)\n        vec3.sub(dat.position, dat.adjacent, dat.normal)\n        dat.blockID = noa.world.getBlockID(dat.position[0], dat.position[1], dat.position[2])\n        noa.targetedBlock = dat\n        newhash = dat.position.join('|') + dat.normal.join('|') + '|' + dat.blockID\n    } else {\n        noa.targetedBlock = null\n    }\n    if (newhash != _prevTargetHash) {\n        noa.emit('targetBlockChanged', noa.targetedBlock)\n        _prevTargetHash = newhash\n    }\n}\n\nvar _targetedBlockDat = {\n    blockID: 0,\n    position: [],\n    normal: [],\n    adjacent: [],\n}\n\nvar _prevTargetHash = ''\n\n\n\n\n/*\n * \n *  add some hooks for guidance on removed APIs\n * \n */\n\nfunction deprecateStuff(noa) {\n    var ver = `0.27`\n    var dep = (loc, name, msg) => {\n        var throwFn = () => { throw `This property changed in ${ver} - ${msg}` }\n        Object.defineProperty(loc, name, { get: throwFn, set: throwFn })\n    }\n    dep(noa, 'getPlayerEyePosition', 'to get the camera/player offset see API docs for `noa.camera.cameraTarget`')\n    dep(noa, 'setPlayerEyePosition', 'to set the camera/player offset see API docs for `noa.camera.cameraTarget`')\n    dep(noa, 'getPlayerPosition', 'use `noa.ents.getPosition(noa.playerEntity)` or similar')\n    dep(noa, 'getCameraVector', 'use `noa.camera.getDirection`')\n    dep(noa, 'getPlayerMesh', 'use `noa.ents.getMeshData(noa.playerEntity).mesh` or similar')\n    dep(noa, 'playerBody', 'use `noa.ents.getPhysicsBody(noa.playerEntity)`')\n    dep(noa.rendering, 'zoomDistance', 'use `noa.camera.zoomDistance`')\n    dep(noa.rendering, '_currentZoom', 'use `noa.camera.currentZoom`')\n    dep(noa.rendering, '_cameraZoomSpeed', 'use `noa.camera.zoomSpeed`')\n    dep(noa.rendering, 'getCameraVector', 'use `noa.camera.getDirection`')\n    dep(noa.rendering, 'getCameraPosition', 'use `noa.camera.getLocalPosition`')\n    dep(noa.rendering, 'getCameraRotation', 'use `noa.camera.heading` and `noa.camera.pitch`')\n    dep(noa.rendering, 'setCameraRotation', 'to customize camera behavior see API docs for `noa.camera`')\n    ver = '0.28'\n    dep(noa.rendering, 'makeMeshInstance', 'removed, use Babylon\\'s `mesh.createInstance`')\n    dep(noa.world, '_maxChunksPendingCreation', 'use `maxChunksPendingCreation` (no \"_\")')\n    dep(noa.world, '_maxChunksPendingMeshing', 'use `maxChunksPendingMeshing` (no \"_\")')\n    dep(noa.world, '_maxProcessingPerTick', 'use `maxProcessingPerTick` (no \"_\")')\n    dep(noa.world, '_maxProcessingPerRender', 'use `maxProcessingPerRender` (no \"_\")')\n}\n\n\n\n\n\n\n\nimport { makeProfileHook } from './lib/util'\nvar profile_hook = (PROFILE) ?\n    makeProfileHook(200, 'tick   ') : () => { }\nvar profile_hook_render = (PROFILE_RENDER) ?\n    makeProfileHook(200, 'render ') : () => { }\n","\n\n/*\n * \n * \n *\t\ttestbed world generation\n * \n * \n*/\n\n// this module implements two \"worlds\" of voxel data\nvar WORLD1 = 'world1'\nvar WORLD2 = 'world2'\n\n// storage for data from voxels that were unloaded\nvar cruncher = require('voxel-crunch')\nvar storage = {}\nvar chunkIsStored = (id) => { return !!storage[id] }\nvar storeChunk = (id, arr) => { storage[id] = cruncher.encode(arr.data) }\nvar retrieveChunk = (id, arr) => { cruncher.decode(storage[id], arr.data) }\n\n\n\n\n\nexport function initWorldGen(noa, blockIDs) {\n\n    // init world name and add binding to swap it    \n    noa.worldName = WORLD1\n    noa.inputs.bind('swap-world', 'O')\n    noa.inputs.down.on('swap-world', function () {\n        noa.worldName = (noa.worldName === WORLD1) ? WORLD2 : WORLD1\n    })\n\n\n    // catch engine's chunk removal event, and store the data\n    noa.world.on('chunkBeingRemoved', function (id, array, userData) {\n        storeChunk(id, array)\n    })\n\n\n    // catch worldgen requests, and queue them to handle asynchronously\n    var requestQueue = []\n    noa.world.on('worldDataNeeded', function (id, array, x, y, z, worldName) {\n        requestQueue.push({ id, array, x, y, z, worldName })\n    })\n\n\n\n    // process the worldgen request queue:\n    setInterval(function () {\n        if (requestQueue.length === 0) return\n        var req = requestQueue.shift()\n        if (chunkIsStored(req.id)) {\n            retrieveChunk(req.id, req.array)\n        } else {\n            generateChunk(req.array, req.x, req.y, req.z, req.worldName)\n        }\n        // pass the finished data back to the game engine\n        noa.world.setChunkData(req.id, req.array)\n    }, 10)\n\n\n\n\n    // two versions of world data\n    // `data` is an ndarray - see https://github.com/scijs/ndarray\n    function generateChunk(array, x, y, z, worldName) {\n        if (worldName === WORLD1) generateChunk1(array, x, y, z)\n        if (worldName === WORLD2) generateChunk2(array, x, y, z)\n    }\n\n    function generateChunk1(array, x, y, z) {\n        for (var i = 0; i < array.shape[0]; ++i) {\n            for (var k = 0; k < array.shape[2]; ++k) {\n                var height = getHeightMap(x + i, z + k, 10, 30)\n                for (var j = 0; j < array.shape[1]; ++j) {\n                    var b = decideBlock(x + i, y + j, z + k, height)\n                    if (b) array.set(i, j, k, b)\n                }\n            }\n        }\n    }\n\n    function generateChunk2(array, x, y, z) {\n        for (var i = 0; i < array.shape[0]; ++i) {\n            for (var k = 0; k < array.shape[2]; ++k) {\n                var height = getHeightMap(x + i, z + k, 20, 40)\n                for (var j = 0; j < array.shape[1]; ++j) {\n                    var b = decideBlock(x + i, y + j, z + k, height)\n                    if (b === blockIDs.grassID) b = blockIDs.grass2ID\n                    if (b) array.set(i, j, k, b)\n                }\n            }\n        }\n    }\n\n\n\n\n\n    // helpers\n\n    // worldgen - return a heightmap for a given [x,z]\n    function getHeightMap(x, z, xsize, zsize) {\n        var xs = 0.8 + 2 * Math.sin(x / xsize)\n        var zs = 0.4 + 2 * Math.sin(z / zsize + x / 30)\n        return xs + zs\n    }\n\n    function decideBlock(x, y, z, height) {\n        // flat area to NE\n        if (x > 0 && z > 0) {\n            var h = 1\n            if (z == 63 || x == 63) h = 20\n            return (y < h) ? blockIDs.grassID : 0\n        }\n        // general stuff\n        if (y < height) {\n            return (y < 0) ? blockIDs.dirtID : blockIDs.grassID\n        } else {\n            return (y < 1) ? blockIDs.waterID : 0\n        }\n    }\n\n\n\n    // After the world is initialzed, fill in a bunch of test blocks. \n    // There's no particular significance to these, I use them to \n    // debug meshing and AO and whatnot\n\n    setTimeout(function () {\n        addWorldFeatures()\n    }, 1000)\n\n    function addWorldFeatures() {\n        noa.setBlock(blockIDs.testID1, -6, 5, 6)\n        noa.setBlock(blockIDs.testID2, -4, 5, 6)\n        noa.setBlock(blockIDs.testID3, -2, 5, 6)\n\n        noa.setBlock(blockIDs.waterPole, -18, -1, 6)\n        noa.setBlock(blockIDs.waterPole, -16, -1, 6)\n        noa.setBlock(blockIDs.waterPole, -14, -1, 6)\n\n        var z = 5\n        makeRows(10, 5, z, blockIDs.shinyDirtID)\n        makeRows(10, 5, z + 2, blockIDs.dirtID)\n        makeRows(10, 5, z + 5, blockIDs.dirtID)\n        makeRows(10, 5, z + 9, blockIDs.dirtID)\n        makeRows(10, 5, z + 14, blockIDs.dirtID)\n        z += 18\n        makeRows(10, 5, z, blockIDs.customID)\n        makeRows(10, 5, z + 2, blockIDs.customID)\n        makeRows(10, 5, z + 5, blockIDs.customID)\n        makeRows(10, 5, z + 9, blockIDs.customID)\n        makeRows(10, 5, z + 14, blockIDs.customID)\n    }\n\n    function makeRows(length, x, z, block) {\n        for (var i = 0; i < length; i++) {\n            noa.setBlock(block, x + i, 1, z + i)\n            noa.setBlock(block, length * 2 + x - i, 1, z + i)\n        }\n    }\n}\n\n","\n\nimport { Mesh } from '@babylonjs/core/Meshes/mesh'\n\n\n/*\n * \n *      helpers for setting up entities\n * \n*/\n\n\nexport function setupPlayerEntity(noa) {\n    // get the player entity's ID and other info (aabb, size)\n    var eid = noa.playerEntity\n    var dat = noa.entities.getPositionData(eid)\n    var w = dat.width\n    var h = dat.height\n\n    // make a Babylon.js mesh and scale it, etc.\n    var playerMesh = Mesh.CreateBox('player', 1, noa.rendering.getScene())\n    playerMesh.scaling.x = playerMesh.scaling.z = w\n    playerMesh.scaling.y = h\n\n    // offset of mesh relative to the entity's \"position\" (center of its feet)\n    var offset = [0, h / 2, 0]\n\n    // a \"mesh\" component to the player entity\n    noa.entities.addComponent(eid, noa.entities.names.mesh, {\n        mesh: playerMesh,\n        offset: offset\n    })\n}\n\n\n\nexport function shootBouncyBall(noa) {\n    var ents = noa.entities\n    var radius = 0.2\n\n    if (!ballMesh) {\n        ballMesh = Mesh.CreateSphere('ball', 6, 2 * radius, noa.rendering.getScene())\n    }\n\n    // syntatic sugar for creating a default entity\n    var playPos = ents.getPosition(noa.playerEntity)\n    var pos = [playPos[0], playPos[1] + 0.5, playPos[2]]\n    var width = 2 * radius\n    var height = 2 * radius\n\n    var mesh = ballMesh.createInstance('ball_instance')\n    var meshOffset = [0, radius, 0]\n    var doPhysics = true\n    var shadow = true\n\n    var id = noa.entities.add(\n        pos, width, height, // required\n        mesh, meshOffset, doPhysics, shadow // optional\n    )\n\n    // adjust physics body\n    var body = ents.getPhysicsBody(id)\n    body.restitution = 0.8\n    body.friction = 0.7\n    var dir = noa.camera.getDirection()\n    var imp = []\n    for (var i = 0; i < 3; i++) imp[i] = 5 * dir[i]\n    imp[1] += 1\n    body.applyImpulse(imp)\n\n    // add an entity collision handler, doing fake pseudo physics\n    // (physics engine only does entity-terrain collisions, not entity-entity)\n    if (!collideHandler) collideHandler = (id, other) => {\n        var p1 = ents.getPosition(id)\n        var p2 = ents.getPosition(other)\n        var imp = []\n        for (var i = 0; i < 3; i++) imp[i] = 2 * (p1[i] - p2[i])\n        var b = ents.getPhysicsBody(id)\n        b.applyImpulse(imp)\n    }\n    ents.addComponent(id, ents.names.collideEntities, {\n        cylinder: true,\n        callback: (other) => collideHandler(id, other)\n    })\n\n\n    // add a custom component to remove entities if they get too far away\n    if (!removeComp) removeComp = ents.createComponent({\n        name: 'remove',\n        system: (dt, states) => {\n            var p1 = ents.getPosition(noa.playerEntity)\n            states.forEach(state => {\n                var p2 = ents.getPosition(state.__id)\n                var dist = 0\n                for (var i = 0; i < 3; i++) dist += Math.abs(p1[i] - p2[i])\n                if (dist > 500) ents.deleteEntity(state.__id)\n            })\n        }\n    })\n    ents.addComponent(id, removeComp)\n\n}\n\nvar ballMesh\nvar collideHandler\nvar removeComp\n\n","\n\n/* \n *\n *\n *      Testbed.\n *\n * \n */\n\n\nimport Engine from 'noa-engine'\nimport { initRegistration } from './registration'\nimport { initWorldGen } from './worldgen'\nimport { setupPlayerEntity } from './entities'\nimport { setupInteractions } from './actions'\n\n\n\n// create engine\nvar noa = new Engine({\n    debug: true,\n    showFPS: true,\n    inverseY: true,\n    inverseX: false,\n    chunkSize: 32,\n    chunkAddDistance: 3.5,\n    chunkRemoveDistance: 3.0,\n    blockTestDistance: 50,\n    texturePath: 'textures/',\n    playerStart: [0.5, 5, 0.5],\n    playerHeight: 1.4,\n    playerWidth: 0.6,\n    playerAutoStep: true,\n    useAO: true,\n    AOmultipliers: [0.92, 0.8, 0.5],\n    reverseAOmultiplier: 1.0,\n})\n\n\n// this registers all the blocks and materials\nvar blockIDs = initRegistration(noa)\n\n// this sets up worldgen\ninitWorldGen(noa, blockIDs)\n\n// adds a mesh to player\nsetupPlayerEntity(noa)\n\n// does stuff on button presses\nsetupInteractions(noa)\n\n","\nimport { Texture } from '@babylonjs/core/Materials/Textures'\nimport { Mesh } from '@babylonjs/core/Meshes/mesh'\nimport { Vector3, Matrix } from '@babylonjs/core/Maths/math'\n\n\n\n\n/*\n * \n *\t\tRegister a bunch of blocks and materials and whatnot\n * \n*/\n\nexport function initRegistration(noa) {\n\n    // block materials\n    var brownish = [0.45, 0.36, 0.22]\n    var greenish = [0.1, 0.8, 0.2]\n    var greenish2 = [0.1, 0.6, 0.2]\n    noa.registry.registerMaterial('grass', greenish, null)\n    noa.registry.registerMaterial('grass2', greenish2, null)\n    noa.registry.registerMaterial('dirt', brownish, null, false)\n    var strs = ['a', 'b', 'c', 'd', '1', '2']\n    for (var i = 0; i < 6; i++) {\n        var s = strs[i]\n        noa.registry.registerMaterial(s, null, s + '.png')\n        noa.registry.registerMaterial('t' + s, null, 't' + s + '.png', true)\n    }\n    noa.registry.registerMaterial('water', [0.5, 0.5, 0.8, 0.7], null)\n\n\n    // do some Babylon.js stuff with the scene, materials, etc.\n    var scene = noa.rendering.getScene()\n\n\n    // register a shinyDirt block with a custom render material\n    var shinyMat = noa.rendering.makeStandardMaterial('shinyDirtMat')\n    shinyMat.specularColor.copyFromFloats(1, 1, 1)\n    shinyMat.specularPower = 32\n    shinyMat.bumpTexture = new Texture('textures/stone.png', scene)\n    noa.registry.registerMaterial('shinyDirt', brownish, null, false, shinyMat)\n\n\n    // object block mesh\n    var mesh = Mesh.CreateBox('b', 1, scene)\n    var mat = Matrix.Scaling(0.2, 1, 0.2)\n    mat.setTranslation(new Vector3(0, 0.5, 0))\n    mesh.bakeTransformIntoVertices(mat)\n    scene.removeMesh(mesh)\n\n\n    // block types registration\n    var blockIDs = {}\n    var _id = 1\n\n    blockIDs.dirtID = noa.registry.registerBlock(_id++, { material: 'dirt' })\n    blockIDs.shinyDirtID = noa.registry.registerBlock(_id++, { material: 'shinyDirt' })\n    blockIDs.grassID = noa.registry.registerBlock(_id++, { material: 'grass' })\n    blockIDs.grass2ID = noa.registry.registerBlock(_id++, { material: 'grass2' })\n    blockIDs.testID1 = noa.registry.registerBlock(_id++, { material: ['b', 'd', '1', '2', 'c', 'a'] })\n    blockIDs.testID2 = noa.registry.registerBlock(_id++, {\n        material: ['tb', 'td', 't1', 't2', 'tc', 'ta'],\n        opaque: false,\n    })\n    blockIDs.testID3 = noa.registry.registerBlock(_id++, { material: ['1', '2', 'a'] })\n    blockIDs.waterID = noa.registry.registerBlock(_id++, {\n        material: 'water',\n        fluid: true\n    })\n    blockIDs.customID = noa.registry.registerBlock(_id++, {\n        blockMesh: mesh,\n        opaque: false,\n        onCustomMeshCreate: function (mesh, x, y, z) {\n            mesh.rotation.y = ((x + 0.234) * 1.234 + (z + 0.567) * 6.78) % (2 * Math.PI)\n        },\n    })\n\n    blockIDs.waterPole = noa.registry.registerBlock(_id++, {\n        blockMesh: mesh,\n        solid: true,\n        opaque: false,\n        material: 'water',\n        fluid: true,\n    })\n\n    return blockIDs\n}\n\n\n","\n\nimport { shootBouncyBall } from './entities'\nimport '@babylonjs/core/Debug/debugLayer'\n\n\n/*\n * \n *      interactivity\n * \n*/\n\n\nexport function setupInteractions(noa) {\n\n    // on left mouse, set targeted block to be air\n    noa.inputs.down.on('fire', function () {\n        if (noa.targetedBlock) noa.setBlock(0, noa.targetedBlock.position)\n    })\n\n\n    // place block on alt-fire (RMB/E)\n    var pickedID = 1\n    noa.inputs.down.on('alt-fire', function () {\n        if (noa.targetedBlock) noa.addBlock(pickedID, noa.targetedBlock.adjacent)\n    })\n\n\n    // pick block on middle fire (MMB/Q)\n    noa.inputs.down.on('mid-fire', function () {\n        if (noa.targetedBlock) pickedID = noa.targetedBlock.blockID\n    })\n\n\n    // pause (P)\n    noa.inputs.bind('pause', 'P')\n    noa.inputs.down.on('pause', function () {\n        paused = !paused\n        noa.setPaused(paused)\n    })\n    var paused = false\n\n\n    // shoot a bouncy ball (1)\n    noa.inputs.bind('shoot', '1')\n    var shoot = () => shootBouncyBall(noa)\n    var interval, timeout\n    noa.inputs.down.on('shoot', function () {\n        shoot()\n        timeout = setTimeout(() => {\n            interval = setInterval(shoot, 50)\n        }, 400)\n    })\n    noa.inputs.up.on('shoot', function () {\n        clearTimeout(timeout)\n        clearInterval(interval)\n    })\n\n\n    // each tick, consume any scroll events and use them to zoom camera\n    noa.on('tick', function (dt) {\n        var scroll = noa.inputs.state.scrolly\n        if (scroll !== 0) {\n            noa.camera.zoomDistance += (scroll > 0) ? 1 : -1\n            if (noa.camera.zoomDistance < 0) noa.camera.zoomDistance = 0\n            if (noa.camera.zoomDistance > 10) noa.camera.zoomDistance = 10\n        }\n    })\n\n\n    // launch Babylon debug layer when pressing \"Z\"\n    var debug = false\n    var scene = noa.rendering.getScene()\n    noa.inputs.bind('debug', 'Z')\n    noa.inputs.down.on('debug', () => {\n        // inspector is very heavy, so load it via dynamic import\n        import('@babylonjs/inspector').then(data => {\n            debug = !debug\n            if (debug) scene.debugLayer.show()\n            else scene.debugLayer.hide()\n        })\n    })\n\n\n}\n\n"],"sourceRoot":""}